var X3=Object.defineProperty;var Y3=(n,e,t)=>e in n?X3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var q=(n,e,t)=>(Y3(n,typeof e!="symbol"?e+"":e,t),t),iS=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var l=(n,e,t)=>(iS(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},_=(n,e,t,s)=>(iS(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t);var $t=(n,e,t,s)=>({set _(r){_(n,e,r,t)},get _(){return l(n,e,s)}}),C=(n,e,t)=>(iS(n,e,"access private method"),t);function ZR(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function u1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Q3(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var ej={exports:{}},d1={},tj={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy=Symbol.for("react.element"),J3=Symbol.for("react.portal"),Z3=Symbol.for("react.fragment"),e4=Symbol.for("react.strict_mode"),t4=Symbol.for("react.profiler"),n4=Symbol.for("react.provider"),s4=Symbol.for("react.context"),r4=Symbol.for("react.forward_ref"),i4=Symbol.for("react.suspense"),o4=Symbol.for("react.memo"),a4=Symbol.for("react.lazy"),uP=Symbol.iterator;function l4(n){return n===null||typeof n!="object"?null:(n=uP&&n[uP]||n["@@iterator"],typeof n=="function"?n:null)}var nj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sj=Object.assign,rj={};function Ff(n,e,t){this.props=n,this.context=e,this.refs=rj,this.updater=t||nj}Ff.prototype.isReactComponent={};Ff.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ff.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ij(){}ij.prototype=Ff.prototype;function vC(n,e,t){this.props=n,this.context=e,this.refs=rj,this.updater=t||nj}var bC=vC.prototype=new ij;bC.constructor=vC;sj(bC,Ff.prototype);bC.isPureReactComponent=!0;var dP=Array.isArray,oj=Object.prototype.hasOwnProperty,xC={current:null},aj={key:!0,ref:!0,__self:!0,__source:!0};function lj(n,e,t){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)oj.call(e,s)&&!aj.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];r.children=c}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:gy,type:n,key:i,ref:o,props:r,_owner:xC.current}}function c4(n,e){return{$$typeof:gy,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function wC(n){return typeof n=="object"&&n!==null&&n.$$typeof===gy}function u4(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var hP=/\/+/g;function oS(n,e){return typeof n=="object"&&n!==null&&n.key!=null?u4(""+n.key):e.toString(36)}function Nv(n,e,t,s,r){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case gy:case J3:o=!0}}if(o)return o=n,r=r(o),n=s===""?"."+oS(o,0):s,dP(r)?(t="",n!=null&&(t=n.replace(hP,"$&/")+"/"),Nv(r,e,t,"",function(u){return u})):r!=null&&(wC(r)&&(r=c4(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(hP,"$&/")+"/")+n)),e.push(r)),1;if(o=0,s=s===""?".":s+":",dP(n))for(var a=0;a<n.length;a++){i=n[a];var c=s+oS(i,a);o+=Nv(i,e,t,c,r)}else if(c=l4(n),typeof c=="function")for(n=c.call(n),a=0;!(i=n.next()).done;)i=i.value,c=s+oS(i,a++),o+=Nv(i,e,t,c,r);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function zy(n,e,t){if(n==null)return n;var s=[],r=0;return Nv(n,s,"","",function(i){return e.call(t,i,r++)}),s}function d4(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Gn={current:null},Rv={transition:null},h4={ReactCurrentDispatcher:Gn,ReactCurrentBatchConfig:Rv,ReactCurrentOwner:xC};function cj(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:zy,forEach:function(n,e,t){zy(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return zy(n,function(){e++}),e},toArray:function(n){return zy(n,function(e){return e})||[]},only:function(n){if(!wC(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ee.Component=Ff;Ee.Fragment=Z3;Ee.Profiler=t4;Ee.PureComponent=vC;Ee.StrictMode=e4;Ee.Suspense=i4;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h4;Ee.act=cj;Ee.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=sj({},n.props),r=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=xC.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)oj.call(e,c)&&!aj.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:gy,type:n.type,key:r,ref:i,props:s,_owner:o}};Ee.createContext=function(n){return n={$$typeof:s4,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:n4,_context:n},n.Consumer=n};Ee.createElement=lj;Ee.createFactory=function(n){var e=lj.bind(null,n);return e.type=n,e};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(n){return{$$typeof:r4,render:n}};Ee.isValidElement=wC;Ee.lazy=function(n){return{$$typeof:a4,_payload:{_status:-1,_result:n},_init:d4}};Ee.memo=function(n,e){return{$$typeof:o4,type:n,compare:e===void 0?null:e}};Ee.startTransition=function(n){var e=Rv.transition;Rv.transition={};try{n()}finally{Rv.transition=e}};Ee.unstable_act=cj;Ee.useCallback=function(n,e){return Gn.current.useCallback(n,e)};Ee.useContext=function(n){return Gn.current.useContext(n)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(n){return Gn.current.useDeferredValue(n)};Ee.useEffect=function(n,e){return Gn.current.useEffect(n,e)};Ee.useId=function(){return Gn.current.useId()};Ee.useImperativeHandle=function(n,e,t){return Gn.current.useImperativeHandle(n,e,t)};Ee.useInsertionEffect=function(n,e){return Gn.current.useInsertionEffect(n,e)};Ee.useLayoutEffect=function(n,e){return Gn.current.useLayoutEffect(n,e)};Ee.useMemo=function(n,e){return Gn.current.useMemo(n,e)};Ee.useReducer=function(n,e,t){return Gn.current.useReducer(n,e,t)};Ee.useRef=function(n){return Gn.current.useRef(n)};Ee.useState=function(n){return Gn.current.useState(n)};Ee.useSyncExternalStore=function(n,e,t){return Gn.current.useSyncExternalStore(n,e,t)};Ee.useTransition=function(){return Gn.current.useTransition()};Ee.version="18.3.1";tj.exports=Ee;var A=tj.exports;const Re=u1(A),uj=ZR({__proto__:null,default:Re},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f4=A,p4=Symbol.for("react.element"),m4=Symbol.for("react.fragment"),g4=Object.prototype.hasOwnProperty,y4=f4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v4={key:!0,ref:!0,__self:!0,__source:!0};function dj(n,e,t){var s,r={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)g4.call(e,s)&&!v4.hasOwnProperty(s)&&(r[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:p4,type:n,key:i,ref:o,props:r,_owner:y4.current}}d1.Fragment=m4;d1.jsx=dj;d1.jsxs=dj;ej.exports=d1;var f=ej.exports,b_={},hj={exports:{}},$s={},fj={exports:{}},pj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,z){var B=$.length;$.push(z);e:for(;0<B;){var H=B-1>>>1,U=$[H];if(0<r(U,z))$[H]=z,$[B]=U,B=H;else break e}}function t($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var z=$[0],B=$.pop();if(B!==z){$[0]=B;e:for(var H=0,U=$.length,Y=U>>>1;H<Y;){var Q=2*(H+1)-1,ge=$[Q],Ce=Q+1,oe=$[Ce];if(0>r(ge,B))Ce<U&&0>r(oe,ge)?($[H]=oe,$[Ce]=B,H=Ce):($[H]=ge,$[Q]=B,H=Q);else if(Ce<U&&0>r(oe,B))$[H]=oe,$[Ce]=B,H=Ce;else break e}}return z}function r($,z){var B=$.sortIndex-z.sortIndex;return B!==0?B:$.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,p=3,m=!1,y=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S($){for(var z=t(u);z!==null;){if(z.callback===null)s(u);else if(z.startTime<=$)s(u),z.sortIndex=z.expirationTime,e(c,z);else break;z=t(u)}}function E($){if(g=!1,S($),!y)if(t(c)!==null)y=!0,j(k);else{var z=t(u);z!==null&&F(E,z.startTime-$)}}function k($,z){y=!1,g&&(g=!1,v(N),N=-1),m=!0;var B=p;try{for(S(z),h=t(c);h!==null&&(!(h.expirationTime>z)||$&&!O());){var H=h.callback;if(typeof H=="function"){h.callback=null,p=h.priorityLevel;var U=H(h.expirationTime<=z);z=n.unstable_now(),typeof U=="function"?h.callback=U:h===t(c)&&s(c),S(z)}else s(c);h=t(c)}if(h!==null)var Y=!0;else{var Q=t(u);Q!==null&&F(E,Q.startTime-z),Y=!1}return Y}finally{h=null,p=B,m=!1}}var T=!1,P=null,N=-1,M=5,L=-1;function O(){return!(n.unstable_now()-L<M)}function D(){if(P!==null){var $=n.unstable_now();L=$;var z=!0;try{z=P(!0,$)}finally{z?V():(T=!1,P=null)}}else T=!1}var V;if(typeof b=="function")V=function(){b(D)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,R=I.port2;I.port1.onmessage=D,V=function(){R.postMessage(null)}}else V=function(){w(D,0)};function j($){P=$,T||(T=!0,V())}function F($,z){N=w(function(){$(n.unstable_now())},z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,j(k))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(p){case 1:case 2:case 3:var z=3;break;default:z=p}var B=p;p=z;try{return $()}finally{p=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,z){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var B=p;p=$;try{return z()}finally{p=B}},n.unstable_scheduleCallback=function($,z,B){var H=n.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?H+B:H):B=H,$){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=B+U,$={id:d++,callback:z,priorityLevel:$,startTime:B,expirationTime:U,sortIndex:-1},B>H?($.sortIndex=B,e(u,$),t(c)===null&&$===t(u)&&(g?(v(N),N=-1):g=!0,F(E,B-H))):($.sortIndex=U,e(c,$),y||m||(y=!0,j(k))),$},n.unstable_shouldYield=O,n.unstable_wrapCallback=function($){var z=p;return function(){var B=p;p=z;try{return $.apply(this,arguments)}finally{p=B}}}})(pj);fj.exports=pj;var b4=fj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x4=A,Os=b4;function K(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mj=new Set,um={};function ku(n,e){Ef(n,e),Ef(n+"Capture",e)}function Ef(n,e){for(um[n]=e,n=0;n<e.length;n++)mj.add(e[n])}var ko=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x_=Object.prototype.hasOwnProperty,w4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fP={},pP={};function S4(n){return x_.call(pP,n)?!0:x_.call(fP,n)?!1:w4.test(n)?pP[n]=!0:(fP[n]=!0,!1)}function _4(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function A4(n,e,t,s){if(e===null||typeof e>"u"||_4(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qn(n,e,t,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){yn[n]=new qn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];yn[e]=new qn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){yn[n]=new qn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){yn[n]=new qn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){yn[n]=new qn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){yn[n]=new qn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){yn[n]=new qn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){yn[n]=new qn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){yn[n]=new qn(n,5,!1,n.toLowerCase(),null,!1,!1)});var SC=/[\-:]([a-z])/g;function _C(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(SC,_C);yn[e]=new qn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(SC,_C);yn[e]=new qn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(SC,_C);yn[e]=new qn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){yn[n]=new qn(n,1,!1,n.toLowerCase(),null,!1,!1)});yn.xlinkHref=new qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){yn[n]=new qn(n,1,!1,n.toLowerCase(),null,!0,!0)});function AC(n,e,t,s){var r=yn.hasOwnProperty(e)?yn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(A4(e,t,r,s)&&(t=null),s||r===null?S4(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,s=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Io=x4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vy=Symbol.for("react.element"),Xu=Symbol.for("react.portal"),Yu=Symbol.for("react.fragment"),EC=Symbol.for("react.strict_mode"),w_=Symbol.for("react.profiler"),gj=Symbol.for("react.provider"),yj=Symbol.for("react.context"),CC=Symbol.for("react.forward_ref"),S_=Symbol.for("react.suspense"),__=Symbol.for("react.suspense_list"),kC=Symbol.for("react.memo"),Ho=Symbol.for("react.lazy"),vj=Symbol.for("react.offscreen"),mP=Symbol.iterator;function Xf(n){return n===null||typeof n!="object"?null:(n=mP&&n[mP]||n["@@iterator"],typeof n=="function"?n:null)}var St=Object.assign,aS;function yp(n){if(aS===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);aS=e&&e[1]||""}return`
`+aS+n}var lS=!1;function cS(n,e){if(!n||lS)return"";lS=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{lS=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?yp(n):""}function E4(n){switch(n.tag){case 5:return yp(n.type);case 16:return yp("Lazy");case 13:return yp("Suspense");case 19:return yp("SuspenseList");case 0:case 2:case 15:return n=cS(n.type,!1),n;case 11:return n=cS(n.type.render,!1),n;case 1:return n=cS(n.type,!0),n;default:return""}}function A_(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Yu:return"Fragment";case Xu:return"Portal";case w_:return"Profiler";case EC:return"StrictMode";case S_:return"Suspense";case __:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case yj:return(n.displayName||"Context")+".Consumer";case gj:return(n._context.displayName||"Context")+".Provider";case CC:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case kC:return e=n.displayName||null,e!==null?e:A_(n.type)||"Memo";case Ho:e=n._payload,n=n._init;try{return A_(n(e))}catch{}}return null}function C4(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A_(e);case 8:return e===EC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function al(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function bj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function k4(n){var e=bj(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Uy(n){n._valueTracker||(n._valueTracker=k4(n))}function xj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=bj(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Cb(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function E_(n,e){var t=e.checked;return St({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function gP(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=al(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function wj(n,e){e=e.checked,e!=null&&AC(n,"checked",e,!1)}function C_(n,e){wj(n,e);var t=al(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?k_(n,e.type,t):e.hasOwnProperty("defaultValue")&&k_(n,e.type,al(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function yP(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function k_(n,e,t){(e!=="number"||Cb(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var vp=Array.isArray;function gd(n,e,t,s){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&s&&(n[t].defaultSelected=!0)}else{for(t=""+al(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,s&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function T_(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return St({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function vP(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(K(92));if(vp(t)){if(1<t.length)throw Error(K(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:al(t)}}function Sj(n,e){var t=al(e.value),s=al(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function bP(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function _j(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function P_(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?_j(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Hy,Aj=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Hy=Hy||document.createElement("div"),Hy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Hy.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function dm(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Gp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T4=["Webkit","ms","Moz","O"];Object.keys(Gp).forEach(function(n){T4.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Gp[e]=Gp[n]})});function Ej(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Gp.hasOwnProperty(n)&&Gp[n]?(""+e).trim():e+"px"}function Cj(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,r=Ej(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,r):n[t]=r}}var P4=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function N_(n,e){if(e){if(P4[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function R_(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var j_=null;function TC(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var M_=null,yd=null,vd=null;function xP(n){if(n=by(n)){if(typeof M_!="function")throw Error(K(280));var e=n.stateNode;e&&(e=g1(e),M_(n.stateNode,n.type,e))}}function kj(n){yd?vd?vd.push(n):vd=[n]:yd=n}function Tj(){if(yd){var n=yd,e=vd;if(vd=yd=null,xP(n),e)for(n=0;n<e.length;n++)xP(e[n])}}function Pj(n,e){return n(e)}function Nj(){}var uS=!1;function Rj(n,e,t){if(uS)return n(e,t);uS=!0;try{return Pj(n,e,t)}finally{uS=!1,(yd!==null||vd!==null)&&(Nj(),Tj())}}function hm(n,e){var t=n.stateNode;if(t===null)return null;var s=g1(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(K(231,e,typeof t));return t}var L_=!1;if(ko)try{var Yf={};Object.defineProperty(Yf,"passive",{get:function(){L_=!0}}),window.addEventListener("test",Yf,Yf),window.removeEventListener("test",Yf,Yf)}catch{L_=!1}function N4(n,e,t,s,r,i,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var qp=!1,kb=null,Tb=!1,I_=null,R4={onError:function(n){qp=!0,kb=n}};function j4(n,e,t,s,r,i,o,a,c){qp=!1,kb=null,N4.apply(R4,arguments)}function M4(n,e,t,s,r,i,o,a,c){if(j4.apply(this,arguments),qp){if(qp){var u=kb;qp=!1,kb=null}else throw Error(K(198));Tb||(Tb=!0,I_=u)}}function Tu(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function jj(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function wP(n){if(Tu(n)!==n)throw Error(K(188))}function L4(n){var e=n.alternate;if(!e){if(e=Tu(n),e===null)throw Error(K(188));return e!==n?null:n}for(var t=n,s=e;;){var r=t.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){t=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===t)return wP(r),n;if(i===s)return wP(r),e;i=i.sibling}throw Error(K(188))}if(t.return!==s.return)t=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,s=i;break}if(a===s){o=!0,s=r,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,s=r;break}if(a===s){o=!0,s=i,t=r;break}a=a.sibling}if(!o)throw Error(K(189))}}if(t.alternate!==s)throw Error(K(190))}if(t.tag!==3)throw Error(K(188));return t.stateNode.current===t?n:e}function Mj(n){return n=L4(n),n!==null?Lj(n):null}function Lj(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Lj(n);if(e!==null)return e;n=n.sibling}return null}var Ij=Os.unstable_scheduleCallback,SP=Os.unstable_cancelCallback,I4=Os.unstable_shouldYield,D4=Os.unstable_requestPaint,jt=Os.unstable_now,O4=Os.unstable_getCurrentPriorityLevel,PC=Os.unstable_ImmediatePriority,Dj=Os.unstable_UserBlockingPriority,Pb=Os.unstable_NormalPriority,F4=Os.unstable_LowPriority,Oj=Os.unstable_IdlePriority,h1=null,Si=null;function B4(n){if(Si&&typeof Si.onCommitFiberRoot=="function")try{Si.onCommitFiberRoot(h1,n,void 0,(n.current.flags&128)===128)}catch{}}var Or=Math.clz32?Math.clz32:V4,$4=Math.log,z4=Math.LN2;function V4(n){return n>>>=0,n===0?32:31-($4(n)/z4|0)|0}var Gy=64,qy=4194304;function bp(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Nb(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,r=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?s=bp(a):(i&=o,i!==0&&(s=bp(i)))}else o=t&~r,o!==0?s=bp(o):i!==0&&(s=bp(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Or(e),r=1<<t,s|=n[t],e&=~r;return s}function U4(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function H4(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,r=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Or(i),a=1<<o,c=r[o];c===-1?(!(a&t)||a&s)&&(r[o]=U4(a,e)):c<=e&&(n.expiredLanes|=a),i&=~a}}function D_(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Fj(){var n=Gy;return Gy<<=1,!(Gy&4194240)&&(Gy=64),n}function dS(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function yy(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Or(e),n[e]=t}function G4(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Or(t),i=1<<r;e[r]=0,s[r]=-1,n[r]=-1,t&=~i}}function NC(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Or(t),r=1<<s;r&e|n[s]&e&&(n[s]|=e),t&=~r}}var Ve=0;function Bj(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var $j,RC,zj,Vj,Uj,O_=!1,Wy=[],Qa=null,Ja=null,Za=null,fm=new Map,pm=new Map,Wo=[],q4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _P(n,e){switch(n){case"focusin":case"focusout":Qa=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":Za=null;break;case"pointerover":case"pointerout":fm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pm.delete(e.pointerId)}}function Qf(n,e,t,s,r,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=by(e),e!==null&&RC(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function W4(n,e,t,s,r){switch(e){case"focusin":return Qa=Qf(Qa,n,e,t,s,r),!0;case"dragenter":return Ja=Qf(Ja,n,e,t,s,r),!0;case"mouseover":return Za=Qf(Za,n,e,t,s,r),!0;case"pointerover":var i=r.pointerId;return fm.set(i,Qf(fm.get(i)||null,n,e,t,s,r)),!0;case"gotpointercapture":return i=r.pointerId,pm.set(i,Qf(pm.get(i)||null,n,e,t,s,r)),!0}return!1}function Hj(n){var e=Ol(n.target);if(e!==null){var t=Tu(e);if(t!==null){if(e=t.tag,e===13){if(e=jj(t),e!==null){n.blockedOn=e,Uj(n.priority,function(){zj(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function jv(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=F_(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);j_=s,t.target.dispatchEvent(s),j_=null}else return e=by(t),e!==null&&RC(e),n.blockedOn=t,!1;e.shift()}return!0}function AP(n,e,t){jv(n)&&t.delete(e)}function K4(){O_=!1,Qa!==null&&jv(Qa)&&(Qa=null),Ja!==null&&jv(Ja)&&(Ja=null),Za!==null&&jv(Za)&&(Za=null),fm.forEach(AP),pm.forEach(AP)}function Jf(n,e){n.blockedOn===e&&(n.blockedOn=null,O_||(O_=!0,Os.unstable_scheduleCallback(Os.unstable_NormalPriority,K4)))}function mm(n){function e(r){return Jf(r,n)}if(0<Wy.length){Jf(Wy[0],n);for(var t=1;t<Wy.length;t++){var s=Wy[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Qa!==null&&Jf(Qa,n),Ja!==null&&Jf(Ja,n),Za!==null&&Jf(Za,n),fm.forEach(e),pm.forEach(e),t=0;t<Wo.length;t++)s=Wo[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Wo.length&&(t=Wo[0],t.blockedOn===null);)Hj(t),t.blockedOn===null&&Wo.shift()}var bd=Io.ReactCurrentBatchConfig,Rb=!0;function X4(n,e,t,s){var r=Ve,i=bd.transition;bd.transition=null;try{Ve=1,jC(n,e,t,s)}finally{Ve=r,bd.transition=i}}function Y4(n,e,t,s){var r=Ve,i=bd.transition;bd.transition=null;try{Ve=4,jC(n,e,t,s)}finally{Ve=r,bd.transition=i}}function jC(n,e,t,s){if(Rb){var r=F_(n,e,t,s);if(r===null)wS(n,e,s,jb,t),_P(n,s);else if(W4(r,n,e,t,s))s.stopPropagation();else if(_P(n,s),e&4&&-1<q4.indexOf(n)){for(;r!==null;){var i=by(r);if(i!==null&&$j(i),i=F_(n,e,t,s),i===null&&wS(n,e,s,jb,t),i===r)break;r=i}r!==null&&s.stopPropagation()}else wS(n,e,s,null,t)}}var jb=null;function F_(n,e,t,s){if(jb=null,n=TC(s),n=Ol(n),n!==null)if(e=Tu(n),e===null)n=null;else if(t=e.tag,t===13){if(n=jj(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return jb=n,null}function Gj(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(O4()){case PC:return 1;case Dj:return 4;case Pb:case F4:return 16;case Oj:return 536870912;default:return 16}default:return 16}}var Xa=null,MC=null,Mv=null;function qj(){if(Mv)return Mv;var n,e=MC,t=e.length,s,r="value"in Xa?Xa.value:Xa.textContent,i=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===r[i-s];s++);return Mv=r.slice(n,1<s?1-s:void 0)}function Lv(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ky(){return!0}function EP(){return!1}function zs(n){function e(t,s,r,i,o){this._reactName=t,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ky:EP,this.isPropagationStopped=EP,this}return St(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ky)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ky)},persist:function(){},isPersistent:Ky}),e}var Bf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LC=zs(Bf),vy=St({},Bf,{view:0,detail:0}),Q4=zs(vy),hS,fS,Zf,f1=St({},vy,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:IC,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Zf&&(Zf&&n.type==="mousemove"?(hS=n.screenX-Zf.screenX,fS=n.screenY-Zf.screenY):fS=hS=0,Zf=n),hS)},movementY:function(n){return"movementY"in n?n.movementY:fS}}),CP=zs(f1),J4=St({},f1,{dataTransfer:0}),Z4=zs(J4),eB=St({},vy,{relatedTarget:0}),pS=zs(eB),tB=St({},Bf,{animationName:0,elapsedTime:0,pseudoElement:0}),nB=zs(tB),sB=St({},Bf,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),rB=zs(sB),iB=St({},Bf,{data:0}),kP=zs(iB),oB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cB(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=lB[n])?!!e[n]:!1}function IC(){return cB}var uB=St({},vy,{key:function(n){if(n.key){var e=oB[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Lv(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?aB[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:IC,charCode:function(n){return n.type==="keypress"?Lv(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Lv(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),dB=zs(uB),hB=St({},f1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TP=zs(hB),fB=St({},vy,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:IC}),pB=zs(fB),mB=St({},Bf,{propertyName:0,elapsedTime:0,pseudoElement:0}),gB=zs(mB),yB=St({},f1,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),vB=zs(yB),bB=[9,13,27,32],DC=ko&&"CompositionEvent"in window,Wp=null;ko&&"documentMode"in document&&(Wp=document.documentMode);var xB=ko&&"TextEvent"in window&&!Wp,Wj=ko&&(!DC||Wp&&8<Wp&&11>=Wp),PP=String.fromCharCode(32),NP=!1;function Kj(n,e){switch(n){case"keyup":return bB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xj(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qu=!1;function wB(n,e){switch(n){case"compositionend":return Xj(e);case"keypress":return e.which!==32?null:(NP=!0,PP);case"textInput":return n=e.data,n===PP&&NP?null:n;default:return null}}function SB(n,e){if(Qu)return n==="compositionend"||!DC&&Kj(n,e)?(n=qj(),Mv=MC=Xa=null,Qu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wj&&e.locale!=="ko"?null:e.data;default:return null}}var _B={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function RP(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!_B[n.type]:e==="textarea"}function Yj(n,e,t,s){kj(s),e=Mb(e,"onChange"),0<e.length&&(t=new LC("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var Kp=null,gm=null;function AB(n){aM(n,0)}function p1(n){var e=ed(n);if(xj(e))return n}function EB(n,e){if(n==="change")return e}var Qj=!1;if(ko){var mS;if(ko){var gS="oninput"in document;if(!gS){var jP=document.createElement("div");jP.setAttribute("oninput","return;"),gS=typeof jP.oninput=="function"}mS=gS}else mS=!1;Qj=mS&&(!document.documentMode||9<document.documentMode)}function MP(){Kp&&(Kp.detachEvent("onpropertychange",Jj),gm=Kp=null)}function Jj(n){if(n.propertyName==="value"&&p1(gm)){var e=[];Yj(e,gm,n,TC(n)),Rj(AB,e)}}function CB(n,e,t){n==="focusin"?(MP(),Kp=e,gm=t,Kp.attachEvent("onpropertychange",Jj)):n==="focusout"&&MP()}function kB(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return p1(gm)}function TB(n,e){if(n==="click")return p1(e)}function PB(n,e){if(n==="input"||n==="change")return p1(e)}function NB(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Br=typeof Object.is=="function"?Object.is:NB;function ym(n,e){if(Br(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var r=t[s];if(!x_.call(e,r)||!Br(n[r],e[r]))return!1}return!0}function LP(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function IP(n,e){var t=LP(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=LP(t)}}function Zj(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Zj(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function eM(){for(var n=window,e=Cb();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Cb(n.document)}return e}function OC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function RB(n){var e=eM(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Zj(t.ownerDocument.documentElement,t)){if(s!==null&&OC(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!n.extend&&i>s&&(r=s,s=i,i=r),r=IP(t,i);var o=IP(t,s);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),i>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var jB=ko&&"documentMode"in document&&11>=document.documentMode,Ju=null,B_=null,Xp=null,$_=!1;function DP(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;$_||Ju==null||Ju!==Cb(s)||(s=Ju,"selectionStart"in s&&OC(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Xp&&ym(Xp,s)||(Xp=s,s=Mb(B_,"onSelect"),0<s.length&&(e=new LC("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Ju)))}function Xy(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Zu={animationend:Xy("Animation","AnimationEnd"),animationiteration:Xy("Animation","AnimationIteration"),animationstart:Xy("Animation","AnimationStart"),transitionend:Xy("Transition","TransitionEnd")},yS={},tM={};ko&&(tM=document.createElement("div").style,"AnimationEvent"in window||(delete Zu.animationend.animation,delete Zu.animationiteration.animation,delete Zu.animationstart.animation),"TransitionEvent"in window||delete Zu.transitionend.transition);function m1(n){if(yS[n])return yS[n];if(!Zu[n])return n;var e=Zu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in tM)return yS[n]=e[t];return n}var nM=m1("animationend"),sM=m1("animationiteration"),rM=m1("animationstart"),iM=m1("transitionend"),oM=new Map,OP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fl(n,e){oM.set(n,e),ku(e,[n])}for(var vS=0;vS<OP.length;vS++){var bS=OP[vS],MB=bS.toLowerCase(),LB=bS[0].toUpperCase()+bS.slice(1);fl(MB,"on"+LB)}fl(nM,"onAnimationEnd");fl(sM,"onAnimationIteration");fl(rM,"onAnimationStart");fl("dblclick","onDoubleClick");fl("focusin","onFocus");fl("focusout","onBlur");fl(iM,"onTransitionEnd");Ef("onMouseEnter",["mouseout","mouseover"]);Ef("onMouseLeave",["mouseout","mouseover"]);Ef("onPointerEnter",["pointerout","pointerover"]);Ef("onPointerLeave",["pointerout","pointerover"]);ku("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ku("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ku("onBeforeInput",["compositionend","keypress","textInput","paste"]);ku("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IB=new Set("cancel close invalid load scroll toggle".split(" ").concat(xp));function FP(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,M4(s,e,void 0,n),n.currentTarget=null}function aM(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==i&&r.isPropagationStopped())break e;FP(r,a,u),i=c}else for(o=0;o<s.length;o++){if(a=s[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==i&&r.isPropagationStopped())break e;FP(r,a,u),i=c}}}if(Tb)throw n=I_,Tb=!1,I_=null,n}function at(n,e){var t=e[G_];t===void 0&&(t=e[G_]=new Set);var s=n+"__bubble";t.has(s)||(lM(e,n,2,!1),t.add(s))}function xS(n,e,t){var s=0;e&&(s|=4),lM(t,n,s,e)}var Yy="_reactListening"+Math.random().toString(36).slice(2);function vm(n){if(!n[Yy]){n[Yy]=!0,mj.forEach(function(t){t!=="selectionchange"&&(IB.has(t)||xS(t,!1,n),xS(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Yy]||(e[Yy]=!0,xS("selectionchange",!1,e))}}function lM(n,e,t,s){switch(Gj(e)){case 1:var r=X4;break;case 4:r=Y4;break;default:r=jC}t=r.bind(null,e,t,n),r=void 0,!L_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function wS(n,e,t,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ol(a),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}a=a.parentNode}}s=s.return}Rj(function(){var u=i,d=TC(t),h=[];e:{var p=oM.get(n);if(p!==void 0){var m=LC,y=n;switch(n){case"keypress":if(Lv(t)===0)break e;case"keydown":case"keyup":m=dB;break;case"focusin":y="focus",m=pS;break;case"focusout":y="blur",m=pS;break;case"beforeblur":case"afterblur":m=pS;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=CP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Z4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=pB;break;case nM:case sM:case rM:m=nB;break;case iM:m=gB;break;case"scroll":m=Q4;break;case"wheel":m=vB;break;case"copy":case"cut":case"paste":m=rB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=TP}var g=(e&4)!==0,w=!g&&n==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var b=u,S;b!==null;){S=b;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,v!==null&&(E=hm(b,v),E!=null&&g.push(bm(b,E,S)))),w)break;b=b.return}0<g.length&&(p=new m(p,y,null,t,d),h.push({event:p,listeners:g}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==j_&&(y=t.relatedTarget||t.fromElement)&&(Ol(y)||y[To]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=u,y=y?Ol(y):null,y!==null&&(w=Tu(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(g=CP,E="onMouseLeave",v="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(g=TP,E="onPointerLeave",v="onPointerEnter",b="pointer"),w=m==null?p:ed(m),S=y==null?p:ed(y),p=new g(E,b+"leave",m,t,d),p.target=w,p.relatedTarget=S,E=null,Ol(d)===u&&(g=new g(v,b+"enter",y,t,d),g.target=S,g.relatedTarget=w,E=g),w=E,m&&y)t:{for(g=m,v=y,b=0,S=g;S;S=Du(S))b++;for(S=0,E=v;E;E=Du(E))S++;for(;0<b-S;)g=Du(g),b--;for(;0<S-b;)v=Du(v),S--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=Du(g),v=Du(v)}g=null}else g=null;m!==null&&BP(h,p,m,g,!1),y!==null&&w!==null&&BP(h,w,y,g,!0)}}e:{if(p=u?ed(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var k=EB;else if(RP(p))if(Qj)k=PB;else{k=kB;var T=CB}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=TB);if(k&&(k=k(n,u))){Yj(h,k,t,d);break e}T&&T(n,p,u),n==="focusout"&&(T=p._wrapperState)&&T.controlled&&p.type==="number"&&k_(p,"number",p.value)}switch(T=u?ed(u):window,n){case"focusin":(RP(T)||T.contentEditable==="true")&&(Ju=T,B_=u,Xp=null);break;case"focusout":Xp=B_=Ju=null;break;case"mousedown":$_=!0;break;case"contextmenu":case"mouseup":case"dragend":$_=!1,DP(h,t,d);break;case"selectionchange":if(jB)break;case"keydown":case"keyup":DP(h,t,d)}var P;if(DC)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Qu?Kj(n,t)&&(N="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(Wj&&t.locale!=="ko"&&(Qu||N!=="onCompositionStart"?N==="onCompositionEnd"&&Qu&&(P=qj()):(Xa=d,MC="value"in Xa?Xa.value:Xa.textContent,Qu=!0)),T=Mb(u,N),0<T.length&&(N=new kP(N,n,null,t,d),h.push({event:N,listeners:T}),P?N.data=P:(P=Xj(t),P!==null&&(N.data=P)))),(P=xB?wB(n,t):SB(n,t))&&(u=Mb(u,"onBeforeInput"),0<u.length&&(d=new kP("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:u}),d.data=P))}aM(h,e)})}function bm(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Mb(n,e){for(var t=e+"Capture",s=[];n!==null;){var r=n,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=hm(n,t),i!=null&&s.unshift(bm(n,i,r)),i=hm(n,e),i!=null&&s.push(bm(n,i,r))),n=n.return}return s}function Du(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function BP(n,e,t,s,r){for(var i=e._reactName,o=[];t!==null&&t!==s;){var a=t,c=a.alternate,u=a.stateNode;if(c!==null&&c===s)break;a.tag===5&&u!==null&&(a=u,r?(c=hm(t,i),c!=null&&o.unshift(bm(t,c,a))):r||(c=hm(t,i),c!=null&&o.push(bm(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var DB=/\r\n?/g,OB=/\u0000|\uFFFD/g;function $P(n){return(typeof n=="string"?n:""+n).replace(DB,`
`).replace(OB,"")}function Qy(n,e,t){if(e=$P(e),$P(n)!==e&&t)throw Error(K(425))}function Lb(){}var z_=null,V_=null;function U_(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var H_=typeof setTimeout=="function"?setTimeout:void 0,FB=typeof clearTimeout=="function"?clearTimeout:void 0,zP=typeof Promise=="function"?Promise:void 0,BB=typeof queueMicrotask=="function"?queueMicrotask:typeof zP<"u"?function(n){return zP.resolve(null).then(n).catch($B)}:H_;function $B(n){setTimeout(function(){throw n})}function SS(n,e){var t=e,s=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(s===0){n.removeChild(r),mm(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=r}while(t);mm(e)}function el(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function VP(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var $f=Math.random().toString(36).slice(2),xi="__reactFiber$"+$f,xm="__reactProps$"+$f,To="__reactContainer$"+$f,G_="__reactEvents$"+$f,zB="__reactListeners$"+$f,VB="__reactHandles$"+$f;function Ol(n){var e=n[xi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[To]||t[xi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=VP(n);n!==null;){if(t=n[xi])return t;n=VP(n)}return e}n=t,t=n.parentNode}return null}function by(n){return n=n[xi]||n[To],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ed(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(K(33))}function g1(n){return n[xm]||null}var q_=[],td=-1;function pl(n){return{current:n}}function lt(n){0>td||(n.current=q_[td],q_[td]=null,td--)}function st(n,e){td++,q_[td]=n.current,n.current=e}var ll={},jn=pl(ll),ls=pl(!1),vu=ll;function Cf(n,e){var t=n.type.contextTypes;if(!t)return ll;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in t)r[i]=e[i];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function cs(n){return n=n.childContextTypes,n!=null}function Ib(){lt(ls),lt(jn)}function UP(n,e,t){if(jn.current!==ll)throw Error(K(168));st(jn,e),st(ls,t)}function cM(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(K(108,C4(n)||"Unknown",r));return St({},t,s)}function Db(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ll,vu=jn.current,st(jn,n),st(ls,ls.current),!0}function HP(n,e,t){var s=n.stateNode;if(!s)throw Error(K(169));t?(n=cM(n,e,vu),s.__reactInternalMemoizedMergedChildContext=n,lt(ls),lt(jn),st(jn,n)):lt(ls),st(ls,t)}var Li=null,y1=!1,_S=!1;function uM(n){Li===null?Li=[n]:Li.push(n)}function UB(n){y1=!0,uM(n)}function ml(){if(!_S&&Li!==null){_S=!0;var n=0,e=Ve;try{var t=Li;for(Ve=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}Li=null,y1=!1}catch(r){throw Li!==null&&(Li=Li.slice(n+1)),Ij(PC,ml),r}finally{Ve=e,_S=!1}}return null}var nd=[],sd=0,Ob=null,Fb=0,ir=[],or=0,bu=null,bo=1,xo="";function Al(n,e){nd[sd++]=Fb,nd[sd++]=Ob,Ob=n,Fb=e}function dM(n,e,t){ir[or++]=bo,ir[or++]=xo,ir[or++]=bu,bu=n;var s=bo;n=xo;var r=32-Or(s)-1;s&=~(1<<r),t+=1;var i=32-Or(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,bo=1<<32-Or(e)+r|t<<r|s,xo=i+n}else bo=1<<i|t<<r|s,xo=n}function FC(n){n.return!==null&&(Al(n,1),dM(n,1,0))}function BC(n){for(;n===Ob;)Ob=nd[--sd],nd[sd]=null,Fb=nd[--sd],nd[sd]=null;for(;n===bu;)bu=ir[--or],ir[or]=null,xo=ir[--or],ir[or]=null,bo=ir[--or],ir[or]=null}var Ds=null,Is=null,ft=!1,Dr=null;function hM(n,e){var t=lr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function GP(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ds=n,Is=el(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ds=n,Is=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=bu!==null?{id:bo,overflow:xo}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=lr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ds=n,Is=null,!0):!1;default:return!1}}function W_(n){return(n.mode&1)!==0&&(n.flags&128)===0}function K_(n){if(ft){var e=Is;if(e){var t=e;if(!GP(n,e)){if(W_(n))throw Error(K(418));e=el(t.nextSibling);var s=Ds;e&&GP(n,e)?hM(s,t):(n.flags=n.flags&-4097|2,ft=!1,Ds=n)}}else{if(W_(n))throw Error(K(418));n.flags=n.flags&-4097|2,ft=!1,Ds=n}}}function qP(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ds=n}function Jy(n){if(n!==Ds)return!1;if(!ft)return qP(n),ft=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!U_(n.type,n.memoizedProps)),e&&(e=Is)){if(W_(n))throw fM(),Error(K(418));for(;e;)hM(n,e),e=el(e.nextSibling)}if(qP(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(K(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Is=el(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Is=null}}else Is=Ds?el(n.stateNode.nextSibling):null;return!0}function fM(){for(var n=Is;n;)n=el(n.nextSibling)}function kf(){Is=Ds=null,ft=!1}function $C(n){Dr===null?Dr=[n]:Dr.push(n)}var HB=Io.ReactCurrentBatchConfig;function ep(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(K(309));var s=t.stateNode}if(!s)throw Error(K(147,n));var r=s,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(K(284));if(!t._owner)throw Error(K(290,n))}return n}function Zy(n,e){throw n=Object.prototype.toString.call(e),Error(K(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function WP(n){var e=n._init;return e(n._payload)}function pM(n){function e(v,b){if(n){var S=v.deletions;S===null?(v.deletions=[b],v.flags|=16):S.push(b)}}function t(v,b){if(!n)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function s(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function r(v,b){return v=rl(v,b),v.index=0,v.sibling=null,v}function i(v,b,S){return v.index=S,n?(S=v.alternate,S!==null?(S=S.index,S<b?(v.flags|=2,b):S):(v.flags|=2,b)):(v.flags|=1048576,b)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,b,S,E){return b===null||b.tag!==6?(b=NS(S,v.mode,E),b.return=v,b):(b=r(b,S),b.return=v,b)}function c(v,b,S,E){var k=S.type;return k===Yu?d(v,b,S.props.children,E,S.key):b!==null&&(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ho&&WP(k)===b.type)?(E=r(b,S.props),E.ref=ep(v,b,S),E.return=v,E):(E=zv(S.type,S.key,S.props,null,v.mode,E),E.ref=ep(v,b,S),E.return=v,E)}function u(v,b,S,E){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=RS(S,v.mode,E),b.return=v,b):(b=r(b,S.children||[]),b.return=v,b)}function d(v,b,S,E,k){return b===null||b.tag!==7?(b=yu(S,v.mode,E,k),b.return=v,b):(b=r(b,S),b.return=v,b)}function h(v,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=NS(""+b,v.mode,S),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vy:return S=zv(b.type,b.key,b.props,null,v.mode,S),S.ref=ep(v,null,b),S.return=v,S;case Xu:return b=RS(b,v.mode,S),b.return=v,b;case Ho:var E=b._init;return h(v,E(b._payload),S)}if(vp(b)||Xf(b))return b=yu(b,v.mode,S,null),b.return=v,b;Zy(v,b)}return null}function p(v,b,S,E){var k=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return k!==null?null:a(v,b,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Vy:return S.key===k?c(v,b,S,E):null;case Xu:return S.key===k?u(v,b,S,E):null;case Ho:return k=S._init,p(v,b,k(S._payload),E)}if(vp(S)||Xf(S))return k!==null?null:d(v,b,S,E,null);Zy(v,S)}return null}function m(v,b,S,E,k){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(S)||null,a(b,v,""+E,k);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Vy:return v=v.get(E.key===null?S:E.key)||null,c(b,v,E,k);case Xu:return v=v.get(E.key===null?S:E.key)||null,u(b,v,E,k);case Ho:var T=E._init;return m(v,b,S,T(E._payload),k)}if(vp(E)||Xf(E))return v=v.get(S)||null,d(b,v,E,k,null);Zy(b,E)}return null}function y(v,b,S,E){for(var k=null,T=null,P=b,N=b=0,M=null;P!==null&&N<S.length;N++){P.index>N?(M=P,P=null):M=P.sibling;var L=p(v,P,S[N],E);if(L===null){P===null&&(P=M);break}n&&P&&L.alternate===null&&e(v,P),b=i(L,b,N),T===null?k=L:T.sibling=L,T=L,P=M}if(N===S.length)return t(v,P),ft&&Al(v,N),k;if(P===null){for(;N<S.length;N++)P=h(v,S[N],E),P!==null&&(b=i(P,b,N),T===null?k=P:T.sibling=P,T=P);return ft&&Al(v,N),k}for(P=s(v,P);N<S.length;N++)M=m(P,v,N,S[N],E),M!==null&&(n&&M.alternate!==null&&P.delete(M.key===null?N:M.key),b=i(M,b,N),T===null?k=M:T.sibling=M,T=M);return n&&P.forEach(function(O){return e(v,O)}),ft&&Al(v,N),k}function g(v,b,S,E){var k=Xf(S);if(typeof k!="function")throw Error(K(150));if(S=k.call(S),S==null)throw Error(K(151));for(var T=k=null,P=b,N=b=0,M=null,L=S.next();P!==null&&!L.done;N++,L=S.next()){P.index>N?(M=P,P=null):M=P.sibling;var O=p(v,P,L.value,E);if(O===null){P===null&&(P=M);break}n&&P&&O.alternate===null&&e(v,P),b=i(O,b,N),T===null?k=O:T.sibling=O,T=O,P=M}if(L.done)return t(v,P),ft&&Al(v,N),k;if(P===null){for(;!L.done;N++,L=S.next())L=h(v,L.value,E),L!==null&&(b=i(L,b,N),T===null?k=L:T.sibling=L,T=L);return ft&&Al(v,N),k}for(P=s(v,P);!L.done;N++,L=S.next())L=m(P,v,N,L.value,E),L!==null&&(n&&L.alternate!==null&&P.delete(L.key===null?N:L.key),b=i(L,b,N),T===null?k=L:T.sibling=L,T=L);return n&&P.forEach(function(D){return e(v,D)}),ft&&Al(v,N),k}function w(v,b,S,E){if(typeof S=="object"&&S!==null&&S.type===Yu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Vy:e:{for(var k=S.key,T=b;T!==null;){if(T.key===k){if(k=S.type,k===Yu){if(T.tag===7){t(v,T.sibling),b=r(T,S.props.children),b.return=v,v=b;break e}}else if(T.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ho&&WP(k)===T.type){t(v,T.sibling),b=r(T,S.props),b.ref=ep(v,T,S),b.return=v,v=b;break e}t(v,T);break}else e(v,T);T=T.sibling}S.type===Yu?(b=yu(S.props.children,v.mode,E,S.key),b.return=v,v=b):(E=zv(S.type,S.key,S.props,null,v.mode,E),E.ref=ep(v,b,S),E.return=v,v=E)}return o(v);case Xu:e:{for(T=S.key;b!==null;){if(b.key===T)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){t(v,b.sibling),b=r(b,S.children||[]),b.return=v,v=b;break e}else{t(v,b);break}else e(v,b);b=b.sibling}b=RS(S,v.mode,E),b.return=v,v=b}return o(v);case Ho:return T=S._init,w(v,b,T(S._payload),E)}if(vp(S))return y(v,b,S,E);if(Xf(S))return g(v,b,S,E);Zy(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(t(v,b.sibling),b=r(b,S),b.return=v,v=b):(t(v,b),b=NS(S,v.mode,E),b.return=v,v=b),o(v)):t(v,b)}return w}var Tf=pM(!0),mM=pM(!1),Bb=pl(null),$b=null,rd=null,zC=null;function VC(){zC=rd=$b=null}function UC(n){var e=Bb.current;lt(Bb),n._currentValue=e}function X_(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function xd(n,e){$b=n,zC=rd=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(as=!0),n.firstContext=null)}function ur(n){var e=n._currentValue;if(zC!==n)if(n={context:n,memoizedValue:e,next:null},rd===null){if($b===null)throw Error(K(308));rd=n,$b.dependencies={lanes:0,firstContext:n}}else rd=rd.next=n;return e}var Fl=null;function HC(n){Fl===null?Fl=[n]:Fl.push(n)}function gM(n,e,t,s){var r=e.interleaved;return r===null?(t.next=t,HC(e)):(t.next=r.next,r.next=t),e.interleaved=t,Po(n,s)}function Po(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Go=!1;function GC(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yM(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function _o(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function tl(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,Ie&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Po(n,t)}return r=s.interleaved,r===null?(e.next=e,HC(s)):(e.next=r.next,r.next=e),s.interleaved=e,Po(n,t)}function Iv(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,NC(n,t)}}function KP(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var r=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?r=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?r=i=e:i=i.next=e}else r=i=e;t={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function zb(n,e,t,s){var r=n.updateQueue;Go=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=r.baseState;o=0,d=u=c=null,a=i;do{var p=a.lane,m=a.eventTime;if((s&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,g=a;switch(p=e,m=t,g.tag){case 1:if(y=g.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=St({},h,p);break e;case 2:Go=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(1);if(d===null&&(c=h),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);wu|=o,n.lanes=o,n.memoizedState=h}}function XP(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],r=s.callback;if(r!==null){if(s.callback=null,s=t,typeof r!="function")throw Error(K(191,r));r.call(s)}}}var xy={},_i=pl(xy),wm=pl(xy),Sm=pl(xy);function Bl(n){if(n===xy)throw Error(K(174));return n}function qC(n,e){switch(st(Sm,e),st(wm,n),st(_i,xy),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:P_(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=P_(e,n)}lt(_i),st(_i,e)}function Pf(){lt(_i),lt(wm),lt(Sm)}function vM(n){Bl(Sm.current);var e=Bl(_i.current),t=P_(e,n.type);e!==t&&(st(wm,n),st(_i,t))}function WC(n){wm.current===n&&(lt(_i),lt(wm))}var yt=pl(0);function Vb(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var AS=[];function KC(){for(var n=0;n<AS.length;n++)AS[n]._workInProgressVersionPrimary=null;AS.length=0}var Dv=Io.ReactCurrentDispatcher,ES=Io.ReactCurrentBatchConfig,xu=0,xt=null,qt=null,nn=null,Ub=!1,Yp=!1,_m=0,GB=0;function vn(){throw Error(K(321))}function XC(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Br(n[t],e[t]))return!1;return!0}function YC(n,e,t,s,r,i){if(xu=i,xt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Dv.current=n===null||n.memoizedState===null?XB:YB,n=t(s,r),Yp){i=0;do{if(Yp=!1,_m=0,25<=i)throw Error(K(301));i+=1,nn=qt=null,e.updateQueue=null,Dv.current=QB,n=t(s,r)}while(Yp)}if(Dv.current=Hb,e=qt!==null&&qt.next!==null,xu=0,nn=qt=xt=null,Ub=!1,e)throw Error(K(300));return n}function QC(){var n=_m!==0;return _m=0,n}function Kr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?xt.memoizedState=nn=n:nn=nn.next=n,nn}function dr(){if(qt===null){var n=xt.alternate;n=n!==null?n.memoizedState:null}else n=qt.next;var e=nn===null?xt.memoizedState:nn.next;if(e!==null)nn=e,qt=n;else{if(n===null)throw Error(K(310));qt=n,n={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},nn===null?xt.memoizedState=nn=n:nn=nn.next=n}return nn}function Am(n,e){return typeof e=="function"?e(n):e}function CS(n){var e=dr(),t=e.queue;if(t===null)throw Error(K(311));t.lastRenderedReducer=n;var s=qt,r=s.baseQueue,i=t.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,t.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,c=null,u=i;do{var d=u.lane;if((xu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=s):c=c.next=h,xt.lanes|=d,wu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=s:c.next=a,Br(s,e.memoizedState)||(as=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){r=n;do i=r.lane,xt.lanes|=i,wu|=i,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function kS(n){var e=dr(),t=e.queue;if(t===null)throw Error(K(311));t.lastRenderedReducer=n;var s=t.dispatch,r=t.pending,i=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do i=n(i,o.action),o=o.next;while(o!==r);Br(i,e.memoizedState)||(as=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,s]}function bM(){}function xM(n,e){var t=xt,s=dr(),r=e(),i=!Br(s.memoizedState,r);if(i&&(s.memoizedState=r,as=!0),s=s.queue,JC(_M.bind(null,t,s,n),[n]),s.getSnapshot!==e||i||nn!==null&&nn.memoizedState.tag&1){if(t.flags|=2048,Em(9,SM.bind(null,t,s,r,e),void 0,null),sn===null)throw Error(K(349));xu&30||wM(t,e,r)}return r}function wM(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=xt.updateQueue,e===null?(e={lastEffect:null,stores:null},xt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function SM(n,e,t,s){e.value=t,e.getSnapshot=s,AM(e)&&EM(n)}function _M(n,e,t){return t(function(){AM(e)&&EM(n)})}function AM(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Br(n,t)}catch{return!0}}function EM(n){var e=Po(n,1);e!==null&&Fr(e,n,1,-1)}function YP(n){var e=Kr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Am,lastRenderedState:n},e.queue=n,n=n.dispatch=KB.bind(null,xt,n),[e.memoizedState,n]}function Em(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=xt.updateQueue,e===null?(e={lastEffect:null,stores:null},xt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function CM(){return dr().memoizedState}function Ov(n,e,t,s){var r=Kr();xt.flags|=n,r.memoizedState=Em(1|e,t,void 0,s===void 0?null:s)}function v1(n,e,t,s){var r=dr();s=s===void 0?null:s;var i=void 0;if(qt!==null){var o=qt.memoizedState;if(i=o.destroy,s!==null&&XC(s,o.deps)){r.memoizedState=Em(e,t,i,s);return}}xt.flags|=n,r.memoizedState=Em(1|e,t,i,s)}function QP(n,e){return Ov(8390656,8,n,e)}function JC(n,e){return v1(2048,8,n,e)}function kM(n,e){return v1(4,2,n,e)}function TM(n,e){return v1(4,4,n,e)}function PM(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function NM(n,e,t){return t=t!=null?t.concat([n]):null,v1(4,4,PM.bind(null,e,n),t)}function ZC(){}function RM(n,e){var t=dr();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&XC(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function jM(n,e){var t=dr();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&XC(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function MM(n,e,t){return xu&21?(Br(t,e)||(t=Fj(),xt.lanes|=t,wu|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,as=!0),n.memoizedState=t)}function qB(n,e){var t=Ve;Ve=t!==0&&4>t?t:4,n(!0);var s=ES.transition;ES.transition={};try{n(!1),e()}finally{Ve=t,ES.transition=s}}function LM(){return dr().memoizedState}function WB(n,e,t){var s=sl(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},IM(n))DM(e,t);else if(t=gM(n,e,t,s),t!==null){var r=Hn();Fr(t,n,s,r),OM(t,e,s)}}function KB(n,e,t){var s=sl(n),r={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(IM(n))DM(e,r);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(r.hasEagerState=!0,r.eagerState=a,Br(a,o)){var c=e.interleaved;c===null?(r.next=r,HC(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=gM(n,e,r,s),t!==null&&(r=Hn(),Fr(t,n,s,r),OM(t,e,s))}}function IM(n){var e=n.alternate;return n===xt||e!==null&&e===xt}function DM(n,e){Yp=Ub=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function OM(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,NC(n,t)}}var Hb={readContext:ur,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},XB={readContext:ur,useCallback:function(n,e){return Kr().memoizedState=[n,e===void 0?null:e],n},useContext:ur,useEffect:QP,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Ov(4194308,4,PM.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Ov(4194308,4,n,e)},useInsertionEffect:function(n,e){return Ov(4,2,n,e)},useMemo:function(n,e){var t=Kr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Kr();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=WB.bind(null,xt,n),[s.memoizedState,n]},useRef:function(n){var e=Kr();return n={current:n},e.memoizedState=n},useState:YP,useDebugValue:ZC,useDeferredValue:function(n){return Kr().memoizedState=n},useTransition:function(){var n=YP(!1),e=n[0];return n=qB.bind(null,n[1]),Kr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=xt,r=Kr();if(ft){if(t===void 0)throw Error(K(407));t=t()}else{if(t=e(),sn===null)throw Error(K(349));xu&30||wM(s,e,t)}r.memoizedState=t;var i={value:t,getSnapshot:e};return r.queue=i,QP(_M.bind(null,s,i,n),[n]),s.flags|=2048,Em(9,SM.bind(null,s,i,t,e),void 0,null),t},useId:function(){var n=Kr(),e=sn.identifierPrefix;if(ft){var t=xo,s=bo;t=(s&~(1<<32-Or(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=_m++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=GB++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},YB={readContext:ur,useCallback:RM,useContext:ur,useEffect:JC,useImperativeHandle:NM,useInsertionEffect:kM,useLayoutEffect:TM,useMemo:jM,useReducer:CS,useRef:CM,useState:function(){return CS(Am)},useDebugValue:ZC,useDeferredValue:function(n){var e=dr();return MM(e,qt.memoizedState,n)},useTransition:function(){var n=CS(Am)[0],e=dr().memoizedState;return[n,e]},useMutableSource:bM,useSyncExternalStore:xM,useId:LM,unstable_isNewReconciler:!1},QB={readContext:ur,useCallback:RM,useContext:ur,useEffect:JC,useImperativeHandle:NM,useInsertionEffect:kM,useLayoutEffect:TM,useMemo:jM,useReducer:kS,useRef:CM,useState:function(){return kS(Am)},useDebugValue:ZC,useDeferredValue:function(n){var e=dr();return qt===null?e.memoizedState=n:MM(e,qt.memoizedState,n)},useTransition:function(){var n=kS(Am)[0],e=dr().memoizedState;return[n,e]},useMutableSource:bM,useSyncExternalStore:xM,useId:LM,unstable_isNewReconciler:!1};function br(n,e){if(n&&n.defaultProps){e=St({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Y_(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:St({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var b1={isMounted:function(n){return(n=n._reactInternals)?Tu(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Hn(),r=sl(n),i=_o(s,r);i.payload=e,t!=null&&(i.callback=t),e=tl(n,i,r),e!==null&&(Fr(e,n,r,s),Iv(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Hn(),r=sl(n),i=_o(s,r);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=tl(n,i,r),e!==null&&(Fr(e,n,r,s),Iv(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Hn(),s=sl(n),r=_o(t,s);r.tag=2,e!=null&&(r.callback=e),e=tl(n,r,s),e!==null&&(Fr(e,n,s,t),Iv(e,n,s))}};function JP(n,e,t,s,r,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!ym(t,s)||!ym(r,i):!0}function FM(n,e,t){var s=!1,r=ll,i=e.contextType;return typeof i=="object"&&i!==null?i=ur(i):(r=cs(e)?vu:jn.current,s=e.contextTypes,i=(s=s!=null)?Cf(n,r):ll),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=b1,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=i),e}function ZP(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&b1.enqueueReplaceState(e,e.state,null)}function Q_(n,e,t,s){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},GC(n);var i=e.contextType;typeof i=="object"&&i!==null?r.context=ur(i):(i=cs(e)?vu:jn.current,r.context=Cf(n,i)),r.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Y_(n,e,i,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&b1.enqueueReplaceState(r,r.state,null),zb(n,t,r,s),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Nf(n,e){try{var t="",s=e;do t+=E4(s),s=s.return;while(s);var r=t}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:r,digest:null}}function TS(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function J_(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var JB=typeof WeakMap=="function"?WeakMap:Map;function BM(n,e,t){t=_o(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){qb||(qb=!0,lA=s),J_(n,e)},t}function $M(n,e,t){t=_o(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;t.payload=function(){return s(r)},t.callback=function(){J_(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){J_(n,e),typeof s!="function"&&(nl===null?nl=new Set([this]):nl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function e2(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new JB;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(t)||(r.add(t),n=h5.bind(null,n,e,t),e.then(n,n))}function t2(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function n2(n,e,t,s,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=_o(-1,1),e.tag=2,tl(t,e,1))),t.lanes|=1),n)}var ZB=Io.ReactCurrentOwner,as=!1;function Vn(n,e,t,s){e.child=n===null?mM(e,null,t,s):Tf(e,n.child,t,s)}function s2(n,e,t,s,r){t=t.render;var i=e.ref;return xd(e,r),s=YC(n,e,t,s,i,r),t=QC(),n!==null&&!as?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,No(n,e,r)):(ft&&t&&FC(e),e.flags|=1,Vn(n,e,s,r),e.child)}function r2(n,e,t,s,r){if(n===null){var i=t.type;return typeof i=="function"&&!ak(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,zM(n,e,i,s,r)):(n=zv(t.type,null,s,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&r)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:ym,t(o,s)&&n.ref===e.ref)return No(n,e,r)}return e.flags|=1,n=rl(i,s),n.ref=e.ref,n.return=e,e.child=n}function zM(n,e,t,s,r){if(n!==null){var i=n.memoizedProps;if(ym(i,s)&&n.ref===e.ref)if(as=!1,e.pendingProps=s=i,(n.lanes&r)!==0)n.flags&131072&&(as=!0);else return e.lanes=n.lanes,No(n,e,r)}return Z_(n,e,t,s,r)}function VM(n,e,t){var s=e.pendingProps,r=s.children,i=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(od,Ms),Ms|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,st(od,Ms),Ms|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:t,st(od,Ms),Ms|=s}else i!==null?(s=i.baseLanes|t,e.memoizedState=null):s=t,st(od,Ms),Ms|=s;return Vn(n,e,r,t),e.child}function UM(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Z_(n,e,t,s,r){var i=cs(t)?vu:jn.current;return i=Cf(e,i),xd(e,r),t=YC(n,e,t,s,i,r),s=QC(),n!==null&&!as?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,No(n,e,r)):(ft&&s&&FC(e),e.flags|=1,Vn(n,e,t,r),e.child)}function i2(n,e,t,s,r){if(cs(t)){var i=!0;Db(e)}else i=!1;if(xd(e,r),e.stateNode===null)Fv(n,e),FM(e,t,s),Q_(e,t,s,r),s=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=ur(u):(u=cs(t)?vu:jn.current,u=Cf(e,u));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||c!==u)&&ZP(e,o,s,u),Go=!1;var p=e.memoizedState;o.state=p,zb(e,s,o,r),c=e.memoizedState,a!==s||p!==c||ls.current||Go?(typeof d=="function"&&(Y_(e,t,d,s),c=e.memoizedState),(a=Go||JP(e,t,a,s,p,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,yM(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:br(e.type,a),o.props=u,h=e.pendingProps,p=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=ur(c):(c=cs(t)?vu:jn.current,c=Cf(e,c));var m=t.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==c)&&ZP(e,o,s,c),Go=!1,p=e.memoizedState,o.state=p,zb(e,s,o,r);var y=e.memoizedState;a!==h||p!==y||ls.current||Go?(typeof m=="function"&&(Y_(e,t,m,s),y=e.memoizedState),(u=Go||JP(e,t,u,s,p,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),o.props=s,o.state=y,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return eA(n,e,t,s,i,r)}function eA(n,e,t,s,r,i){UM(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&HP(e,t,!1),No(n,e,i);s=e.stateNode,ZB.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=Tf(e,n.child,null,i),e.child=Tf(e,null,a,i)):Vn(n,e,a,i),e.memoizedState=s.state,r&&HP(e,t,!0),e.child}function HM(n){var e=n.stateNode;e.pendingContext?UP(n,e.pendingContext,e.pendingContext!==e.context):e.context&&UP(n,e.context,!1),qC(n,e.containerInfo)}function o2(n,e,t,s,r){return kf(),$C(r),e.flags|=256,Vn(n,e,t,s),e.child}var tA={dehydrated:null,treeContext:null,retryLane:0};function nA(n){return{baseLanes:n,cachePool:null,transitions:null}}function GM(n,e,t){var s=e.pendingProps,r=yt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),st(yt,r&1),n===null)return K_(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=S1(o,s,0,null),n=yu(n,s,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=nA(t),e.memoizedState=tA,n):ek(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return e5(n,e,o,s,a,r,t);if(i){i=s.fallback,o=e.mode,r=n.child,a=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=rl(r,c),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=rl(a,i):(i=yu(i,o,t,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=n.child.memoizedState,o=o===null?nA(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=tA,s}return i=n.child,n=i.sibling,s=rl(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function ek(n,e){return e=S1({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ev(n,e,t,s){return s!==null&&$C(s),Tf(e,n.child,null,t),n=ek(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function e5(n,e,t,s,r,i,o){if(t)return e.flags&256?(e.flags&=-257,s=TS(Error(K(422))),ev(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=S1({mode:"visible",children:s.children},r,0,null),i=yu(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Tf(e,n.child,null,o),e.child.memoizedState=nA(o),e.memoizedState=tA,i);if(!(e.mode&1))return ev(n,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(K(419)),s=TS(i,s,void 0),ev(n,e,o,s)}if(a=(o&n.childLanes)!==0,as||a){if(s=sn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Po(n,r),Fr(s,n,r,-1))}return ok(),s=TS(Error(K(421))),ev(n,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=f5.bind(null,n),r._reactRetry=e,null):(n=i.treeContext,Is=el(r.nextSibling),Ds=e,ft=!0,Dr=null,n!==null&&(ir[or++]=bo,ir[or++]=xo,ir[or++]=bu,bo=n.id,xo=n.overflow,bu=e),e=ek(e,s.children),e.flags|=4096,e)}function a2(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),X_(n.return,e,t)}function PS(n,e,t,s,r){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=t,i.tailMode=r)}function qM(n,e,t){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Vn(n,e,s.children,t),s=yt.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&a2(n,t,e);else if(n.tag===19)a2(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(st(yt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Vb(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),PS(e,!1,r,t,i);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Vb(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}PS(e,!0,t,null,i);break;case"together":PS(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fv(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function No(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),wu|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(K(153));if(e.child!==null){for(n=e.child,t=rl(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=rl(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function t5(n,e,t){switch(e.tag){case 3:HM(e),kf();break;case 5:vM(e);break;case 1:cs(e.type)&&Db(e);break;case 4:qC(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;st(Bb,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(st(yt,yt.current&1),e.flags|=128,null):t&e.child.childLanes?GM(n,e,t):(st(yt,yt.current&1),n=No(n,e,t),n!==null?n.sibling:null);st(yt,yt.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return qM(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),st(yt,yt.current),s)break;return null;case 22:case 23:return e.lanes=0,VM(n,e,t)}return No(n,e,t)}var WM,sA,KM,XM;WM=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};sA=function(){};KM=function(n,e,t,s){var r=n.memoizedProps;if(r!==s){n=e.stateNode,Bl(_i.current);var i=null;switch(t){case"input":r=E_(n,r),s=E_(n,s),i=[];break;case"select":r=St({},r,{value:void 0}),s=St({},s,{value:void 0}),i=[];break;case"textarea":r=T_(n,r),s=T_(n,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Lb)}N_(t,s);var o;t=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(um.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(i||(i=[]),i.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(um.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&at("scroll",n),i||a===c||(i=[])):(i=i||[]).push(u,c))}t&&(i=i||[]).push("style",t);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};XM=function(n,e,t,s){t!==s&&(e.flags|=4)};function tp(n,e){if(!ft)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function bn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function n5(n,e,t){var s=e.pendingProps;switch(BC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(e),null;case 1:return cs(e.type)&&Ib(),bn(e),null;case 3:return s=e.stateNode,Pf(),lt(ls),lt(jn),KC(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Jy(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Dr!==null&&(dA(Dr),Dr=null))),sA(n,e),bn(e),null;case 5:WC(e);var r=Bl(Sm.current);if(t=e.type,n!==null&&e.stateNode!=null)KM(n,e,t,s,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(K(166));return bn(e),null}if(n=Bl(_i.current),Jy(e)){s=e.stateNode,t=e.type;var i=e.memoizedProps;switch(s[xi]=e,s[xm]=i,n=(e.mode&1)!==0,t){case"dialog":at("cancel",s),at("close",s);break;case"iframe":case"object":case"embed":at("load",s);break;case"video":case"audio":for(r=0;r<xp.length;r++)at(xp[r],s);break;case"source":at("error",s);break;case"img":case"image":case"link":at("error",s),at("load",s);break;case"details":at("toggle",s);break;case"input":gP(s,i),at("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},at("invalid",s);break;case"textarea":vP(s,i),at("invalid",s)}N_(t,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&Qy(s.textContent,a,n),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Qy(s.textContent,a,n),r=["children",""+a]):um.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&at("scroll",s)}switch(t){case"input":Uy(s),yP(s,i,!0);break;case"textarea":Uy(s),bP(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Lb)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=_j(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[xi]=e,n[xm]=s,WM(n,e,!1,!1),e.stateNode=n;e:{switch(o=R_(t,s),t){case"dialog":at("cancel",n),at("close",n),r=s;break;case"iframe":case"object":case"embed":at("load",n),r=s;break;case"video":case"audio":for(r=0;r<xp.length;r++)at(xp[r],n);r=s;break;case"source":at("error",n),r=s;break;case"img":case"image":case"link":at("error",n),at("load",n),r=s;break;case"details":at("toggle",n),r=s;break;case"input":gP(n,s),r=E_(n,s),at("invalid",n);break;case"option":r=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},r=St({},s,{value:void 0}),at("invalid",n);break;case"textarea":vP(n,s),r=T_(n,s),at("invalid",n);break;default:r=s}N_(t,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?Cj(n,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Aj(n,c)):i==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&dm(n,c):typeof c=="number"&&dm(n,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(um.hasOwnProperty(i)?c!=null&&i==="onScroll"&&at("scroll",n):c!=null&&AC(n,i,c,o))}switch(t){case"input":Uy(n),yP(n,s,!1);break;case"textarea":Uy(n),bP(n);break;case"option":s.value!=null&&n.setAttribute("value",""+al(s.value));break;case"select":n.multiple=!!s.multiple,i=s.value,i!=null?gd(n,!!s.multiple,i,!1):s.defaultValue!=null&&gd(n,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Lb)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bn(e),null;case 6:if(n&&e.stateNode!=null)XM(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(K(166));if(t=Bl(Sm.current),Bl(_i.current),Jy(e)){if(s=e.stateNode,t=e.memoizedProps,s[xi]=e,(i=s.nodeValue!==t)&&(n=Ds,n!==null))switch(n.tag){case 3:Qy(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Qy(s.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[xi]=e,e.stateNode=s}return bn(e),null;case 13:if(lt(yt),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ft&&Is!==null&&e.mode&1&&!(e.flags&128))fM(),kf(),e.flags|=98560,i=!1;else if(i=Jy(e),s!==null&&s.dehydrated!==null){if(n===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[xi]=e}else kf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bn(e),i=!1}else Dr!==null&&(dA(Dr),Dr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||yt.current&1?Wt===0&&(Wt=3):ok())),e.updateQueue!==null&&(e.flags|=4),bn(e),null);case 4:return Pf(),sA(n,e),n===null&&vm(e.stateNode.containerInfo),bn(e),null;case 10:return UC(e.type._context),bn(e),null;case 17:return cs(e.type)&&Ib(),bn(e),null;case 19:if(lt(yt),i=e.memoizedState,i===null)return bn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)tp(i,!1);else{if(Wt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Vb(n),o!==null){for(e.flags|=128,tp(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)i=t,n=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return st(yt,yt.current&1|2),e.child}n=n.sibling}i.tail!==null&&jt()>Rf&&(e.flags|=128,s=!0,tp(i,!1),e.lanes=4194304)}else{if(!s)if(n=Vb(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),tp(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ft)return bn(e),null}else 2*jt()-i.renderingStartTime>Rf&&t!==1073741824&&(e.flags|=128,s=!0,tp(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=jt(),e.sibling=null,t=yt.current,st(yt,s?t&1|2:t&1),e):(bn(e),null);case 22:case 23:return ik(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Ms&1073741824&&(bn(e),e.subtreeFlags&6&&(e.flags|=8192)):bn(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function s5(n,e){switch(BC(e),e.tag){case 1:return cs(e.type)&&Ib(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Pf(),lt(ls),lt(jn),KC(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return WC(e),null;case 13:if(lt(yt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(K(340));kf()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return lt(yt),null;case 4:return Pf(),null;case 10:return UC(e.type._context),null;case 22:case 23:return ik(),null;case 24:return null;default:return null}}var tv=!1,Pn=!1,r5=typeof WeakSet=="function"?WeakSet:Set,te=null;function id(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){kt(n,e,s)}else t.current=null}function rA(n,e,t){try{t()}catch(s){kt(n,e,s)}}var l2=!1;function i5(n,e){if(z_=Rb,n=eM(),OC(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=n,p=null;t:for(;;){for(var m;h!==t||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===n)break t;if(p===t&&++u===r&&(a=o),p===i&&++d===s&&(c=o),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(V_={focusedElem:n,selectionRange:t},Rb=!1,te=e;te!==null;)if(e=te,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,te=n;else for(;te!==null;){e=te;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,w=y.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:br(e.type,g),w);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(E){kt(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}return y=l2,l2=!1,y}function Qp(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&n)===n){var i=r.destroy;r.destroy=void 0,i!==void 0&&rA(e,t,i)}r=r.next}while(r!==s)}}function x1(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function iA(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function YM(n){var e=n.alternate;e!==null&&(n.alternate=null,YM(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[xi],delete e[xm],delete e[G_],delete e[zB],delete e[VB])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function QM(n){return n.tag===5||n.tag===3||n.tag===4}function c2(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||QM(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function oA(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Lb));else if(s!==4&&(n=n.child,n!==null))for(oA(n,e,t),n=n.sibling;n!==null;)oA(n,e,t),n=n.sibling}function aA(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(aA(n,e,t),n=n.sibling;n!==null;)aA(n,e,t),n=n.sibling}var pn=null,Lr=!1;function Bo(n,e,t){for(t=t.child;t!==null;)JM(n,e,t),t=t.sibling}function JM(n,e,t){if(Si&&typeof Si.onCommitFiberUnmount=="function")try{Si.onCommitFiberUnmount(h1,t)}catch{}switch(t.tag){case 5:Pn||id(t,e);case 6:var s=pn,r=Lr;pn=null,Bo(n,e,t),pn=s,Lr=r,pn!==null&&(Lr?(n=pn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):pn.removeChild(t.stateNode));break;case 18:pn!==null&&(Lr?(n=pn,t=t.stateNode,n.nodeType===8?SS(n.parentNode,t):n.nodeType===1&&SS(n,t),mm(n)):SS(pn,t.stateNode));break;case 4:s=pn,r=Lr,pn=t.stateNode.containerInfo,Lr=!0,Bo(n,e,t),pn=s,Lr=r;break;case 0:case 11:case 14:case 15:if(!Pn&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&rA(t,e,o),r=r.next}while(r!==s)}Bo(n,e,t);break;case 1:if(!Pn&&(id(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(a){kt(t,e,a)}Bo(n,e,t);break;case 21:Bo(n,e,t);break;case 22:t.mode&1?(Pn=(s=Pn)||t.memoizedState!==null,Bo(n,e,t),Pn=s):Bo(n,e,t);break;default:Bo(n,e,t)}}function u2(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new r5),e.forEach(function(s){var r=p5.bind(null,n,s);t.has(s)||(t.add(s),s.then(r,r))})}}function mr(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:pn=a.stateNode,Lr=!1;break e;case 3:pn=a.stateNode.containerInfo,Lr=!0;break e;case 4:pn=a.stateNode.containerInfo,Lr=!0;break e}a=a.return}if(pn===null)throw Error(K(160));JM(i,o,r),pn=null,Lr=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(u){kt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZM(e,n),e=e.sibling}function ZM(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(mr(e,n),Hr(n),s&4){try{Qp(3,n,n.return),x1(3,n)}catch(g){kt(n,n.return,g)}try{Qp(5,n,n.return)}catch(g){kt(n,n.return,g)}}break;case 1:mr(e,n),Hr(n),s&512&&t!==null&&id(t,t.return);break;case 5:if(mr(e,n),Hr(n),s&512&&t!==null&&id(t,t.return),n.flags&32){var r=n.stateNode;try{dm(r,"")}catch(g){kt(n,n.return,g)}}if(s&4&&(r=n.stateNode,r!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&wj(r,i),R_(a,o);var u=R_(a,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Cj(r,h):d==="dangerouslySetInnerHTML"?Aj(r,h):d==="children"?dm(r,h):AC(r,d,h,u)}switch(a){case"input":C_(r,i);break;case"textarea":Sj(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?gd(r,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?gd(r,!!i.multiple,i.defaultValue,!0):gd(r,!!i.multiple,i.multiple?[]:"",!1))}r[xm]=i}catch(g){kt(n,n.return,g)}}break;case 6:if(mr(e,n),Hr(n),s&4){if(n.stateNode===null)throw Error(K(162));r=n.stateNode,i=n.memoizedProps;try{r.nodeValue=i}catch(g){kt(n,n.return,g)}}break;case 3:if(mr(e,n),Hr(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{mm(e.containerInfo)}catch(g){kt(n,n.return,g)}break;case 4:mr(e,n),Hr(n);break;case 13:mr(e,n),Hr(n),r=n.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(sk=jt())),s&4&&u2(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Pn=(u=Pn)||d,mr(e,n),Pn=u):mr(e,n),Hr(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(te=n,d=n.child;d!==null;){for(h=te=d;te!==null;){switch(p=te,m=p.child,p.tag){case 0:case 11:case 14:case 15:Qp(4,p,p.return);break;case 1:id(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(g){kt(s,t,g)}}break;case 5:id(p,p.return);break;case 22:if(p.memoizedState!==null){h2(h);continue}}m!==null?(m.return=p,te=m):h2(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Ej("display",o))}catch(g){kt(n,n.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kt(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mr(e,n),Hr(n),s&4&&u2(n);break;case 21:break;default:mr(e,n),Hr(n)}}function Hr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(QM(t)){var s=t;break e}t=t.return}throw Error(K(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(dm(r,""),s.flags&=-33);var i=c2(n);aA(n,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=c2(n);oA(n,a,o);break;default:throw Error(K(161))}}catch(c){kt(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function o5(n,e,t){te=n,eL(n)}function eL(n,e,t){for(var s=(n.mode&1)!==0;te!==null;){var r=te,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||tv;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||Pn;a=tv;var u=Pn;if(tv=o,(Pn=c)&&!u)for(te=r;te!==null;)o=te,c=o.child,o.tag===22&&o.memoizedState!==null?f2(r):c!==null?(c.return=o,te=c):f2(r);for(;i!==null;)te=i,eL(i),i=i.sibling;te=r,tv=a,Pn=u}d2(n)}else r.subtreeFlags&8772&&i!==null?(i.return=r,te=i):d2(n)}}function d2(n){for(;te!==null;){var e=te;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pn||x1(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Pn)if(t===null)s.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:br(e.type,t.memoizedProps);s.componentDidUpdate(r,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&XP(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}XP(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&mm(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Pn||e.flags&512&&iA(e)}catch(p){kt(e,e.return,p)}}if(e===n){te=null;break}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}}function h2(n){for(;te!==null;){var e=te;if(e===n){te=null;break}var t=e.sibling;if(t!==null){t.return=e.return,te=t;break}te=e.return}}function f2(n){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{x1(4,e)}catch(c){kt(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){kt(e,r,c)}}var i=e.return;try{iA(e)}catch(c){kt(e,i,c)}break;case 5:var o=e.return;try{iA(e)}catch(c){kt(e,o,c)}}}catch(c){kt(e,e.return,c)}if(e===n){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var a5=Math.ceil,Gb=Io.ReactCurrentDispatcher,tk=Io.ReactCurrentOwner,cr=Io.ReactCurrentBatchConfig,Ie=0,sn=null,Ot=null,gn=0,Ms=0,od=pl(0),Wt=0,Cm=null,wu=0,w1=0,nk=0,Jp=null,is=null,sk=0,Rf=1/0,Ni=null,qb=!1,lA=null,nl=null,nv=!1,Ya=null,Wb=0,Zp=0,cA=null,Bv=-1,$v=0;function Hn(){return Ie&6?jt():Bv!==-1?Bv:Bv=jt()}function sl(n){return n.mode&1?Ie&2&&gn!==0?gn&-gn:HB.transition!==null?($v===0&&($v=Fj()),$v):(n=Ve,n!==0||(n=window.event,n=n===void 0?16:Gj(n.type)),n):1}function Fr(n,e,t,s){if(50<Zp)throw Zp=0,cA=null,Error(K(185));yy(n,t,s),(!(Ie&2)||n!==sn)&&(n===sn&&(!(Ie&2)&&(w1|=t),Wt===4&&Ko(n,gn)),us(n,s),t===1&&Ie===0&&!(e.mode&1)&&(Rf=jt()+500,y1&&ml()))}function us(n,e){var t=n.callbackNode;H4(n,e);var s=Nb(n,n===sn?gn:0);if(s===0)t!==null&&SP(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&SP(t),e===1)n.tag===0?UB(p2.bind(null,n)):uM(p2.bind(null,n)),BB(function(){!(Ie&6)&&ml()}),t=null;else{switch(Bj(s)){case 1:t=PC;break;case 4:t=Dj;break;case 16:t=Pb;break;case 536870912:t=Oj;break;default:t=Pb}t=lL(t,tL.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function tL(n,e){if(Bv=-1,$v=0,Ie&6)throw Error(K(327));var t=n.callbackNode;if(wd()&&n.callbackNode!==t)return null;var s=Nb(n,n===sn?gn:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Kb(n,s);else{e=s;var r=Ie;Ie|=2;var i=sL();(sn!==n||gn!==e)&&(Ni=null,Rf=jt()+500,gu(n,e));do try{u5();break}catch(a){nL(n,a)}while(1);VC(),Gb.current=i,Ie=r,Ot!==null?e=0:(sn=null,gn=0,e=Wt)}if(e!==0){if(e===2&&(r=D_(n),r!==0&&(s=r,e=uA(n,r))),e===1)throw t=Cm,gu(n,0),Ko(n,s),us(n,jt()),t;if(e===6)Ko(n,s);else{if(r=n.current.alternate,!(s&30)&&!l5(r)&&(e=Kb(n,s),e===2&&(i=D_(n),i!==0&&(s=i,e=uA(n,i))),e===1))throw t=Cm,gu(n,0),Ko(n,s),us(n,jt()),t;switch(n.finishedWork=r,n.finishedLanes=s,e){case 0:case 1:throw Error(K(345));case 2:El(n,is,Ni);break;case 3:if(Ko(n,s),(s&130023424)===s&&(e=sk+500-jt(),10<e)){if(Nb(n,0)!==0)break;if(r=n.suspendedLanes,(r&s)!==s){Hn(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=H_(El.bind(null,n,is,Ni),e);break}El(n,is,Ni);break;case 4:if(Ko(n,s),(s&4194240)===s)break;for(e=n.eventTimes,r=-1;0<s;){var o=31-Or(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=jt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*a5(s/1960))-s,10<s){n.timeoutHandle=H_(El.bind(null,n,is,Ni),s);break}El(n,is,Ni);break;case 5:El(n,is,Ni);break;default:throw Error(K(329))}}}return us(n,jt()),n.callbackNode===t?tL.bind(null,n):null}function uA(n,e){var t=Jp;return n.current.memoizedState.isDehydrated&&(gu(n,e).flags|=256),n=Kb(n,e),n!==2&&(e=is,is=t,e!==null&&dA(e)),n}function dA(n){is===null?is=n:is.push.apply(is,n)}function l5(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var r=t[s],i=r.getSnapshot;r=r.value;try{if(!Br(i(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ko(n,e){for(e&=~nk,e&=~w1,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Or(e),s=1<<t;n[t]=-1,e&=~s}}function p2(n){if(Ie&6)throw Error(K(327));wd();var e=Nb(n,0);if(!(e&1))return us(n,jt()),null;var t=Kb(n,e);if(n.tag!==0&&t===2){var s=D_(n);s!==0&&(e=s,t=uA(n,s))}if(t===1)throw t=Cm,gu(n,0),Ko(n,e),us(n,jt()),t;if(t===6)throw Error(K(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,El(n,is,Ni),us(n,jt()),null}function rk(n,e){var t=Ie;Ie|=1;try{return n(e)}finally{Ie=t,Ie===0&&(Rf=jt()+500,y1&&ml())}}function Su(n){Ya!==null&&Ya.tag===0&&!(Ie&6)&&wd();var e=Ie;Ie|=1;var t=cr.transition,s=Ve;try{if(cr.transition=null,Ve=1,n)return n()}finally{Ve=s,cr.transition=t,Ie=e,!(Ie&6)&&ml()}}function ik(){Ms=od.current,lt(od)}function gu(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,FB(t)),Ot!==null)for(t=Ot.return;t!==null;){var s=t;switch(BC(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ib();break;case 3:Pf(),lt(ls),lt(jn),KC();break;case 5:WC(s);break;case 4:Pf();break;case 13:lt(yt);break;case 19:lt(yt);break;case 10:UC(s.type._context);break;case 22:case 23:ik()}t=t.return}if(sn=n,Ot=n=rl(n.current,null),gn=Ms=e,Wt=0,Cm=null,nk=w1=wu=0,is=Jp=null,Fl!==null){for(e=0;e<Fl.length;e++)if(t=Fl[e],s=t.interleaved,s!==null){t.interleaved=null;var r=s.next,i=t.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}t.pending=s}Fl=null}return n}function nL(n,e){do{var t=Ot;try{if(VC(),Dv.current=Hb,Ub){for(var s=xt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Ub=!1}if(xu=0,nn=qt=xt=null,Yp=!1,_m=0,tk.current=null,t===null||t.return===null){Wt=1,Cm=e,Ot=null;break}e:{var i=n,o=t.return,a=t,c=e;if(e=gn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=t2(o);if(m!==null){m.flags&=-257,n2(m,o,a,i,e),m.mode&1&&e2(i,u,e),e=m,c=u;var y=e.updateQueue;if(y===null){var g=new Set;g.add(c),e.updateQueue=g}else y.add(c);break e}else{if(!(e&1)){e2(i,u,e),ok();break e}c=Error(K(426))}}else if(ft&&a.mode&1){var w=t2(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),n2(w,o,a,i,e),$C(Nf(c,a));break e}}i=c=Nf(c,a),Wt!==4&&(Wt=2),Jp===null?Jp=[i]:Jp.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=BM(i,c,e);KP(i,v);break e;case 1:a=c;var b=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(nl===null||!nl.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=$M(i,a,e);KP(i,E);break e}}i=i.return}while(i!==null)}iL(t)}catch(k){e=k,Ot===t&&t!==null&&(Ot=t=t.return);continue}break}while(1)}function sL(){var n=Gb.current;return Gb.current=Hb,n===null?Hb:n}function ok(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),sn===null||!(wu&268435455)&&!(w1&268435455)||Ko(sn,gn)}function Kb(n,e){var t=Ie;Ie|=2;var s=sL();(sn!==n||gn!==e)&&(Ni=null,gu(n,e));do try{c5();break}catch(r){nL(n,r)}while(1);if(VC(),Ie=t,Gb.current=s,Ot!==null)throw Error(K(261));return sn=null,gn=0,Wt}function c5(){for(;Ot!==null;)rL(Ot)}function u5(){for(;Ot!==null&&!I4();)rL(Ot)}function rL(n){var e=aL(n.alternate,n,Ms);n.memoizedProps=n.pendingProps,e===null?iL(n):Ot=e,tk.current=null}function iL(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=s5(t,e),t!==null){t.flags&=32767,Ot=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Wt=6,Ot=null;return}}else if(t=n5(t,e,Ms),t!==null){Ot=t;return}if(e=e.sibling,e!==null){Ot=e;return}Ot=e=n}while(e!==null);Wt===0&&(Wt=5)}function El(n,e,t){var s=Ve,r=cr.transition;try{cr.transition=null,Ve=1,d5(n,e,t,s)}finally{cr.transition=r,Ve=s}return null}function d5(n,e,t,s){do wd();while(Ya!==null);if(Ie&6)throw Error(K(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(K(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(G4(n,i),n===sn&&(Ot=sn=null,gn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||nv||(nv=!0,lL(Pb,function(){return wd(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=cr.transition,cr.transition=null;var o=Ve;Ve=1;var a=Ie;Ie|=4,tk.current=null,i5(n,t),ZM(t,n),RB(V_),Rb=!!z_,V_=z_=null,n.current=t,o5(t),D4(),Ie=a,Ve=o,cr.transition=i}else n.current=t;if(nv&&(nv=!1,Ya=n,Wb=r),i=n.pendingLanes,i===0&&(nl=null),B4(t.stateNode),us(n,jt()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],s(r.value,{componentStack:r.stack,digest:r.digest});if(qb)throw qb=!1,n=lA,lA=null,n;return Wb&1&&n.tag!==0&&wd(),i=n.pendingLanes,i&1?n===cA?Zp++:(Zp=0,cA=n):Zp=0,ml(),null}function wd(){if(Ya!==null){var n=Bj(Wb),e=cr.transition,t=Ve;try{if(cr.transition=null,Ve=16>n?16:n,Ya===null)var s=!1;else{if(n=Ya,Ya=null,Wb=0,Ie&6)throw Error(K(331));var r=Ie;for(Ie|=4,te=n.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(te=u;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:Qp(8,d,i)}var h=d.child;if(h!==null)h.return=d,te=h;else for(;te!==null;){d=te;var p=d.sibling,m=d.return;if(YM(d),d===u){te=null;break}if(p!==null){p.return=m,te=p;break}te=m}}}var y=i.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qp(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,te=v;break e}te=i.return}}var b=n.current;for(te=b;te!==null;){o=te;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,te=S;else e:for(o=b;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:x1(9,a)}}catch(k){kt(a,a.return,k)}if(a===o){te=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,te=E;break e}te=a.return}}if(Ie=r,ml(),Si&&typeof Si.onPostCommitFiberRoot=="function")try{Si.onPostCommitFiberRoot(h1,n)}catch{}s=!0}return s}finally{Ve=t,cr.transition=e}}return!1}function m2(n,e,t){e=Nf(t,e),e=BM(n,e,1),n=tl(n,e,1),e=Hn(),n!==null&&(yy(n,1,e),us(n,e))}function kt(n,e,t){if(n.tag===3)m2(n,n,t);else for(;e!==null;){if(e.tag===3){m2(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(nl===null||!nl.has(s))){n=Nf(t,n),n=$M(e,n,1),e=tl(e,n,1),n=Hn(),e!==null&&(yy(e,1,n),us(e,n));break}}e=e.return}}function h5(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Hn(),n.pingedLanes|=n.suspendedLanes&t,sn===n&&(gn&t)===t&&(Wt===4||Wt===3&&(gn&130023424)===gn&&500>jt()-sk?gu(n,0):nk|=t),us(n,e)}function oL(n,e){e===0&&(n.mode&1?(e=qy,qy<<=1,!(qy&130023424)&&(qy=4194304)):e=1);var t=Hn();n=Po(n,e),n!==null&&(yy(n,e,t),us(n,t))}function f5(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),oL(n,t)}function p5(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(K(314))}s!==null&&s.delete(e),oL(n,t)}var aL;aL=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ls.current)as=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return as=!1,t5(n,e,t);as=!!(n.flags&131072)}else as=!1,ft&&e.flags&1048576&&dM(e,Fb,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Fv(n,e),n=e.pendingProps;var r=Cf(e,jn.current);xd(e,t),r=YC(null,e,s,n,r,t);var i=QC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cs(s)?(i=!0,Db(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,GC(e),r.updater=b1,e.stateNode=r,r._reactInternals=e,Q_(e,s,n,t),e=eA(null,e,s,!0,i,t)):(e.tag=0,ft&&i&&FC(e),Vn(null,e,r,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Fv(n,e),n=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=g5(s),n=br(s,n),r){case 0:e=Z_(null,e,s,n,t);break e;case 1:e=i2(null,e,s,n,t);break e;case 11:e=s2(null,e,s,n,t);break e;case 14:e=r2(null,e,s,br(s.type,n),t);break e}throw Error(K(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:br(s,r),Z_(n,e,s,r,t);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:br(s,r),i2(n,e,s,r,t);case 3:e:{if(HM(e),n===null)throw Error(K(387));s=e.pendingProps,i=e.memoizedState,r=i.element,yM(n,e),zb(e,s,null,t);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Nf(Error(K(423)),e),e=o2(n,e,s,t,r);break e}else if(s!==r){r=Nf(Error(K(424)),e),e=o2(n,e,s,t,r);break e}else for(Is=el(e.stateNode.containerInfo.firstChild),Ds=e,ft=!0,Dr=null,t=mM(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(kf(),s===r){e=No(n,e,t);break e}Vn(n,e,s,t)}e=e.child}return e;case 5:return vM(e),n===null&&K_(e),s=e.type,r=e.pendingProps,i=n!==null?n.memoizedProps:null,o=r.children,U_(s,r)?o=null:i!==null&&U_(s,i)&&(e.flags|=32),UM(n,e),Vn(n,e,o,t),e.child;case 6:return n===null&&K_(e),null;case 13:return GM(n,e,t);case 4:return qC(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Tf(e,null,s,t):Vn(n,e,s,t),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:br(s,r),s2(n,e,s,r,t);case 7:return Vn(n,e,e.pendingProps,t),e.child;case 8:return Vn(n,e,e.pendingProps.children,t),e.child;case 12:return Vn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,st(Bb,s._currentValue),s._currentValue=o,i!==null)if(Br(i.value,o)){if(i.children===r.children&&!ls.current){e=No(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=_o(-1,t&-t),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=t,c=i.alternate,c!==null&&(c.lanes|=t),X_(i.return,t,e),a.lanes|=t;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),X_(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Vn(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,xd(e,t),r=ur(r),s=s(r),e.flags|=1,Vn(n,e,s,t),e.child;case 14:return s=e.type,r=br(s,e.pendingProps),r=br(s.type,r),r2(n,e,s,r,t);case 15:return zM(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:br(s,r),Fv(n,e),e.tag=1,cs(s)?(n=!0,Db(e)):n=!1,xd(e,t),FM(e,s,r),Q_(e,s,r,t),eA(null,e,s,!0,n,t);case 19:return qM(n,e,t);case 22:return VM(n,e,t)}throw Error(K(156,e.tag))};function lL(n,e){return Ij(n,e)}function m5(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(n,e,t,s){return new m5(n,e,t,s)}function ak(n){return n=n.prototype,!(!n||!n.isReactComponent)}function g5(n){if(typeof n=="function")return ak(n)?1:0;if(n!=null){if(n=n.$$typeof,n===CC)return 11;if(n===kC)return 14}return 2}function rl(n,e){var t=n.alternate;return t===null?(t=lr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function zv(n,e,t,s,r,i){var o=2;if(s=n,typeof n=="function")ak(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Yu:return yu(t.children,r,i,e);case EC:o=8,r|=8;break;case w_:return n=lr(12,t,e,r|2),n.elementType=w_,n.lanes=i,n;case S_:return n=lr(13,t,e,r),n.elementType=S_,n.lanes=i,n;case __:return n=lr(19,t,e,r),n.elementType=__,n.lanes=i,n;case vj:return S1(t,r,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case gj:o=10;break e;case yj:o=9;break e;case CC:o=11;break e;case kC:o=14;break e;case Ho:o=16,s=null;break e}throw Error(K(130,n==null?n:typeof n,""))}return e=lr(o,t,e,r),e.elementType=n,e.type=s,e.lanes=i,e}function yu(n,e,t,s){return n=lr(7,n,s,e),n.lanes=t,n}function S1(n,e,t,s){return n=lr(22,n,s,e),n.elementType=vj,n.lanes=t,n.stateNode={isHidden:!1},n}function NS(n,e,t){return n=lr(6,n,null,e),n.lanes=t,n}function RS(n,e,t){return e=lr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function y5(n,e,t,s,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dS(0),this.expirationTimes=dS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dS(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function lk(n,e,t,s,r,i,o,a,c){return n=new y5(n,e,t,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=lr(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},GC(i),n}function v5(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xu,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function cL(n){if(!n)return ll;n=n._reactInternals;e:{if(Tu(n)!==n||n.tag!==1)throw Error(K(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(n.tag===1){var t=n.type;if(cs(t))return cM(n,t,e)}return e}function uL(n,e,t,s,r,i,o,a,c){return n=lk(t,s,!0,n,r,i,o,a,c),n.context=cL(null),t=n.current,s=Hn(),r=sl(t),i=_o(s,r),i.callback=e??null,tl(t,i,r),n.current.lanes=r,yy(n,r,s),us(n,s),n}function _1(n,e,t,s){var r=e.current,i=Hn(),o=sl(r);return t=cL(t),e.context===null?e.context=t:e.pendingContext=t,e=_o(i,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=tl(r,e,o),n!==null&&(Fr(n,r,o,i),Iv(n,r,o)),o}function Xb(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function g2(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function ck(n,e){g2(n,e),(n=n.alternate)&&g2(n,e)}function b5(){return null}var dL=typeof reportError=="function"?reportError:function(n){console.error(n)};function uk(n){this._internalRoot=n}A1.prototype.render=uk.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(K(409));_1(n,e,null,null)};A1.prototype.unmount=uk.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Su(function(){_1(null,n,null,null)}),e[To]=null}};function A1(n){this._internalRoot=n}A1.prototype.unstable_scheduleHydration=function(n){if(n){var e=Vj();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Wo.length&&e!==0&&e<Wo[t].priority;t++);Wo.splice(t,0,n),t===0&&Hj(n)}};function dk(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function E1(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function y2(){}function x5(n,e,t,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Xb(o);i.call(u)}}var o=uL(e,s,n,0,null,!1,!1,"",y2);return n._reactRootContainer=o,n[To]=o.current,vm(n.nodeType===8?n.parentNode:n),Su(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=Xb(c);a.call(u)}}var c=lk(n,0,!1,null,null,!1,!1,"",y2);return n._reactRootContainer=c,n[To]=c.current,vm(n.nodeType===8?n.parentNode:n),Su(function(){_1(e,c,t,s)}),c}function C1(n,e,t,s,r){var i=t._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var c=Xb(o);a.call(c)}}_1(e,o,n,r)}else o=x5(t,e,n,r,s);return Xb(o)}$j=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=bp(e.pendingLanes);t!==0&&(NC(e,t|1),us(e,jt()),!(Ie&6)&&(Rf=jt()+500,ml()))}break;case 13:Su(function(){var s=Po(n,1);if(s!==null){var r=Hn();Fr(s,n,1,r)}}),ck(n,1)}};RC=function(n){if(n.tag===13){var e=Po(n,134217728);if(e!==null){var t=Hn();Fr(e,n,134217728,t)}ck(n,134217728)}};zj=function(n){if(n.tag===13){var e=sl(n),t=Po(n,e);if(t!==null){var s=Hn();Fr(t,n,e,s)}ck(n,e)}};Vj=function(){return Ve};Uj=function(n,e){var t=Ve;try{return Ve=n,e()}finally{Ve=t}};M_=function(n,e,t){switch(e){case"input":if(C_(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var r=g1(s);if(!r)throw Error(K(90));xj(s),C_(s,r)}}}break;case"textarea":Sj(n,t);break;case"select":e=t.value,e!=null&&gd(n,!!t.multiple,e,!1)}};Pj=rk;Nj=Su;var w5={usingClientEntryPoint:!1,Events:[by,ed,g1,kj,Tj,rk]},np={findFiberByHostInstance:Ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},S5={bundleType:np.bundleType,version:np.version,rendererPackageName:np.rendererPackageName,rendererConfig:np.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Io.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Mj(n),n===null?null:n.stateNode},findFiberByHostInstance:np.findFiberByHostInstance||b5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sv.isDisabled&&sv.supportsFiber)try{h1=sv.inject(S5),Si=sv}catch{}}$s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w5;$s.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dk(e))throw Error(K(200));return v5(n,e,null,t)};$s.createRoot=function(n,e){if(!dk(n))throw Error(K(299));var t=!1,s="",r=dL;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=lk(n,1,!1,null,null,t,!1,s,r),n[To]=e.current,vm(n.nodeType===8?n.parentNode:n),new uk(e)};$s.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(K(188)):(n=Object.keys(n).join(","),Error(K(268,n)));return n=Mj(e),n=n===null?null:n.stateNode,n};$s.flushSync=function(n){return Su(n)};$s.hydrate=function(n,e,t){if(!E1(e))throw Error(K(200));return C1(null,n,e,!0,t)};$s.hydrateRoot=function(n,e,t){if(!dk(n))throw Error(K(405));var s=t!=null&&t.hydratedSources||null,r=!1,i="",o=dL;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=uL(e,null,n,1,t??null,r,!1,i,o),n[To]=e.current,vm(n),s)for(n=0;n<s.length;n++)t=s[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new A1(e)};$s.render=function(n,e,t){if(!E1(e))throw Error(K(200));return C1(null,n,e,!1,t)};$s.unmountComponentAtNode=function(n){if(!E1(n))throw Error(K(40));return n._reactRootContainer?(Su(function(){C1(null,null,n,!1,function(){n._reactRootContainer=null,n[To]=null})}),!0):!1};$s.unstable_batchedUpdates=rk;$s.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!E1(t))throw Error(K(200));if(n==null||n._reactInternals===void 0)throw Error(K(38));return C1(n,e,t,!1,s)};$s.version="18.3.1-next-f1338f8080-20240426";function hL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hL)}catch(n){console.error(n)}}hL(),hj.exports=$s;var wy=hj.exports;const _5=u1(wy);var v2=wy;b_.createRoot=v2.createRoot,b_.hydrateRoot=v2.hydrateRoot;function Un(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function b2(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function fL(...n){return e=>{let t=!1;const s=n.map(r=>{const i=b2(r,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():b2(n[r],null)}}}}function Ro(...n){return A.useCallback(fL(...n),n)}function k1(n,e=[]){let t=[];function s(i,o){const a=A.createContext(o),c=t.length;t=[...t,o];const u=h=>{var v;const{scope:p,children:m,...y}=h,g=((v=p==null?void 0:p[n])==null?void 0:v[c])||a,w=A.useMemo(()=>y,Object.values(y));return f.jsx(g.Provider,{value:w,children:m})};u.displayName=i+"Provider";function d(h,p){var g;const m=((g=p==null?void 0:p[n])==null?void 0:g[c])||a,y=A.useContext(m);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=t.map(o=>A.createContext(o));return function(a){const c=(a==null?void 0:a[n])||i;return A.useMemo(()=>({[`__scope${n}`]:{...a,[n]:c}}),[a,c])}};return r.scopeName=n,[s,A5(r,...e)]}function A5(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const s=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...a,...h}},{});return A.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function Yb(n){const e=C5(n),t=A.forwardRef((s,r)=>{const{children:i,...o}=s,a=A.Children.toArray(i),c=a.find(T5);if(c){const u=c.props.children,d=a.map(h=>h===c?A.Children.count(u)>1?A.Children.only(null):A.isValidElement(u)?u.props.children:null:h);return f.jsx(e,{...o,ref:r,children:A.isValidElement(u)?A.cloneElement(u,void 0,d):null})}return f.jsx(e,{...o,ref:r,children:i})});return t.displayName=`${n}.Slot`,t}var E5=Yb("Slot");function C5(n){const e=A.forwardRef((t,s)=>{const{children:r,...i}=t;if(A.isValidElement(r)){const o=N5(r),a=P5(i,r.props);return r.type!==A.Fragment&&(a.ref=s?fL(s,o):o),A.cloneElement(r,a)}return A.Children.count(r)>1?A.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var k5=Symbol("radix.slottable");function T5(n){return A.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===k5}function P5(n,e){const t={...e};for(const s in e){const r=n[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?t[s]=(...a)=>{const c=i(...a);return r(...a),c}:r&&(t[s]=r):s==="style"?t[s]={...r,...i}:s==="className"&&(t[s]=[r,i].filter(Boolean).join(" "))}return{...n,...t}}function N5(n){var s,r;let e=(s=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function pL(n){const e=n+"CollectionProvider",[t,s]=k1(e),[r,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:w,children:v}=g,b=Re.useRef(null),S=Re.useRef(new Map).current;return f.jsx(r,{scope:w,itemMap:S,collectionRef:b,children:v})};o.displayName=e;const a=n+"CollectionSlot",c=Yb(a),u=Re.forwardRef((g,w)=>{const{scope:v,children:b}=g,S=i(a,v),E=Ro(w,S.collectionRef);return f.jsx(c,{ref:E,children:b})});u.displayName=a;const d=n+"CollectionItemSlot",h="data-radix-collection-item",p=Yb(d),m=Re.forwardRef((g,w)=>{const{scope:v,children:b,...S}=g,E=Re.useRef(null),k=Ro(w,E),T=i(d,v);return Re.useEffect(()=>(T.itemMap.set(E,{ref:E,...S}),()=>void T.itemMap.delete(E))),f.jsx(p,{[h]:"",ref:k,children:b})});m.displayName=d;function y(g){const w=i(n+"CollectionConsumer",g);return Re.useCallback(()=>{const b=w.collectionRef.current;if(!b)return[];const S=Array.from(b.querySelectorAll(`[${h}]`));return Array.from(w.itemMap.values()).sort((T,P)=>S.indexOf(T.ref.current)-S.indexOf(P.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},y,s]}var R5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wn=R5.reduce((n,e)=>{const t=Yb(`Primitive.${e}`),s=A.forwardRef((r,i)=>{const{asChild:o,...a}=r,c=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(c,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...n,[e]:s}},{});function mL(n,e){n&&wy.flushSync(()=>n.dispatchEvent(e))}function _u(n){const e=A.useRef(n);return A.useEffect(()=>{e.current=n}),A.useMemo(()=>(...t)=>{var s;return(s=e.current)==null?void 0:s.call(e,...t)},[])}function j5(n,e=globalThis==null?void 0:globalThis.document){const t=_u(n);A.useEffect(()=>{const s=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[t,e])}var M5="DismissableLayer",hA="dismissableLayer.update",L5="dismissableLayer.pointerDownOutside",I5="dismissableLayer.focusOutside",x2,gL=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),yL=A.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...c}=n,u=A.useContext(gL),[d,h]=A.useState(null),p=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=A.useState({}),y=Ro(e,P=>h(P)),g=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(w),b=d?g.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,E=b>=v,k=O5(P=>{const N=P.target,M=[...u.branches].some(L=>L.contains(N));!E||M||(r==null||r(P),o==null||o(P),P.defaultPrevented||a==null||a())},p),T=F5(P=>{const N=P.target;[...u.branches].some(L=>L.contains(N))||(i==null||i(P),o==null||o(P),P.defaultPrevented||a==null||a())},p);return j5(P=>{b===u.layers.size-1&&(s==null||s(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},p),A.useEffect(()=>{if(d)return t&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(x2=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),w2(),()=>{t&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=x2)}},[d,p,t,u]),A.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),w2())},[d,u]),A.useEffect(()=>{const P=()=>m({});return document.addEventListener(hA,P),()=>document.removeEventListener(hA,P)},[]),f.jsx(Wn.div,{...c,ref:y,style:{pointerEvents:S?E?"auto":"none":void 0,...n.style},onFocusCapture:Un(n.onFocusCapture,T.onFocusCapture),onBlurCapture:Un(n.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Un(n.onPointerDownCapture,k.onPointerDownCapture)})});yL.displayName=M5;var D5="DismissableLayerBranch",vL=A.forwardRef((n,e)=>{const t=A.useContext(gL),s=A.useRef(null),r=Ro(e,s);return A.useEffect(()=>{const i=s.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),f.jsx(Wn.div,{...n,ref:r})});vL.displayName=D5;function O5(n,e=globalThis==null?void 0:globalThis.document){const t=_u(n),s=A.useRef(!1),r=A.useRef(()=>{});return A.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let c=function(){bL(L5,t,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=c,e.addEventListener("click",r.current,{once:!0})):c()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>s.current=!0}}function F5(n,e=globalThis==null?void 0:globalThis.document){const t=_u(n),s=A.useRef(!1);return A.useEffect(()=>{const r=i=>{i.target&&!s.current&&bL(I5,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function w2(){const n=new CustomEvent(hA);document.dispatchEvent(n)}function bL(n,e,t,{discrete:s}){const r=t.originalEvent.target,i=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(n,e,{once:!0}),s?mL(r,i):r.dispatchEvent(i)}var B5=yL,$5=vL,Au=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},z5="Portal",xL=A.forwardRef((n,e)=>{var a;const{container:t,...s}=n,[r,i]=A.useState(!1);Au(()=>i(!0),[]);const o=t||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?_5.createPortal(f.jsx(Wn.div,{...s,ref:e}),o):null});xL.displayName=z5;function V5(n,e){return A.useReducer((t,s)=>e[t][s]??t,n)}var hk=n=>{const{present:e,children:t}=n,s=U5(e),r=typeof t=="function"?t({present:s.isPresent}):A.Children.only(t),i=Ro(s.ref,H5(r));return typeof t=="function"||s.isPresent?A.cloneElement(r,{ref:i}):null};hk.displayName="Presence";function U5(n){const[e,t]=A.useState(),s=A.useRef(null),r=A.useRef(n),i=A.useRef("none"),o=n?"mounted":"unmounted",[a,c]=V5(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const u=rv(s.current);i.current=a==="mounted"?u:"none"},[a]),Au(()=>{const u=s.current,d=r.current;if(d!==n){const p=i.current,m=rv(u);n?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&p!==m?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,c]),Au(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const g=rv(s.current).includes(CSS.escape(m.animationName));if(m.target===e&&g&&(c("ANIMATION_END"),!r.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},p=m=>{m.target===e&&(i.current=rv(s.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:A.useCallback(u=>{s.current=u?getComputedStyle(u):null,t(u)},[])}}function rv(n){return(n==null?void 0:n.animationName)||"none"}function H5(n){var s,r;let e=(s=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var G5=uj[" useInsertionEffect ".trim().toString()]||Au;function T1({prop:n,defaultProp:e,onChange:t=()=>{},caller:s}){const[r,i,o]=q5({defaultProp:e,onChange:t}),a=n!==void 0,c=a?n:r;{const d=A.useRef(n!==void 0);A.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,s])}const u=A.useCallback(d=>{var h;if(a){const p=W5(d)?d(n):d;p!==n&&((h=o.current)==null||h.call(o,p))}else i(d)},[a,n,i,o]);return[c,u]}function q5({defaultProp:n,onChange:e}){const[t,s]=A.useState(n),r=A.useRef(t),i=A.useRef(e);return G5(()=>{i.current=e},[e]),A.useEffect(()=>{var o;r.current!==t&&((o=i.current)==null||o.call(i,t),r.current=t)},[t,r]),[t,s,i]}function W5(n){return typeof n=="function"}var K5=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),X5="VisuallyHidden",fk=A.forwardRef((n,e)=>f.jsx(Wn.span,{...n,ref:e,style:{...K5,...n.style}}));fk.displayName=X5;var pk="ToastProvider",[mk,Y5,Q5]=pL("Toast"),[wL,hK]=k1("Toast",[Q5]),[J5,P1]=wL(pk),SL=n=>{const{__scopeToast:e,label:t="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:i=50,children:o}=n,[a,c]=A.useState(null),[u,d]=A.useState(0),h=A.useRef(!1),p=A.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${pk}\`. Expected non-empty \`string\`.`),f.jsx(mk.Provider,{scope:e,children:f.jsx(J5,{scope:e,label:t,duration:s,swipeDirection:r,swipeThreshold:i,toastCount:u,viewport:a,onViewportChange:c,onToastAdd:A.useCallback(()=>d(m=>m+1),[]),onToastRemove:A.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p,children:o})})};SL.displayName=pk;var _L="ToastViewport",Z5=["F8"],fA="toast.viewportPause",pA="toast.viewportResume",AL=A.forwardRef((n,e)=>{const{__scopeToast:t,hotkey:s=Z5,label:r="Notifications ({hotkey})",...i}=n,o=P1(_L,t),a=Y5(t),c=A.useRef(null),u=A.useRef(null),d=A.useRef(null),h=A.useRef(null),p=Ro(e,h,o.onViewportChange),m=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=o.toastCount>0;A.useEffect(()=>{const w=v=>{var S;s.length!==0&&s.every(E=>v[E]||v.code===E)&&((S=h.current)==null||S.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[s]),A.useEffect(()=>{const w=c.current,v=h.current;if(y&&w&&v){const b=()=>{if(!o.isClosePausedRef.current){const T=new CustomEvent(fA);v.dispatchEvent(T),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const T=new CustomEvent(pA);v.dispatchEvent(T),o.isClosePausedRef.current=!1}},E=T=>{!w.contains(T.relatedTarget)&&S()},k=()=>{w.contains(document.activeElement)||S()};return w.addEventListener("focusin",b),w.addEventListener("focusout",E),w.addEventListener("pointermove",b),w.addEventListener("pointerleave",k),window.addEventListener("blur",b),window.addEventListener("focus",S),()=>{w.removeEventListener("focusin",b),w.removeEventListener("focusout",E),w.removeEventListener("pointermove",b),w.removeEventListener("pointerleave",k),window.removeEventListener("blur",b),window.removeEventListener("focus",S)}}},[y,o.isClosePausedRef]);const g=A.useCallback(({tabbingDirection:w})=>{const b=a().map(S=>{const E=S.ref.current,k=[E,...h$(E)];return w==="forwards"?k:k.reverse()});return(w==="forwards"?b.reverse():b).flat()},[a]);return A.useEffect(()=>{const w=h.current;if(w){const v=b=>{var k,T,P;const S=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!S){const N=document.activeElement,M=b.shiftKey;if(b.target===w&&M){(k=u.current)==null||k.focus();return}const D=g({tabbingDirection:M?"backwards":"forwards"}),V=D.findIndex(I=>I===N);jS(D.slice(V+1))?b.preventDefault():M?(T=u.current)==null||T.focus():(P=d.current)==null||P.focus()}};return w.addEventListener("keydown",v),()=>w.removeEventListener("keydown",v)}},[a,g]),f.jsxs($5,{ref:c,role:"region","aria-label":r.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&f.jsx(mA,{ref:u,onFocusFromOutsideViewport:()=>{const w=g({tabbingDirection:"forwards"});jS(w)}}),f.jsx(mk.Slot,{scope:t,children:f.jsx(Wn.ol,{tabIndex:-1,...i,ref:p})}),y&&f.jsx(mA,{ref:d,onFocusFromOutsideViewport:()=>{const w=g({tabbingDirection:"backwards"});jS(w)}})]})});AL.displayName=_L;var EL="ToastFocusProxy",mA=A.forwardRef((n,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:s,...r}=n,i=P1(EL,t);return f.jsx(fk,{tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const a=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(a))&&s()}})});mA.displayName=EL;var Sy="Toast",e$="toast.swipeStart",t$="toast.swipeMove",n$="toast.swipeCancel",s$="toast.swipeEnd",CL=A.forwardRef((n,e)=>{const{forceMount:t,open:s,defaultOpen:r,onOpenChange:i,...o}=n,[a,c]=T1({prop:s,defaultProp:r??!0,onChange:i,caller:Sy});return f.jsx(hk,{present:t||a,children:f.jsx(o$,{open:a,...o,ref:e,onClose:()=>c(!1),onPause:_u(n.onPause),onResume:_u(n.onResume),onSwipeStart:Un(n.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Un(n.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Un(n.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Un(n.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});CL.displayName=Sy;var[r$,i$]=wL(Sy,{onClose(){}}),o$=A.forwardRef((n,e)=>{const{__scopeToast:t,type:s="foreground",duration:r,open:i,onClose:o,onEscapeKeyDown:a,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:m,...y}=n,g=P1(Sy,t),[w,v]=A.useState(null),b=Ro(e,I=>v(I)),S=A.useRef(null),E=A.useRef(null),k=r||g.duration,T=A.useRef(0),P=A.useRef(k),N=A.useRef(0),{onToastAdd:M,onToastRemove:L}=g,O=_u(()=>{var R;(w==null?void 0:w.contains(document.activeElement))&&((R=g.viewport)==null||R.focus()),o()}),D=A.useCallback(I=>{!I||I===1/0||(window.clearTimeout(N.current),T.current=new Date().getTime(),N.current=window.setTimeout(O,I))},[O]);A.useEffect(()=>{const I=g.viewport;if(I){const R=()=>{D(P.current),u==null||u()},j=()=>{const F=new Date().getTime()-T.current;P.current=P.current-F,window.clearTimeout(N.current),c==null||c()};return I.addEventListener(fA,j),I.addEventListener(pA,R),()=>{I.removeEventListener(fA,j),I.removeEventListener(pA,R)}}},[g.viewport,k,c,u,D]),A.useEffect(()=>{i&&!g.isClosePausedRef.current&&D(k)},[i,k,g.isClosePausedRef,D]),A.useEffect(()=>(M(),()=>L()),[M,L]);const V=A.useMemo(()=>w?ML(w):null,[w]);return g.viewport?f.jsxs(f.Fragment,{children:[V&&f.jsx(a$,{__scopeToast:t,role:"status","aria-live":s==="foreground"?"assertive":"polite",children:V}),f.jsx(r$,{scope:t,onClose:O,children:wy.createPortal(f.jsx(mk.ItemSlot,{scope:t,children:f.jsx(B5,{asChild:!0,onEscapeKeyDown:Un(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(Wn.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...y,ref:b,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:Un(n.onKeyDown,I=>{I.key==="Escape"&&(a==null||a(I.nativeEvent),I.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:Un(n.onPointerDown,I=>{I.button===0&&(S.current={x:I.clientX,y:I.clientY})}),onPointerMove:Un(n.onPointerMove,I=>{if(!S.current)return;const R=I.clientX-S.current.x,j=I.clientY-S.current.y,F=!!E.current,$=["left","right"].includes(g.swipeDirection),z=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,B=$?z(0,R):0,H=$?0:z(0,j),U=I.pointerType==="touch"?10:2,Y={x:B,y:H},Q={originalEvent:I,delta:Y};F?(E.current=Y,iv(t$,h,Q,{discrete:!1})):S2(Y,g.swipeDirection,U)?(E.current=Y,iv(e$,d,Q,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(R)>U||Math.abs(j)>U)&&(S.current=null)}),onPointerUp:Un(n.onPointerUp,I=>{const R=E.current,j=I.target;if(j.hasPointerCapture(I.pointerId)&&j.releasePointerCapture(I.pointerId),E.current=null,S.current=null,R){const F=I.currentTarget,$={originalEvent:I,delta:R};S2(R,g.swipeDirection,g.swipeThreshold)?iv(s$,m,$,{discrete:!0}):iv(n$,p,$,{discrete:!0}),F.addEventListener("click",z=>z.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),a$=n=>{const{__scopeToast:e,children:t,...s}=n,r=P1(Sy,e),[i,o]=A.useState(!1),[a,c]=A.useState(!1);return u$(()=>o(!0)),A.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:f.jsx(xL,{asChild:!0,children:f.jsx(fk,{...s,children:i&&f.jsxs(f.Fragment,{children:[r.label," ",t]})})})},l$="ToastTitle",kL=A.forwardRef((n,e)=>{const{__scopeToast:t,...s}=n;return f.jsx(Wn.div,{...s,ref:e})});kL.displayName=l$;var c$="ToastDescription",TL=A.forwardRef((n,e)=>{const{__scopeToast:t,...s}=n;return f.jsx(Wn.div,{...s,ref:e})});TL.displayName=c$;var PL="ToastAction",NL=A.forwardRef((n,e)=>{const{altText:t,...s}=n;return t.trim()?f.jsx(jL,{altText:t,asChild:!0,children:f.jsx(gk,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${PL}\`. Expected non-empty \`string\`.`),null)});NL.displayName=PL;var RL="ToastClose",gk=A.forwardRef((n,e)=>{const{__scopeToast:t,...s}=n,r=i$(RL,t);return f.jsx(jL,{asChild:!0,children:f.jsx(Wn.button,{type:"button",...s,ref:e,onClick:Un(n.onClick,r.onClose)})})});gk.displayName=RL;var jL=A.forwardRef((n,e)=>{const{__scopeToast:t,altText:s,...r}=n;return f.jsx(Wn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...r,ref:e})});function ML(n){const e=[];return Array.from(n.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),d$(s)){const r=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!r)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...ML(s))}}),e}function iv(n,e,t,{discrete:s}){const r=t.originalEvent.currentTarget,i=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:t});e&&r.addEventListener(n,e,{once:!0}),s?mL(r,i):r.dispatchEvent(i)}var S2=(n,e,t=0)=>{const s=Math.abs(n.x),r=Math.abs(n.y),i=s>r;return e==="left"||e==="right"?i&&s>t:!i&&r>t};function u$(n=()=>{}){const e=_u(n);Au(()=>{let t=0,s=0;return t=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(s)}},[e])}function d$(n){return n.nodeType===n.ELEMENT_NODE}function h$(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function jS(n){const e=document.activeElement;return n.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var f$=SL,LL=AL,IL=CL,DL=kL,OL=TL,FL=NL,BL=gk;function $L(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=$L(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function zf(){for(var n,e,t=0,s="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=$L(n))&&(s&&(s+=" "),s+=e);return s}const _2=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,A2=zf,zL=(n,e)=>t=>{var s;if((e==null?void 0:e.variants)==null)return A2(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(u=>{const d=t==null?void 0:t[u],h=i==null?void 0:i[u];if(d===null)return null;const p=_2(d)||_2(h);return r[u][p]}),a=t&&Object.entries(t).reduce((u,d)=>{let[h,p]=d;return p===void 0||(u[h]=p),u},{}),c=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:p,...m}=d;return Object.entries(m).every(y=>{let[g,w]=y;return Array.isArray(w)?w.includes({...i,...a}[g]):{...i,...a}[g]===w})?[...u,h,p]:u},[]);return A2(n,o,c,t==null?void 0:t.class,t==null?void 0:t.className)};var p$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const m$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_e=(n,e)=>{const t=A.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...c},u)=>A.createElement("svg",{ref:u,...p$,width:r,height:r,stroke:s,strokeWidth:o?Number(i)*24/Number(r):i,className:`lucide lucide-${m$(n)}`,...c},[...e.map(([d,h])=>A.createElement(d,h)),...(Array.isArray(a)?a:[a])||[]]));return t.displayName=`${n}`,t},g$=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),y$=_e("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),v$=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),yk=_e("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),b$=_e("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),vk=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),x$=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),w$=_e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),S$=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),VL=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),UL=_e("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),_$=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),HL=_e("Drama",[["path",{d:"M 10 11h.01",key:"1lksi6"}],["path",{d:"M 14 6h.01",key:"1kxpxo"}],["path",{d:"M 18 6h.01",key:"1goweo"}],["path",{d:"M 6.5 13.1h.01",key:"1i19cj"}],["path",{d:"M22 5c0 9-4 12-6 12s-6-3-6-12c0-2 2-3 6-3s6 1 6 3",key:"172yzv"}],["path",{d:"M17.4 9.9c-.8.8-2 .8-2.8 0",key:"1obv0w"}],["path",{d:"M10.1 7.1C9 7.2 7.7 7.7 6 8.6c-3.5 2-4.7 3.9-3.7 5.6 4.5 7.8 9.5 8.4 11.2 7.4.9-.5 1.9-2.1 1.9-4.7",key:"rqjl8i"}],["path",{d:"M9.1 16.5c.3-1.1 1.4-1.7 2.4-1.4",key:"1mr6wy"}]]),A$=_e("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),GL=_e("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),N1=_e("Feather",[["path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z",key:"u4sw5n"}],["line",{x1:"16",x2:"2",y1:"8",y2:"22",key:"1c47m2"}],["line",{x1:"17.5",x2:"9",y1:"15",y2:"15",key:"2fj3pr"}]]),bk=_e("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),E$=_e("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),qL=_e("HeartHandshake",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08v0c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66",key:"12sd6o"}],["path",{d:"m18 15-2-2",key:"60u0ii"}],["path",{d:"m15 18-2-2",key:"6p76be"}]]),WL=_e("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),xk=_e("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),C$=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),k$=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),KL=_e("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),XL=_e("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),T$=_e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),P$=_e("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]),N$=_e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),R$=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),j$=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),M$=_e("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),wk=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),L$=_e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),I$=_e("Theater",[["path",{d:"M2 10s3-3 3-8",key:"3xiif0"}],["path",{d:"M22 10s-3-3-3-8",key:"ioaa5q"}],["path",{d:"M10 2c0 4.4-3.6 8-8 8",key:"16fkpi"}],["path",{d:"M14 2c0 4.4 3.6 8 8 8",key:"b9eulq"}],["path",{d:"M2 10s2 2 2 5",key:"1au1lb"}],["path",{d:"M22 10s-2 2-2 5",key:"qi2y5e"}],["path",{d:"M8 15h8",key:"45n4r"}],["path",{d:"M2 22v-1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1",key:"1vsc2m"}],["path",{d:"M14 22v-1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1",key:"hrha4u"}]]),Sk=_e("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]),YL=_e("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),_k=_e("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),R1=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function D$(){for(var n=0,e,t,s="";n<arguments.length;)(e=arguments[n++])&&(t=QL(e))&&(s&&(s+=" "),s+=t);return s}function QL(n){if(typeof n=="string")return n;for(var e,t="",s=0;s<n.length;s++)n[s]&&(e=QL(n[s]))&&(t&&(t+=" "),t+=e);return t}var Ak="-";function O$(n){var e=B$(n),t=n.conflictingClassGroups,s=n.conflictingClassGroupModifiers,r=s===void 0?{}:s;function i(a){var c=a.split(Ak);return c[0]===""&&c.length!==1&&c.shift(),JL(c,e)||F$(a)}function o(a,c){var u=t[a]||[];return c&&r[a]?[].concat(u,r[a]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function JL(n,e){var o;if(n.length===0)return e.classGroupId;var t=n[0],s=e.nextPart.get(t),r=s?JL(n.slice(1),s):void 0;if(r)return r;if(e.validators.length!==0){var i=n.join(Ak);return(o=e.validators.find(function(a){var c=a.validator;return c(i)}))==null?void 0:o.classGroupId}}var E2=/^\[(.+)\]$/;function F$(n){if(E2.test(n)){var e=E2.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}}function B$(n){var e=n.theme,t=n.prefix,s={nextPart:new Map,validators:[]},r=z$(Object.entries(n.classGroups),t);return r.forEach(function(i){var o=i[0],a=i[1];gA(a,s,o,e)}),s}function gA(n,e,t,s){n.forEach(function(r){if(typeof r=="string"){var i=r===""?e:C2(e,r);i.classGroupId=t;return}if(typeof r=="function"){if($$(r)){gA(r(s),e,t,s);return}e.validators.push({validator:r,classGroupId:t});return}Object.entries(r).forEach(function(o){var a=o[0],c=o[1];gA(c,C2(e,a),t,s)})})}function C2(n,e){var t=n;return e.split(Ak).forEach(function(s){t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t}function $$(n){return n.isThemeGetter}function z$(n,e){return e?n.map(function(t){var s=t[0],r=t[1],i=r.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(a){var c=a[0],u=a[1];return[e+c,u]})):o});return[s,i]}):n}function V$(n){if(n<1)return{get:function(){},set:function(){}};var e=0,t=new Map,s=new Map;function r(i,o){t.set(i,o),e++,e>n&&(e=0,s=t,t=new Map)}return{get:function(o){var a=t.get(o);if(a!==void 0)return a;if((a=s.get(o))!==void 0)return r(o,a),a},set:function(o,a){t.has(o)?t.set(o,a):r(o,a)}}}var ZL="!";function U$(n){var e=n.separator||":",t=e.length===1,s=e[0],r=e.length;return function(o){for(var a=[],c=0,u=0,d,h=0;h<o.length;h++){var p=o[h];if(c===0){if(p===s&&(t||o.slice(h,h+r)===e)){a.push(o.slice(u,h)),u=h+r;continue}if(p==="/"){d=h;continue}}p==="["?c++:p==="]"&&c--}var m=a.length===0?o:o.substring(u),y=m.startsWith(ZL),g=y?m.substring(1):m,w=d&&d>u?d-u:void 0;return{modifiers:a,hasImportantModifier:y,baseClassName:g,maybePostfixModifierPosition:w}}}function H$(n){if(n.length<=1)return n;var e=[],t=[];return n.forEach(function(s){var r=s[0]==="[";r?(e.push.apply(e,t.sort().concat([s])),t=[]):t.push(s)}),e.push.apply(e,t.sort()),e}function G$(n){return{cache:V$(n.cacheSize),splitModifiers:U$(n),...O$(n)}}var q$=/\s+/;function W$(n,e){var t=e.splitModifiers,s=e.getClassGroupId,r=e.getConflictingClassGroupIds,i=new Set;return n.trim().split(q$).map(function(o){var a=t(o),c=a.modifiers,u=a.hasImportantModifier,d=a.baseClassName,h=a.maybePostfixModifierPosition,p=s(h?d.substring(0,h):d),m=!!h;if(!p){if(!h)return{isTailwindClass:!1,originalClassName:o};if(p=s(d),!p)return{isTailwindClass:!1,originalClassName:o};m=!1}var y=H$(c).join(":"),g=u?y+ZL:y;return{isTailwindClass:!0,modifierId:g,classGroupId:p,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var a=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=a+c;return i.has(d)?!1:(i.add(d),r(c,u).forEach(function(h){return i.add(a+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function K$(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var s,r,i,o=a;function a(u){var d=e[0],h=e.slice(1),p=h.reduce(function(m,y){return y(m)},d());return s=G$(p),r=s.cache.get,i=s.cache.set,o=c,c(u)}function c(u){var d=r(u);if(d)return d;var h=W$(u,s);return i(u,h),h}return function(){return o(D$.apply(null,arguments))}}function ot(n){var e=function(s){return s[n]||[]};return e.isThemeGetter=!0,e}var eI=/^\[(?:([a-z-]+):)?(.+)\]$/i,X$=/^\d+\/\d+$/,Y$=new Set(["px","full","screen"]),Q$=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,J$=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Z$=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function gr(n){return $l(n)||Y$.has(n)||X$.test(n)||yA(n)}function yA(n){return Pu(n,"length",iz)}function ez(n){return Pu(n,"size",tI)}function tz(n){return Pu(n,"position",tI)}function nz(n){return Pu(n,"url",oz)}function ov(n){return Pu(n,"number",$l)}function $l(n){return!Number.isNaN(Number(n))}function sz(n){return n.endsWith("%")&&$l(n.slice(0,-1))}function sp(n){return k2(n)||Pu(n,"number",k2)}function ke(n){return eI.test(n)}function rp(){return!0}function $o(n){return Q$.test(n)}function rz(n){return Pu(n,"",az)}function Pu(n,e,t){var s=eI.exec(n);return s?s[1]?s[1]===e:t(s[2]):!1}function iz(n){return J$.test(n)}function tI(){return!1}function oz(n){return n.startsWith("url(")}function k2(n){return Number.isInteger(Number(n))}function az(n){return Z$.test(n)}function lz(){var n=ot("colors"),e=ot("spacing"),t=ot("blur"),s=ot("brightness"),r=ot("borderColor"),i=ot("borderRadius"),o=ot("borderSpacing"),a=ot("borderWidth"),c=ot("contrast"),u=ot("grayscale"),d=ot("hueRotate"),h=ot("invert"),p=ot("gap"),m=ot("gradientColorStops"),y=ot("gradientColorStopPositions"),g=ot("inset"),w=ot("margin"),v=ot("opacity"),b=ot("padding"),S=ot("saturate"),E=ot("scale"),k=ot("sepia"),T=ot("skew"),P=ot("space"),N=ot("translate"),M=function(){return["auto","contain","none"]},L=function(){return["auto","hidden","clip","visible","scroll"]},O=function(){return["auto",ke,e]},D=function(){return[ke,e]},V=function(){return["",gr]},I=function(){return["auto",$l,ke]},R=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},j=function(){return["solid","dashed","dotted","double","none"]},F=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},z=function(){return["","0",ke]},B=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},H=function(){return[$l,ov]},U=function(){return[$l,ke]};return{cacheSize:500,theme:{colors:[rp],spacing:[gr],blur:["none","",$o,ke],brightness:H(),borderColor:[n],borderRadius:["none","","full",$o,ke],borderSpacing:D(),borderWidth:V(),contrast:H(),grayscale:z(),hueRotate:U(),invert:z(),gap:D(),gradientColorStops:[n],gradientColorStopPositions:[sz,yA],inset:O(),margin:O(),opacity:H(),padding:D(),saturate:H(),scale:H(),sepia:z(),skew:U(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",ke]}],container:["container"],columns:[{columns:[$o]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(R(),[ke])}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sp]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ke]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",sp]}],"grid-cols":[{"grid-cols":[rp]}],"col-start-end":[{col:["auto",{span:["full",sp]},ke]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[rp]}],"row-start-end":[{row:["auto",{span:[sp]},ke]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ke]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ke]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",ke,e]}],"min-w":[{"min-w":["min","max","fit",ke,gr]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[$o]},$o,ke]}],h:[{h:[ke,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ke,gr]}],"max-h":[{"max-h":[ke,e,"min","max","fit"]}],"font-size":[{text:["base",$o,yA]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ov]}],"font-family":[{font:[rp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ke]}],"line-clamp":[{"line-clamp":["none",$l,ov]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ke,gr]}],"list-image":[{"list-image":["none",ke]}],"list-style-type":[{list:["none","disc","decimal",ke]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(j(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",gr]}],"underline-offset":[{"underline-offset":["auto",ke,gr]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(R(),[tz])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ez]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},nz]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(j(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:j()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:[""].concat(j())}],"outline-offset":[{"outline-offset":[ke,gr]}],"outline-w":[{outline:[gr]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[gr]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",$o,rz]}],"shadow-color":[{shadow:[rp]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":F()}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[s]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",$o,ke]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ke]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",ke]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",ke]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[sp,ke]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ke]}],accent:[{accent:["auto",n]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ke]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ke]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[gr,ov]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var cz=K$(lz);function zr(...n){return cz(zf(n))}const uz=f$,nI=Re.forwardRef(({className:n,...e},t)=>f.jsx(LL,{ref:t,className:zr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...e}));nI.displayName=LL.displayName;const dz=zL("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),sI=Re.forwardRef(({className:n,variant:e,...t},s)=>f.jsx(IL,{ref:s,className:zr(dz({variant:e}),n),...t}));sI.displayName=IL.displayName;const hz=Re.forwardRef(({className:n,...e},t)=>f.jsx(FL,{ref:t,className:zr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...e}));hz.displayName=FL.displayName;const rI=Re.forwardRef(({className:n,...e},t)=>f.jsx(BL,{ref:t,className:zr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...e,children:f.jsx(R1,{className:"h-4 w-4"})}));rI.displayName=BL.displayName;const iI=Re.forwardRef(({className:n,...e},t)=>f.jsx(DL,{ref:t,className:zr("text-sm font-semibold",n),...e}));iI.displayName=DL.displayName;const oI=Re.forwardRef(({className:n,...e},t)=>f.jsx(OL,{ref:t,className:zr("text-sm opacity-90",n),...e}));oI.displayName=OL.displayName;const fz=1,pz=1e6,wo={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let MS=0;function mz(){return MS=(MS+1)%Number.MAX_SAFE_INTEGER,MS.toString()}const LS=new Map,T2=n=>{if(LS.has(n))return;const e=setTimeout(()=>{LS.delete(n),em({type:wo.REMOVE_TOAST,toastId:n})},pz);LS.set(n,e)},gz=(n,e)=>{switch(e.type){case wo.ADD_TOAST:return{...n,toasts:[e.toast,...n.toasts].slice(0,fz)};case wo.UPDATE_TOAST:return{...n,toasts:n.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case wo.DISMISS_TOAST:{const{toastId:t}=e;return t?T2(t):n.toasts.forEach(s=>{T2(s.id)}),{...n,toasts:n.toasts.map(s=>s.id===t||t===void 0?{...s,open:!1}:s)}}case wo.REMOVE_TOAST:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(t=>t.id!==e.toastId)}}},Vv=[];let Uv={toasts:[]};function em(n){Uv=gz(Uv,n),Vv.forEach(e=>{e(Uv)})}function Ae({...n}){const e=mz(),t=r=>em({type:wo.UPDATE_TOAST,toast:{...r,id:e}}),s=()=>em({type:wo.DISMISS_TOAST,toastId:e});return em({type:wo.ADD_TOAST,toast:{...n,id:e,open:!0,onOpenChange:r=>{r||s()}}}),{id:e,dismiss:s,update:t}}function Ek(){const[n,e]=Re.useState(Uv);return Re.useEffect(()=>(Vv.push(e),()=>{const t=Vv.indexOf(e);t>-1&&Vv.splice(t,1)}),[n]),{...n,toast:Ae,dismiss:t=>em({type:wo.DISMISS_TOAST,toastId:t})}}function yz(){const{toasts:n}=Ek();return f.jsxs(uz,{children:[n.map(({id:e,title:t,description:s,action:r,...i})=>f.jsxs(sI,{...i,children:[f.jsxs("div",{className:"grid gap-1",children:[t&&f.jsx(iI,{children:t}),s&&f.jsx(oI,{children:s})]}),r,f.jsx(rI,{})]},e)),f.jsx(nI,{})]})}const aI=A.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"}),j1=A.createContext({}),M1=A.createContext(null),L1=typeof document<"u",Ck=L1?A.useLayoutEffect:A.useEffect,lI=A.createContext({strict:!1}),kk=n=>n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),vz="framerAppearId",cI="data-"+kk(vz);function bz(n,e,t,s){const{visualElement:r}=A.useContext(j1),i=A.useContext(lI),o=A.useContext(M1),a=A.useContext(aI).reducedMotion,c=A.useRef();s=s||i.renderer,!c.current&&s&&(c.current=s(n,{visualState:e,parent:r,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const u=c.current;A.useInsertionEffect(()=>{u&&u.update(t,o)});const d=A.useRef(!!(t[cI]&&!window.HandoffComplete));return Ck(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function ad(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function xz(n,e,t){return A.useCallback(s=>{s&&n.mount&&n.mount(s),e&&(s?e.mount(s):e.unmount()),t&&(typeof t=="function"?t(s):ad(t)&&(t.current=s))},[e])}function km(n){return typeof n=="string"||Array.isArray(n)}function I1(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Tk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Pk=["initial",...Tk];function D1(n){return I1(n.animate)||Pk.some(e=>km(n[e]))}function uI(n){return!!(D1(n)||n.variants)}function wz(n,e){if(D1(n)){const{initial:t,animate:s}=n;return{initial:t===!1||km(t)?t:void 0,animate:km(s)?s:void 0}}return n.inherit!==!1?e:{}}function Sz(n){const{initial:e,animate:t}=wz(n,A.useContext(j1));return A.useMemo(()=>({initial:e,animate:t}),[P2(e),P2(t)])}function P2(n){return Array.isArray(n)?n.join(" "):n}const N2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Tm={};for(const n in N2)Tm[n]={isEnabled:e=>N2[n].some(t=>!!e[t])};function _z(n){for(const e in n)Tm[e]={...Tm[e],...n[e]}}const Nk=A.createContext({}),dI=A.createContext({}),Az=Symbol.for("motionComponentSymbol");function Ez({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:s,Component:r}){n&&_z(n);function i(a,c){let u;const d={...A.useContext(aI),...a,layoutId:Cz(a)},{isStatic:h}=d,p=Sz(a),m=s(a,h);if(!h&&L1){p.visualElement=bz(r,m,d,e);const y=A.useContext(dI),g=A.useContext(lI).strict;p.visualElement&&(u=p.visualElement.loadFeatures(d,g,n,y))}return A.createElement(j1.Provider,{value:p},u&&p.visualElement?A.createElement(u,{visualElement:p.visualElement,...d}):null,t(r,a,xz(m,p.visualElement,c),m,h,p.visualElement))}const o=A.forwardRef(i);return o[Az]=r,o}function Cz({layoutId:n}){const e=A.useContext(Nk).id;return e&&n!==void 0?e+"-"+n:n}function kz(n){function e(s,r={}){return Ez(n(s,r))}if(typeof Proxy>"u")return e;const t=new Map;return new Proxy(e,{get:(s,r)=>(t.has(r)||t.set(r,e(r)),t.get(r))})}const Tz=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Rk(n){return typeof n!="string"||n.includes("-")?!1:!!(Tz.indexOf(n)>-1||/[A-Z]/.test(n))}const Qb={};function Pz(n){Object.assign(Qb,n)}const _y=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nu=new Set(_y);function hI(n,{layout:e,layoutId:t}){return Nu.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Qb[n]||n==="opacity")}const ds=n=>!!(n&&n.getVelocity),Nz={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Rz=_y.length;function jz(n,{enableHardwareAcceleration:e=!0,allowTransformNone:t=!0},s,r){let i="";for(let o=0;o<Rz;o++){const a=_y[o];if(n[a]!==void 0){const c=Nz[a]||a;i+=`${c}(${n[a]}) `}}return e&&!n.z&&(i+="translateZ(0)"),i=i.trim(),r?i=r(n,s?"":i):t&&s&&(i="none"),i}const fI=n=>e=>typeof e=="string"&&e.startsWith(n),pI=fI("--"),vA=fI("var(--"),Mz=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Lz=(n,e)=>e&&typeof n=="number"?e.transform(n):n,cl=(n,e,t)=>Math.min(Math.max(t,n),e),Ru={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},tm={...Ru,transform:n=>cl(0,1,n)},av={...Ru,default:1},nm=n=>Math.round(n*1e5)/1e5,O1=/(-)?([\d]*\.?[\d])+/g,mI=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Iz=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ay(n){return typeof n=="string"}const Ey=n=>({test:e=>Ay(e)&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Vo=Ey("deg"),Ai=Ey("%"),de=Ey("px"),Dz=Ey("vh"),Oz=Ey("vw"),R2={...Ai,parse:n=>Ai.parse(n)/100,transform:n=>Ai.transform(n*100)},j2={...Ru,transform:Math.round},gI={borderWidth:de,borderTopWidth:de,borderRightWidth:de,borderBottomWidth:de,borderLeftWidth:de,borderRadius:de,radius:de,borderTopLeftRadius:de,borderTopRightRadius:de,borderBottomRightRadius:de,borderBottomLeftRadius:de,width:de,maxWidth:de,height:de,maxHeight:de,size:de,top:de,right:de,bottom:de,left:de,padding:de,paddingTop:de,paddingRight:de,paddingBottom:de,paddingLeft:de,margin:de,marginTop:de,marginRight:de,marginBottom:de,marginLeft:de,rotate:Vo,rotateX:Vo,rotateY:Vo,rotateZ:Vo,scale:av,scaleX:av,scaleY:av,scaleZ:av,skew:Vo,skewX:Vo,skewY:Vo,distance:de,translateX:de,translateY:de,translateZ:de,x:de,y:de,z:de,perspective:de,transformPerspective:de,opacity:tm,originX:R2,originY:R2,originZ:de,zIndex:j2,fillOpacity:tm,strokeOpacity:tm,numOctaves:j2};function jk(n,e,t,s){const{style:r,vars:i,transform:o,transformOrigin:a}=n;let c=!1,u=!1,d=!0;for(const h in e){const p=e[h];if(pI(h)){i[h]=p;continue}const m=gI[h],y=Lz(p,m);if(Nu.has(h)){if(c=!0,o[h]=y,!d)continue;p!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,a[h]=y):r[h]=y}if(e.transform||(c||s?r.transform=jz(n.transform,t,d,s):r.transform&&(r.transform="none")),u){const{originX:h="50%",originY:p="50%",originZ:m=0}=a;r.transformOrigin=`${h} ${p} ${m}`}}const Mk=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function yI(n,e,t){for(const s in e)!ds(e[s])&&!hI(s,t)&&(n[s]=e[s])}function Fz({transformTemplate:n},e,t){return A.useMemo(()=>{const s=Mk();return jk(s,e,{enableHardwareAcceleration:!t},n),Object.assign({},s.vars,s.style)},[e])}function Bz(n,e,t){const s=n.style||{},r={};return yI(r,s,n),Object.assign(r,Fz(n,e,t)),n.transformValues?n.transformValues(r):r}function $z(n,e,t){const s={},r=Bz(n,e,t);return n.drag&&n.dragListener!==!1&&(s.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(s.tabIndex=0),s.style=r,s}const zz=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Jb(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||zz.has(n)}let vI=n=>!Jb(n);function Vz(n){n&&(vI=e=>e.startsWith("on")?!Jb(e):n(e))}try{Vz(require("@emotion/is-prop-valid").default)}catch{}function Uz(n,e,t){const s={};for(const r in n)r==="values"&&typeof n.values=="object"||(vI(r)||t===!0&&Jb(r)||!e&&!Jb(r)||n.draggable&&r.startsWith("onDrag"))&&(s[r]=n[r]);return s}function M2(n,e,t){return typeof n=="string"?n:de.transform(e+t*n)}function Hz(n,e,t){const s=M2(e,n.x,n.width),r=M2(t,n.y,n.height);return`${s} ${r}`}const Gz={offset:"stroke-dashoffset",array:"stroke-dasharray"},qz={offset:"strokeDashoffset",array:"strokeDasharray"};function Wz(n,e,t=1,s=0,r=!0){n.pathLength=1;const i=r?Gz:qz;n[i.offset]=de.transform(-s);const o=de.transform(e),a=de.transform(t);n[i.array]=`${o} ${a}`}function Lk(n,{attrX:e,attrY:t,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:c=0,...u},d,h,p){if(jk(n,u,d,p),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:g}=n;m.transform&&(g&&(y.transform=m.transform),delete m.transform),g&&(r!==void 0||i!==void 0||y.transform)&&(y.transformOrigin=Hz(g,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),s!==void 0&&(m.scale=s),o!==void 0&&Wz(m,o,a,c,!1)}const bI=()=>({...Mk(),attrs:{}}),Ik=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Kz(n,e,t,s){const r=A.useMemo(()=>{const i=bI();return Lk(i,e,{enableHardwareAcceleration:!1},Ik(s),n.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(n.style){const i={};yI(i,n.style,n),r.style={...i,...r.style}}return r}function Xz(n=!1){return(t,s,r,{latestValues:i},o)=>{const c=(Rk(t)?Kz:$z)(s,i,o,t),d={...Uz(s,typeof t=="string",n),...c,ref:r},{children:h}=s,p=A.useMemo(()=>ds(h)?h.get():h,[h]);return A.createElement(t,{...d,children:p})}}function xI(n,{style:e,vars:t},s,r){Object.assign(n.style,e,r&&r.getProjectionStyles(s));for(const i in t)n.style.setProperty(i,t[i])}const wI=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SI(n,e,t,s){xI(n,e,void 0,s);for(const r in e.attrs)n.setAttribute(wI.has(r)?r:kk(r),e.attrs[r])}function Dk(n,e){const{style:t}=n,s={};for(const r in t)(ds(t[r])||e.style&&ds(e.style[r])||hI(r,n))&&(s[r]=t[r]);return s}function _I(n,e){const t=Dk(n,e);for(const s in n)if(ds(n[s])||ds(e[s])){const r=_y.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;t[r]=n[s]}return t}function Ok(n,e,t,s={},r={}){return typeof e=="function"&&(e=e(t!==void 0?t:n.custom,s,r)),typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"&&(e=e(t!==void 0?t:n.custom,s,r)),e}function AI(n){const e=A.useRef(null);return e.current===null&&(e.current=n()),e.current}const Zb=n=>Array.isArray(n),Yz=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Qz=n=>Zb(n)?n[n.length-1]||0:n;function Hv(n){const e=ds(n)?n.get():n;return Yz(e)?e.toValue():e}function Jz({scrapeMotionValuesFromProps:n,createRenderState:e,onMount:t},s,r,i){const o={latestValues:Zz(s,r,i,n),renderState:e()};return t&&(o.mount=a=>t(s,a,o)),o}const EI=n=>(e,t)=>{const s=A.useContext(j1),r=A.useContext(M1),i=()=>Jz(n,e,s,r);return t?i():AI(i)};function Zz(n,e,t,s){const r={},i=s(n,{});for(const p in i)r[p]=Hv(i[p]);let{initial:o,animate:a}=n;const c=D1(n),u=uI(n);e&&u&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const h=d?a:o;return h&&typeof h!="boolean"&&!I1(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const y=Ok(n,m);if(!y)return;const{transitionEnd:g,transition:w,...v}=y;for(const b in v){let S=v[b];if(Array.isArray(S)){const E=d?S.length-1:0;S=S[E]}S!==null&&(r[b]=S)}for(const b in g)r[b]=g[b]}),r}const Tt=n=>n;class L2{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);t!==-1&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function eV(n){let e=new L2,t=new L2,s=0,r=!1,i=!1;const o=new WeakSet,a={schedule:(c,u=!1,d=!1)=>{const h=d&&r,p=h?e:t;return u&&o.add(c),p.add(c)&&h&&r&&(s=e.order.length),c},cancel:c=>{t.remove(c),o.delete(c)},process:c=>{if(r){i=!0;return}if(r=!0,[e,t]=[t,e],t.clear(),s=e.order.length,s)for(let u=0;u<s;u++){const d=e.order[u];d(c),o.has(d)&&(a.schedule(d),n())}r=!1,i&&(i=!1,a.process(c))}};return a}const lv=["prepare","read","update","preRender","render","postRender"],tV=40;function nV(n,e){let t=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=lv.reduce((h,p)=>(h[p]=eV(()=>t=!0),h),{}),o=h=>i[h].process(r),a=()=>{const h=performance.now();t=!1,r.delta=s?1e3/60:Math.max(Math.min(h-r.timestamp,tV),1),r.timestamp=h,r.isProcessing=!0,lv.forEach(o),r.isProcessing=!1,t&&e&&(s=!1,n(a))},c=()=>{t=!0,s=!0,r.isProcessing||n(a)};return{schedule:lv.reduce((h,p)=>{const m=i[p];return h[p]=(y,g=!1,w=!1)=>(t||c(),m.schedule(y,g,w)),h},{}),cancel:h=>lv.forEach(p=>i[p].cancel(h)),state:r,steps:i}}const{schedule:it,cancel:jo,state:kn,steps:IS}=nV(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tt,!0),sV={useVisualState:EI({scrapeMotionValuesFromProps:_I,createRenderState:bI,onMount:(n,e,{renderState:t,latestValues:s})=>{it.read(()=>{try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}),it.render(()=>{Lk(t,s,{enableHardwareAcceleration:!1},Ik(e.tagName),n.transformTemplate),SI(e,t)})}})},rV={useVisualState:EI({scrapeMotionValuesFromProps:Dk,createRenderState:Mk})};function iV(n,{forwardMotionProps:e=!1},t,s){return{...Rk(n)?sV:rV,preloadedFeatures:t,useRender:Xz(e),createVisualElement:s,Component:n}}function So(n,e,t,s={passive:!0}){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t)}const CI=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1;function F1(n,e="page"){return{point:{x:n[e+"X"],y:n[e+"Y"]}}}const oV=n=>e=>CI(e)&&n(e,F1(e));function Ao(n,e,t,s){return So(n,e,oV(t),s)}const aV=(n,e)=>t=>e(n(t)),il=(...n)=>n.reduce(aV);function kI(n){let e=null;return()=>{const t=()=>{e=null};return e===null?(e=n,t):!1}}const I2=kI("dragHorizontal"),D2=kI("dragVertical");function TI(n){let e=!1;if(n==="y")e=D2();else if(n==="x")e=I2();else{const t=I2(),s=D2();t&&s?e=()=>{t(),s()}:(t&&t(),s&&s())}return e}function PI(){const n=TI(!0);return n?(n(),!1):!0}class gl{constructor(e){this.isMounted=!1,this.node=e}update(){}}function O2(n,e){const t="pointer"+(e?"enter":"leave"),s="onHover"+(e?"Start":"End"),r=(i,o)=>{if(i.pointerType==="touch"||PI())return;const a=n.getProps();n.animationState&&a.whileHover&&n.animationState.setActive("whileHover",e),a[s]&&it.update(()=>a[s](i,o))};return Ao(n.current,t,r,{passive:!n.getProps()[s]})}class lV extends gl{mount(){this.unmount=il(O2(this.node,!0),O2(this.node,!1))}unmount(){}}class cV extends gl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=il(So(this.node.current,"focus",()=>this.onFocus()),So(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const NI=(n,e)=>e?n===e?!0:NI(n,e.parentElement):!1;function DS(n,e){if(!e)return;const t=new PointerEvent("pointer"+n);e(t,F1(t))}class uV extends gl{constructor(){super(...arguments),this.removeStartListeners=Tt,this.removeEndListeners=Tt,this.removeAccessibleListeners=Tt,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=Ao(window,"pointerup",(a,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();it.update(()=>{!h&&!NI(this.node.current,a.target)?d&&d(a,c):u&&u(a,c)})},{passive:!(s.onTap||s.onPointerUp)}),o=Ao(window,"pointercancel",(a,c)=>this.cancelPress(a,c),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=il(i,o),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||DS("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&it.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=So(this.node.current,"keyup",o),DS("down",(a,c)=>{this.startPress(a,c)})},t=So(this.node.current,"keydown",e),s=()=>{this.isPressing&&DS("cancel",(i,o)=>this.cancelPress(i,o))},r=So(this.node.current,"blur",s);this.removeAccessibleListeners=il(t,r)}}startPress(e,t){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&it.update(()=>s(e,t))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!PI()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&it.update(()=>s(e,t))}mount(){const e=this.node.getProps(),t=Ao(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),s=So(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=il(t,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const bA=new WeakMap,OS=new WeakMap,dV=n=>{const e=bA.get(n.target);e&&e(n)},hV=n=>{n.forEach(dV)};function fV({root:n,...e}){const t=n||document;OS.has(t)||OS.set(t,{});const s=OS.get(t),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(hV,{root:n,...e})),s[r]}function pV(n,e,t){const s=fV(e);return bA.set(n,t),s.observe(n),()=>{bA.delete(n),s.unobserve(n)}}const mV={some:0,all:1};class gV extends gl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:s,amount:r="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:mV[r]},a=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),p=u?d:h;p&&p(c)};return pV(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(yV(e,t))&&this.startObserver()}unmount(){}}function yV({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const vV={inView:{Feature:gV},tap:{Feature:uV},focus:{Feature:cV},hover:{Feature:lV}};function RI(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let s=0;s<t;s++)if(e[s]!==n[s])return!1;return!0}function bV(n){const e={};return n.values.forEach((t,s)=>e[s]=t.get()),e}function xV(n){const e={};return n.values.forEach((t,s)=>e[s]=t.getVelocity()),e}function B1(n,e,t){const s=n.getProps();return Ok(s,e,t!==void 0?t:s.custom,bV(n),xV(n))}let wV=Tt,Fk=Tt;const ol=n=>n*1e3,Eo=n=>n/1e3,SV={current:!1},jI=n=>Array.isArray(n)&&typeof n[0]=="number";function MI(n){return!!(!n||typeof n=="string"&&LI[n]||jI(n)||Array.isArray(n)&&n.every(MI))}const wp=([n,e,t,s])=>`cubic-bezier(${n}, ${e}, ${t}, ${s})`,LI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:wp([0,.65,.55,1]),circOut:wp([.55,0,1,.45]),backIn:wp([.31,.01,.66,-.59]),backOut:wp([.33,1.53,.69,.99])};function II(n){if(n)return jI(n)?wp(n):Array.isArray(n)?n.map(II):LI[n]}function _V(n,e,t,{delay:s=0,duration:r,repeat:i=0,repeatType:o="loop",ease:a,times:c}={}){const u={[e]:t};c&&(u.offset=c);const d=II(a);return Array.isArray(d)&&(u.easing=d),n.animate(u,{delay:s,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function AV(n,{repeat:e,repeatType:t="loop"}){const s=e&&t!=="loop"&&e%2===1?0:n.length-1;return n[s]}const DI=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,EV=1e-7,CV=12;function kV(n,e,t,s,r){let i,o,a=0;do o=e+(t-e)/2,i=DI(o,s,r)-n,i>0?t=o:e=o;while(Math.abs(i)>EV&&++a<CV);return o}function Cy(n,e,t,s){if(n===e&&t===s)return Tt;const r=i=>kV(i,0,1,n,t);return i=>i===0||i===1?i:DI(r(i),e,s)}const TV=Cy(.42,0,1,1),PV=Cy(0,0,.58,1),OI=Cy(.42,0,.58,1),NV=n=>Array.isArray(n)&&typeof n[0]!="number",FI=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,BI=n=>e=>1-n(1-e),Bk=n=>1-Math.sin(Math.acos(n)),$I=BI(Bk),RV=FI(Bk),zI=Cy(.33,1.53,.69,.99),$k=BI(zI),jV=FI($k),MV=n=>(n*=2)<1?.5*$k(n):.5*(2-Math.pow(2,-10*(n-1))),LV={linear:Tt,easeIn:TV,easeInOut:OI,easeOut:PV,circIn:Bk,circInOut:RV,circOut:$I,backIn:$k,backInOut:jV,backOut:zI,anticipate:MV},F2=n=>{if(Array.isArray(n)){Fk(n.length===4);const[e,t,s,r]=n;return Cy(e,t,s,r)}else if(typeof n=="string")return LV[n];return n},zk=(n,e)=>t=>!!(Ay(t)&&Iz.test(t)&&t.startsWith(n)||e&&Object.prototype.hasOwnProperty.call(t,e)),VI=(n,e,t)=>s=>{if(!Ay(s))return s;const[r,i,o,a]=s.match(O1);return{[n]:parseFloat(r),[e]:parseFloat(i),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},IV=n=>cl(0,255,n),FS={...Ru,transform:n=>Math.round(IV(n))},zl={test:zk("rgb","red"),parse:VI("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:s=1})=>"rgba("+FS.transform(n)+", "+FS.transform(e)+", "+FS.transform(t)+", "+nm(tm.transform(s))+")"};function DV(n){let e="",t="",s="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),s=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),s=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const xA={test:zk("#"),parse:DV,transform:zl.transform},ld={test:zk("hsl","hue"),parse:VI("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:s=1})=>"hsla("+Math.round(n)+", "+Ai.transform(nm(e))+", "+Ai.transform(nm(t))+", "+nm(tm.transform(s))+")"},$n={test:n=>zl.test(n)||xA.test(n)||ld.test(n),parse:n=>zl.test(n)?zl.parse(n):ld.test(n)?ld.parse(n):xA.parse(n),transform:n=>Ay(n)?n:n.hasOwnProperty("red")?zl.transform(n):ld.transform(n)},bt=(n,e,t)=>-t*n+t*e+n;function BS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function OV({hue:n,saturation:e,lightness:t,alpha:s}){n/=360,e/=100,t/=100;let r=0,i=0,o=0;if(!e)r=i=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=BS(c,a,n+1/3),i=BS(c,a,n),o=BS(c,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}const $S=(n,e,t)=>{const s=n*n;return Math.sqrt(Math.max(0,t*(e*e-s)+s))},FV=[xA,zl,ld],BV=n=>FV.find(e=>e.test(n));function B2(n){const e=BV(n);let t=e.parse(n);return e===ld&&(t=OV(t)),t}const UI=(n,e)=>{const t=B2(n),s=B2(e),r={...t};return i=>(r.red=$S(t.red,s.red,i),r.green=$S(t.green,s.green,i),r.blue=$S(t.blue,s.blue,i),r.alpha=bt(t.alpha,s.alpha,i),zl.transform(r))};function $V(n){var e,t;return isNaN(n)&&Ay(n)&&(((e=n.match(O1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(mI))===null||t===void 0?void 0:t.length)||0)>0}const HI={regex:Mz,countKey:"Vars",token:"${v}",parse:Tt},GI={regex:mI,countKey:"Colors",token:"${c}",parse:$n.parse},qI={regex:O1,countKey:"Numbers",token:"${n}",parse:Ru.parse};function zS(n,{regex:e,countKey:t,token:s,parse:r}){const i=n.tokenised.match(e);i&&(n["num"+t]=i.length,n.tokenised=n.tokenised.replace(e,s),n.values.push(...i.map(r)))}function ex(n){const e=n.toString(),t={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return t.value.includes("var(--")&&zS(t,HI),zS(t,GI),zS(t,qI),t}function WI(n){return ex(n).values}function KI(n){const{values:e,numColors:t,numVars:s,tokenised:r}=ex(n),i=e.length;return o=>{let a=r;for(let c=0;c<i;c++)c<s?a=a.replace(HI.token,o[c]):c<s+t?a=a.replace(GI.token,$n.transform(o[c])):a=a.replace(qI.token,nm(o[c]));return a}}const zV=n=>typeof n=="number"?0:n;function VV(n){const e=WI(n);return KI(n)(e.map(zV))}const ul={test:$V,parse:WI,createTransformer:KI,getAnimatableNone:VV},XI=(n,e)=>t=>`${t>0?e:n}`;function YI(n,e){return typeof n=="number"?t=>bt(n,e,t):$n.test(n)?UI(n,e):n.startsWith("var(")?XI(n,e):JI(n,e)}const QI=(n,e)=>{const t=[...n],s=t.length,r=n.map((i,o)=>YI(i,e[o]));return i=>{for(let o=0;o<s;o++)t[o]=r[o](i);return t}},UV=(n,e)=>{const t={...n,...e},s={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(s[r]=YI(n[r],e[r]));return r=>{for(const i in s)t[i]=s[i](r);return t}},JI=(n,e)=>{const t=ul.createTransformer(e),s=ex(n),r=ex(e);return s.numVars===r.numVars&&s.numColors===r.numColors&&s.numNumbers>=r.numNumbers?il(QI(s.values,r.values),t):XI(n,e)},Pm=(n,e,t)=>{const s=e-n;return s===0?1:(t-n)/s},$2=(n,e)=>t=>bt(n,e,t);function HV(n){return typeof n=="number"?$2:typeof n=="string"?$n.test(n)?UI:JI:Array.isArray(n)?QI:typeof n=="object"?UV:$2}function GV(n,e,t){const s=[],r=t||HV(n[0]),i=n.length-1;for(let o=0;o<i;o++){let a=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||Tt:e;a=il(c,a)}s.push(a)}return s}function ZI(n,e,{clamp:t=!0,ease:s,mixer:r}={}){const i=n.length;if(Fk(i===e.length),i===1)return()=>e[0];n[0]>n[i-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=GV(e,s,r),a=o.length,c=u=>{let d=0;if(a>1)for(;d<n.length-2&&!(u<n[d+1]);d++);const h=Pm(n[d],n[d+1],u);return o[d](h)};return t?u=>c(cl(n[0],n[i-1],u)):c}function qV(n,e){const t=n[n.length-1];for(let s=1;s<=e;s++){const r=Pm(0,e,s);n.push(bt(t,1,r))}}function WV(n){const e=[0];return qV(e,n.length-1),e}function KV(n,e){return n.map(t=>t*e)}function XV(n,e){return n.map(()=>e||OI).splice(0,n.length-1)}function tx({duration:n=300,keyframes:e,times:t,ease:s="easeInOut"}){const r=NV(s)?s.map(F2):F2(s),i={done:!1,value:e[0]},o=KV(t&&t.length===e.length?t:WV(e),n),a=ZI(o,e,{ease:Array.isArray(r)?r:XV(e,r)});return{calculatedDuration:n,next:c=>(i.value=a(c),i.done=c>=n,i)}}function eD(n,e){return e?n*(1e3/e):0}const YV=5;function tD(n,e,t){const s=Math.max(e-YV,0);return eD(t-n(s),e-s)}const VS=.001,QV=.01,z2=10,JV=.05,ZV=1;function eU({duration:n=800,bounce:e=.25,velocity:t=0,mass:s=1}){let r,i;wV(n<=ol(z2));let o=1-e;o=cl(JV,ZV,o),n=cl(QV,z2,Eo(n)),o<1?(r=u=>{const d=u*o,h=d*n,p=d-t,m=wA(u,o),y=Math.exp(-h);return VS-p/m*y},i=u=>{const h=u*o*n,p=h*t+t,m=Math.pow(o,2)*Math.pow(u,2)*n,y=Math.exp(-h),g=wA(Math.pow(u,2),o);return(-r(u)+VS>0?-1:1)*((p-m)*y)/g}):(r=u=>{const d=Math.exp(-u*n),h=(u-t)*n+1;return-VS+d*h},i=u=>{const d=Math.exp(-u*n),h=(t-u)*(n*n);return d*h});const a=5/n,c=nU(r,i,a);if(n=ol(n),isNaN(c))return{stiffness:100,damping:10,duration:n};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:o*2*Math.sqrt(s*u),duration:n}}}const tU=12;function nU(n,e,t){let s=t;for(let r=1;r<tU;r++)s=s-n(s)/e(s);return s}function wA(n,e){return n*Math.sqrt(1-e*e)}const sU=["duration","bounce"],rU=["stiffness","damping","mass"];function V2(n,e){return e.some(t=>n[t]!==void 0)}function iU(n){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...n};if(!V2(n,rU)&&V2(n,sU)){const t=eU(n);e={...e,...t,mass:1},e.isResolvedFromDuration=!0}return e}function nD({keyframes:n,restDelta:e,restSpeed:t,...s}){const r=n[0],i=n[n.length-1],o={done:!1,value:r},{stiffness:a,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=iU({...s,velocity:-Eo(s.velocity||0)}),m=h||0,y=c/(2*Math.sqrt(a*u)),g=i-r,w=Eo(Math.sqrt(a/u)),v=Math.abs(g)<5;t||(t=v?.01:2),e||(e=v?.005:.5);let b;if(y<1){const S=wA(w,y);b=E=>{const k=Math.exp(-y*w*E);return i-k*((m+y*w*g)/S*Math.sin(S*E)+g*Math.cos(S*E))}}else if(y===1)b=S=>i-Math.exp(-w*S)*(g+(m+w*g)*S);else{const S=w*Math.sqrt(y*y-1);b=E=>{const k=Math.exp(-y*w*E),T=Math.min(S*E,300);return i-k*((m+y*w*g)*Math.sinh(T)+S*g*Math.cosh(T))/S}}return{calculatedDuration:p&&d||null,next:S=>{const E=b(S);if(p)o.done=S>=d;else{let k=m;S!==0&&(y<1?k=tD(b,S,E):k=0);const T=Math.abs(k)<=t,P=Math.abs(i-E)<=e;o.done=T&&P}return o.value=o.done?i:E,o}}}function U2({keyframes:n,velocity:e=0,power:t=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:c,restDelta:u=.5,restSpeed:d}){const h=n[0],p={done:!1,value:h},m=N=>a!==void 0&&N<a||c!==void 0&&N>c,y=N=>a===void 0?c:c===void 0||Math.abs(a-N)<Math.abs(c-N)?a:c;let g=t*e;const w=h+g,v=o===void 0?w:o(w);v!==w&&(g=v-h);const b=N=>-g*Math.exp(-N/s),S=N=>v+b(N),E=N=>{const M=b(N),L=S(N);p.done=Math.abs(M)<=u,p.value=p.done?v:L};let k,T;const P=N=>{m(p.value)&&(k=N,T=nD({keyframes:[p.value,y(p.value)],velocity:tD(S,N,p.value),damping:r,stiffness:i,restDelta:u,restSpeed:d}))};return P(0),{calculatedDuration:null,next:N=>{let M=!1;return!T&&k===void 0&&(M=!0,E(N),P(N)),k!==void 0&&N>k?T.next(N-k):(!M&&E(N),p)}}}const oU=n=>{const e=({timestamp:t})=>n(t);return{start:()=>it.update(e,!0),stop:()=>jo(e),now:()=>kn.isProcessing?kn.timestamp:performance.now()}},H2=2e4;function G2(n){let e=0;const t=50;let s=n.next(e);for(;!s.done&&e<H2;)e+=t,s=n.next(e);return e>=H2?1/0:e}const aU={decay:U2,inertia:U2,tween:tx,keyframes:tx,spring:nD};function nx({autoplay:n=!0,delay:e=0,driver:t=oU,keyframes:s,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...p}){let m=1,y=!1,g,w;const v=()=>{w=new Promise(H=>{g=H})};v();let b;const S=aU[r]||tx;let E;S!==tx&&typeof s[0]!="number"&&(E=ZI([0,100],s,{clamp:!1}),s=[0,100]);const k=S({...p,keyframes:s});let T;a==="mirror"&&(T=S({...p,keyframes:[...s].reverse(),velocity:-(p.velocity||0)}));let P="idle",N=null,M=null,L=null;k.calculatedDuration===null&&i&&(k.calculatedDuration=G2(k));const{calculatedDuration:O}=k;let D=1/0,V=1/0;O!==null&&(D=O+o,V=D*(i+1)-o);let I=0;const R=H=>{if(M===null)return;m>0&&(M=Math.min(M,H)),m<0&&(M=Math.min(H-V/m,M)),N!==null?I=N:I=Math.round(H-M)*m;const U=I-e*(m>=0?1:-1),Y=m>=0?U<0:U>V;I=Math.max(U,0),P==="finished"&&N===null&&(I=V);let Q=I,ge=k;if(i){const Ue=Math.min(I,V)/D;let ye=Math.floor(Ue),Be=Ue%1;!Be&&Ue>=1&&(Be=1),Be===1&&ye--,ye=Math.min(ye,i+1),!!(ye%2)&&(a==="reverse"?(Be=1-Be,o&&(Be-=o/D)):a==="mirror"&&(ge=T)),Q=cl(0,1,Be)*D}const Ce=Y?{done:!1,value:s[0]}:ge.next(Q);E&&(Ce.value=E(Ce.value));let{done:oe}=Ce;!Y&&O!==null&&(oe=m>=0?I>=V:I<=0);const je=N===null&&(P==="finished"||P==="running"&&oe);return h&&h(Ce.value),je&&$(),Ce},j=()=>{b&&b.stop(),b=void 0},F=()=>{P="idle",j(),g(),v(),M=L=null},$=()=>{P="finished",d&&d(),j(),g()},z=()=>{if(y)return;b||(b=t(R));const H=b.now();c&&c(),N!==null?M=H-N:(!M||P==="finished")&&(M=H),P==="finished"&&v(),L=M,N=null,P="running",b.start()};n&&z();const B={then(H,U){return w.then(H,U)},get time(){return Eo(I)},set time(H){H=ol(H),I=H,N!==null||!b||m===0?N=H:M=b.now()-H/m},get duration(){const H=k.calculatedDuration===null?G2(k):k.calculatedDuration;return Eo(H)},get speed(){return m},set speed(H){H===m||!b||(m=H,B.time=Eo(I))},get state(){return P},play:z,pause:()=>{P="paused",N=I},stop:()=>{y=!0,P!=="idle"&&(P="idle",u&&u(),F())},cancel:()=>{L!==null&&R(L),F()},complete:()=>{P="finished"},sample:H=>(M=0,R(H))};return B}function lU(n){let e;return()=>(e===void 0&&(e=n()),e)}const cU=lU(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),uU=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),cv=10,dU=2e4,hU=(n,e)=>e.type==="spring"||n==="backgroundColor"||!MI(e.ease);function fU(n,e,{onUpdate:t,onComplete:s,...r}){if(!(cU()&&uU.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,c,u=!1;const d=()=>{c=new Promise(S=>{a=S})};d();let{keyframes:h,duration:p=300,ease:m,times:y}=r;if(hU(e,r)){const S=nx({...r,repeat:0,delay:0});let E={done:!1,value:h[0]};const k=[];let T=0;for(;!E.done&&T<dU;)E=S.sample(T),k.push(E.value),T+=cv;y=void 0,h=k,p=T-cv,m="linear"}const g=_V(n.owner.current,e,h,{...r,duration:p,ease:m,times:y}),w=()=>{u=!1,g.cancel()},v=()=>{u=!0,it.update(w),a(),d()};return g.onfinish=()=>{u||(n.set(AV(h,r)),s&&s(),v())},{then(S,E){return c.then(S,E)},attachTimeline(S){return g.timeline=S,g.onfinish=null,Tt},get time(){return Eo(g.currentTime||0)},set time(S){g.currentTime=ol(S)},get speed(){return g.playbackRate},set speed(S){g.playbackRate=S},get duration(){return Eo(p)},play:()=>{o||(g.play(),jo(w))},pause:()=>g.pause(),stop:()=>{if(o=!0,g.playState==="idle")return;const{currentTime:S}=g;if(S){const E=nx({...r,autoplay:!1});n.setWithVelocity(E.sample(S-cv).value,E.sample(S).value,cv)}v()},complete:()=>{u||g.finish()},cancel:v}}function pU({keyframes:n,delay:e,onUpdate:t,onComplete:s}){const r=()=>(t&&t(n[n.length-1]),s&&s(),{time:0,speed:1,duration:0,play:Tt,pause:Tt,stop:Tt,then:i=>(i(),Promise.resolve()),cancel:Tt,complete:Tt});return e?nx({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const mU={type:"spring",stiffness:500,damping:25,restSpeed:10},gU=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),yU={type:"keyframes",duration:.8},vU={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},bU=(n,{keyframes:e})=>e.length>2?yU:Nu.has(n)?n.startsWith("scale")?gU(e[1]):mU:vU,SA=(n,e)=>n==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ul.test(e)||e==="0")&&!e.startsWith("url(")),xU=new Set(["brightness","contrast","saturate","opacity"]);function wU(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[s]=t.match(O1)||[];if(!s)return n;const r=t.replace(s,"");let i=xU.has(e)?1:0;return s!==t&&(i*=100),e+"("+i+r+")"}const SU=/([a-z-]*)\(.*?\)/g,_A={...ul,getAnimatableNone:n=>{const e=n.match(SU);return e?e.map(wU).join(" "):n}},_U={...gI,color:$n,backgroundColor:$n,outlineColor:$n,fill:$n,stroke:$n,borderColor:$n,borderTopColor:$n,borderRightColor:$n,borderBottomColor:$n,borderLeftColor:$n,filter:_A,WebkitFilter:_A},Vk=n=>_U[n];function sD(n,e){let t=Vk(n);return t!==_A&&(t=ul),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const rD=n=>/^0[^.\s]+$/.test(n);function AU(n){if(typeof n=="number")return n===0;if(n!==null)return n==="none"||n==="0"||rD(n)}function EU(n,e,t,s){const r=SA(e,t);let i;Array.isArray(t)?i=[...t]:i=[null,t];const o=s.from!==void 0?s.from:n.get();let a;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),AU(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(a=i[u]);if(r&&c.length&&a)for(let u=0;u<c.length;u++){const d=c[u];i[d]=sD(e,a)}return i}function CU({when:n,delay:e,delayChildren:t,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function Uk(n,e){return n[e]||n.default||n}const kU={skipAnimations:!1},Hk=(n,e,t,s={})=>r=>{const i=Uk(s,n)||{},o=i.delay||s.delay||0;let{elapsed:a=0}=s;a=a-ol(o);const c=EU(e,n,t,i),u=c[0],d=c[c.length-1],h=SA(n,u),p=SA(n,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-a,onUpdate:y=>{e.set(y),i.onUpdate&&i.onUpdate(y)},onComplete:()=>{r(),i.onComplete&&i.onComplete()}};if(CU(i)||(m={...m,...bU(n,m)}),m.duration&&(m.duration=ol(m.duration)),m.repeatDelay&&(m.repeatDelay=ol(m.repeatDelay)),!h||!p||SV.current||i.type===!1||kU.skipAnimations)return pU(m);if(!s.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const y=fU(e,n,m);if(y)return y}return nx(m)};function sx(n){return!!(ds(n)&&n.add)}const iD=n=>/^\-?\d*\.?\d+$/.test(n);function Gk(n,e){n.indexOf(e)===-1&&n.push(e)}function qk(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Wk{constructor(){this.subscriptions=[]}add(e){return Gk(this.subscriptions,e),()=>qk(this.subscriptions,e)}notify(e,t,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,t,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const TU=n=>!isNaN(parseFloat(n));class PU{constructor(e,t={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(s,r=!0)=>{this.prev=this.current,this.current=s;const{delta:i,timestamp:o}=kn;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,it.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>it.postRender(this.velocityCheck),this.velocityCheck=({timestamp:s})=>{s!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=TU(this.current),this.owner=t.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Wk);const s=this.events[e].add(t);return e==="change"?()=>{s(),it.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,s){this.set(t),this.prev=e,this.timeDelta=s}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?eD(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function jf(n,e){return new PU(n,e)}const oD=n=>e=>e.test(n),NU={test:n=>n==="auto",parse:n=>n},aD=[Ru,de,Ai,Vo,Oz,Dz,NU],ip=n=>aD.find(oD(n)),RU=[...aD,$n,ul],jU=n=>RU.find(oD(n));function MU(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,jf(t))}function LU(n,e){const t=B1(n,e);let{transitionEnd:s={},transition:r={},...i}=t?n.makeTargetAnimatable(t,!1):{};i={...i,...s};for(const o in i){const a=Qz(i[o]);MU(n,o,a)}}function IU(n,e,t){var s,r;const i=Object.keys(e).filter(a=>!n.hasValue(a)),o=i.length;if(o)for(let a=0;a<o;a++){const c=i[a],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(r=(s=t[c])!==null&&s!==void 0?s:n.readValue(c))!==null&&r!==void 0?r:e[c]),d!=null&&(typeof d=="string"&&(iD(d)||rD(d))?d=parseFloat(d):!jU(d)&&ul.test(u)&&(d=sD(c,u)),n.addValue(c,jf(d,{owner:n})),t[c]===void 0&&(t[c]=d),d!==null&&n.setBaseTarget(c,d))}}function DU(n,e){return e?(e[n]||e.default||e).from:void 0}function OU(n,e,t){const s={};for(const r in n){const i=DU(r,e);if(i!==void 0)s[r]=i;else{const o=t.getValue(r);o&&(s[r]=o.get())}}return s}function FU({protectedKeys:n,needsAnimating:e},t){const s=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,s}function BU(n,e){const t=n.get();if(Array.isArray(e)){for(let s=0;s<e.length;s++)if(e[s]!==t)return!0}else return t!==e}function lD(n,e,{delay:t=0,transitionOverride:s,type:r}={}){let{transition:i=n.getDefaultTransition(),transitionEnd:o,...a}=n.makeTargetAnimatable(e);const c=n.getValue("willChange");s&&(i=s);const u=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const h in a){const p=n.getValue(h),m=a[h];if(!p||m===void 0||d&&FU(d,h))continue;const y={delay:t,elapsed:0,...Uk(i||{},h)};if(window.HandoffAppearAnimations){const v=n.getProps()[cI];if(v){const b=window.HandoffAppearAnimations(v,h,p,it);b!==null&&(y.elapsed=b,y.isHandoff=!0)}}let g=!y.isHandoff&&!BU(p,m);if(y.type==="spring"&&(p.getVelocity()||y.velocity)&&(g=!1),p.animation&&(g=!1),g)continue;p.start(Hk(h,p,m,n.shouldReduceMotion&&Nu.has(h)?{type:!1}:y));const w=p.animation;sx(c)&&(c.add(h),w.then(()=>c.remove(h))),u.push(w)}return o&&Promise.all(u).then(()=>{o&&LU(n,o)}),u}function AA(n,e,t={}){const s=B1(n,e,t.custom);let{transition:r=n.getDefaultTransition()||{}}=s||{};t.transitionOverride&&(r=t.transitionOverride);const i=s?()=>Promise.all(lD(n,s,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=r;return $U(n,e,u+c,d,h,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[c,u]=a==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(t.delay)])}function $U(n,e,t=0,s=0,r=1,i){const o=[],a=(n.variantChildren.size-1)*s,c=r===1?(u=0)=>u*s:(u=0)=>a-u*s;return Array.from(n.variantChildren).sort(zU).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(AA(u,e,{...i,delay:t+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function zU(n,e){return n.sortNodePosition(e)}function VU(n,e,t={}){n.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>AA(n,i,t));s=Promise.all(r)}else if(typeof e=="string")s=AA(n,e,t);else{const r=typeof e=="function"?B1(n,e,t.custom):e;s=Promise.all(lD(n,r,t))}return s.then(()=>n.notify("AnimationComplete",e))}const UU=[...Tk].reverse(),HU=Tk.length;function GU(n){return e=>Promise.all(e.map(({animation:t,options:s})=>VU(n,t,s)))}function qU(n){let e=GU(n);const t=KU();let s=!0;const r=(c,u)=>{const d=B1(n,u);if(d){const{transition:h,transitionEnd:p,...m}=d;c={...c,...m,...p}}return c};function i(c){e=c(n)}function o(c,u){const d=n.getProps(),h=n.getVariantContext(!0)||{},p=[],m=new Set;let y={},g=1/0;for(let v=0;v<HU;v++){const b=UU[v],S=t[b],E=d[b]!==void 0?d[b]:h[b],k=km(E),T=b===u?S.isActive:null;T===!1&&(g=v);let P=E===h[b]&&E!==d[b]&&k;if(P&&s&&n.manuallyAnimateOnMount&&(P=!1),S.protectedKeys={...y},!S.isActive&&T===null||!E&&!S.prevProp||I1(E)||typeof E=="boolean")continue;let M=WU(S.prevProp,E)||b===u&&S.isActive&&!P&&k||v>g&&k,L=!1;const O=Array.isArray(E)?E:[E];let D=O.reduce(r,{});T===!1&&(D={});const{prevResolvedValues:V={}}=S,I={...V,...D},R=j=>{M=!0,m.has(j)&&(L=!0,m.delete(j)),S.needsAnimating[j]=!0};for(const j in I){const F=D[j],$=V[j];if(y.hasOwnProperty(j))continue;let z=!1;Zb(F)&&Zb($)?z=!RI(F,$):z=F!==$,z?F!==void 0?R(j):m.add(j):F!==void 0&&m.has(j)?R(j):S.protectedKeys[j]=!0}S.prevProp=E,S.prevResolvedValues=D,S.isActive&&(y={...y,...D}),s&&n.blockInitialAnimation&&(M=!1),M&&(!P||L)&&p.push(...O.map(j=>({animation:j,options:{type:b,...c}})))}if(m.size){const v={};m.forEach(b=>{const S=n.getBaseTarget(b);S!==void 0&&(v[b]=S)}),p.push({animation:v})}let w=!!p.length;return s&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),s=!1,w?e(p):Promise.resolve()}function a(c,u,d){var h;if(t[c].isActive===u)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(c,u)}),t[c].isActive=u;const p=o(d,c);for(const m in t)t[m].protectedKeys={};return p}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>t}}function WU(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!RI(e,n):!1}function vl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function KU(){return{animate:vl(!0),whileInView:vl(),whileHover:vl(),whileTap:vl(),whileDrag:vl(),whileFocus:vl(),exit:vl()}}class XU extends gl{constructor(e){super(e),e.animationState||(e.animationState=qU(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),I1(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}let YU=0;class QU extends gl{constructor(){super(...arguments),this.id=YU++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:s}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e,{custom:s??this.node.getProps().custom});t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const JU={animation:{Feature:XU},exit:{Feature:QU}},q2=(n,e)=>Math.abs(n-e);function ZU(n,e){const t=q2(n.x,e.x),s=q2(n.y,e.y);return Math.sqrt(t**2+s**2)}class cD{constructor(e,t,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=HS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=ZU(h.offset,{x:0,y:0})>=3;if(!p&&!m)return;const{point:y}=h,{timestamp:g}=kn;this.history.push({...y,timestamp:g});const{onStart:w,onMove:v}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=US(p,this.transformPagePoint),it.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=HS(h.type==="pointercancel"?this.lastMoveEventInfo:US(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,w),y&&y(h,w)},!CI(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=s,this.contextWindow=r||window;const o=F1(e),a=US(o,this.transformPagePoint),{point:c}=a,{timestamp:u}=kn;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=t;d&&d(e,HS(a,this.history)),this.removeListeners=il(Ao(this.contextWindow,"pointermove",this.handlePointerMove),Ao(this.contextWindow,"pointerup",this.handlePointerUp),Ao(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),jo(this.updatePoint)}}function US(n,e){return e?{point:e(n.point)}:n}function W2(n,e){return{x:n.x-e.x,y:n.y-e.y}}function HS({point:n},e){return{point:n,delta:W2(n,uD(e)),offset:W2(n,e6(e)),velocity:t6(e,.1)}}function e6(n){return n[0]}function uD(n){return n[n.length-1]}function t6(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,s=null;const r=uD(n);for(;t>=0&&(s=n[t],!(r.timestamp-s.timestamp>ol(e)));)t--;if(!s)return{x:0,y:0};const i=Eo(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Fs(n){return n.max-n.min}function EA(n,e=0,t=.01){return Math.abs(n-e)<=t}function K2(n,e,t,s=.5){n.origin=s,n.originPoint=bt(e.min,e.max,n.origin),n.scale=Fs(t)/Fs(e),(EA(n.scale,1,1e-4)||isNaN(n.scale))&&(n.scale=1),n.translate=bt(t.min,t.max,n.origin)-n.originPoint,(EA(n.translate)||isNaN(n.translate))&&(n.translate=0)}function sm(n,e,t,s){K2(n.x,e.x,t.x,s?s.originX:void 0),K2(n.y,e.y,t.y,s?s.originY:void 0)}function X2(n,e,t){n.min=t.min+e.min,n.max=n.min+Fs(e)}function n6(n,e,t){X2(n.x,e.x,t.x),X2(n.y,e.y,t.y)}function Y2(n,e,t){n.min=e.min-t.min,n.max=n.min+Fs(e)}function rm(n,e,t){Y2(n.x,e.x,t.x),Y2(n.y,e.y,t.y)}function s6(n,{min:e,max:t},s){return e!==void 0&&n<e?n=s?bt(e,n,s.min):Math.max(n,e):t!==void 0&&n>t&&(n=s?bt(t,n,s.max):Math.min(n,t)),n}function Q2(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function r6(n,{top:e,left:t,bottom:s,right:r}){return{x:Q2(n.x,t,r),y:Q2(n.y,e,s)}}function J2(n,e){let t=e.min-n.min,s=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,s]=[s,t]),{min:t,max:s}}function i6(n,e){return{x:J2(n.x,e.x),y:J2(n.y,e.y)}}function o6(n,e){let t=.5;const s=Fs(n),r=Fs(e);return r>s?t=Pm(e.min,e.max-s,n.min):s>r&&(t=Pm(n.min,n.max-r,e.min)),cl(0,1,t)}function a6(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const CA=.35;function l6(n=CA){return n===!1?n=0:n===!0&&(n=CA),{x:Z2(n,"left","right"),y:Z2(n,"top","bottom")}}function Z2(n,e,t){return{min:eN(n,e),max:eN(n,t)}}function eN(n,e){return typeof n=="number"?n:n[e]||0}const tN=()=>({translate:0,scale:1,origin:0,originPoint:0}),cd=()=>({x:tN(),y:tN()}),nN=()=>({min:0,max:0}),It=()=>({x:nN(),y:nN()});function qs(n){return[n("x"),n("y")]}function dD({top:n,left:e,right:t,bottom:s}){return{x:{min:e,max:t},y:{min:n,max:s}}}function c6({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function u6(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),s=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:s.y,right:s.x}}function GS(n){return n===void 0||n===1}function kA({scale:n,scaleX:e,scaleY:t}){return!GS(n)||!GS(e)||!GS(t)}function Cl(n){return kA(n)||hD(n)||n.z||n.rotate||n.rotateX||n.rotateY}function hD(n){return sN(n.x)||sN(n.y)}function sN(n){return n&&n!=="0%"}function rx(n,e,t){const s=n-t,r=e*s;return t+r}function rN(n,e,t,s,r){return r!==void 0&&(n=rx(n,r,s)),rx(n,t,s)+e}function TA(n,e=0,t=1,s,r){n.min=rN(n.min,e,t,s,r),n.max=rN(n.max,e,t,s,r)}function fD(n,{x:e,y:t}){TA(n.x,e.translate,e.scale,e.originPoint),TA(n.y,t.translate,t.scale,t.originPoint)}function d6(n,e,t,s=!1){const r=t.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=t[a],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ud(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,fD(n,o)),s&&Cl(i.latestValues)&&ud(n,i.latestValues))}e.x=iN(e.x),e.y=iN(e.y)}function iN(n){return Number.isInteger(n)||n>1.0000000000001||n<.999999999999?n:1}function qo(n,e){n.min=n.min+e,n.max=n.max+e}function oN(n,e,[t,s,r]){const i=e[r]!==void 0?e[r]:.5,o=bt(n.min,n.max,i);TA(n,e[t],e[s],o,e.scale)}const h6=["x","scaleX","originX"],f6=["y","scaleY","originY"];function ud(n,e){oN(n.x,e,h6),oN(n.y,e,f6)}function pD(n,e){return dD(u6(n.getBoundingClientRect(),e))}function p6(n,e,t){const s=pD(n,t),{scroll:r}=e;return r&&(qo(s.x,r.offset.x),qo(s.y,r.offset.y)),s}const mD=({current:n})=>n?n.ownerDocument.defaultView:null,m6=new WeakMap;class g6{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=It(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(F1(d,"page").point)},i=(d,h)=>{const{drag:p,dragPropagation:m,onDragStart:y}=this.getProps();if(p&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=TI(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),qs(w=>{let v=this.getAxisMotionValue(w).get()||0;if(Ai.test(v)){const{projection:b}=this.visualElement;if(b&&b.layout){const S=b.layout.layoutBox[w];S&&(v=Fs(S)*(parseFloat(v)/100))}}this.originPoint[w]=v}),y&&it.update(()=>y(d,h),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:y,onDrag:g}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:w}=h;if(m&&this.currentDirection===null){this.currentDirection=y6(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),g&&g(d,h)},a=(d,h)=>this.stop(d,h),c=()=>qs(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new cD(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:mD(this.visualElement)})}stop(e,t){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&it.update(()=>i(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,s){const{drag:r}=this.getProps();if(!s||!uv(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=s6(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;t&&ad(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=r6(r.layoutBox,t):this.constraints=!1,this.elastic=l6(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&qs(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=a6(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!ad(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=p6(s,r.root,this.visualElement.getTransformPagePoint());let o=i6(r.layout.layoutBox,i);if(t){const a=t(c6(o));this.hasMutatedConstraints=!!a,a&&(o=dD(a))}return o}startAnimation(e){const{drag:t,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},u=qs(d=>{if(!uv(d,t,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const p=r?200:1e6,m=r?40:1e7,y={type:"inertia",velocity:s?e[d]:0,bounceStiffness:p,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,y)});return Promise.all(u).then(a)}startAxisValueAnimation(e,t){const s=this.getAxisMotionValue(e);return s.start(Hk(e,s,0,t))}stopAnimation(){qs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){qs(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),s=this.visualElement.getProps(),r=s[t];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){qs(t=>{const{drag:s}=this.getProps();if(!uv(t,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];i.set(e[t]-bt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:s}=this.visualElement;if(!ad(t)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};qs(o=>{const a=this.getAxisMotionValue(o);if(a){const c=a.get();r[o]=o6({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),qs(o=>{if(!uv(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];a.set(bt(c,u,r[o]))})}addListeners(){if(!this.visualElement.current)return;m6.set(this.visualElement,this);const e=this.visualElement.current,t=Ao(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();ad(c)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),s();const o=So(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(qs(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),t(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=CA,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function uv(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function y6(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class v6 extends gl{constructor(e){super(e),this.removeGroupControls=Tt,this.removeListeners=Tt,this.controls=new g6(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tt}unmount(){this.removeGroupControls(),this.removeListeners()}}const aN=n=>(e,t)=>{n&&it.update(()=>n(e,t))};class b6 extends gl{constructor(){super(...arguments),this.removePointerDownListener=Tt}onPointerDown(e){this.session=new cD(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:mD(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:aN(e),onStart:aN(t),onMove:s,onEnd:(i,o)=>{delete this.session,r&&it.update(()=>r(i,o))}}}mount(){this.removePointerDownListener=Ao(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function x6(){const n=A.useContext(M1);if(n===null)return[!0,null];const{isPresent:e,onExitComplete:t,register:s}=n,r=A.useId();return A.useEffect(()=>s(r),[]),!e&&t?[!1,()=>t&&t(r)]:[!0]}const Gv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function lN(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const op={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(de.test(n))n=parseFloat(n);else return n;const t=lN(n,e.target.x),s=lN(n,e.target.y);return`${t}% ${s}%`}},w6={correct:(n,{treeScale:e,projectionDelta:t})=>{const s=n,r=ul.parse(n);if(r.length>5)return s;const i=ul.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const u=bt(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=u),typeof r[3+o]=="number"&&(r[3+o]/=u),i(r)}};class S6 extends Re.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;Pz(_6),i&&(t.group&&t.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Gv.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||it.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function gD(n){const[e,t]=x6(),s=A.useContext(Nk);return Re.createElement(S6,{...n,layoutGroup:s,switchLayoutGroup:A.useContext(dI),isPresent:e,safeToRemove:t})}const _6={borderRadius:{...op,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:op,borderTopRightRadius:op,borderBottomLeftRadius:op,borderBottomRightRadius:op,boxShadow:w6},yD=["TopLeft","TopRight","BottomLeft","BottomRight"],A6=yD.length,cN=n=>typeof n=="string"?parseFloat(n):n,uN=n=>typeof n=="number"||de.test(n);function E6(n,e,t,s,r,i){r?(n.opacity=bt(0,t.opacity!==void 0?t.opacity:1,C6(s)),n.opacityExit=bt(e.opacity!==void 0?e.opacity:1,0,k6(s))):i&&(n.opacity=bt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,s));for(let o=0;o<A6;o++){const a=`border${yD[o]}Radius`;let c=dN(e,a),u=dN(t,a);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||uN(c)===uN(u)?(n[a]=Math.max(bt(cN(c),cN(u),s),0),(Ai.test(u)||Ai.test(c))&&(n[a]+="%")):n[a]=u}(e.rotate||t.rotate)&&(n.rotate=bt(e.rotate||0,t.rotate||0,s))}function dN(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const C6=vD(0,.5,$I),k6=vD(.5,.95,Tt);function vD(n,e,t){return s=>s<n?0:s>e?1:t(Pm(n,e,s))}function hN(n,e){n.min=e.min,n.max=e.max}function Us(n,e){hN(n.x,e.x),hN(n.y,e.y)}function fN(n,e,t,s,r){return n-=e,n=rx(n,1/t,s),r!==void 0&&(n=rx(n,1/r,s)),n}function T6(n,e=0,t=1,s=.5,r,i=n,o=n){if(Ai.test(e)&&(e=parseFloat(e),e=bt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=bt(i.min,i.max,s);n===i&&(a-=e),n.min=fN(n.min,e,t,a,r),n.max=fN(n.max,e,t,a,r)}function pN(n,e,[t,s,r],i,o){T6(n,e[t],e[s],e[r],e.scale,i,o)}const P6=["x","scaleX","originX"],N6=["y","scaleY","originY"];function mN(n,e,t,s){pN(n.x,e,P6,t?t.x:void 0,s?s.x:void 0),pN(n.y,e,N6,t?t.y:void 0,s?s.y:void 0)}function gN(n){return n.translate===0&&n.scale===1}function bD(n){return gN(n.x)&&gN(n.y)}function R6(n,e){return n.x.min===e.x.min&&n.x.max===e.x.max&&n.y.min===e.y.min&&n.y.max===e.y.max}function xD(n,e){return Math.round(n.x.min)===Math.round(e.x.min)&&Math.round(n.x.max)===Math.round(e.x.max)&&Math.round(n.y.min)===Math.round(e.y.min)&&Math.round(n.y.max)===Math.round(e.y.max)}function yN(n){return Fs(n.x)/Fs(n.y)}class j6{constructor(){this.members=[]}add(e){Gk(this.members,e),e.scheduleRender()}remove(e){if(qk(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let s;for(let r=t;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,t){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,t&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:s}=e;t.onExitComplete&&t.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vN(n,e,t){let s="";const r=n.x.translate/e.x,i=n.y.translate/e.y;if((r||i)&&(s=`translate3d(${r}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),t){const{rotate:c,rotateX:u,rotateY:d}=t;c&&(s+=`rotate(${c}deg) `),u&&(s+=`rotateX(${u}deg) `),d&&(s+=`rotateY(${d}deg) `)}const o=n.x.scale*e.x,a=n.y.scale*e.y;return(o!==1||a!==1)&&(s+=`scale(${o}, ${a})`),s||"none"}const M6=(n,e)=>n.depth-e.depth;class L6{constructor(){this.children=[],this.isDirty=!1}add(e){Gk(this.children,e),this.isDirty=!0}remove(e){qk(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(M6),this.isDirty=!1,this.children.forEach(e)}}function I6(n,e){const t=performance.now(),s=({timestamp:r})=>{const i=r-t;i>=e&&(jo(s),n(i-e))};return it.read(s,!0),()=>jo(s)}function D6(n){window.MotionDebug&&window.MotionDebug.record(n)}function O6(n){return n instanceof SVGElement&&n.tagName!=="svg"}function F6(n,e,t){const s=ds(n)?n:jf(n);return s.start(Hk("",s,e,t)),s.animation}const bN=["","X","Y","Z"],B6={visibility:"hidden"},xN=1e3;let $6=0;const kl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function wD({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=$6++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,kl.totalNodes=kl.resolvedTargetDeltas=kl.recalculatedProjection=0,this.nodes.forEach(U6),this.nodes.forEach(K6),this.nodes.forEach(X6),this.nodes.forEach(H6),D6(kl)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new L6)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Wk),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=O6(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||c)&&(this.isLayoutDirty=!0),n){let h;const p=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=I6(p,250),Gv.hasAnimatedSinceResize&&(Gv.hasAnimatedSinceResize=!1,this.nodes.forEach(SN))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeTargetChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||d.getDefaultTransition()||e8,{onLayoutAnimationStart:w,onLayoutAnimationComplete:v}=d.getProps(),b=!this.targetLayout||!xD(this.targetLayout,y)||m,S=!p&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||p&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,S);const E={...Uk(g,"layout"),onPlay:w,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(E.delay=0,E.type=!1),this.startAnimation(E)}else p||SN(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Y6),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wN);return}this.isUpdating||this.nodes.forEach(q6),this.isUpdating=!1,this.nodes.forEach(W6),this.nodes.forEach(z6),this.nodes.forEach(V6),this.clearAllSnapshots();const a=performance.now();kn.delta=cl(0,1e3/60,a-kn.timestamp),kn.timestamp=a,kn.isProcessing=!0,IS.update.process(kn),IS.preRender.process(kn),IS.render.process(kn),kn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(G6),this.sharedNodes.forEach(Q6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,it.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){it.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=It(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:s(this.instance),offset:t(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!bD(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(a||Cl(this.latestValues)||d)&&(r(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),t8(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return It();const a=o.measureViewportBox(),{scroll:c}=this.root;return c&&(qo(a.x,c.offset.x),qo(a.y,c.offset.y)),a}removeElementScroll(o){const a=It();Us(a,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){Us(a,o);const{scroll:p}=this.root;p&&(qo(a.x,-p.offset.x),qo(a.y,-p.offset.y))}qo(a.x,d.offset.x),qo(a.y,d.offset.y)}}return a}applyTransform(o,a=!1){const c=It();Us(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&ud(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cl(d.latestValues)&&ud(c,d.latestValues)}return Cl(this.latestValues)&&ud(c,this.latestValues),c}removeTransform(o){const a=It();Us(a,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Cl(u.latestValues))continue;kA(u.latestValues)&&u.updateSnapshot();const d=It(),h=u.measurePageBox();Us(d,h),mN(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Cl(this.latestValues)&&mN(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==kn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=kn.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=It(),this.relativeTargetOrigin=It(),rm(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Us(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=It(),this.targetWithTransforms=It()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),n6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Us(this.target,this.layout.layoutBox),fD(this.target,this.targetDelta)):Us(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=It(),this.relativeTargetOrigin=It(),rm(this.relativeTargetOrigin,this.target,m.target),Us(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}kl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||kA(this.parent.latestValues)||hD(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),c=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===kn.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Us(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;d6(this.layoutCorrected,this.treeScale,this.path,c),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox);const{target:y}=a;if(!y){this.projectionTransform&&(this.projectionDelta=cd(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=cd(),this.projectionDeltaWithTransform=cd());const g=this.projectionTransform;sm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),this.projectionTransform=vN(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==p||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),kl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=cd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const p=It(),m=c?c.source:void 0,y=this.layout?this.layout.source:void 0,g=m!==y,w=this.getStack(),v=!w||w.members.length<=1,b=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(Z6));this.animationProgress=0;let S;this.mixTargetDelta=E=>{const k=E/1e3;_N(h.x,o.x,k),_N(h.y,o.y,k),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(rm(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),J6(this.relativeTarget,this.relativeTargetOrigin,p,k),S&&R6(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=It()),Us(S,this.relativeTarget)),g&&(this.animationValues=d,E6(d,u,this.latestValues,k,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=it.update(()=>{Gv.hasAnimatedSinceResize=!0,this.currentAnimation=F6(0,xN,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xN),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:u,latestValues:d}=o;if(!(!a||!c||!u)){if(this!==o&&this.layout&&u&&SD(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||It();const h=Fs(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const p=Fs(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+p}Us(a,c),ud(a,d),sm(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new j6),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(a=!0),!a)return;const u={};for(let d=0;d<bN.length;d++){const h="rotate"+bN[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var a,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return B6;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Hv(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=Hv(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Cl(this.latestValues)&&(g.transform=d?d({},""):"none",this.hasProjected=!1),g}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=vN(this.projectionDeltaWithTransform,this.treeScale,p),d&&(u.transform=d(p,u.transform));const{x:m,y}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${y.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(a=p.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:u.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const g in Qb){if(p[g]===void 0)continue;const{correct:w,applyTo:v}=Qb[g],b=u.transform==="none"?p[g]:w(p[g],h);if(v){const S=v.length;for(let E=0;E<S;E++)u[v[E]]=b}else u[g]=b}return this.options.layoutId&&(u.pointerEvents=h===this?Hv(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(wN),this.root.sharedNodes.clear()}}}function z6(n){n.updateLayout()}function V6(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=n.layout,{animationType:i}=n.options,o=t.source!==n.layout.source;i==="size"?qs(h=>{const p=o?t.measuredBox[h]:t.layoutBox[h],m=Fs(p);p.min=s[h].min,p.max=p.min+m}):SD(i,t.layoutBox,s)&&qs(h=>{const p=o?t.measuredBox[h]:t.layoutBox[h],m=Fs(s[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const a=cd();sm(a,s,t.layoutBox);const c=cd();o?sm(c,n.applyTransform(r,!0),t.measuredBox):sm(c,s,t.layoutBox);const u=!bD(a);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const y=It();rm(y,t.layoutBox,p.layoutBox);const g=It();rm(g,s,m.layoutBox),xD(y,g)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=g,n.relativeTargetOrigin=y,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:s}=n.options;s&&s()}n.options.transition=void 0}function U6(n){kl.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function H6(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function G6(n){n.clearSnapshot()}function wN(n){n.clearMeasurements()}function q6(n){n.isLayoutDirty=!1}function W6(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function SN(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function K6(n){n.resolveTargetDelta()}function X6(n){n.calcProjection()}function Y6(n){n.resetRotation()}function Q6(n){n.removeLeadSnapshot()}function _N(n,e,t){n.translate=bt(e.translate,0,t),n.scale=bt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function AN(n,e,t,s){n.min=bt(e.min,t.min,s),n.max=bt(e.max,t.max,s)}function J6(n,e,t,s){AN(n.x,e.x,t.x,s),AN(n.y,e.y,t.y,s)}function Z6(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const e8={duration:.45,ease:[.4,0,.1,1]},EN=n=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(n),CN=EN("applewebkit/")&&!EN("chrome/")?Math.round:Tt;function kN(n){n.min=CN(n.min),n.max=CN(n.max)}function t8(n){kN(n.x),kN(n.y)}function SD(n,e,t){return n==="position"||n==="preserve-aspect"&&!EA(yN(e),yN(t),.2)}const n8=wD({attachResizeListener:(n,e)=>So(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),qS={current:void 0},_D=wD({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!qS.current){const n=new n8({});n.mount(window),n.setOptions({layoutScroll:!0}),qS.current=n}return qS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),s8={pan:{Feature:b6},drag:{Feature:v6,ProjectionNode:_D,MeasureLayout:gD}},r8=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function i8(n){const e=r8.exec(n);if(!e)return[,];const[,t,s]=e;return[t,s]}function PA(n,e,t=1){const[s,r]=i8(n);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return iD(o)?parseFloat(o):o}else return vA(r)?PA(r,e,t+1):r}function o8(n,{...e},t){const s=n.current;if(!(s instanceof Element))return{target:e,transitionEnd:t};t&&(t={...t}),n.values.forEach(r=>{const i=r.get();if(!vA(i))return;const o=PA(i,s);o&&r.set(o)});for(const r in e){const i=e[r];if(!vA(i))continue;const o=PA(i,s);o&&(e[r]=o,t||(t={}),t[r]===void 0&&(t[r]=i))}return{target:e,transitionEnd:t}}const a8=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),AD=n=>a8.has(n),l8=n=>Object.keys(n).some(AD),TN=n=>n===Ru||n===de,PN=(n,e)=>parseFloat(n.split(", ")[e]),NN=(n,e)=>(t,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/);if(r)return PN(r[1],e);{const i=s.match(/^matrix\((.+)\)$/);return i?PN(i[1],n):0}},c8=new Set(["x","y","z"]),u8=_y.filter(n=>!c8.has(n));function d8(n){const e=[];return u8.forEach(t=>{const s=n.getValue(t);s!==void 0&&(e.push([t,s.get()]),s.set(t.startsWith("scale")?1:0))}),e.length&&n.render(),e}const Mf={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:NN(4,13),y:NN(5,14)};Mf.translateX=Mf.x;Mf.translateY=Mf.y;const h8=(n,e,t)=>{const s=e.measureViewportBox(),r=e.current,i=getComputedStyle(r),{display:o}=i,a={};o==="none"&&e.setStaticValue("display",n.display||"block"),t.forEach(u=>{a[u]=Mf[u](s,i)}),e.render();const c=e.measureViewportBox();return t.forEach(u=>{const d=e.getValue(u);d&&d.jump(a[u]),n[u]=Mf[u](c,i)}),n},f8=(n,e,t={},s={})=>{e={...e},s={...s};const r=Object.keys(e).filter(AD);let i=[],o=!1;const a=[];if(r.forEach(c=>{const u=n.getValue(c);if(!n.hasValue(c))return;let d=t[c],h=ip(d);const p=e[c];let m;if(Zb(p)){const y=p.length,g=p[0]===null?1:0;d=p[g],h=ip(d);for(let w=g;w<y&&p[w]!==null;w++)m?Fk(ip(p[w])===m):m=ip(p[w])}else m=ip(p);if(h!==m)if(TN(h)&&TN(m)){const y=u.get();typeof y=="string"&&u.set(parseFloat(y)),typeof p=="string"?e[c]=parseFloat(p):Array.isArray(p)&&m===de&&(e[c]=p.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||p===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(p):(o||(i=d8(n),o=!0),a.push(c),s[c]=s[c]!==void 0?s[c]:e[c],u.jump(p))}),a.length){const c=a.indexOf("height")>=0?window.pageYOffset:null,u=h8(e,n,a);return i.length&&i.forEach(([d,h])=>{n.getValue(d).set(h)}),n.render(),L1&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:s}}else return{target:e,transitionEnd:s}};function p8(n,e,t,s){return l8(e)?f8(n,e,t,s):{target:e,transitionEnd:s}}const m8=(n,e,t,s)=>{const r=o8(n,e,s);return e=r.target,s=r.transitionEnd,p8(n,e,t,s)},NA={current:null},ED={current:!1};function g8(){if(ED.current=!0,!!L1)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>NA.current=n.matches;n.addListener(e),e()}else NA.current=!1}function y8(n,e,t){const{willChange:s}=e;for(const r in e){const i=e[r],o=t[r];if(ds(i))n.addValue(r,i),sx(s)&&s.add(r);else if(ds(o))n.addValue(r,jf(i,{owner:n})),sx(s)&&s.remove(r);else if(o!==i)if(n.hasValue(r)){const a=n.getValue(r);!a.hasAnimated&&a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,jf(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const RN=new WeakMap,CD=Object.keys(Tm),v8=CD.length,jN=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],b8=Pk.length;class x8{constructor({parent:e,props:t,presenceContext:s,reducedMotionConfig:r,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>it.render(this.render,!1,!0);const{latestValues:a,renderState:c}=i;this.latestValues=a,this.baseTarget={...a},this.initialValues=t.initial?{...a}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=D1(t),this.isVariantNode=uI(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(t,{});for(const h in d){const p=d[h];a[h]!==void 0&&ds(p)&&(p.set(a[h],!1),sx(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,RN.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,s)=>this.bindToMotionValue(s,t)),ED.current||g8(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:NA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){RN.delete(this.current),this.projection&&this.projection.unmount(),jo(this.notifyUpdate),jo(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const s=Nu.has(e),r=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&it.update(this.notifyUpdate,!1,!0),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...t},s,r,i){let o,a;for(let c=0;c<v8;c++){const u=CD[c],{isEnabled:d,Feature:h,ProjectionNode:p,MeasureLayout:m}=Tm[u];p&&(o=p),d(t)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(a=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:p,layoutRoot:m}=t;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&ad(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:p,layoutRoot:m})}return a}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):It()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e,t=!0){return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let s=0;s<jN.length;s++){const r=jN[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i=e["on"+r];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=y8(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const t={};for(let s=0;s<b8;s++){const r=Pk[s],i=this.props[r];(km(i)||i===!1)&&(t[r]=i)}return t}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&t!==void 0&&(s=jf(t,{owner:this}),this.addValue(e,s)),s}readValue(e){var t;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(t=this.getBaseTargetFromProps(this.props,e))!==null&&t!==void 0?t:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:s}=this.props,r=typeof s=="string"||typeof s=="object"?(t=Ok(this.props,s))===null||t===void 0?void 0:t[e]:void 0;if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!ds(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Wk),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class kD extends x8{sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:s}){delete t[e],delete s[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:t,...s},{transformValues:r},i){let o=OU(s,e||{},this);if(r&&(t&&(t=r(t)),s&&(s=r(s)),o&&(o=r(o))),i){IU(this,s,o);const a=m8(this,s,o,t);t=a.transitionEnd,s=a.target}return{transition:e,transitionEnd:t,...s}}}function w8(n){return window.getComputedStyle(n)}class S8 extends kD{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(Nu.has(t)){const s=Vk(t);return s&&s.default||0}else{const s=w8(e),r=(pI(t)?s.getPropertyValue(t):s[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return pD(e,t)}build(e,t,s,r){jk(e,t,s,r.transformTemplate)}scrapeMotionValuesFromProps(e,t){return Dk(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ds(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}renderInstance(e,t,s,r){xI(e,t,s,r)}}class _8 extends kD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Nu.has(t)){const s=Vk(t);return s&&s.default||0}return t=wI.has(t)?t:kk(t),e.getAttribute(t)}measureInstanceViewportBox(){return It()}scrapeMotionValuesFromProps(e,t){return _I(e,t)}build(e,t,s,r){Lk(e,t,s,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,s,r){SI(e,t,s,r)}mount(e){this.isSVGTag=Ik(e.tagName),super.mount(e)}}const A8=(n,e)=>Rk(n)?new _8(e,{enableHardwareAcceleration:!1}):new S8(e,{enableHardwareAcceleration:!0}),E8={layout:{ProjectionNode:_D,MeasureLayout:gD}},C8={...JU,...vV,...s8,...E8},se=kz((n,e)=>iV(n,e,C8,A8));function TD(){const n=A.useRef(!1);return Ck(()=>(n.current=!0,()=>{n.current=!1}),[]),n}function k8(){const n=TD(),[e,t]=A.useState(0),s=A.useCallback(()=>{n.current&&t(e+1)},[e]);return[A.useCallback(()=>it.postRender(s),[s]),e]}class T8 extends A.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function P8({children:n,isPresent:e}){const t=A.useId(),s=A.useRef(null),r=A.useRef({width:0,height:0,top:0,left:0});return A.useInsertionEffect(()=>{const{width:i,height:o,top:a,left:c}=r.current;if(e||!s.current||!i||!o)return;s.current.dataset.motionPopId=t;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),A.createElement(T8,{isPresent:e,childRef:s,sizeRef:r},A.cloneElement(n,{ref:s}))}const WS=({children:n,initial:e,isPresent:t,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o})=>{const a=AI(N8),c=A.useId(),u=A.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:d=>{a.set(d,!0);for(const h of a.values())if(!h)return;s&&s()},register:d=>(a.set(d,!1),()=>a.delete(d))}),i?void 0:[t]);return A.useMemo(()=>{a.forEach((d,h)=>a.set(h,!1))},[t]),A.useEffect(()=>{!t&&!a.size&&s&&s()},[t]),o==="popLayout"&&(n=A.createElement(P8,{isPresent:t},n)),A.createElement(M1.Provider,{value:u},n)};function N8(){return new Map}function R8(n){return A.useEffect(()=>()=>n(),[])}const Tl=n=>n.key||"";function j8(n,e){n.forEach(t=>{const s=Tl(t);e.set(s,t)})}function M8(n){const e=[];return A.Children.forEach(n,t=>{A.isValidElement(t)&&e.push(t)}),e}const Co=({children:n,custom:e,initial:t=!0,onExitComplete:s,exitBeforeEnter:r,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=A.useContext(Nk).forceRender||k8()[0],c=TD(),u=M8(n);let d=u;const h=A.useRef(new Map).current,p=A.useRef(d),m=A.useRef(new Map).current,y=A.useRef(!0);if(Ck(()=>{y.current=!1,j8(u,m),p.current=d}),R8(()=>{y.current=!0,m.clear(),h.clear()}),y.current)return A.createElement(A.Fragment,null,d.map(b=>A.createElement(WS,{key:Tl(b),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:i,mode:o},b)));d=[...d];const g=p.current.map(Tl),w=u.map(Tl),v=g.length;for(let b=0;b<v;b++){const S=g[b];w.indexOf(S)===-1&&!h.has(S)&&h.set(S,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((b,S)=>{if(w.indexOf(S)!==-1)return;const E=m.get(S);if(!E)return;const k=g.indexOf(S);let T=b;if(!T){const P=()=>{h.delete(S);const N=Array.from(m.keys()).filter(M=>!w.includes(M));if(N.forEach(M=>m.delete(M)),p.current=u.filter(M=>{const L=Tl(M);return L===S||N.includes(L)}),!h.size){if(c.current===!1)return;a(),s&&s()}};T=A.createElement(WS,{key:Tl(E),isPresent:!1,onExitComplete:P,custom:e,presenceAffectsLayout:i,mode:o},E),h.set(S,T)}d.splice(k,0,T)}),d=d.map(b=>{const S=b.key;return h.has(S)?b:A.createElement(WS,{key:Tl(b),isPresent:!0,presenceAffectsLayout:i,mode:o},b)}),A.createElement(A.Fragment,null,h.size?d:d.map(b=>A.cloneElement(b)))},L8=zL("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),xe=A.forwardRef(({className:n,variant:e,size:t,asChild:s=!1,...r},i)=>{const o=s?E5:"button";return f.jsx(o,{className:zr(L8({variant:e,size:t,className:n})),ref:i,...r})});xe.displayName="Button";const I8="modulepreload",D8=function(n){return"/"+n},MN={},Do=function(e,t,s){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=D8(i),i in MN)return;MN[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let d=r.length-1;d>=0;d--){const h=r[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":I8,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},O8=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Do(()=>Promise.resolve().then(()=>Ty),void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Kk extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class LN extends Kk{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class IN extends Kk{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class DN extends Kk{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var RA;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(RA||(RA={}));var F8=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};class B8{constructor(e,{headers:t={},customFetch:s,region:r=RA.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=O8(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return F8(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:o,signal:a}=t;let c={},{region:u}=t;u||(u=this.region);const d=new URL(`${this.url}/${e}`);u&&u!=="any"&&(c["x-region"]=u,d.searchParams.set("forceFunctionRegion",u));let h;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(c["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(c["Content-Type"]="application/json",h=JSON.stringify(o)));const p=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),r),body:h,signal:a}).catch(w=>{throw w.name==="AbortError"?w:new LN(w)}),m=p.headers.get("x-relay-error");if(m&&m==="true")throw new IN(p);if(!p.ok)throw new DN(p);let y=((s=p.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),g;return y==="application/json"?g=yield p.json():y==="application/octet-stream"?g=yield p.blob():y==="text/event-stream"?g=p:y==="multipart/form-data"?g=yield p.formData():g=yield p.text(),{data:g,error:null,response:p}}catch(r){return r instanceof Error&&r.name==="AbortError"?{data:null,error:new LN(r)}:{data:null,error:r,response:r instanceof DN||r instanceof IN?r.context:void 0}}})}}var os={},Xk={},$1={},ky={},z1={},V1={},$8=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Lf=$8();const z8=Lf.fetch,V8=Lf.fetch.bind(Lf),U8=Lf.Headers,H8=Lf.Request,G8=Lf.Response,Ty=Object.freeze(Object.defineProperty({__proto__:null,Headers:U8,Request:H8,Response:G8,default:V8,fetch:z8},Symbol.toStringTag,{value:"Module"})),q8=Q3(Ty);var U1={};Object.defineProperty(U1,"__esModule",{value:!0});let W8=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};U1.default=W8;var PD=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(V1,"__esModule",{value:!0});const K8=PD(q8),X8=PD(U1);let Y8=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=K8.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,c,u;let d=null,h=null,p=null,m=i.status,y=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?h=b:h=JSON.parse(b))}const w=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),v=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");w&&v&&v.length>1&&(p=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,m=406,y="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const w=await i.text();try{d=JSON.parse(w),Array.isArray(d)&&i.status===404&&(h=[],d=null,m=200,y="OK")}catch{i.status===404&&w===""?(m=204,y="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,m=200,y="OK"),d&&this.shouldThrowOnError)throw new X8.default(d)}return{error:d,data:h,count:p,status:m,statusText:y}});return this.shouldThrowOnError||(r=r.catch(i=>{var o,a,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};V1.default=Y8;var Q8=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(z1,"__esModule",{value:!0});const J8=Q8(V1);let Z8=class extends J8.default{select(e){let t=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:o="text"}={}){var a;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};z1.default=Z8;var eH=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ky,"__esModule",{value:!0});const tH=eH(z1);let nH=class extends tH.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};ky.default=nH;var sH=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($1,"__esModule",{value:!0});const ap=sH(ky);let rH=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new ap.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var r;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new ap.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){var o;const a="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ap.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var s;const r="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new ap.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new ap.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};$1.default=rH;var ND=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xk,"__esModule",{value:!0});const iH=ND($1),oH=ND(ky);let aH=class RD{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new iH.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new RD(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const c=new URL(`${this.url}/rpc/${e}`);let u;s||r?(a=s?"HEAD":"GET",Object.entries(t).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{c.searchParams.append(h,p)})):(a="POST",u=t);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new oH.default({method:a,url:c,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Xk.default=aH;var Vf=Rn&&Rn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(os,"__esModule",{value:!0});os.PostgrestError=os.PostgrestBuilder=os.PostgrestTransformBuilder=os.PostgrestFilterBuilder=os.PostgrestQueryBuilder=os.PostgrestClient=void 0;const jD=Vf(Xk);os.PostgrestClient=jD.default;const MD=Vf($1);os.PostgrestQueryBuilder=MD.default;const LD=Vf(ky);os.PostgrestFilterBuilder=LD.default;const ID=Vf(z1);os.PostgrestTransformBuilder=ID.default;const DD=Vf(V1);os.PostgrestBuilder=DD.default;const OD=Vf(U1);os.PostgrestError=OD.default;var lH=os.default={PostgrestClient:jD.default,PostgrestQueryBuilder:MD.default,PostgrestFilterBuilder:LD.default,PostgrestTransformBuilder:ID.default,PostgrestBuilder:DD.default,PostgrestError:OD.default};const{PostgrestClient:cH,PostgrestQueryBuilder:bK,PostgrestFilterBuilder:xK,PostgrestTransformBuilder:wK,PostgrestBuilder:SK,PostgrestError:_K}=lH;class uH{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const s=t.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const dH="2.15.6",hH=`realtime-js/${dH}`,fH="1.0.0",jA=1e4,pH=1e3,mH=100;var im;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(im||(im={}));var zt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(zt||(zt={}));var Ir;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Ir||(Ir={}));var MA;(function(n){n.websocket="websocket"})(MA||(MA={}));var jl;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(jl||(jl={}));class gH{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+r));o=o+r;const c=s.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:u}}}class FD{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ze||(Ze={}));const ON=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=yH(o,n,e,r),i),{}):{}},yH=(n,e,t,s)=>{const r=e.find(a=>a.name===n),i=r==null?void 0:r.type,o=t[n];return i&&!s.includes(i)?BD(i,o):LA(o)},BD=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return wH(e,t)}switch(n){case Ze.bool:return vH(e);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return bH(e);case Ze.json:case Ze.jsonb:return xH(e);case Ze.timestamp:return SH(e);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return LA(e);default:return LA(e)}},LA=n=>n,vH=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},bH=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},xH=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},wH=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>BD(e,a))}return n},SH=n=>typeof n=="string"?n.replace(" ","T"):n,$D=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class KS{constructor(e,t,s={},r=jA){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var FN;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(FN||(FN={}));class om{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=om.syncState(this.state,r,i,o),this.pendingDiffs.forEach(c=>{this.state=om.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=om.syncDiff(this.state,r,i,o),a())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),o=this.transformState(t),a={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const p=d.map(w=>w.presence_ref),m=h.map(w=>w.presence_ref),y=d.filter(w=>m.indexOf(w.presence_ref)<0),g=h.filter(w=>p.indexOf(w.presence_ref)<0);y.length>0&&(a[u]=y),g.length>0&&(c[u]=g)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:c},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(a,c)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(c),d.length>0){const h=e[a].map(m=>m.presence_ref),p=d.filter(m=>h.indexOf(m.presence_ref)<0);e[a].unshift(...p)}s(a,d,c)}),this.map(o,(a,c)=>{let u=e[a];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[a]=u,r(a,u,c),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var BN;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(BN||(BN={}));var am;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(am||(am={}));var Ri;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Ri||(Ri={}));class Yk{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new KS(this,Ir.join,this.params,this.timeout),this.rejoinTimer=new FD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=zt.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ir.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new om(this),this.broadcastEndpointURL=$D(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==zt.closed){const{config:{broadcast:o,presence:a,private:c}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[am.PRESENCE]&&this.bindings[am.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},p={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(Ri.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(Ri.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var y;if(this.socket.setAuth(),m===void 0){e==null||e(Ri.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,w=(y=g==null?void 0:g.length)!==null&&y!==void 0?y:0,v=[];for(let b=0;b<w;b++){const S=g[b],{filter:{event:E,schema:k,table:T,filter:P}}=S,N=m&&m[b];if(N&&N.event===E&&N.schema===k&&N.table===T&&N.filter===P)v.push(Object.assign(Object.assign({},S),{id:N.id}));else{this.unsubscribe(),this.state=zt.errored,e==null||e(Ri.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Ri.SUBSCRIBED);return}}).receive("error",m=>{this.state=zt.errored,e==null||e(Ri.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ri.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===zt.joined&&e===am.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=zt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ir.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new KS(this,Ir.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=zt.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new KS(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>mH){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const o=e.toLocaleLowerCase(),{close:a,error:c,leave:u,join:d}=Ir;if(s&&[a,c,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(m=>{var y,g,w;return((y=m.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(g=m.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(m=>m.callback(p,s)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var y,g,w,v,b,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const E=m.id,k=(y=m.filter)===null||y===void 0?void 0:y.event;return E&&((g=t.ids)===null||g===void 0?void 0:g.includes(E))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const E=(b=(v=m==null?void 0:m.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return E==="*"||E===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:g,table:w,commit_timestamp:v,type:b,errors:S}=y;p=Object.assign(Object.assign({},{schema:g,table:w,commit_timestamp:v,eventType:b,new:{},old:{},errors:S}),this._getPayloadRecords(y))}m.callback(p,s)})}_isClosed(){return this.state===zt.closed}_isJoined(){return this.state===zt.joined}_isJoining(){return this.state===zt.joining}_isLeaving(){return this.state===zt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Yk.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ir.close,{},e)}_onError(e){this._on(Ir.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ON(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ON(e.columns,e.old_record)),t}}const XS=()=>{},dv={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},_H=[1e3,2e3,5e3,1e4],AH=1e4,EH=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class CH{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=jA,this.transport=null,this.heartbeatIntervalMs=dv.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=XS,this.ref=0,this.reconnectTimer=null,this.logger=XS,this.conn=null,this.sendBuffer=[],this.serializer=new gH,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let i;return r?i=r:typeof fetch>"u"?i=(...o)=>Do(()=>Promise.resolve().then(()=>Ty),void 0).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${MA.websocket}`,this.httpEndpoint=$D(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=uH.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fH}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case im.connecting:return jl.Connecting;case im.open:return jl.Open;case im.closing:return jl.Closing;default:return jl.Closed}}isConnected(){return this.connectionState()===jl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new Yk(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(pH,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},dv.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=t,a=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${r} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ir.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([EH],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const r={access_token:t,version:hH};t&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(Ir.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new FD(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},dv.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,i,o,a,c,u,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:jA,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:dv.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:XS,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:h=>_H[h-1]||AH,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(h,p)=>p(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Qk extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Gt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class kH extends Qk{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class IA extends Qk{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var TH=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};const zD=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Do(()=>Promise.resolve().then(()=>Ty),void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},PH=()=>TH(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Do(()=>Promise.resolve().then(()=>Ty),void 0)).Response:Response}),DA=n=>{if(Array.isArray(n))return n.map(t=>DA(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=DA(s)}),e},NH=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var ju=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};const YS=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),RH=(n,e,t)=>ju(void 0,void 0,void 0,function*(){const s=yield PH();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{const i=n.status||500,o=(r==null?void 0:r.statusCode)||i+"";e(new kH(YS(r),i,o))}).catch(r=>{e(new IA(YS(r),r))}):e(new IA(YS(n),n))}),jH=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?r:(NH(s)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),t))};function Py(n,e,t,s,r,i){return ju(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,jH(e,s,r,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>RH(c,a,s))})})}function ix(n,e,t,s){return ju(this,void 0,void 0,function*(){return Py(n,"GET",e,t,s)})}function Xr(n,e,t,s,r){return ju(this,void 0,void 0,function*(){return Py(n,"POST",e,s,r,t)})}function OA(n,e,t,s,r){return ju(this,void 0,void 0,function*(){return Py(n,"PUT",e,s,r,t)})}function MH(n,e,t,s){return ju(this,void 0,void 0,function*(){return Py(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function VD(n,e,t,s,r){return ju(this,void 0,void 0,function*(){return Py(n,"DELETE",e,s,r,t)})}var Ln=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};const LH={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$N={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IH{constructor(e,t={},s,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=zD(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,r){return Ln(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},$N),r);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),r!=null&&r.headers&&(a=Object.assign(Object.assign({},a),r.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield(e=="PUT"?OA:Xr)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Gt(i))return{data:null,error:i};throw i}})}upload(e,t,s){return Ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return Ln(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let c;const u=Object.assign({upsert:$N.upsert},r),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield OA(this.fetch,a.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Gt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return Ln(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const i=yield Xr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Qk("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s))return{data:null,error:s};throw s}})}update(e,t,s){return Ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Ln(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gt(r))return{data:null,error:r};throw r}})}copy(e,t,s){return Ln(this,void 0,void 0,function*(){try{return{data:{path:(yield Xr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gt(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return Ln(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield Xr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gt(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return Ln(this,void 0,void 0,function*(){try{const r=yield Xr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gt(r))return{data:null,error:r};throw r}})}download(e,t){return Ln(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ix(this.fetch,`${this.url}/${r}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Gt(a))return{data:null,error:a};throw a}})}info(e){return Ln(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield ix(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:DA(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s))return{data:null,error:s};throw s}})}exists(e){return Ln(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield MH(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s)&&s instanceof IA){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&r.push(c);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${u}`)}}}remove(e){return Ln(this,void 0,void 0,function*(){try{return{data:yield VD(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gt(t))return{data:null,error:t};throw t}})}list(e,t,s){return Ln(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},LH),t),{prefix:e||""});return{data:yield Xr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gt(r))return{data:null,error:r};throw r}})}listV2(e,t){return Ln(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Xr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const DH="2.12.1",OH={"X-Client-Info":`storage-js/${DH}`};var Ou=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};class FH{constructor(e,t={},s,r){this.shouldThrowOnError=!1;const i=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},OH),t),this.fetch=zD(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ou(this,void 0,void 0,function*(){try{return{data:yield ix(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Gt(e))return{data:null,error:e};throw e}})}getBucket(e){return Ou(this,void 0,void 0,function*(){try{return{data:yield ix(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ou(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ou(this,void 0,void 0,function*(){try{return{data:yield OA(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Gt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ou(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ou(this,void 0,void 0,function*(){try{return{data:yield VD(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gt(t))return{data:null,error:t};throw t}})}}class BH extends FH{constructor(e,t={},s,r){super(e,t,s,r)}from(e){return new IH(this.url,this.headers,e,this.fetch)}}const $H="2.30.0",zH={"X-Client-Info":`supabase-js/${$H}`};var FA={exports:{}};(function(n,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Rn<"u"&&Rn,s=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Rn<"u"&&Rn||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(R){return R&&DataView.prototype.isPrototypeOf(R)}if(c.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(R){return R&&d.indexOf(Object.prototype.toString.call(R))>-1};function p(R){if(typeof R!="string"&&(R=String(R)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(R)||R==="")throw new TypeError('Invalid character in header field name: "'+R+'"');return R.toLowerCase()}function m(R){return typeof R!="string"&&(R=String(R)),R}function y(R){var j={next:function(){var F=R.shift();return{done:F===void 0,value:F}}};return c.iterable&&(j[Symbol.iterator]=function(){return j}),j}function g(R){this.map={},R instanceof g?R.forEach(function(j,F){this.append(F,j)},this):Array.isArray(R)?R.forEach(function(j){if(j.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+j.length);this.append(j[0],j[1])},this):R&&Object.getOwnPropertyNames(R).forEach(function(j){this.append(j,R[j])},this)}g.prototype.append=function(R,j){R=p(R),j=m(j);var F=this.map[R];this.map[R]=F?F+", "+j:j},g.prototype.delete=function(R){delete this.map[p(R)]},g.prototype.get=function(R){return R=p(R),this.has(R)?this.map[R]:null},g.prototype.has=function(R){return this.map.hasOwnProperty(p(R))},g.prototype.set=function(R,j){this.map[p(R)]=m(j)},g.prototype.forEach=function(R,j){for(var F in this.map)this.map.hasOwnProperty(F)&&R.call(j,this.map[F],F,this)},g.prototype.keys=function(){var R=[];return this.forEach(function(j,F){R.push(F)}),y(R)},g.prototype.values=function(){var R=[];return this.forEach(function(j){R.push(j)}),y(R)},g.prototype.entries=function(){var R=[];return this.forEach(function(j,F){R.push([F,j])}),y(R)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(R){if(!R._noBody){if(R.bodyUsed)return Promise.reject(new TypeError("Already read"));R.bodyUsed=!0}}function v(R){return new Promise(function(j,F){R.onload=function(){j(R.result)},R.onerror=function(){F(R.error)}})}function b(R){var j=new FileReader,F=v(j);return j.readAsArrayBuffer(R),F}function S(R){var j=new FileReader,F=v(j),$=/charset=([A-Za-z0-9_-]+)/.exec(R.type),z=$?$[1]:"utf-8";return j.readAsText(R,z),F}function E(R){for(var j=new Uint8Array(R),F=new Array(j.length),$=0;$<j.length;$++)F[$]=String.fromCharCode(j[$]);return F.join("")}function k(R){if(R.slice)return R.slice(0);var j=new Uint8Array(R.byteLength);return j.set(new Uint8Array(R)),j.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(R){this.bodyUsed=this.bodyUsed,this._bodyInit=R,R?typeof R=="string"?this._bodyText=R:c.blob&&Blob.prototype.isPrototypeOf(R)?this._bodyBlob=R:c.formData&&FormData.prototype.isPrototypeOf(R)?this._bodyFormData=R:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)?this._bodyText=R.toString():c.arrayBuffer&&c.blob&&u(R)?(this._bodyArrayBuffer=k(R.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(R)||h(R))?this._bodyArrayBuffer=k(R):this._bodyText=R=Object.prototype.toString.call(R):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof R=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var R=w(this);if(R)return R;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var R=w(this);return R||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(b);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var R=w(this);if(R)return R;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(E(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}var P=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function N(R){var j=R.toUpperCase();return P.indexOf(j)>-1?j:R}function M(R,j){if(!(this instanceof M))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');j=j||{};var F=j.body;if(R instanceof M){if(R.bodyUsed)throw new TypeError("Already read");this.url=R.url,this.credentials=R.credentials,j.headers||(this.headers=new g(R.headers)),this.method=R.method,this.mode=R.mode,this.signal=R.signal,!F&&R._bodyInit!=null&&(F=R._bodyInit,R.bodyUsed=!0)}else this.url=String(R);if(this.credentials=j.credentials||this.credentials||"same-origin",(j.headers||!this.headers)&&(this.headers=new g(j.headers)),this.method=N(j.method||this.method||"GET"),this.mode=j.mode||this.mode||null,this.signal=j.signal||this.signal||function(){if("AbortController"in a){var B=new AbortController;return B.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&F)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(F),(this.method==="GET"||this.method==="HEAD")&&(j.cache==="no-store"||j.cache==="no-cache")){var $=/([?&])_=[^&]*/;if($.test(this.url))this.url=this.url.replace($,"$1_="+new Date().getTime());else{var z=/\?/;this.url+=(z.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}M.prototype.clone=function(){return new M(this,{body:this._bodyInit})};function L(R){var j=new FormData;return R.trim().split("&").forEach(function(F){if(F){var $=F.split("="),z=$.shift().replace(/\+/g," "),B=$.join("=").replace(/\+/g," ");j.append(decodeURIComponent(z),decodeURIComponent(B))}}),j}function O(R){var j=new g,F=R.replace(/\r?\n[\t ]+/g," ");return F.split("\r").map(function($){return $.indexOf(`
`)===0?$.substr(1,$.length):$}).forEach(function($){var z=$.split(":"),B=z.shift().trim();if(B){var H=z.join(":").trim();try{j.append(B,H)}catch(U){console.warn("Response "+U.message)}}}),j}T.call(M.prototype);function D(R,j){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(j||(j={}),this.type="default",this.status=j.status===void 0?200:j.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=j.statusText===void 0?"":""+j.statusText,this.headers=new g(j.headers),this.url=j.url||"",this._initBody(R)}T.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},D.error=function(){var R=new D(null,{status:200,statusText:""});return R.ok=!1,R.status=0,R.type="error",R};var V=[301,302,303,307,308];D.redirect=function(R,j){if(V.indexOf(j)===-1)throw new RangeError("Invalid status code");return new D(null,{status:j,headers:{location:R}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(j,F){this.message=j,this.name=F;var $=Error(j);this.stack=$.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function I(R,j){return new Promise(function(F,$){var z=new M(R,j);if(z.signal&&z.signal.aborted)return $(new o.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function H(){B.abort()}B.onload=function(){var Q={statusText:B.statusText,headers:O(B.getAllResponseHeaders()||"")};z.url.indexOf("file://")===0&&(B.status<200||B.status>599)?Q.status=200:Q.status=B.status,Q.url="responseURL"in B?B.responseURL:Q.headers.get("X-Request-URL");var ge="response"in B?B.response:B.responseText;setTimeout(function(){F(new D(ge,Q))},0)},B.onerror=function(){setTimeout(function(){$(new TypeError("Network request failed"))},0)},B.ontimeout=function(){setTimeout(function(){$(new TypeError("Network request timed out"))},0)},B.onabort=function(){setTimeout(function(){$(new o.DOMException("Aborted","AbortError"))},0)};function U(Q){try{return Q===""&&a.location.href?a.location.href:Q}catch{return Q}}if(B.open(z.method,U(z.url),!0),z.credentials==="include"?B.withCredentials=!0:z.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&(c.blob?B.responseType="blob":c.arrayBuffer&&(B.responseType="arraybuffer")),j&&typeof j.headers=="object"&&!(j.headers instanceof g||a.Headers&&j.headers instanceof a.Headers)){var Y=[];Object.getOwnPropertyNames(j.headers).forEach(function(Q){Y.push(p(Q)),B.setRequestHeader(Q,m(j.headers[Q]))}),z.headers.forEach(function(Q,ge){Y.indexOf(ge)===-1&&B.setRequestHeader(ge,Q)})}else z.headers.forEach(function(Q,ge){B.setRequestHeader(ge,Q)});z.signal&&(z.signal.addEventListener("abort",H),B.onreadystatechange=function(){B.readyState===4&&z.signal.removeEventListener("abort",H)}),B.send(typeof z._bodyInit>"u"?null:z._bodyInit)})}return I.polyfill=!0,a.fetch||(a.fetch=I,a.Headers=g,a.Request=M,a.Response=D),o.Headers=g,o.Request=M,o.Response=D,o.fetch=I,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var r=t.fetch?t:s;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,n.exports=e})(FA,FA.exports);var Jk=FA.exports;const UD=u1(Jk),VH=ZR({__proto__:null,default:UD},[Jk]);var UH=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};const HH=n=>{let e;return n?e=n:typeof fetch>"u"?e=UD:e=fetch,(...t)=>e(...t)},GH=()=>typeof Headers>"u"?Jk.Headers:Headers,qH=(n,e,t)=>{const s=HH(t),r=GH();return(i,o)=>UH(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:n;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:u}))})};function WH(n){return n.replace(/\/$/,"")}function KH(n,e){const{db:t,auth:s,realtime:r,global:i}=n,{db:o,auth:a,realtime:c,global:u}=e;return{db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},c),r),global:Object.assign(Object.assign({},u),i)}}function XH(n){return Math.round(Date.now()/1e3)+n}function YH(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ci=()=>typeof document<"u",bl={tested:!1,writable:!1},qv=()=>{if(!Ci())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(bl.tested)return bl.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),bl.tested=!0,bl.writable=!0}catch{bl.tested=!0,bl.writable=!1}return bl.writable};function Kn(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),r=s.exec(e);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}const HD=n=>{let e;return n?e=n:typeof fetch>"u"?e=async(...t)=>await(await Do(()=>Promise.resolve().then(()=>VH),void 0)).fetch(...t):e=fetch,(...t)=>e(...t)},QH=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",lp=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},hv=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},QS=async(n,e)=>{await n.removeItem(e)};function JH(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,r,i,o,a,c,u,d=0;for(n=n.replace("-","+").replace("_","/");d<n.length;)o=e.indexOf(n.charAt(d++)),a=e.indexOf(n.charAt(d++)),c=e.indexOf(n.charAt(d++)),u=e.indexOf(n.charAt(d++)),s=o<<2|a>>4,r=(a&15)<<4|c>>2,i=(c&3)<<6|u,t=t+String.fromCharCode(s),c!=64&&r!=0&&(t=t+String.fromCharCode(r)),u!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class H1{constructor(){this.promise=new H1.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}H1.promiseConstructor=Promise;function zN(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(JH(s))}function ZH(n){return new Promise(e=>{setTimeout(()=>e(null),n)})}function eG(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function tG(n){return("0"+n.toString(16)).substr(-2)}function fv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,tG).join("")}async function nG(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}function sG(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pv(n){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const e=await nG(n);return sG(e)}const rG="__stack_guard__",iG="__",oG=/__stack_guard__([a-zA-Z0-9_-]+)__/;let VN=!1,Zk;function BA(n){var e,t;Zk();let s;try{throw new Error}catch(i){s=i}const r=(t=(e=s.stack)===null||e===void 0?void 0:e.split(`
`))!==null&&t!==void 0?t:[];for(let i=0;i<r.length;i+=1){const a=r[i].match(oG);if(a&&a[1]===n)return!0}return!1}async function $A(n,e){await Zk();const t=`${rG}${n}${iG}`;return await{[t]:async()=>await e()}[t]()}Zk=async()=>{VN||(VN=!0,await $A("ENV_CHECK",async()=>{const n=BA("ENV_CHECK");return n||console.warn("@supabase/gotrue-js: Stack guards not supported in this environment. Generally not an issue but may point to a very conservative transpilation environment (use ES2017 or above) that implements async/await with generators, or this is a JavaScript engine that does not support async/await stack traces."),n}))};class eT extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function Le(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class aG extends eT{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function lG(n){return Le(n)&&n.name==="AuthApiError"}class GD extends eT{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Uf extends eT{constructor(e,t,s){super(e),this.name=t,this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Fu extends Uf{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class JS extends Uf{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class mv extends Uf{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Ei extends Uf{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ZS extends Uf{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class zA extends Uf{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function UN(n){return Le(n)&&n.name==="AuthRetryableFetchError"}var cG=globalThis&&globalThis.__rest||function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const Sp=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),uG=[502,503,504];async function HN(n){if(!QH(n))throw new zA(Sp(n),0);if(uG.includes(n.status))throw new zA(Sp(n),n.status);let e;try{e=await n.json()}catch(t){throw new GD(Sp(t),t)}throw new aG(Sp(e),n.status||500)}const dG=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function Fe(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await hG(n,e,t+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function hG(n,e,t,s,r,i){const o=dG(e,s,r,i);let a;try{a=await n(t,o)}catch(c){throw console.error(c),new zA(Sp(c),0)}if(a.ok||await HN(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(c){await HN(c)}}function zo(n){var e;let t=null;gG(n)&&(t=Object.assign({},n),t.expires_at=XH(n.expires_in));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function Ml(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function fG(n){return{data:n,error:null}}function pG(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,o=cG(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},c=Object.assign({},o);return{data:{properties:a,user:c},error:null}}function mG(n){return n}function gG(n){return n.access_token&&n.refresh_token&&n.expires_in}var yG=globalThis&&globalThis.__rest||function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class vG{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=HD(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await Fe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ml})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=yG(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await Fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:pG,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Fe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ml})}catch(t){if(Le(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,o,a,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:mG});if(d.error)throw d.error;const h=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Le(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await Fe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ml})}catch(t){if(Le(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Fe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ml})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await Fe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ml})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await Fe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(Le(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Fe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Le(t))return{data:null,error:t};throw t}}}const bG="2.43.1",xG="http://localhost:9999",wG="supabase.auth.token",SG={"X-Client-Info":`gotrue-js/${bG}`},GN=10,qN={getItem:n=>qv()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{qv()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{qv()&&globalThis.localStorage.removeItem(n)}};function _G(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}_G();const AG={url:xG,storageKey:wG,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:SG,flowType:"implicit",debug:!1},gv=30*1e3,WN=3;class Nm{constructor(e){var t;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=Nm.nextInstanceID,Nm.nextInstanceID+=1,this.instanceID>0&&Ci()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},AG),e);if(this.logDebugMessages=s.debug,this.inMemorySession=null,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.persistSession=s.persistSession,this.storage=s.storage||qN,this.admin=new vG({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=HD(s.fetch),this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===qN&&!qv()&&console.warn(`No storage option exists to persist the session, which may result in unexpected behavior when using auth.
        If you want to set persistSession to true, please provide a storage option or you may set persistSession to false to disable this warning.`),Ci()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&console.log(`GoTrueClient@${this.instanceID} ${new Date().toISOString()}`,...e),this}initialize(){return this.initializePromise?this.initializePromise:this._initialize()}async _initialize(){if(this.initializePromise)throw new Error("Double call of #_initialize()");return this.initializePromise=$A("_initialize",async()=>{try{const e=Ci()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromUrl(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),await this._removeSession(),{error:s};const{session:r,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Le(e)?{error:e}:{error:new GD("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}),await this.initializePromise}async signUp(e){var t,s,r;try{await this._removeSession();let i;if("email"in e){const{email:d,password:h,options:p}=e;let m=null,y=null;if(this.flowType==="pkce"){const g=fv();await lp(this.storage,`${this.storageKey}-code-verifier`,g),m=await pv(g),y=g===m?"plain":"s256"}i=await Fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:y},xform:zo})}else if("phone"in e){const{phone:d,password:h,options:p}=e;i=await Fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:zo})}else throw new mv("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Le(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:zo})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:zo})}else throw new mv("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new JS}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:{user:s.user,session:s.session},error:r})}catch(t){if(Le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){const t=await hv(this.storage,`${this.storageKey}-code-verifier`),{data:s,error:r}=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:zo});return await QS(this.storage,`${this.storageKey}-code-verifier`),r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new JS}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:r})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:s,token:r,access_token:i,nonce:o}=e,a=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:zo}),{data:c,error:u}=a;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new JS}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(t){if(Le(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:c}=e;let u=null,d=null;if(this.flowType==="pkce"){const p=fv();await lp(this.storage,`${this.storageKey}-code-verifier`,p),u=await pv(p),d=p===u?"plain":"s256"}const{error:h}=await Fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:c}=e,{data:u,error:d}=await Fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new mv("You must provide either an email or phone number.")}catch(a){if(Le(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();const{data:r,error:i}=await Fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:(t=e.options)===null||t===void 0?void 0:t.captchaToken}}),redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,xform:zo});if(i)throw i;if(!r)throw new Error("An error occurred on token verification.");const o=r.session,a=r.user;return o!=null&&o.access_token&&(await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:a,session:o},error:null}}catch(r){if(Le(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{return await this._removeSession(),await Fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:fG})}catch(i){if(Le(i))return{data:null,error:i};throw i}}async reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Fu;const{error:r}=await Fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Le(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await Fe(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:a}=await Fe(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new mv("You must provide either an email or phone number and a type")}catch(t){if(Le(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return this._useSession(async e=>e)}async _useSession(e){return await $A("_useSession",async()=>{const t=await this.__loadSession();return await e(t)})}async __loadSession(){if(this._debug("#__loadSession()","begin"),this.logDebugMessages&&!BA("_useSession"))throw new Error("Please use #_useSession()");BA("_initialize")||await this.initializePromise;try{let e=null;if(this.persistSession){const i=await hv(this.storage,this.storageKey);this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession()))}else e=this.inMemorySession,this._debug("#getSession()","session from memory",e);if(!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t)return{data:{session:e},error:null};const{session:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){try{return await this._useSession(async t=>{var s,r;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0}return await Fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ml})})}catch(t){if(Le(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new Fu;const o=r.session,{data:a,error:c}=await Fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:e,jwt:o.access_token,xform:Ml});if(c)throw c;return o.user=a.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(Le(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return zN(e)}async setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Fu;const t=Date.now()/1e3;let s=t,r=!0,i=null;const o=zN(e.access_token);if(o.exp&&(s=o.exp,r=s<=t),r){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:c}=await this.getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Le(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Fu;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Le(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromUrl(e){try{if(!Ci())throw new Ei("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ei("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new ZS("Not a valid PKCE flow url.");if(e){const w=Kn("code");if(!w)throw new ZS("No code detected.");const{data:v,error:b}=await this.exchangeCodeForSession(w);if(b)throw b;if(!v.session)throw new ZS("No session detected.");let S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:v.session,redirectType:null},error:null}}const t=Kn("error_description");if(t){const w=Kn("error_code");if(!w)throw new Ei("No error_code detected.");const v=Kn("error");throw v?new Ei(t,{error:v,code:w}):new Ei("No error detected.")}const s=Kn("provider_token"),r=Kn("provider_refresh_token"),i=Kn("access_token");if(!i)throw new Ei("No access_token detected.");const o=Kn("expires_in");if(!o)throw new Ei("No expires_in detected.");const a=Kn("refresh_token");if(!a)throw new Ei("No refresh_token detected.");const c=Kn("token_type");if(!c)throw new Ei("No token_type detected.");const d=Math.round(Date.now()/1e3)+parseInt(o),{data:h,error:p}=await this.getUser(i);if(p)throw p;const m=h.user,y={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:parseInt(o),expires_at:d,refresh_token:a,token_type:c,user:m},g=Kn("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session:y,redirectType:g},error:null}}catch(t){if(Le(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){return Ci()&&(!!Kn("access_token")||!!Kn("error_description"))}async _isPKCEFlow(){const e=await hv(this.storage,`${this.storageKey}-code-verifier`);return!!Kn("code")&&!!e}async signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(lG(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await QS(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=YH(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),this._emitInitialSession(t),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;if(this.flowType==="pkce"){const i=fv();await lp(this.storage,`${this.storageKey}-code-verifier`,i),s=await pv(i),r=i===s?"plain":"s256"}try{return await Fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Le(i))return{data:null,error:i};throw i}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await eG(async r=>(await ZH(r*200),this._debug(t,"refreshing attempt",r),await Fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:zo})),(r,i,o)=>o&&o.error&&UN(o.error)&&Date.now()+(r+1)*200-s<gv)}catch(s){if(this._debug(t,"error",s),Le(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ci()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await hv(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+GN;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${GN}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),UN(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Fu;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new H1;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Fu;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(r,"error",i),Le(i)){const o={session:null,error:i};return(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.persistSession||(this.inMemorySession=e),this.persistSession&&e.expires_at&&await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),lp(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),this.persistSession?await QS(this.storage,this.storageKey):this.inMemorySession=null}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ci()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),gv);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),await this._autoRefreshTokenTick()}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/gv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${gv}ms, refresh threshold is ${WN} ticks`),r<=WN&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ci()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){this._debug(`#_onVisibilityChanged(${e})`,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(e||(await this.initializePromise,await this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){const s=[`provider=${encodeURIComponent(e)}`];if(t!=null&&t.redirectTo&&s.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&s.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const r=fv();await lp(this.storage,`${this.storageKey}-code-verifier`,r);const i=await pv(r),o=r===i?"plain":"s256";this._debug("PKCE","code verifier",`${r.substring(0,5)}...`,"code challenge",i,"method",o);const a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(t!=null&&t.queryParams){const r=new URLSearchParams(t.queryParams);s.push(r.toString())}return`${this.url}/authorize?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await Fe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Le(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:a,error:c}=await Fe(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(!((r=a==null?void 0:a.totp)===null||r===void 0)&&r.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(Le(t))return{data:null,error:t};throw t}}async _verify(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await Fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(Le(t))return{data:null,error:t};throw t}}async _challenge(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await Fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Le(t))return{data:null,error:t};throw t}}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:s,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return await this._useSession(async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let a=null;o.aal&&(a=o.aal);let c=a;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:d},error:null}})}}Nm.nextInstanceID=0;class EG extends Nm{constructor(e){super(e)}}var CG=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function c(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,c)}u((s=s.apply(n,e||[])).next())})};const kG={headers:zH},TG={schema:"public"},PG={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},NG={};class RG{constructor(e,t,s){var r,i,o,a,c,u,d,h;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const p=WH(e);this.realtimeUrl=`${p}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${p}/auth/v1`,this.storageUrl=`${p}/storage/v1`,this.functionsUrl=`${p}/functions/v1`;const m=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,y={db:TG,realtime:NG,auth:Object.assign(Object.assign({},PG),{storageKey:m}),global:kG},g=KH(s??{},y);this.storageKey=(i=(r=g.auth)===null||r===void 0?void 0:r.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=(o=g.global)===null||o===void 0?void 0:o.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((c=g.auth)!==null&&c!==void 0?c:{},this.headers,(u=g.global)===null||u===void 0?void 0:u.fetch),this.fetch=qH(t,this._getAccessToken.bind(this),(d=g.global)===null||d===void 0?void 0:d.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},g.realtime)),this.rest=new cH(`${p}/rest/v1`,{headers:this.headers,schema:(h=g.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new B8(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new BH(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}rpc(e,t={},s){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return CG(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:o,debug:a},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new EG({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:o,debug:a,fetch:u})}_initRealtimeClient(e){return new CH(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const jG=(n,e,t)=>new RG(n,e,t),xl=new Map,KN={type:"memory",getItem:n=>xl.has(n)?xl.get(n):null,setItem:(n,e)=>{xl.set(n,e)},removeItem:n=>{xl.delete(n)},clear:()=>xl.clear(),key:n=>Array.from(xl.keys())[n]??null,get length(){return xl.size}},XN={type:"cookie",getItem:n=>{if(typeof document>"u")return null;const e=document.cookie.match(new RegExp(`(?:^|; )${n}=([^;]*)`));return e?decodeURIComponent(e[1]):null},setItem:(n,e)=>{if(typeof document>"u")return;const t=encodeURIComponent(e);document.cookie=`${n}=${t}; path=/; SameSite=Lax`},removeItem:n=>{typeof document>"u"||(document.cookie=`${n}=; path=/; max-age=0; SameSite=Lax`)},clear:()=>{if(typeof document>"u")return;document.cookie.split(";").forEach(e=>{const[t]=e.split("=");document.cookie=`${t.trim()}=; path=/; max-age=0; SameSite=Lax`})},key:()=>null,get length(){return typeof document>"u"||!document.cookie?0:document.cookie.split(";").length}},YN=n=>{if(!n)return null;try{const e=`safe-storage-probe-${Math.random().toString(36).slice(2)}`;n.setItem(e,"ok");const t=n.getItem(e)==="ok";return n.removeItem(e),t?n:null}catch{return null}},MG=()=>{if(typeof window>"u")return{storage:KN,type:"memory"};const n=[{type:"local",ref:window.localStorage},{type:"session",ref:window.sessionStorage}];for(const t of n){const s=YN(t.ref);if(s)return{storage:s,type:t.type}}return YN(XN)?{storage:XN,type:"cookie"}:{storage:KN,type:"memory"}},qD=MG(),G1=qD.storage,LG=qD.type,tT=n=>{try{return G1.getItem(n)}catch{return null}},Rm=(n,e)=>{try{return G1.setItem(n,e),!0}catch{return!1}},WD=n=>{try{G1.removeItem(n)}catch{}},IG="https://ytubybkoucltwnselbhc.supabase.co",DG="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl0dWJ5YmtvdWNsdHduc2VsYmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1OTAwMDgsImV4cCI6MjA3NDE2NjAwOH0.hJuYwMc_MGgXIiXPC_3gSe3dRlU0SQ26-xDpC5y8QKo",nt=jG(IG,DG,{auth:{storage:G1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}}),KD=A.createContext(void 0),OG=({children:n})=>{const{toast:e}=Ek(),[t,s]=A.useState(null),[r,i]=A.useState(null),[o,a]=A.useState(!0),c=A.useCallback(async m=>{i(m),s((m==null?void 0:m.user)??null),a(!1)},[]);A.useEffect(()=>{if(typeof window>"u")return;let m=!1;return(async()=>{const g=new URL(window.location.href),w=new URLSearchParams(window.location.hash.replace(/^#/,"")),v=g.searchParams.get("code"),b=w.get("access_token"),S=w.get("refresh_token"),E=g.searchParams.get("error_description"),k=window.location.hash.includes("access_token")||window.location.hash.includes("refresh_token"),T=`${g.origin}${g.pathname}${k?"":g.hash}`,P=()=>{window.history.replaceState({},document.title,T)};if(E){e({variant:"destructive",title:"No pudimos iniciar sesin",description:E||"El enlace no es vlido. Intenta abrirlo en el navegador nativo."}),P();return}if(v){const{data:N,error:M}=await nt.auth.exchangeCodeForSession(v);m||(M?e({variant:"destructive",title:"No pudimos completar el login",description:M.message||"Intenta abrir el enlace en el navegador por defecto."}):c(N.session),P());return}if(b&&S){const{data:N,error:M}=await nt.auth.setSession({access_token:b,refresh_token:S});m||(M?e({variant:"destructive",title:"No pudimos completar el login",description:M.message||"Intenta abrir el enlace en el navegador por defecto."}):c(N.session),P())}})(),()=>{m=!0}},[c,e]),A.useEffect(()=>{(async()=>{const{data:{session:g}}=await nt.auth.getSession();c(g)})();const{data:{subscription:y}}=nt.auth.onAuthStateChange(async(g,w)=>{c(w)});return()=>y.unsubscribe()},[c]);const u=A.useCallback(async(m,y,g)=>{const{error:w}=await nt.auth.signUp({email:m,password:y,options:g});return w&&e({variant:"destructive",title:"Sign up Failed",description:w.message||"Something went wrong"}),{error:w}},[e]),d=A.useCallback(async(m,y)=>{const{error:g}=await nt.auth.signInWithPassword({email:m,password:y});return g&&e({variant:"destructive",title:"Sign in Failed",description:g.message||"Something went wrong"}),{error:g}},[e]),h=A.useCallback(async()=>{const{error:m}=await nt.auth.signOut();return m&&e({variant:"destructive",title:"Sign out Failed",description:m.message||"Something went wrong"}),{error:m}},[e]),p=A.useMemo(()=>({user:t,session:r,loading:o,signUp:u,signIn:d,signOut:h}),[t,r,o,u,d,h]);return A.useEffect(()=>{typeof window>"u"||r&&tT("gatoencerrado:resume-contribution")==="true"&&(window.dispatchEvent(new CustomEvent("gatoencerrado:resume-contribution")),WD("gatoencerrado:resume-contribution"))},[r]),f.jsx(KD.Provider,{value:p,children:n})},Ny=()=>{const n=A.useContext(KD);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},QN={hidden:{opacity:0},visible:{opacity:1}},FG={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1}},nT=({onClose:n})=>{const[e,t]=A.useState(""),[s,r]=A.useState(!1),[i,o]=A.useState(null),a=LG==="memory",c=A.useMemo(()=>{if(typeof window>"u")return;const{origin:h,pathname:p,hash:m}=window.location,y=m&&!m.includes("access_token")?m:"";return`${h}${p}${y}`},[]),u=A.useCallback(async h=>{if(h.preventDefault(),s)return;if(a){o({type:"error",text:"Tu navegador mvil est bloqueando almacenamiento. brelo en el navegador por defecto o desactiva el modo privado para iniciar sesin."});return}const p=e.trim();if(!p){o({type:"error",text:"Ingresa tu correo para enviarte el enlace mgico."});return}r(!0),o(null),Rm("gatoencerrado:resume-contribution","true");const{error:m}=await nt.auth.signInWithOtp({email:p,options:{emailRedirectTo:c}});m?o({type:"error",text:m.message||"No pudimos enviar el enlace."}):(o({type:"success",text:"Te enviamos un link mgico. Revisa tu correo para continuar."}),t("")),r(!1)},[e,s,c,a]),d=A.useCallback(async()=>{if(o(null),a){o({type:"error",text:"No pudimos iniciar sesin porque el navegador bloquea cookies/almacenamiento. Prueba abrir en Safari/Chrome fuera de modo privado."});return}Rm("gatoencerrado:resume-contribution","true");const{error:h}=await nt.auth.signInWithOAuth({provider:"google",options:{redirectTo:c}});if(h){o({type:"error",text:h.message||"No pudimos iniciar sesin con Google."});return}n==null||n()},[n,c,a]);return A.useEffect(()=>{const h=p=>{p.key==="Escape"&&(n==null||n())};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[n]),f.jsxs(se.div,{className:"fixed inset-0 z-[110] flex items-center justify-center px-4 py-6",initial:"hidden",animate:"visible",exit:"hidden",variants:QN,children:[f.jsx(se.button,{type:"button",className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:n,"aria-label":"Cerrar overlay de autenticacin",variants:QN}),f.jsxs(se.div,{role:"dialog","aria-modal":"true","aria-labelledby":"tracking-overlay-title","aria-describedby":"tracking-overlay-desc",className:"relative z-10 w-full max-w-md transform rounded-3xl border border-white/10 bg-[#0a0019]/90 p-6 shadow-2xl backdrop-blur-xl",initial:"hidden",animate:"visible",exit:"hidden",variants:FG,children:[f.jsx("button",{type:"button",onClick:n,className:"absolute top-3 right-3 rounded-full border border-white/15 px-2 py-1 text-sm text-slate-400 hover:text-slate-100","aria-label":"Cerrar overlay",children:""}),f.jsxs("div",{className:"space-y-4 pt-2",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-500/80",children:"Seguimiento"}),f.jsx("h3",{id:"tracking-overlay-title",className:"font-display text-2xl text-slate-50",children:"Inicia sesin para continuar el dilogo"})]}),f.jsx("p",{id:"tracking-overlay-desc",className:"text-sm text-slate-300 leading-relaxed",children:"Queremos asegurarnos de que puedas retomar tu experiencia justo donde la dejaste. Esto no genera ningn cargo ni suscripcin."}),f.jsx("button",{type:"button",onClick:d,className:"flex w-full items-center justify-center rounded-full border border-white/20 bg-white/10 px-4 py-3 text-sm font-semibold text-white transition hover:border-white/40 hover:bg-white/15",children:"Iniciar sesin con Google"}),a?f.jsx("p",{className:"text-xs text-amber-300",children:"Tu navegador est bloqueando almacenamiento; abre el sitio en Safari/Chrome (fuera de modo privado) para completar el login."}):null,f.jsxs("form",{onSubmit:u,className:"space-y-3",children:[f.jsx("label",{htmlFor:"tracking-email",className:"sr-only",children:"Correo electrnico"}),f.jsx("input",{id:"tracking-email",type:"email",value:e,onChange:h=>t(h.target.value),placeholder:"nombre@correo.com",className:"w-full rounded-2xl border border-white/20 bg-black/30 px-4 py-3 text-sm text-slate-100 placeholder:text-slate-400 focus:border-purple-400 focus:outline-none focus:ring-1 focus:ring-purple-400",required:!0}),f.jsx("button",{type:"submit",disabled:s,className:"w-full rounded-full bg-gradient-to-r from-purple-600/80 to-indigo-600/80 px-4 py-3 text-sm font-semibold text-white transition hover:from-purple-500 hover:to-indigo-500 disabled:cursor-not-allowed disabled:opacity-60",children:s?"Enviando...":"Enviar Magic Link"})]}),i?f.jsx("p",{className:`text-xs ${i.type==="error"?"text-rose-300":"text-emerald-300"}`,children:i.text}):null,f.jsx("p",{className:"text-xs text-slate-500",children:"Tu experienica no se perder. Continuars donde te quedaste."})]})]})]})},BG=()=>{var S,E;const[n,e]=A.useState(!1),[t,s]=A.useState(!1),[r,i]=A.useState(!1),{user:o,signOut:a}=Ny(),{toast:c}=Ek(),u=((S=o==null?void 0:o.user_metadata)==null?void 0:S.alias)||((E=o==null?void 0:o.user_metadata)==null?void 0:E.full_name)||(o!=null&&o.email?o.email.split("@")[0]:""),d=u?u.trim().split(/\s+/)[0]:"",h=o?`Hola ${d||"gato"}`:"",p=o?"Cerrar sesin":"Iniciar sesin",m=o?"bg-emerald-400":"bg-slate-600",y=A.useCallback(()=>i(!1),[]),g=A.useCallback(()=>i(!0),[]),w=A.useCallback(async()=>{if(!o){i(!0);return}const{error:k}=await a();c(k?{description:k.message||"No pudimos cerrar sesin. Intenta ms tarde."}:{description:"Sesin cerrada correctamente."})},[a,c,o]);A.useEffect(()=>{const k=()=>{s(window.scrollY>20)};return window.addEventListener("scroll",k),()=>window.removeEventListener("scroll",k)},[]);const v=[{name:"La Obra",href:"#about"},{name:"Equipo",href:"#team"},{name:"Miniversos",href:"#transmedia"},{name:"Textos",href:"#dialogo-critico"},{name:"Galera",href:"#instagram"},{name:"Funcin",href:"#next-show"}],b=k=>{e(!1);const T=document.querySelector(k);T&&T.scrollIntoView({behavior:"smooth"})};return f.jsxs(se.header,{initial:{y:-100},animate:{y:0},transition:{duration:.5,ease:"easeOut"},className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${t?"bg-black/60 backdrop-blur-lg border-b border-slate-100/10":"bg-transparent"}`,children:[f.jsxs("nav",{className:"container mx-auto px-6 py-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs(se.button,{type:"button",whileHover:{scale:1.05,textShadow:"0 0 8px rgba(233, 213, 255, 0.5)"},className:"flex items-center gap-3 cursor-pointer text-white",onClick:()=>b("#hero"),children:[f.jsx("span",{className:"font-display text-2xl font-bold text-gradient",children:"#GatoEncerrado"}),f.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${m}`}),o?f.jsx("span",{className:"text-sm md:text-base font-semibold tracking-tight text-white",children:h}):null]}),f.jsxs("div",{className:"hidden md:flex items-center space-x-1",children:[v.map(k=>f.jsx(se.button,{whileHover:{scale:1.05,color:"#e9d5ff"},onClick:()=>b(k.href),className:"text-slate-300 hover:text-white transition-colors font-medium px-4 py-2 rounded-md",children:k.name},k.name)),f.jsx(se.button,{whileHover:{scale:1.05,color:"#e9d5ff"},onClick:()=>b("#contact"),className:"text-slate-300 hover:text-white transition-colors font-medium px-4 py-2 rounded-md ml-4 border border-purple-300/30 hover:bg-purple-500/20",children:"Contacto"})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(xe,{variant:"ghost",size:"icon",className:"md:hidden text-slate-200",onClick:()=>e(!n),children:n?f.jsx(R1,{size:24}):f.jsx(k$,{size:24})}),f.jsx("button",{onClick:o?w:g,className:"hidden md:inline text-sm font-semibold text-slate-100",children:p})]})]}),n&&f.jsxs(se.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden mt-4 bg-black/80 backdrop-blur-md rounded-lg p-4 border border-slate-100/10",children:[v.map(k=>f.jsx("button",{onClick:()=>b(k.href),className:"block w-full text-left py-3 text-slate-200 hover:text-white transition-colors",children:k.name},k.name)),f.jsx("button",{onClick:()=>b("#contact"),className:"block w-full text-left py-3 text-slate-200 hover:text-white transition-colors mt-2 border-t border-slate-100/10",children:"Contacto"}),f.jsx("button",{onClick:o?w:g,className:"block w-full text-left py-3 text-slate-200 hover:text-white transition-colors mt-2",children:p})]})]}),r?f.jsx(nT,{onClose:y}):null]})},JN=["#f472b6","#a855f7","#facc15","#34d399"],$G=({seed:n})=>{const e=A.useMemo(()=>Array.from({length:12},(t,s)=>({left:Math.random()*100,delay:Math.random()*.2,color:JN[s%JN.length]})),[n]);return f.jsx("div",{className:"confetti-layer","aria-hidden":"true",children:e.map((t,s)=>f.jsx("span",{className:"confetti-piece",style:{left:`${t.left}%`,top:`${Math.random()*20}%`,backgroundColor:t.color,animationDelay:`${t.delay}s`}},`${n}-${s}`))})},zG=()=>{const[n,e]=A.useState([]),t=A.useCallback(()=>{const s=Date.now();e(r=>[...r,s]),setTimeout(()=>{e(r=>r.filter(i=>i!==s))},1100)},[]);return{bursts:n,fireConfetti:t}},VG="/assets/logoapp.png",_p=[{value:"reservaciones",label:"Informacin sobre reservaciones",description:"Accede a la lnea de reservaciones y consulta los paquetes que an quedan."},{value:"recordatorio",label:"Recordatorio de la funcin",description:"Recibe el aviso oficial justo antes de que abra la funcin en diciembre."}],UG="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Gato%20Encerrado%20%C2%B7%2028%20de%20diciembre&dates=20241228T210000Z/20241228T223000Z&details=Funci%C3%B3n%20especial%20en%20CEC&location=CECUT",HG={}.VITE_SMS_NUMBER||"+5215550112233",GG=encodeURIComponent("Recordarme la funcin #GatoEncerrado el 28 de diciembre en CECUT."),qG=[{id:"calendar",label:"Aadir a mi calendario",description:"Calendario de Google prellenado con lugar y horario.",href:UG},{id:"sms",label:"Enviar notificacin va SMS",description:"Recibe una alerta en tu celular el da del evento.",href:`sms:${HG}?body=${GG}`}],XD=[{id:"taza-250",title:"Taza",price:"$250",helper:"Edicin especial disponible el da del evento."},{id:"taza-causa-600",title:"Taza con causa",price:"$600",helper:"Incluye membresa de 6 meses. Se entrega el 28 de diciembre."},{id:"novela-400",title:"Novela Mi Gato Encerrado",price:"$400",helper:"Primera edicin con QR secreto."},{id:"combo-900",title:"Combo dos tazas + novela",price:"$900",helper:"Paquete completo disponible solo el da del evento."}],WG=XD.reduce((n,e)=>(n[e.id]=`${e.title}  ${e.price}`,n),{}),ZN={fullName:"",email:"",city:"",interest:_p[0].value,notes:"",packages:[]},KG={hidden:{opacity:0},visible:{opacity:.85}},XG={hidden:{opacity:0,y:40,scale:.96},visible:{opacity:1,y:0,scale:1,transition:{duration:.35,ease:"easeOut"}},exit:{opacity:0,y:20,scale:.97,transition:{duration:.2,ease:"easeIn"}}},sT=({open:n,onClose:e,initialInterest:t=_p[0].value})=>{const[s,r]=A.useState(ZN),[i,o]=A.useState("idle"),[a,c]=A.useState(""),{bursts:u,fireConfetti:d}=zG();A.useEffect(()=>{n&&(r({...ZN,interest:t}),o("idle"),c(""))},[n,t]),A.useEffect(()=>{if(!n)return;const w=v=>{v.key==="Escape"&&(e==null||e())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[n,e]);const h=A.useCallback(w=>{const{name:v,value:b}=w.target;r(S=>({...S,[v]:b}))},[]),p=A.useCallback(w=>{r(v=>{const b=v.packages.includes(w);return{...v,packages:b?v.packages.filter(S=>S!==w):[...v.packages,w]}})},[]),m=A.useMemo(()=>_p.find(w=>w.value===s.interest)??_p[0],[s.interest]),y=A.useCallback(async w=>{if(w.preventDefault(),i!=="loading"){if(!s.fullName.trim()||!s.email.trim()){Ae({description:"Por favor completa tu nombre y correo electrnico."});return}o("loading"),c("");try{const v=s.packages.length>0?`Paquetes apartados (sin pago): ${s.packages.map(E=>WG[E]).join(", ")}`:null,b={full_name:s.fullName.trim(),email:s.email.trim().toLowerCase(),city:s.city.trim()||null,interest:s.interest,channel:"landing",object_type:"boleto",event:"funcion-2025-12-28",notes:[v,s.notes.trim()].filter(Boolean).join(" | ")||null},{error:S}=await nt.from("rsvp_extended").insert(b);if(S){o("error"),c("No pudimos registrar tu solicitud. Intenta nuevamente.");return}await YG({email:b.email,name:b.full_name,interestLabel:m.label,interestValue:b.interest,city:b.city,notes:b.notes}),d(),o("success"),Ae({description:"Gracias! Te enviaremos las prximas novedades."})}catch{o("error"),c("Ocurri un error inesperado. Intenta ms tarde.")}}},[s,m.label,i,d]),g=A.useCallback(()=>{i!=="loading"&&(e==null||e())},[e,i]);return f.jsx(Co,{children:n&&f.jsxs(se.div,{className:"fixed inset-0 z-50 flex items-start justify-center px-4 py-6 sm:py-10 overflow-y-auto",initial:"hidden",animate:"visible",exit:"hidden",children:[f.jsx(se.div,{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",variants:KG,onClick:g}),f.jsxs(se.div,{role:"dialog","aria-modal":"true",variants:XG,className:"relative z-10 w-full max-w-3xl rounded-3xl border border-white/10 bg-slate-950/95 p-6 sm:p-10 shadow-2xl max-h-[90vh] overflow-y-auto",children:[u.map(w=>f.jsx($G,{seed:w},w)),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("img",{src:VG,alt:"#GatoEncerrado",className:"h-12 w-auto object-contain rounded-full border border-white/20 bg-white/5 p-1 shadow-lg"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm uppercase tracking-[0.35em] text-slate-400/80 mb-2",children:"28 de diciembre  CECUT"}),f.jsx("h2",{className:"font-display text-3xl text-slate-50",children:"Compra tu boleto y aparta tu lugar en el universo de #GatoEncerrado"})]})]}),f.jsx("button",{onClick:g,className:"self-end text-slate-400 hover:text-white transition",children:""})]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[f.jsxs("div",{className:"space-y-5 text-sm text-slate-300/90 leading-relaxed",children:[f.jsxs("div",{className:"glass-effect rounded-xl border border-white/5 p-4 space-y-3",children:[f.jsx("h3",{className:"font-display text-lg text-slate-100",children:"Compra presencial en taquilla del CECUT"}),f.jsxs("ul",{className:"space-y-2 text-slate-300/80",children:[f.jsx("li",{children:" Taquilla del CECUT  Preventa disponible hasta agotar localidades."}),f.jsx("li",{children:" Llvate una taza como incentivo de preventa."}),f.jsx("li",{children:" Las tazas se entregan exclusivamente en taquilla, hasta agotar existencias."}),f.jsxs("li",{children:[" Tambin puedes comprar en lnea:"," ",f.jsx("a",{href:"https://www.taquillacecut.com.mx/eventos/saladeespectaculos/2025-12-28",target:"_blank",rel:"noopener noreferrer",className:"text-purple-300 underline underline-offset-4 hover:text-white",children:"taquillacecut.com.mx  Entrada 28/12"})]})]})]}),f.jsxs("div",{className:"glass-effect rounded-xl border border-purple-400/20 p-4 space-y-3",children:[f.jsx("h3",{className:"font-display text-lg text-purple-200",children:"Mesa con Merch el da de la funcin"}),f.jsx("p",{className:"text-xs text-slate-400/80",children:"Si deseas apartar o pagar por adelantado, djalo marcado y te enviaremos un enlace seguro para completar tu registro."}),f.jsx("div",{className:"grid sm:grid-cols-2 gap-3 text-sm text-slate-200",children:XD.map(w=>f.jsxs("label",{className:"flex items-start gap-3 rounded-xl border border-white/10 bg-black/30 px-3 py-2",children:[f.jsx("input",{type:"checkbox",checked:s.packages.includes(w.id),onChange:()=>p(w.id),className:"mt-1 h-4 w-4 rounded border-slate-400 bg-black/40 text-purple-500 focus:ring-purple-400"}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("p",{className:"font-semibold text-slate-100",children:[w.title," ",f.jsxs("span",{className:"text-slate-400 font-normal",children:[" ",w.price]})]}),f.jsx("p",{className:"text-xs text-slate-400",children:w.helper})]})]},w.id))})]})]}),f.jsxs("form",{className:"space-y-5",onSubmit:y,children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Nombre completo *"}),f.jsx("input",{name:"fullName",type:"text",required:!0,value:s.fullName,onChange:h,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Cmo te llamas?"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Correo electrnico *"}),f.jsx("input",{name:"email",type:"email",required:!0,value:s.email,onChange:h,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"nombre@correo.com"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Ciudad"}),f.jsx("input",{name:"city",type:"text",value:s.city,onChange:h,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Desde dnde nos visitas?"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Qu quieres recibir?"}),f.jsx("select",{name:"interest",value:s.interest,onChange:h,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",children:_p.map(w=>f.jsx("option",{value:w.value,children:w.label},w.value))}),f.jsx("p",{className:"text-xs text-slate-400/80",children:m.description})]}),f.jsxs("div",{className:"glass-effect rounded-2xl border border-white/5 bg-black/25 p-4 space-y-3",children:[f.jsx("h3",{className:"font-display text-lg text-slate-100",children:"Accin preferida"}),s.interest==="recordatorio"?f.jsx("div",{className:"grid sm:grid-cols-2 gap-3",children:qG.map(w=>f.jsxs("a",{href:w.href,target:"_blank",rel:"noreferrer",className:"flex flex-col gap-2 rounded-xl border border-white/10 bg-slate-900/40 px-4 py-3 text-slate-100 hover:border-purple-400/80 hover:bg-slate-900/70 transition",children:[f.jsx("span",{className:"text-sm font-semibold",children:w.label}),f.jsx("span",{className:"text-xs text-slate-400/80",children:w.description})]},w.id))}):f.jsx("div",{className:"space-y-3",children:f.jsx("p",{className:"text-xs text-slate-300/80",children:"Recibirs en tu correo (y en el CTA de confirmacin) la lnea de reservaciones para concretar el paquete que quieras. Nos encargamos de enviarte la liga segura sin saturar este formulario."})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Mensaje opcional"}),f.jsx("textarea",{name:"notes",rows:3,value:s.notes,onChange:h,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 resize-none",placeholder:"Necesitas facilidades especiales o tienes un cdigo de preventa?"})]}),i==="error"&&f.jsx("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:a}),i==="success"&&f.jsx("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:"Tu registro qued guardado. Revisaremos tu correo con los siguientes pasos."}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx(xe,{type:"submit",disabled:i==="loading",className:"w-full bg-gradient-to-r from-purple-600/80 to-indigo-600/80 hover:from-purple-600 hover:to-indigo-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover-glow",children:i==="loading"?"Enviando":"Guardar mi registro"}),f.jsx("button",{type:"button",onClick:g,className:"text-sm text-slate-400 hover:text-white transition",children:"Cerrar"})]})]})]})]})]})})};async function YG({email:n,name:e,interestLabel:t,interestValue:s,city:r,notes:i}){if(n)try{const{error:o}=await nt.functions.invoke("send-reserve-confirmation",{body:{email:n,name:e,interestLabel:t,interestValue:s,city:r,notes:i}});o&&console.error("[ReserveModal] Error en sendReserveConfirmationEmail:",o)}catch(o){console.error("[ReserveModal] Excepcin en sendReserveConfirmationEmail:",o)}}const QG="/assets/bg-logo-ba7fccc4.png",JG=()=>{const[n,e]=A.useState(!1),t=A.useCallback(()=>{const i=document.querySelector("#about");i==null||i.scrollIntoView({behavior:"smooth"})},[]),s=A.useCallback(()=>{e(!0)},[]),r=A.useCallback(()=>{e(!1)},[]);return f.jsxs(f.Fragment,{children:[f.jsxs("section",{id:"hero",className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[f.jsxs("div",{className:"absolute inset-0 bg-black",children:[f.jsxs("div",{className:"absolute inset-0 opacity-30",children:[f.jsx("div",{className:"absolute top-0 left-0 w-1/2 h-1/2 bg-gradient-to-br from-violet-900/90 via-transparent to-transparent blur-4xl"}),f.jsx("div",{className:"absolute bottom-0 right-0 w-1/2 h-1/2 bg-gradient-to-tl from-pink-600/40 via-transparent to-transparent blur-3xl"})]}),f.jsx("img",{className:"absolute inset-0 w-full h-full object-cover opacity-15 mix-blend-luminosity pointer-events-none",style:{filter:"contrast(20%) brightness(105%)"},alt:"Textura de teln de teatro de terciopelo oscuro",src:QG})]}),f.jsxs("div",{className:"container mx-auto px-6 text-center relative z-10",children:[f.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:1,ease:"easeOut"},className:"max-w-4xl mx-auto",children:[f.jsx(se.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1.5,delay:.2},className:"font-display text-5xl md:text-7xl font-medium italic mb-6 text-gradient",style:{textShadow:"0 0 20px rgba(233, 213, 255, 0.3)"},children:"#GatoEncerrado"}),f.jsx(se.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1.5,delay:.5},className:"text-xl md:text-2xl text-slate-300/80 mb-12 leading-relaxed font-light",children:"Lo ves aqu, pero su voz tambin habita otras dimensiones."}),f.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:1,delay:.8},className:"flex flex-col gap-4 justify-center items-center",children:[f.jsxs(xe,{onClick:()=>s("preventa"),className:"bg-gradient-to-r from-orange-500/90 via-rose-500/90 to-pink-500/90 hover:from-orange-400 hover:to-pink-400 text-white px-6 py-3 rounded-full font-semibold flex items-center gap-2 shadow-lg shadow-orange-500/40 transition",children:[f.jsx(Sk,{size:20}),"Compra tu boleto"]}),f.jsx(xe,{variant:"ghost",onClick:t,className:"text-slate-300 hover:text-white hover:bg-white/5 px-8 py-3 rounded-full font-semibold flex items-center gap-2 text-base",children:"Conoce La Obra"})]})]}),f.jsx(se.div,{animate:{y:[0,10,0]},transition:{duration:5,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-50 left-1/2 -translate-x-1/2 text-slate-500",children:f.jsx(y$,{size:24})})]})]}),f.jsx(sT,{open:n,onClose:r,initialInterest:"preventa"})]})},YD="trailers",lm="trailerlanding",QD=(n="")=>n.toLowerCase().replace(/\.[^/.]+$/,""),VA=(n="")=>{var t;switch((t=n.split(".").pop())==null?void 0:t.toLowerCase()){case"webm":return"video/webm";case"mov":return"video/quicktime";case"mkv":return"video/x-matroska";case"m4v":return"video/x-m4v";case"mp4":default:return"video/mp4"}},eR="trailerlanding.mp4",tR="trailer_landing.mp4",JD="https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/trailers/trailer_landing.mp4",UA="https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/trailers/trailer_landing_v.mp4",nR={trailerlanding:{url:JD,name:eR,mimeType:VA(eR)},trailer_landing:{url:UA,name:tR,mimeType:VA(tR)}},ZG=(n=lm)=>{const e=QD(n)||lm;return{...nR[e]||nR[lm]}},ZD=async(n="")=>{const{data:e,error:t}=await nt.storage.from(YD).list(n,{limit:100,offset:0,sortBy:{column:"name",order:"asc"}});if(t)throw new Error(t.message);if(!Array.isArray(e)||e.length===0)return[];const s=[];for(const r of e){const i=n?`${n}/${r.name}`:r.name;if(!r.metadata){const o=await ZD(i);s.push(...o);continue}s.push({...r,fullPath:i})}return s};async function eq(n=lm){var s;const e=QD(n)||lm,t=ZG(e);try{let r;try{r=await ZD("")}catch(u){return console.error("Error al listar trailers:",u.message),{...t}}if(!Array.isArray(r)||r.length===0)return{...t};const i=e;let o=r.find(u=>{const d=u.fullPath.toLowerCase();return i&&(d===i||d.endsWith(`/${i}`)||d.includes(`/${i}.`)||d===`${i}.mp4`||d.startsWith(`${i}.`))});if(!o&&i&&(o=r.find(u=>u.fullPath.toLowerCase().includes(i))),!o)return{...t};const{data:a}=nt.storage.from(YD).getPublicUrl(o.fullPath),c=((s=o.metadata)==null?void 0:s.mimetype)||VA(o.fullPath);return a!=null&&a.publicUrl?{url:a.publicUrl,name:o.fullPath,mimeType:c}:{...t,name:o.fullPath,mimeType:c}}catch(r){return console.error("Excepcin al obtener el triler:",r),{...t}}}const tq="Es un gato encerrado existe como obra escnica y como #UniversoTransmedia: es, al mismo tiempo, un relato ntimo en un escenario y una constelacin de la mente y del dolor humano en mltiples lenguajes artsticos. Nuestra obra es el corazn que hace pulsar aquellas preguntas que no estn aqu para contestarse, sino para sentirlas en compaa. En pocas palabras, cuando la obra est latente, el universo #GatoEncerrado contina latiendo en otras narrativas. Un recordatorio de que el corazn nunca se encierra del todo.",nq=[{quote:"Salir de la funcin fue como despertar con nuevos recuerdos. La obra me oblig a conversar con mis propias ausencias.",author:"Maru Solano",role:"Espectadora / Tijuana"},{quote:"Es un Gato Encerrado nos recuerda que el teatro puede ser tambin archivo emocional y dispositivo de memoria.",author:"Dr. Luis Miguel Snchez",role:"Crtico invitado"}],sq=()=>{const[n,e]=A.useState(null),[t,s]=A.useState(!1),[r,i]=A.useState(!1),[o,a]=A.useState(!1),[c,u]=A.useState("preventa"),[d,h]=A.useState(()=>typeof window<"u"&&window.matchMedia("(max-width: 768px)").matches);A.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const b=window.matchMedia("(max-width: 768px)"),S=E=>h(E.matches);return typeof b.addEventListener=="function"?b.addEventListener("change",S):typeof b.addListener=="function"&&b.addListener(S),()=>{typeof b.removeEventListener=="function"?b.removeEventListener("change",S):typeof b.removeListener=="function"&&b.removeListener(S)}},[]);const p=d?UA:JD,m=A.useCallback(b=>{u(b),a(!0)},[]),y=A.useCallback(()=>{a(!1)},[]),g=A.useCallback(()=>{var S,E;const b=document.getElementById("blog-submit-cta");if(b){b.scrollIntoView({behavior:"smooth",block:"center"}),(S=b.focus)==null||S.call(b);return}(E=document.querySelector("#blog-contribuye"))==null||E.scrollIntoView({behavior:"smooth",block:"start"})},[]),w=A.useCallback(async()=>{var E;if(r)return;const b=d?"trailer_landing_v":"trailerlanding";if((n==null?void 0:n.url)&&(((E=n.name)==null?void 0:E.toLowerCase().includes(b))||n.url.toLowerCase().includes(b))){s(!0);return}try{i(!0);const k=await eq(b);if(k!=null&&k.url){let T=k;d&&!k.url.toLowerCase().includes("trailer_landing_v")&&(T={...k,url:UA,name:"trailer_landing_v.mp4"}),e(T),s(!0)}else Ae({description:"El triler an no est disponible. Intenta ms tarde."})}catch(k){console.error("Error al obtener el triler:",k),Ae({description:"No se pudo cargar el triler. Intntalo de nuevo ms tarde."})}finally{i(!1)}},[r,d,n]),v=A.useCallback(()=>{s(!1);const b=document.getElementById("gato-encerrado-trailer");b&&typeof b.pause=="function"&&b.pause()},[]);return f.jsxs(f.Fragment,{children:[f.jsxs("section",{id:"about",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-16",children:[f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-6 text-gradient italic",children:"Sobre la Obra"}),f.jsx("p",{className:"text-lg text-slate-300/80 max-w-3xl mx-auto leading-relaxed font-light whitespace-pre-line",children:tq})]}),f.jsx(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.2,ease:"easeOut"},viewport:{once:!0},className:"glass-effect rounded-2xl p-8 md:p-12",children:f.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[f.jsxs("div",{className:"relative order-2 md:order-1",children:[f.jsx("video",{className:"w-full h-96 object-cover rounded-xl shadow-2xl shadow-black/50","aria-label":"Escena de la obra #GatoEncerrado, luz tenue y misteriosa",src:p,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,preload:"metadata"}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent rounded-xl","aria-hidden":"true"})]}),f.jsxs("div",{className:"order-1 md:order-2",children:[f.jsx("h3",{className:"font-display text-3xl font-medium text-slate-100 mb-6",children:"La Mente de Silvestre"}),f.jsxs("p",{className:"text-slate-300/80 leading-relaxed mb-8 font-light",children:["Silvestre vive en ",f.jsx("strong",{children:"Es un gato encerrado"}),". Este es el ",f.jsx("i",{children:"rincn onrico"})," donde enfrenta sus desdoblamientos y dilemas existenciales. Aqu, lo real y lo imaginario ya no compiten. Y t espectador, visitante, cmplice puedes entrar sin tocar la puerta, porque quizs t tambin tienes un gato encerrado en el pecho."]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[f.jsxs(xe,{onClick:w,disabled:r,className:"relative bg-purple-500/20 border border-purple-400/30 text-purple-300 hover:bg-purple-500/30 hover:text-purple-200 disabled:opacity-60 disabled:cursor-not-allowed px-6 py-3 rounded-full font-semibold flex items-center gap-2 hover-glow",children:[f.jsx(bk,{size:20}),r?"Cargando":"Ver Triler",f.jsx(E$,{size:18,className:"absolute right-4 top-1/2 -translate-y-1/2 text-purple-200/80 pointer-events-none"})]}),f.jsxs(xe,{variant:"outline",onClick:()=>m("preventa"),className:"border-slate-100/20 text-slate-200 hover:bg-slate-100/10 px-6 py-3 rounded-full font-semibold flex items-center gap-2",children:[f.jsx(Sk,{size:20}),"RSVP"]})]})]})]})}),f.jsx(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.3,ease:"easeOut"},viewport:{once:!0},className:"mt-16 glass-effect rounded-2xl p-8 md:p-12",children:f.jsxs("div",{className:"grid md:grid-cols-[3fr_2fr] gap-8 items-center",children:[f.jsxs("div",{children:[f.jsx("p",{className:"uppercase tracking-[0.35em] text-xs text-slate-400/80 mb-4",children:"Perspectivas del pblico"}),f.jsx("h3",{className:"font-display text-3xl text-slate-100 mb-6 italic",children:"Qu provoca La Obra?"}),f.jsx("p",{className:"text-slate-300/80 leading-relaxed mb-6 font-light",children:"Reunimos testimonios, crticas y preguntas abiertas que continan la conversacin. Haz scroll hacia Textos y Blog para leer ms y expandir tu propia mirada."}),f.jsx(xe,{variant:"outline",onClick:g,className:"border-purple-400/40 text-purple-200 hover:bg-purple-500/20 w-full sm:w-auto whitespace-normal break-words text-center leading-snug",children:"Clicar para compartir tu perspectiva"})]}),f.jsx("div",{className:"space-y-6",children:nq.map(b=>f.jsxs("div",{className:"rounded-2xl border border-white/10 bg-black/30 p-6",children:[f.jsx(P$,{className:"text-purple-300 mb-4",size:28}),f.jsx("p",{className:"text-slate-200 italic leading-relaxed mb-4",children:b.quote}),f.jsxs("div",{className:"text-sm text-slate-400",children:[f.jsx("p",{className:"text-slate-200 font-semibold",children:b.author}),f.jsx("p",{children:b.role})]})]},b.author))})]})})]}),f.jsx(Co,{children:t&&(n==null?void 0:n.url)&&f.jsxs(se.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[f.jsx(se.div,{className:"absolute inset-0 bg-black/70",onClick:v,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),f.jsx(se.div,{className:`relative z-10 w-full h-full ${d?"max-w-4xl p-4":"p-6 sm:p-8"} overflow-hidden bg-slate-950/95 backdrop-blur-xl`,initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.96,opacity:0},transition:{type:"spring",stiffness:220,damping:28},children:f.jsxs("div",{className:"w-full max-w-6xl mx-auto flex flex-col gap-4 h-full",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border border-white/10 rounded-2xl bg-black/40 text-slate-200 uppercase tracking-[0.35em] text-xs shadow-[0_12px_40px_rgba(0,0,0,0.45)]",children:[f.jsx("span",{children:"Triler #GatoEncerrado"}),f.jsx("button",{onClick:v,className:"text-slate-300 hover:text-white transition","aria-label":"Cerrar triler",children:""})]}),f.jsx("div",{className:`relative ${d?"aspect-video":"w-full max-w-6xl aspect-video"} bg-black rounded-2xl overflow-hidden mx-auto flex items-center justify-center shadow-[0_18px_60px_rgba(0,0,0,0.55)]`,children:f.jsx("video",{id:"gato-encerrado-trailer",src:n.url,controls:!0,autoPlay:!0,className:"h-full w-full object-contain"},n.url)})]})})]})})]}),f.jsx(sT,{open:o,onClose:y,initialInterest:c})]})},cp=[{id:"waitlist",label:"Prximamente"},{id:"experiences",label:"Miniversos activos"}],rq=[{title:"Microficciones sonoras",description:"Voces internas de Silvestre publicadas en notas de voz efmeras.",action:"Pronto recibirs el enlace secreto."},{title:"Bitcora interactiva",description:"Un recorrido visual por los objetos que habitan la habitacin de Silvestre.",action:"Se liberar con la novela impresa."},{title:"Constelacin de espectadores",description:"Mapa colaborativo donde la comunidad comparte sueos y teoras.",action:"Disponible a partir de enero 2025."}],sR={fullName:"",email:"",interest:"miniversos",message:""},iq={hidden:{opacity:0},visible:{opacity:.85}},oq={hidden:{opacity:0,y:40,scale:.96},visible:{opacity:1,y:0,scale:1,transition:{duration:.35,ease:"easeOut"}},exit:{opacity:0,y:20,scale:.97,transition:{duration:.2,ease:"easeIn"}}},aq=({open:n,onClose:e})=>{const[t,s]=A.useState(cp[0].id),[r,i]=A.useState(sR),[o,a]=A.useState("idle"),[c,u]=A.useState("");A.useEffect(()=>{n&&(s(cp[0].id),i(sR),a("idle"),u(""))},[n]),A.useEffect(()=>{if(!n)return;const y=g=>{g.key==="Escape"&&(e==null||e())};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[n,e]);const d=A.useCallback(y=>{const{name:g,value:w}=y.target;i(v=>({...v,[g]:w}))},[]),h=A.useMemo(()=>{var y;return((y=cp.find(g=>g.id===t))==null?void 0:y.label)??cp[0].label},[t]),p=A.useCallback(async y=>{var g;if(y.preventDefault(),o!=="loading"){if(!r.fullName.trim()||!r.email.trim()){Ae({description:"Por favor completa tu nombre y correo."});return}a("loading"),u("");try{const w={full_name:r.fullName.trim(),email:r.email.trim().toLowerCase(),city:null,interest:"miniversos",channel:"landing",object_type:"experiencia-digital",event:"miniversos",notes:r.message.trim()||null},{error:v}=await nt.from("rsvp_extended").insert(w);if(v){console.error("[MiniverseModal] Error al registrar miniverso:",v),a("error"),u((g=v.message)!=null&&g.includes("rsvp_extended")?"Crea la tabla rsvp_extended en Supabase para habilitar este formulario.":"No pudimos registrar tu inters. Intenta de nuevo.");return}a("success"),Ae({description:"Gracias. Te enviaremos una seal cuando el prximo miniverso cobre vida."})}catch(w){console.error("[MiniverseModal] Excepcin al guardar:",w),a("error"),u("Ocurri un error inesperado. Intenta ms tarde.")}}},[r,o]),m=A.useCallback(()=>{o!=="loading"&&(e==null||e())},[e,o]);return f.jsx(Co,{children:n?f.jsxs(se.div,{className:"fixed inset-0 z-50 flex items-start sm:items-center justify-center px-3 py-6 sm:px-4 sm:py-10 overflow-y-auto",initial:"hidden",animate:"visible",exit:"hidden",children:[f.jsx(se.div,{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",variants:iq,onClick:m,"aria-hidden":"true"}),f.jsxs(se.div,{role:"dialog","aria-modal":"true","aria-labelledby":"miniverse-modal-title",variants:oq,className:"relative z-10 w-full max-w-4xl rounded-3xl border border-white/10 bg-slate-950/95 p-5 sm:p-10 shadow-2xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-6",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm uppercase tracking-[0.35em] text-slate-400/80 mb-2",children:"Universos expandidos #GatoEncerrado"}),f.jsx("h2",{id:"miniverse-modal-title",className:"font-display text-3xl text-slate-50",children:"Explora los miniversos"}),f.jsx("p",{className:"text-sm text-slate-400/80",children:"Lo que empieza en el escenario contina en otros formatos. Aqu reunimos las experiencias emergentes."})]}),f.jsx("button",{onClick:m,className:"self-end text-slate-400 hover:text-white transition","aria-label":"Cerrar explorador de miniversos",children:""})]}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:cp.map(y=>f.jsx("button",{onClick:()=>s(y.id),className:`rounded-full border px-4 py-2 text-sm transition ${t===y.id?"border-purple-400/60 bg-purple-500/20 text-purple-100":"border-white/10 text-slate-300 hover:border-purple-300/40 hover:text-purple-100"}`,children:y.label},y.id))}),f.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:t==="waitlist"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-4 text-slate-300/90 text-sm leading-relaxed",children:[f.jsxs("div",{className:"glass-effect rounded-xl border border-white/5 p-4",children:[f.jsx("h3",{className:"font-display text-lg text-slate-100 mb-3",children:"Qu necesitas saber?"}),f.jsxs("ul",{className:"space-y-2 text-slate-300/80",children:[f.jsx("li",{children:" Algunos miniversos an estn bajo construccin."}),f.jsx("li",{children:" Puedes ser parte de las pruebas tempranas o versiones beta."}),f.jsx("li",{children:" Si te unes a esta lista, recibirs avances exclusivos antes de que se abran al pblico."})]})]}),f.jsxs("div",{className:"glass-effect rounded-xl border border-purple-400/20 p-4",children:[f.jsx("h3",{className:"font-display text-lg text-purple-200 mb-3",children:"Qu recibirs?"}),f.jsx("p",{children:"Invitaciones a exploraciones internas, accesos temporales, adelantos curatoriales y ventanas de activacin anticipada en los miniversos en desarrollo."})]})]}),f.jsxs("form",{className:"space-y-5",onSubmit:p,children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Nombre completo *"}),f.jsx("input",{name:"fullName",type:"text",required:!0,value:r.fullName,onChange:d,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:outline-none focus:ring-1 focus:ring-purple-400",placeholder:"Tu nombre"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Correo electrnico *"}),f.jsx("input",{name:"email",type:"email",required:!0,value:r.email,onChange:d,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:outline-none focus:ring-1 focus:ring-purple-400",placeholder:"nombre@correo.com"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm font-medium text-slate-200",children:"Mensaje opcional"}),f.jsx("textarea",{name:"message",rows:3,value:r.message,onChange:d,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:outline-none focus:ring-1 focus:ring-purple-400 resize-none",placeholder:"Comparte qu miniverso te emociona ms o si traes alguna propuesta."})]}),o==="error"?f.jsx("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:c}):null,o==="success"?f.jsx("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:"Quedas en lista para las prximas experiencias. Llegar un correo con la primera pista."}):null,f.jsx(xe,{type:"submit",disabled:o==="loading",className:"w-full bg-gradient-to-r from-purple-600/80 to-indigo-600/80 hover:from-purple-600 hover:to-indigo-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover-glow",children:o==="loading"?"Guardando":"Quiero recibir las activaciones"})]})]}):f.jsx("div",{className:"md:col-span-2 grid md:grid-cols-3 gap-6",children:rq.map(y=>f.jsxs("div",{className:"glass-effect rounded-2xl border border-white/10 p-6",children:[f.jsx("h3",{className:"font-display text-xl text-slate-100 mb-3",children:y.title}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed mb-4",children:y.description}),f.jsx("span",{className:"text-xs uppercase tracking-[0.25em] text-purple-200/80",children:y.action})]},y.title))})}),f.jsxs("div",{className:"mt-8 flex items-center justify-between text-xs text-slate-500",children:[f.jsx("span",{children:h}),f.jsx("button",{onClick:m,className:"text-slate-400 hover:text-white transition",children:"Cerrar"})]})]})]}):null})},lq=6,up=17,dp=75;function rR({value:n}){return f.jsx("div",{className:"w-full h-2 rounded-full bg-white/10 overflow-hidden",children:f.jsx("div",{className:"h-full bg-white/70",style:{width:`${Math.min(100,Math.max(0,n))}%`}})})}const cq=()=>{const[n,e]=A.useState(""),[t,s]=A.useState(!1),[r,i]=A.useState(""),[o,a]=A.useState(0),[c,u]=A.useState(!!"http://localhost:8787");A.useEffect(()=>{if(!c)return;let p=!0;async function m(){try{const w=await(await fetch("http://localhost:8787/stats/suscriptores",{cache:"no-store"})).json();if(!p)return;a(Number((w==null?void 0:w.total)||0))}catch(g){console.error("Error stats/suscriptores",g),u(!1)}}m();const y=setInterval(m,15e3);return()=>{p=!1,clearInterval(y)}},[c]);const d=A.useMemo(()=>{const p=o*lq,m=Math.floor(o/up),y=o%up,g=y===0?up:up-y,w=y/up*100,v=Math.floor(o/dp),b=o%dp,S=b===0?dp:dp-b,E=b/dp*100;return{sesiones:p,residencias:m,residenciasFaltan:g,residenciasProg:w,escuelas:v,escuelasFaltan:S,escuelasProg:E}},[o]);async function h(){try{s(!0),i("");const p=await fetch("http://localhost:8787/stripe/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}),m=await p.json();if(!p.ok)throw new Error((m==null?void 0:m.error)||"No se pudo crear la sesin");window.location.href=m.url}catch(p){i(p.message)}finally{s(!1)}}return f.jsxs("div",{className:"max-w-xl mx-auto text-center space-y-6",children:[f.jsx(se.p,{className:"text-md text-white",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:"Cada suscripcin abre un umbral: sostiene el universo y activa impacto real en la causa social."}),f.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 text-left text-slate-100 space-y-4",children:[f.jsxs("div",{className:"flex items-baseline justify-between",children:[f.jsx("p",{className:"text-sm opacity-80",children:"Suscriptores activos"}),f.jsx("p",{className:"text-2xl font-semibold",children:o})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm mb-1 opacity-80",children:"Terapias asignadas"}),f.jsxs("p",{className:"text-lg mb-2",children:[f.jsx("strong",{children:d.sesiones})," sesiones (1 suscripcin = 6 sesiones)"]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm opacity-80",children:[f.jsx("span",{children:"Residencias creativas"}),f.jsxs("span",{children:[d.residencias," activas"]})]}),f.jsx(rR,{value:d.residenciasProg}),f.jsxs("p",{className:"text-xs opacity-70 mt-1",children:["Faltan ",f.jsx("strong",{children:d.residenciasFaltan})," suscripciones para abrir la siguiente residencia ( 17/sub)."]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm opacity-80",children:[f.jsx("span",{children:"Escuelas con app activa"}),f.jsxs("span",{children:[d.escuelas," escuelas"]})]}),f.jsx(rR,{value:d.escuelasProg}),f.jsxs("p",{className:"text-xs opacity-70 mt-1",children:["Faltan ",f.jsx("strong",{children:d.escuelasFaltan})," suscripciones para la prxima escuela ( 75/sub)."]})]}),f.jsx("p",{className:"text-[11px] leading-4 text-slate-300/80 pt-2",children:"* Isabel Ayuda para la Vida, A.C. no cobra al usuario por sesin. Las sesiones se asignan sin costo para las familias cuando se detecta riesgo, gracias a la combinacin de suscripciones, aportes simblicos y apoyos institucionales."})]}),f.jsxs("div",{className:"grid gap-3",children:[f.jsx("input",{type:"email",placeholder:"tu@email.com",value:n,onChange:p=>e(p.target.value),className:"w-full px-3 py-2 rounded text-black"}),f.jsx("button",{onClick:h,disabled:t||!n,className:"bg-white/90 text-black px-4 py-2 rounded disabled:opacity-50",children:t?"Creando sesin":"Quiero suscribirme"})]}),r&&f.jsx("p",{className:"text-red-300 text-sm",children:r})]})},eO="blog_posts",yv=[],iR=()=>`post-${Math.random().toString(36).slice(2,10)}`,HA=n=>({id:n.id??n.slug??iR(),slug:n.slug??`post-${n.id??iR()}`,title:n.title??"Entrada sin ttulo",excerpt:n.excerpt??n.summary??"",author:n.author??n.byline??"Autora pendiente",author_role:n.author_role??n.role??"",content:n.content??n.body??"",published_at:n.published_at??n.publish_date??null,read_time_minutes:n.read_time_minutes??n.read_time??null,tags:n.tags??[],featured_image_url:n.featured_image_url??n.cover_image??null});async function uq(){try{const{data:n,error:e}=await nt.from(eO).select(`
        id,
        slug,
        title,
        excerpt,
        author,
        author_role,
        content,
        published_at,
        read_time_minutes,
        tags,
        featured_image_url,
        is_published
      `).order("published_at",{ascending:!1}).limit(20);if(e)return console.error("[blogService] Error al obtener posts:",e.message),yv;if(!Array.isArray(n)||n.length===0)return yv;const t=n.filter(r=>r.is_published===!0||r.is_published===null||typeof r.is_published>"u").map(HA),s=yv.filter(r=>!t.some(i=>i.slug===r.slug)).map(HA);return[...t,...s]}catch(n){return console.error("[blogService] Excepcin al obtener posts:",n),yv}}async function dq(n){if(!n)return null;try{const{data:e,error:t}=await nt.from(eO).select(`
        id,
        slug,
        title,
        excerpt,
        author,
        author_role,
        content,
        published_at,
        read_time_minutes,
        tags,
        featured_image_url,
        is_published
      `).eq("slug",n).maybeSingle();return t?(console.error("[blogService] Error al obtener post por slug:",t.message),null):!e||e.is_published===!1?null:HA(e)}catch(e){return console.error("[blogService] Excepcin al buscar post por slug:",e),null}}const zn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),GA=[.001,0,0,.001,0,0],e_=1.35,js={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},wi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},jm="pdfjs_internal_editor_",fe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},tO={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},an={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},cm={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Pt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},zu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Ry={ERRORS:0,WARNINGS:1,INFOS:5},If={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},vv={moveTo:0,lineTo:1,curveTo:2,closePath:3},nO={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let q1=Ry.WARNINGS;function hq(n){Number.isInteger(n)&&(q1=n)}function fq(){return q1}function W1(n){q1>=Ry.INFOS&&console.info(`Info: ${n}`)}function pe(n){q1>=Ry.WARNINGS&&console.warn(`Warning: ${n}`)}function Je(n){throw new Error(n)}function Ne(n,e){n||Je(e)}function pq(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function rT(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const r=n.match(/\./g);(r==null?void 0:r.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=bq(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return pq(s)?s:null}function iT(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&rT(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function be(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Mu=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class oR extends Mu{constructor(e,t){super(e,"PasswordException"),this.code=t}}class t_ extends Mu{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ox extends Mu{constructor(e){super(e,"InvalidPDFException")}}class Mm extends Mu{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class mq extends Mu{constructor(e){super(e,"FormatError")}}class Mo extends Mu{constructor(e){super(e,"AbortException")}}function sO(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Je("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),o=n.subarray(r,i);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function jy(n){typeof n!="string"&&Je("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function gq(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function yq(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function vq(){try{return new Function(""),!0}catch{return!1}}class rn{static get isLittleEndian(){return be(this,"isLittleEndian",yq())}static get isEvalSupported(){return be(this,"isEvalSupported",vq())}static get isOffscreenCanvasSupported(){return be(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return be(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return be(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return be(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const n_=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Ed,Wv,zm,qA;class Z{static makeHexColor(e,t,s){return`#${n_[e]}${n_[t]}${n_[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const r=e[s],i=e[s+1];e[s]=r*t[0]+i*t[2]+t[4],e[s+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const r=t[0],i=t[1],o=t[2],a=t[3],c=t[4],u=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],p=e[s+d+1];e[s+d]=h*r+p*o+c,e[s+d+1]=h*i+p*a+u}}static applyInverseTransform(e,t){const s=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const r=t[0],i=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=e[0],h=e[1],p=e[2],m=e[3];let y=r*d+c,g=y,w=r*p+c,v=w,b=a*h+u,S=b,E=a*m+u,k=E;if(i!==0||o!==0){const T=i*d,P=i*p,N=o*h,M=o*m;y+=N,v+=N,w+=M,g+=M,b+=T,k+=T,E+=P,S+=P}s[0]=Math.min(s[0],y,w,g,v),s[1]=Math.min(s[1],b,E,S,k),s[2]=Math.max(s[2],y,w,g,v),s[3]=Math.max(s[3],b,E,S,k)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],r=e[1],i=e[2],o=e[3],a=s**2+r**2,c=s*i+r*o,u=i**2+o**2,d=(a+u)/2,h=Math.sqrt(d**2-(a*u-c**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[s,i,r,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,r,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,r)}static bezierBoundingBox(e,t,s,r,i,o,a,c,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,c),C(this,zm,qA).call(this,e,s,i,a,t,r,o,c,3*(-e+3*(s-i)+a),6*(e-2*s+i),3*(s-e),u),C(this,zm,qA).call(this,e,s,i,a,t,r,o,c,3*(-t+3*(r-o)+c),6*(t-2*r+o),3*(r-t),u)}}Ed=new WeakSet,Wv=function(e,t,s,r,i,o,a,c,u,d){if(u<=0||u>=1)return;const h=1-u,p=u*u,m=p*u,y=h*(h*(h*e+3*u*t)+3*p*s)+m*r,g=h*(h*(h*i+3*u*o)+3*p*a)+m*c;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],g)},zm=new WeakSet,qA=function(e,t,s,r,i,o,a,c,u,d,h,p){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&C(this,Ed,Wv).call(this,e,t,s,r,i,o,a,c,-h/d,p);return}const m=d**2-4*h*u;if(m<0)return;const y=Math.sqrt(m),g=2*u;C(this,Ed,Wv).call(this,e,t,s,r,i,o,a,c,(-d+y)/g,p),C(this,Ed,Wv).call(this,e,t,s,r,i,o,a,c,(-d-y)/g,p)},x(Z,Ed),x(Z,zm);function bq(n){return decodeURIComponent(escape(n))}let s_=null,aR=null;function rO(n){return s_||(s_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aR=new Map([["","t"]])),n.replaceAll(s_,(e,t,s)=>t?t.normalize("NFKC"):aR.get(s))}function oT(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),sO(n)}const aT="pdfjs_internal_id_";function xq(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,r,...i]=t;if(!n(s)&&!Number.isInteger(s)||!e(r))return!1;const o=i.length;let a=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const c of i)if(!(typeof c=="number"||a&&c===null))return!1;return!0}function Tn(n,e,t){return Math.min(Math.max(n,e),t)}function iO(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(sO(n))}function wq(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):jy(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Lm{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function r(i){var c;if(!i)return;let o=null;const a=i.name;if(a==="#text")o=i.value;else if(Lm.shouldBuildText(a))(c=i==null?void 0:i.attributes)!=null&&c.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const u of i.children)r(u)}return r(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class lT{static setupStorage(e,t,s,r,i){const o=r.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",a=>{r.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",a=>{r.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const c=a.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;r.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:r,linkService:i}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}a&&i.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var h,p;const t=e.annotationStorage,s=e.linkService,r=e.xfaHtml,i=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:i,linkService:s});const a=i!=="richText",c=e.div;if(c.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=m}a&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);o.append(m),a&&Lm.shouldBuildText(r.name)&&u.push(m)}return{textDivs:u}}const d=[[r,-1,o]];for(;d.length>0;){const[m,y,g]=d.at(-1);if(y+1===m.children.length){d.pop();continue}const w=m.children[++d.at(-1)[1]];if(w===null)continue;const{name:v}=w;if(v==="#text"){const S=document.createTextNode(w.value);u.push(S),g.append(S);continue}const b=(h=w==null?void 0:w.attributes)!=null&&h.xmlns?document.createElementNS(w.attributes.xmlns,v):document.createElement(v);if(g.append(b),w.attributes&&this.setAttributes({html:b,element:w,storage:t,intent:i,linkService:s}),((p=w.children)==null?void 0:p.length)>0)d.push([w,-1,b]);else if(w.value){const S=document.createTextNode(w.value);a&&Lm.shouldBuildText(v)&&u.push(S),b.append(S)}}for(const m of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ki="http://www.w3.org/2000/svg",Ll=class Ll{};q(Ll,"CSS",96),q(Ll,"PDF",72),q(Ll,"PDF_TO_CSS_UNITS",Ll.CSS/Ll.PDF);let Lo=Ll;async function Hf(n,e="text"){if(Ap(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class My{constructor({viewBox:e,userUnit:t,scale:s,rotation:r,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=r,this.offsetX=i,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,h,p,m;switch(r%=360,r<0&&(r+=360),r){case 180:d=-1,h=0,p=0,m=1;break;case 90:d=0,h=1,p=1,m=0;break;case 270:d=0,h=-1,p=-1,m=0;break;case 0:d=1,h=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(p=-p,m=-m);let y,g,w,v;d===0?(y=Math.abs(u-e[1])*s+i,g=Math.abs(c-e[0])*s+o,w=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(y=Math.abs(c-e[0])*s+i,g=Math.abs(u-e[1])*s+o,w=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[d*s,h*s,p*s,m*s,y-d*s*c-p*s*u,g-h*s*c-m*s*u],this.width=w,this.height=v}get rawDims(){const e=this.viewBox;return be(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new My({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return Z.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Z.applyTransform(t,this.transform);const s=[e[2],e[3]];return Z.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Z.applyInverseTransform(s,this.transform),s}}class K1 extends Mu{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Ly(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function X1(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function oO(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function aO(n,e="document.pdf"){if(typeof n!="string")return e;if(Ly(n))return pe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const r=a=>{try{let c=decodeURIComponent(a);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:a):c}catch{return a}},i=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(i.test(o))return r(o);if(s.searchParams.size>0){const a=Array.from(s.searchParams.values()).reverse();for(const u of a)if(i.test(u))return r(u);const c=Array.from(s.searchParams.keys()).reverse();for(const u of c)if(i.test(u))return r(u)}if(s.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(c)return r(c[0])}return e}class lR{constructor(){q(this,"started",Object.create(null));q(this,"times",[])}time(e){e in this.started&&pe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||pe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:r,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-r}ms
`);return e.join("")}}function Ap(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Bs(n){n.preventDefault()}function vt(n){n.preventDefault(),n.stopPropagation()}function Sq(n){console.log("Deprecated API usage: "+n)}var Vm;class Im{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;l(this,Vm)||_(this,Vm,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Vm).exec(e);if(!t)return null;const s=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(o+=d,a+=h):u==="+"&&(o-=d,a-=h),new Date(Date.UTC(s,r,i,o,a,c))}}Vm=new WeakMap,x(Im,Vm,void 0);function lO(n,{scale:e=1,rotation:t=0}){const{width:s,height:r}=n.attributes.style,i=[0,0,parseInt(s),parseInt(r)];return new My({viewBox:i,userUnit:1,scale:e,rotation:t})}function Gf(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(pe(`Not a valid color format: "${n}"`),[0,0,0])}function _q(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Gf(s))}e.remove()}function gt(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform();return[e,t,s,r,i,o]}function Gr(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform().invertSelf();return[e,t,s,r,i,o]}function dl(n,e,t=!1,s=!0){if(e instanceof My){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:o}=n,a=rn.isCSSRoundSupported,c=`var(--total-scale-factor) * ${r}px`,u=`var(--total-scale-factor) * ${i}px`,d=a?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,h=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=d,o.height=h):(o.width=h,o.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class $r{constructor(){const{pixelRatio:e}=$r;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,r,i=-1){let o=1/0,a=1/0,c=1/0;s=$r.capPixels(s,i),s>0&&(o=Math.sqrt(s/(e*t))),r!==-1&&(a=r/e,c=r/t);const u=Math.min(o,a,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const ax=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Aq{static get isDarkMode(){var e;return be(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class cO{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),be(this,"commentForegroundColor",Gf(s))}}function uO(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return n=Math.round(n*s+r),e=Math.round(e*s+r),t=Math.round(t*s+r),[n,e,t]}function cR(n,e){const t=n[0]/255,s=n[1]/255,r=n[2]/255,i=Math.max(t,s,r),o=Math.min(t,s,r),a=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const c=i-o;switch(e[1]=a<.5?c/(i+o):c/(2-i-o),i){case t:e[0]=((s-r)/c+(s<r?6:0))*60;break;case s:e[0]=((r-t)/c+2)*60;break;case r:e[0]=((t-s)/c+4)*60;break}}e[2]=a}function WA(n,e){const t=n[0],s=n[1],r=n[2],i=(1-Math.abs(2*r-1))*s,o=i*(1-Math.abs(t/60%2-1)),a=r-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+a,e[1]=o+a,e[2]=a;break;case 1:e[0]=o+a,e[1]=i+a,e[2]=a;break;case 2:e[0]=a,e[1]=i+a,e[2]=o+a;break;case 3:e[0]=a,e[1]=o+a,e[2]=i+a;break;case 4:e[0]=o+a,e[1]=a,e[2]=i+a;break;case 5:case 6:e[0]=i+a,e[1]=a,e[2]=o+a;break}}function uR(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function dR(n,e,t){WA(n,t),t.map(uR);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];WA(e,t),t.map(uR);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const hR=new Map;function dO(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=hR.get(t);if(s)return s;const r=new Float32Array(9),i=r.subarray(0,3),o=r.subarray(3,6);cR(n,o);const a=r.subarray(6,9);cR(e,a);const c=a[2]<.5,u=c?12:4.5;if(o[2]=c?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),dR(o,a,i)<u){let d,h;c?(d=o[2],h=1):(d=0,h=o[2]);const p=.005;for(;h-d>p;){const m=o[2]=(d+h)/2;c===dR(o,a,i)<u?d=m:h=m}o[2]=c?h:d}return WA(o,i),s=Z.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),hR.set(t,s),s}function cT({html:n,dir:e,className:t},s){const r=document.createDocumentFragment();if(typeof n=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let a=0,c=o.length;a<c;++a){const u=o[a];i.append(document.createTextNode(u)),a<c-1&&i.append(document.createElement("br"))}r.append(i)}else lT.render({xfaHtml:n,div:r,intent:"richText"});r.firstChild.classList.add("richText",t),s.append(r)}var Xo,Yo,Ws,Ks,Um,Qo,Cd,kd,Hm,xx,hO,wx,fO,Sx,pO,Jo,Vu,Vl,Ep;const ji=class ji{constructor(e){x(this,wx);x(this,Sx);x(this,Jo);x(this,Vl);x(this,Xo,null);x(this,Yo,null);x(this,Ws,void 0);x(this,Ks,null);x(this,Um,null);x(this,Qo,null);x(this,Cd,null);x(this,kd,null);_(this,Ws,e),l(ji,Hm)||_(ji,Hm,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=_(this,Xo,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,Ws)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Bs,{signal:t}),e.addEventListener("pointerdown",C(ji,xx,hO),{signal:t}));const s=_(this,Ks,document.createElement("div"));s.className="buttons",e.append(s);const r=l(this,Ws).toolbarPosition;if(r){const{style:i}=e,o=l(this,Ws)._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return l(this,Xo)}hide(){var e;l(this,Xo).classList.add("hidden"),(e=l(this,Yo))==null||e.hideDropdown()}show(){var e,t;l(this,Xo).classList.remove("hidden"),(e=l(this,Um))==null||e.shown(),(t=l(this,Qo))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=l(this,Ws),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",l(ji,Hm)[e]),C(this,Jo,Vu).call(this,s)&&s.addEventListener("click",r=>{t.delete()},{signal:t._signal}),l(this,Ks).append(s)}async addAltText(e){const t=await e.render();C(this,Jo,Vu).call(this,t),l(this,Ks).append(t,l(this,Vl,Ep)),_(this,Um,e)}addComment(e,t=null){if(l(this,Qo))return;const s=e.renderForToolbar();if(!s)return;C(this,Jo,Vu).call(this,s);const r=_(this,Cd,l(this,Vl,Ep));t?(l(this,Ks).insertBefore(s,t),l(this,Ks).insertBefore(r,t)):l(this,Ks).append(s,r),_(this,Qo,e),e.toolbar=this}addColorPicker(e){if(l(this,Yo))return;_(this,Yo,e);const t=e.renderButton();C(this,Jo,Vu).call(this,t),l(this,Ks).append(t,l(this,Vl,Ep))}async addEditSignatureButton(e){const t=_(this,kd,await e.renderEditButton(l(this,Ws)));C(this,Jo,Vu).call(this,t),l(this,Ks).append(t,l(this,Vl,Ep))}removeButton(e){var t,s;switch(e){case"comment":(t=l(this,Qo))==null||t.removeToolbarCommentButton(),_(this,Qo,null),(s=l(this,Cd))==null||s.remove(),_(this,Cd,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,s){const r=l(this,Ks).querySelector(s);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){l(this,kd)&&(l(this,kd).title=e)}remove(){var e;l(this,Xo).remove(),(e=l(this,Yo))==null||e.destroy(),_(this,Yo,null)}};Xo=new WeakMap,Yo=new WeakMap,Ws=new WeakMap,Ks=new WeakMap,Um=new WeakMap,Qo=new WeakMap,Cd=new WeakMap,kd=new WeakMap,Hm=new WeakMap,xx=new WeakSet,hO=function(e){e.stopPropagation()},wx=new WeakSet,fO=function(e){l(this,Ws)._focusEventsAllowed=!1,vt(e)},Sx=new WeakSet,pO=function(e){l(this,Ws)._focusEventsAllowed=!0,vt(e)},Jo=new WeakSet,Vu=function(e){const t=l(this,Ws)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",C(this,wx,fO).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",C(this,Sx,pO).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Bs,{signal:t}),!0)},Vl=new WeakSet,Ep=function(){const e=document.createElement("div");return e.className="divider",e},x(ji,xx),x(ji,Hm,null);let KA=ji;var Gm,Ul,Ii,_x,mO,Ax,gO,qm,XA;class Eq{constructor(e){x(this,_x);x(this,Ax);x(this,qm);x(this,Gm,null);x(this,Ul,null);x(this,Ii,void 0);_(this,Ii,e)}show(e,t,s){const[r,i]=C(this,Ax,gO).call(this,t,s),{style:o}=l(this,Ul)||_(this,Ul,C(this,_x,mO).call(this));e.append(l(this,Ul)),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,Ul).remove()}}Gm=new WeakMap,Ul=new WeakMap,Ii=new WeakMap,_x=new WeakSet,mO=function(){const e=_(this,Ul,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=l(this,Ii)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Bs,{signal:t});const s=_(this,Gm,document.createElement("div"));return s.className="buttons",e.append(s),l(this,Ii).hasCommentManager()&&C(this,qm,XA).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{l(this,Ii).commentSelection("floating_button")}),C(this,qm,XA).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{l(this,Ii).highlightSelection("floating_button")}),e},Ax=new WeakSet,gO=function(e,t){let s=0,r=0;for(const i of e){const o=i.y+i.height;if(o<s)continue;const a=i.x+(t?i.width:0);if(o>s){r=a,s=o;continue}t?a>r&&(r=a):a<r&&(r=a)}return[t?1-r:r,s]},qm=new WeakSet,XA=function(e,t,s,r){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const a=l(this,Ii)._signal;a instanceof AbortSignal&&!a.aborted&&(i.addEventListener("contextmenu",Bs,{signal:a}),i.addEventListener("click",r,{signal:a})),l(this,Gm).append(i)};function yO(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Ex;class Cq{constructor(){x(this,Ex,0)}get id(){return`${jm}${$t(this,Ex)._++}`}}Ex=new WeakMap;var Td,Wm,wn,Pd,Kv;const kT=class kT{constructor(){x(this,Pd);x(this,Td,oT());x(this,Wm,0);x(this,wn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return be(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:s,size:r,type:i}=e;return C(this,Pd,Kv).call(this,`${t}_${s}_${r}_${i}`,e)}async getFromUrl(e){return C(this,Pd,Kv).call(this,e,e)}async getFromBlob(e,t){const s=await t;return C(this,Pd,Kv).call(this,e,s)}async getFromId(e){l(this,wn)||_(this,wn,new Map);const t=l(this,wn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,wn)||_(this,wn,new Map);let s=l(this,wn).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${l(this,Td)}_${$t(this,Wm)._++}`,refCounter:1,isSvg:!1},l(this,wn).set(e,s),l(this,wn).set(s.id,s),s}getSvgUrl(e){const t=l(this,wn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;l(this,wn)||_(this,wn,new Map);const t=l(this,wn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}(r=s.close)==null||r.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,Td)}_`)}};Td=new WeakMap,Wm=new WeakMap,wn=new WeakMap,Pd=new WeakSet,Kv=async function(e,t){l(this,wn)||_(this,wn,new Map);let s=l(this,wn).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,Td)}_${$t(this,Wm)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(s.url=t,r=await Hf(t,"blob")):t instanceof File?r=s.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=kT._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((u,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const h=s.svgUrl=o.result;a.src=await i?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=d});o.readAsDataURL(r),await c}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){pe(r),s=null}return l(this,wn).set(e,s),s&&l(this,wn).set(s.id,s),s};let YA=kT;var Nt,Zo,Km,mt;class kq{constructor(e=128){x(this,Nt,[]);x(this,Zo,!1);x(this,Km,void 0);x(this,mt,-1);_(this,Km,e)}add({cmd:e,undo:t,post:s,mustExec:r,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(r&&e(),l(this,Zo))return;const c={cmd:e,undo:t,post:s,type:i};if(l(this,mt)===-1){l(this,Nt).length>0&&(l(this,Nt).length=0),_(this,mt,0),l(this,Nt).push(c);return}if(o&&l(this,Nt)[l(this,mt)].type===i){a&&(c.undo=l(this,Nt)[l(this,mt)].undo),l(this,Nt)[l(this,mt)]=c;return}const u=l(this,mt)+1;u===l(this,Km)?l(this,Nt).splice(0,1):(_(this,mt,u),u<l(this,Nt).length&&l(this,Nt).splice(u)),l(this,Nt).push(c)}undo(){if(l(this,mt)===-1)return;_(this,Zo,!0);const{undo:e,post:t}=l(this,Nt)[l(this,mt)];e(),t==null||t(),_(this,Zo,!1),_(this,mt,l(this,mt)-1)}redo(){if(l(this,mt)<l(this,Nt).length-1){_(this,mt,l(this,mt)+1),_(this,Zo,!0);const{cmd:e,post:t}=l(this,Nt)[l(this,mt)];e(),t==null||t(),_(this,Zo,!1)}}hasSomethingToUndo(){return l(this,mt)!==-1}hasSomethingToRedo(){return l(this,mt)<l(this,Nt).length-1}cleanType(e){if(l(this,mt)!==-1){for(let t=l(this,mt);t>=0;t--)if(l(this,Nt)[t].type!==e){l(this,Nt).splice(t+1,l(this,mt)-t),_(this,mt,t);return}l(this,Nt).length=0,_(this,mt,-1)}}destroy(){_(this,Nt,null)}}Nt=new WeakMap,Zo=new WeakMap,Km=new WeakMap,mt=new WeakMap;var Cx,vO;class Iy{constructor(e){x(this,Cx);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=rn.platform;for(const[s,r,i={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(C(this,Cx,vO).call(this,t));if(!s)return;const{callback:r,options:{bubbles:i=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(r.bind(e,...o,t)(),i||vt(t))}}Cx=new WeakSet,vO=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const kx=class kx{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return _q(e),be(this,"_colors",e)}convert(e){const t=Gf(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,r]of this._colors)if(r.every((i,o)=>i===t[o]))return kx._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Z.makeHexColor(...t):e}};q(kx,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let QA=kx;var Nd,ps,Rd,At,Ut,jd,Xs,Md,Ys,Sn,ea,ta,Ld,na,Yr,Qs,Hl,Xm,Ym,Id,Qm,Qr,sa,Dd,ra,Jr,Tx,ia,Od,Jm,oa,Gl,Fd,aa,Zm,Lt,$e,Di,la,ca,eg,Bd,tg,ua,Zr,Oi,ng,sg,Js,$d,Xv,rg,JA,Px,bO,Nx,xO,ql,Cp,Rx,wO,jx,SO,Mx,_O,ig,ZA,Lx,AO,og,eE,ag,tE,Ix,EO,ln,In,xr,Ti,Dx,CO,Ox,kO,lg,nE,Fx,TO,Wl,kp,cg,sE;const hd=class hd{constructor(e,t,s,r,i,o,a,c,u,d,h,p,m,y,g,w){x(this,$d);x(this,rg);x(this,Px);x(this,Nx);x(this,ql);x(this,Rx);x(this,jx);x(this,Mx);x(this,ig);x(this,Lx);x(this,og);x(this,ag);x(this,Ix);x(this,ln);x(this,xr);x(this,Dx);x(this,Ox);x(this,lg);x(this,Fx);x(this,Wl);x(this,cg);x(this,Nd,new AbortController);x(this,ps,null);x(this,Rd,null);x(this,At,new Map);x(this,Ut,new Map);x(this,jd,null);x(this,Xs,null);x(this,Md,null);x(this,Ys,new kq);x(this,Sn,null);x(this,ea,null);x(this,ta,null);x(this,Ld,0);x(this,na,new Set);x(this,Yr,null);x(this,Qs,null);x(this,Hl,new Set);q(this,"_editorUndoBar",null);x(this,Xm,!1);x(this,Ym,!1);x(this,Id,!1);x(this,Qm,null);x(this,Qr,null);x(this,sa,null);x(this,Dd,null);x(this,ra,!1);x(this,Jr,null);x(this,Tx,new Cq);x(this,ia,!1);x(this,Od,!1);x(this,Jm,!1);x(this,oa,null);x(this,Gl,null);x(this,Fd,null);x(this,aa,null);x(this,Zm,null);x(this,Lt,fe.NONE);x(this,$e,new Set);x(this,Di,null);x(this,la,null);x(this,ca,null);x(this,eg,null);x(this,Bd,null);x(this,tg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});x(this,ua,[0,0]);x(this,Zr,null);x(this,Oi,null);x(this,ng,null);x(this,sg,null);x(this,Js,null);const v=this._signal=l(this,Nd).signal;_(this,Oi,e),_(this,ng,t),_(this,sg,s),_(this,jd,r),_(this,Sn,i),_(this,la,o),_(this,Bd,c),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:v}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),a._on("setpreference",this.onSetPreference.bind(this),{signal:v}),a._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:v}),window.addEventListener("pointerdown",()=>{_(this,Od,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{_(this,Od,!1)},{capture:!0,signal:v}),C(this,Rx,wO).call(this),C(this,Ix,EO).call(this),C(this,ig,ZA).call(this),_(this,Xs,c.annotationStorage),_(this,Qm,c.filterFactory),_(this,ca,u),_(this,Dd,d||null),_(this,Xm,h),_(this,Ym,p),_(this,Id,m),_(this,Zm,y||null),this.viewParameters={realScale:Lo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=w!==!1,i==null||i.setSidebarUiManager(this)}static get _keyboardManager(){const e=hd.prototype,t=o=>l(o,Oi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return be(this,"_keyboardManager",new Iy([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Oi).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Oi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,s,r,i,o,a,c,u;(e=l(this,Js))==null||e.resolve(),_(this,Js,null),(t=l(this,Nd))==null||t.abort(),_(this,Nd,null),this._signal=null;for(const d of l(this,Ut).values())d.destroy();l(this,Ut).clear(),l(this,At).clear(),l(this,Hl).clear(),(s=l(this,aa))==null||s.clear(),_(this,ps,null),l(this,$e).clear(),l(this,Ys).destroy(),(r=l(this,jd))==null||r.destroy(),(i=l(this,Sn))==null||i.destroy(),(o=l(this,la))==null||o.destroy(),(a=l(this,Jr))==null||a.hide(),_(this,Jr,null),(c=l(this,Fd))==null||c.destroy(),_(this,Fd,null),_(this,Rd,null),l(this,Qr)&&(clearTimeout(l(this,Qr)),_(this,Qr,null)),l(this,Zr)&&(clearTimeout(l(this,Zr)),_(this,Zr,null)),(u=this._editorUndoBar)==null||u.destroy(),_(this,Bd,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,Zm)}get useNewAltTextFlow(){return l(this,Ym)}get useNewAltTextWhenAddingImage(){return l(this,Id)}get hcmFilter(){return be(this,"hcmFilter",l(this,ca)?l(this,Qm).addHCMFilter(l(this,ca).foreground,l(this,ca).background):"none")}get direction(){return be(this,"direction",getComputedStyle(l(this,Oi)).direction)}get _highlightColors(){return be(this,"_highlightColors",l(this,Dd)?new Map(l(this,Dd).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return be(this,"highlightColors",null);const t=new Map,s=!!l(this,ca);for(const[r,i]of e){const o=r.endsWith("_HCM");if(s&&o){t.set(r.replace("_HCM",""),i);continue}!s&&!o&&t.set(r,i)}return be(this,"highlightColors",t)}get highlightColorNames(){return be(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,ta,e)}setMainHighlightColorPicker(e){_(this,Fd,e)}editAltText(e,t=!1){var s;(s=l(this,jd))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!l(this,Sn)}editComment(e,t,s,r){var i;(i=l(this,Sn))==null||i.showDialog(this,e,t,s,r)}selectComment(e,t){const s=l(this,Ut).get(e),r=s==null?void 0:s.getEditorByUID(t);r==null||r.toggleComment(!0,!0)}updateComment(e){var t;(t=l(this,Sn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=l(this,Sn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=l(this,Sn))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var r;(r=l(this,Sn))==null||r.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=l(this,Sn))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=l(this,Sn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(l(this,Ut).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),r=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await s}getSignature(e){var t;(t=l(this,la))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return l(this,la)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":_(this,Id,t);break}}onPageChanging({pageNumber:e}){_(this,Ld,e-1)}focusMainContainer(){l(this,Oi).focus()}findParent(e,t){for(const s of l(this,Ut).values()){const{x:r,y:i,width:o,height:a}=s.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=i&&t<=i+a)return s}return null}disableUserSelect(e=!1){l(this,ng).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,Hl).add(e)}removeShouldRescale(e){l(this,Hl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Lo.PDF_TO_CSS_UNITS;for(const s of l(this,Hl))s.onScaleChanging();(t=l(this,ta))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:a}=s,c=s.toString(),d=C(this,$d,Xv).call(this,s).closest(".textLayer"),h=this.getSelectionBoxes(d);if(!h)return;s.empty();const p=C(this,rg,JA).call(this,d),m=l(this,Lt)===fe.NONE,y=()=>{const g=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:a,text:c});m&&this.showAllEditors("highlight",!0,!0),t&&(g==null||g.editComment())};if(m){this.switchToMode(fe.HIGHLIGHT,y);return}y()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!l(this,Xs))return null;const t=`${jm}${e}`,s=l(this,Xs).getRawValue(t);return s&&l(this,Xs).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&l(this,Xs)&&!l(this,Xs).has(e.id)&&l(this,Xs).setValue(e.id,e)}a11yAlert(e,t=null){const s=l(this,sg);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,l(this,ra)&&(_(this,ra,!1),C(this,ql,Cp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,$e))if(t.div.contains(e)){_(this,Gl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,Gl))return;const[e,t]=l(this,Gl);_(this,Gl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){C(this,ig,ZA).call(this),C(this,og,eE).call(this)}removeEditListeners(){C(this,Lx,AO).call(this),C(this,ag,tE).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,Qs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,Qs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,ps))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of l(this,$e)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of l(this,Qs))if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){pe(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const c of s){const u=await r.deserialize(c);if(!u)return;i.push(u)}const o=()=>{for(const c of i)C(this,lg,nE).call(this,c);C(this,cg,sE).call(this,i)},a=()=>{for(const c of i)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(i){pe(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,Lt)!==fe.NONE&&!this.isEditorHandlingKeyboard&&hd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,ra)&&(_(this,ra,!1),C(this,ql,Cp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(C(this,jx,SO).call(this),C(this,og,eE).call(this),C(this,ln,In).call(this,{isEditing:l(this,Lt)!==fe.NONE,isEmpty:C(this,Wl,kp).call(this),hasSomethingToUndo:l(this,Ys).hasSomethingToUndo(),hasSomethingToRedo:l(this,Ys).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,Mx,_O).call(this),C(this,ag,tE).call(this),C(this,ln,In).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,Qs)){_(this,Qs,e);for(const t of l(this,Qs))C(this,xr,Ti).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,Tx).id}get currentLayer(){return l(this,Ut).get(l(this,Ld))}getLayer(e){return l(this,Ut).get(e)}get currentPageIndex(){return l(this,Ld)}addLayer(e){l(this,Ut).set(e.pageIndex,e),l(this,ia)?e.enable():e.disable()}removeLayer(e){l(this,Ut).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,r=!1,i=!1){var o,a,c,u,d,h;if(l(this,Lt)!==e&&!(l(this,Js)&&(await l(this,Js).promise,!l(this,Js)))){if(_(this,Js,Promise.withResolvers()),(o=l(this,ta))==null||o.commitOrRemove(),l(this,Lt)===fe.POPUP&&((a=l(this,Sn))==null||a.hideSidebar()),(c=l(this,Sn))==null||c.destroyPopup(),_(this,Lt,e),e===fe.NONE){this.setEditingState(!1),C(this,Ox,kO).call(this);for(const p of l(this,At).values())p.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),l(this,Js).resolve();return}for(const p of l(this,At).values())p.addStandaloneCommentButton();e===fe.SIGNATURE&&await((d=l(this,la))==null?void 0:d.loadSignatures()),this.setEditingState(!0),await C(this,Dx,CO).call(this),this.unselectAll();for(const p of l(this,Ut).values())p.updateMode(e);if(e===fe.POPUP){l(this,Rd)||_(this,Rd,await l(this,Bd).getAnnotationsByType(new Set(l(this,Qs).map(y=>y._editorType))));const p=new Set,m=[];for(const y of l(this,At).values()){const{annotationElementId:g,hasComment:w,deleted:v}=y;g&&p.add(g),w&&!v&&m.push(y.getData())}for(const y of l(this,Rd)){const{id:g,popupRef:w,contentsObj:v}=y;w&&(v!=null&&v.str)&&!p.has(g)&&!l(this,na).has(g)&&m.push(y)}(h=l(this,Sn))==null||h.showSidebar(m)}if(!t){s&&this.addNewEditorFromKeyboard(),l(this,Js).resolve();return}for(const p of l(this,At).values())p.uid===t?(this.setSelected(p),i?p.editComment():r?p.enterInEditMode():p.focus()):p.unselect();l(this,Js).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==l(this,Lt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(l(this,Qs)){switch(e){case Te.CREATE:this.currentLayer.addNewEditor(t);return;case Te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,eg)||_(this,eg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of l(this,$e))s.updateParams(e,t);else for(const s of l(this,Qs))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var i;for(const o of l(this,At).values())o.editorType===e&&o.show(t);(((i=l(this,eg))==null?void 0:i.get(Te.HIGHLIGHT_SHOW_ALL))??!0)!==t&&C(this,xr,Ti).call(this,[[Te.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,Jm)!==e){_(this,Jm,e);for(const t of l(this,Ut).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of l(this,At).values())t.pageIndex===e&&(yield t)}getEditor(e){return l(this,At).get(e)}addEditor(e){l(this,At).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(l(this,Qr)&&clearTimeout(l(this,Qr)),_(this,Qr,setTimeout(()=>{this.focusMainContainer(),_(this,Qr,null)},0))),l(this,At).delete(e.id),e.annotationElementId&&((t=l(this,aa))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!l(this,na).has(e.annotationElementId))&&((s=l(this,Xs))==null||s.remove(e.id))}addDeletedAnnotationElement(e){l(this,na).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,na).has(e)}removeDeletedAnnotationElement(e){l(this,na).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,ps)!==e&&(_(this,ps,e),e&&C(this,xr,Ti).call(this,e.propertiesToUpdate))}updateUI(e){l(this,Fx,TO)===e&&C(this,xr,Ti).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){C(this,xr,Ti).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,$e).has(e)){l(this,$e).delete(e),e.unselect(),C(this,ln,In).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,$e).add(e),e.select(),C(this,xr,Ti).call(this,e.propertiesToUpdate),C(this,ln,In).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=l(this,ta))==null||t.commitOrRemove();for(const s of l(this,$e))s!==e&&s.unselect();l(this,$e).clear(),l(this,$e).add(e),e.select(),C(this,xr,Ti).call(this,e.propertiesToUpdate),C(this,ln,In).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,$e).has(e)}get firstSelectedEditor(){return l(this,$e).values().next().value}unselect(e){e.unselect(),l(this,$e).delete(e),C(this,ln,In).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,$e).size!==0}get isEnterHandled(){return l(this,$e).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,Ys).undo(),C(this,ln,In).call(this,{hasSomethingToUndo:l(this,Ys).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,Wl,kp).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,Ys).redo(),C(this,ln,In).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Ys).hasSomethingToRedo(),isEmpty:C(this,Wl,kp).call(this)})}addCommands(e){l(this,Ys).add(e),C(this,ln,In).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,Wl,kp).call(this)})}cleanUndoStack(e){l(this,Ys).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,$e)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(r,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},r=()=>{for(const o of t)C(this,lg,nE).call(this,o)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=l(this,ps))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,ps)||this.hasSelection}selectAll(){for(const e of l(this,$e))e.commit();C(this,cg,sE).call(this,l(this,At).values())}unselectAll(){var e;if(!(l(this,ps)&&(l(this,ps).commitOrRemove(),l(this,Lt)!==fe.NONE))&&!((e=l(this,ta))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,$e))t.unselect();l(this,$e).clear(),C(this,ln,In).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,ua)[0]+=e,l(this,ua)[1]+=t;const[r,i]=l(this,ua),o=[...l(this,$e)],a=1e3;l(this,Zr)&&clearTimeout(l(this,Zr)),_(this,Zr,setTimeout(()=>{_(this,Zr,null),l(this,ua)[0]=l(this,ua)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,At).has(c.id)&&(c.translateInPage(r,i),c.translationDone())},undo:()=>{for(const c of o)l(this,At).has(c.id)&&(c.translateInPage(-r,-i),c.translationDone())},mustExec:!1})},a));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,Yr,new Map);for(const e of l(this,$e))l(this,Yr).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Yr))return!1;this.disableUserSelect(!1);const e=l(this,Yr);_(this,Yr,null);let t=!1;for(const[{x:r,y:i,pageIndex:o},a]of e)a.newX=r,a.newY=i,a.newPageIndex=o,t||(t=r!==a.savedX||i!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const s=(r,i,o,a)=>{if(l(this,At).has(r.id)){const c=l(this,Ut).get(a);c?r._setParentAndPosition(c,i,o):(r.pageIndex=a,r.x=i,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:o,newPageIndex:a}]of e)s(r,i,o,a)},undo:()=>{for(const[r,{savedX:i,savedY:o,savedPageIndex:a}]of e)s(r,i,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Yr))for(const s of l(this,Yr).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,$e).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,ps)===e}getActive(){return l(this,ps)}getMode(){return l(this,Lt)}isEditingMode(){return l(this,Lt)!==fe.NONE}get imageManager(){return be(this,"imageManager",new YA)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:r,width:i,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,d,h,p)=>({x:(d-r)/o,y:1-(u+h-s)/i,width:p/o,height:h/i});break;case"180":a=(u,d,h,p)=>({x:1-(u+h-s)/i,y:1-(d+p-r)/o,width:h/i,height:p/o});break;case"270":a=(u,d,h,p)=>({x:1-(d+p-r)/o,y:(u-s)/i,width:p/o,height:h/i});break;default:a=(u,d,h,p)=>({x:(u-s)/i,y:(d-r)/o,width:h/i,height:p/o});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:p,y:m,width:y,height:g}of h.getClientRects())y===0||g===0||c.push(a(p,m,y,g))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,Md)||_(this,Md,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,Md))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=l(this,Md))==null?void 0:r.get(e.data.id);if(!t)return;const s=l(this,Xs).getRawValue(t);s&&(l(this,Lt)===fe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var i;const r=(i=l(this,aa))==null?void 0:i.get(e);r&&(r.setCanvas(t,s),l(this,aa).delete(e))}addMissingCanvas(e,t){(l(this,aa)||_(this,aa,new Map)).set(e,t)}};Nd=new WeakMap,ps=new WeakMap,Rd=new WeakMap,At=new WeakMap,Ut=new WeakMap,jd=new WeakMap,Xs=new WeakMap,Md=new WeakMap,Ys=new WeakMap,Sn=new WeakMap,ea=new WeakMap,ta=new WeakMap,Ld=new WeakMap,na=new WeakMap,Yr=new WeakMap,Qs=new WeakMap,Hl=new WeakMap,Xm=new WeakMap,Ym=new WeakMap,Id=new WeakMap,Qm=new WeakMap,Qr=new WeakMap,sa=new WeakMap,Dd=new WeakMap,ra=new WeakMap,Jr=new WeakMap,Tx=new WeakMap,ia=new WeakMap,Od=new WeakMap,Jm=new WeakMap,oa=new WeakMap,Gl=new WeakMap,Fd=new WeakMap,aa=new WeakMap,Zm=new WeakMap,Lt=new WeakMap,$e=new WeakMap,Di=new WeakMap,la=new WeakMap,ca=new WeakMap,eg=new WeakMap,Bd=new WeakMap,tg=new WeakMap,ua=new WeakMap,Zr=new WeakMap,Oi=new WeakMap,ng=new WeakMap,sg=new WeakMap,Js=new WeakMap,$d=new WeakSet,Xv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},rg=new WeakSet,JA=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,Ut).values())if(s.hasTextLayer(e))return s;return null},Px=new WeakSet,bO=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=C(this,$d,Xv).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(l(this,Jr)||_(this,Jr,new Eq(this)),l(this,Jr).show(s,r,this.direction==="ltr"))},Nx=new WeakSet,xO=function(){var i,o,a;const e=document.getSelection();if(!e||e.isCollapsed){l(this,Di)&&((i=l(this,Jr))==null||i.hide(),_(this,Di,null),C(this,ln,In).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,Di))return;const r=C(this,$d,Xv).call(this,e).closest(".textLayer");if(!r){l(this,Di)&&((o=l(this,Jr))==null||o.hide(),_(this,Di,null),C(this,ln,In).call(this,{hasSelectedText:!1}));return}if((a=l(this,Jr))==null||a.hide(),_(this,Di,t),C(this,ln,In).call(this,{hasSelectedText:!0}),!(l(this,Lt)!==fe.HIGHLIGHT&&l(this,Lt)!==fe.NONE)&&(l(this,Lt)===fe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,ra,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,Lt)===fe.HIGHLIGHT?C(this,rg,JA).call(this,r):null;if(c==null||c.toggleDrawing(),l(this,Od)){const u=new AbortController,d=this.combinedSignal(u),h=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),p.type==="pointerup"&&C(this,ql,Cp).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}else c==null||c.toggleDrawing(!0),C(this,ql,Cp).call(this,"main_toolbar")}},ql=new WeakSet,Cp=function(e=""){l(this,Lt)===fe.HIGHLIGHT?this.highlightSelection(e):l(this,Xm)&&C(this,Px,bO).call(this)},Rx=new WeakSet,wO=function(){document.addEventListener("selectionchange",C(this,Nx,xO).bind(this),{signal:this._signal})},jx=new WeakSet,SO=function(){if(l(this,sa))return;_(this,sa,new AbortController);const e=this.combinedSignal(l(this,sa));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Mx=new WeakSet,_O=function(){var e;(e=l(this,sa))==null||e.abort(),_(this,sa,null)},ig=new WeakSet,ZA=function(){if(l(this,oa))return;_(this,oa,new AbortController);const e=this.combinedSignal(l(this,oa));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Lx=new WeakSet,AO=function(){var e;(e=l(this,oa))==null||e.abort(),_(this,oa,null)},og=new WeakSet,eE=function(){if(l(this,ea))return;_(this,ea,new AbortController);const e=this.combinedSignal(l(this,ea));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ag=new WeakSet,tE=function(){var e;(e=l(this,ea))==null||e.abort(),_(this,ea,null)},Ix=new WeakSet,EO=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},ln=new WeakSet,In=function(e){Object.entries(e).some(([s,r])=>l(this,tg)[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,tg),e)}),l(this,Lt)===fe.HIGHLIGHT&&e.hasSelectedEditor===!1&&C(this,xr,Ti).call(this,[[Te.HIGHLIGHT_FREE,!0]]))},xr=new WeakSet,Ti=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Dx=new WeakSet,CO=async function(){if(!l(this,ia)){_(this,ia,!0);const e=[];for(const t of l(this,Ut).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,At).values())t.enable()}},Ox=new WeakSet,kO=function(){if(this.unselectAll(),l(this,ia)){_(this,ia,!1);for(const e of l(this,Ut).values())e.disable();for(const e of l(this,At).values())e.disable()}},lg=new WeakSet,nE=function(e){const t=l(this,Ut).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Fx=new WeakSet,TO=function(){let e=null;for(e of l(this,$e));return e},Wl=new WeakSet,kp=function(){if(l(this,At).size===0)return!0;if(l(this,At).size===1)for(const e of l(this,At).values())return e.isEmpty();return!1},cg=new WeakSet,sE=function(e){for(const t of l(this,$e))t.unselect();l(this,$e).clear();for(const t of e)t.isEmpty()||(l(this,$e).add(t),t.select());C(this,ln,In).call(this,{hasSelectedEditor:this.hasSelection})},q(hd,"TRANSLATE_SMALL",1),q(hd,"TRANSLATE_BIG",10);let hl=hd;var Kt,ei,wr,zd,ti,ms,Vd,ni,Qn,Fi,Kl,si,da,Xl,Tp,Ud,Yv;const Dn=class Dn{constructor(e){x(this,Xl);x(this,Ud);x(this,Kt,null);x(this,ei,!1);x(this,wr,null);x(this,zd,null);x(this,ti,null);x(this,ms,null);x(this,Vd,!1);x(this,ni,null);x(this,Qn,null);x(this,Fi,null);x(this,Kl,null);x(this,si,!1);_(this,Qn,e),_(this,si,e._uiManager.useNewAltTextFlow),l(Dn,da)||_(Dn,da,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Dn._l10n??(Dn._l10n=e)}async render(){const e=_(this,wr,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=_(this,zd,document.createElement("span"));e.append(t),l(this,si)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Dn,da).missing),t.setAttribute("data-l10n-id",l(Dn,da)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,Qn)._uiManager._signal;e.addEventListener("contextmenu",Bs,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),l(this,Qn)._uiManager.editAltText(l(this,Qn)),l(this,si)&&l(this,Qn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,Xl,Tp)}})};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(_(this,Vd,!0),r(i))},{signal:s}),await C(this,Ud,Yv).call(this),e}finish(){l(this,wr)&&(l(this,wr).focus({focusVisible:l(this,Vd)}),_(this,Vd,!1))}isEmpty(){return l(this,si)?l(this,Kt)===null:!l(this,Kt)&&!l(this,ei)}hasData(){return l(this,si)?l(this,Kt)!==null||!!l(this,Fi):this.isEmpty()}get guessedText(){return l(this,Fi)}async setGuessedText(e){l(this,Kt)===null&&(_(this,Fi,e),_(this,Kl,await Dn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),C(this,Ud,Yv).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,si)||l(this,Kt)){(t=l(this,ni))==null||t.remove(),_(this,ni,null);return}if(!l(this,ni)){const s=_(this,ni,document.createElement("div"));s.className="noAltTextBadge",l(this,Qn).div.append(s)}l(this,ni).classList.toggle("hidden",!e)}serialize(e){let t=l(this,Kt);return!e&&l(this,Fi)===t&&(t=l(this,Kl)),{altText:t,decorative:l(this,ei),guessedText:l(this,Fi),textWithDisclaimer:l(this,Kl)}}get data(){return{altText:l(this,Kt),decorative:l(this,ei)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:r,cancel:i=!1}){s&&(_(this,Fi,s),_(this,Kl,r)),!(l(this,Kt)===e&&l(this,ei)===t)&&(i||(_(this,Kt,e),_(this,ei,t)),C(this,Ud,Yv).call(this))}toggle(e=!1){l(this,wr)&&(!e&&l(this,ms)&&(clearTimeout(l(this,ms)),_(this,ms,null)),l(this,wr).disabled=!e)}shown(){l(this,Qn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,Xl,Tp)}})}destroy(){var e,t;(e=l(this,wr))==null||e.remove(),_(this,wr,null),_(this,zd,null),_(this,ti,null),(t=l(this,ni))==null||t.remove(),_(this,ni,null)}};Kt=new WeakMap,ei=new WeakMap,wr=new WeakMap,zd=new WeakMap,ti=new WeakMap,ms=new WeakMap,Vd=new WeakMap,ni=new WeakMap,Qn=new WeakMap,Fi=new WeakMap,Kl=new WeakMap,si=new WeakMap,da=new WeakMap,Xl=new WeakSet,Tp=function(){return l(this,Kt)&&"added"||l(this,Kt)===null&&this.guessedText&&"review"||"missing"},Ud=new WeakSet,Yv=async function(){var r,i,o;const e=l(this,wr);if(!e)return;if(l(this,si)){if(e.classList.toggle("done",!!l(this,Kt)),e.setAttribute("data-l10n-id",l(Dn,da)[l(this,Xl,Tp)]),(r=l(this,zd))==null||r.setAttribute("data-l10n-id",l(Dn,da)[`${l(this,Xl,Tp)}-label`]),!l(this,Kt)){(i=l(this,ti))==null||i.remove();return}}else{if(!l(this,Kt)&&!l(this,ei)){e.classList.remove("done"),(o=l(this,ti))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,ti);if(!t){_(this,ti,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,Qn).id}`;const a=100,c=l(this,Qn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,ms)),_(this,ms,null)},{once:!0}),e.addEventListener("mouseenter",()=>{_(this,ms,setTimeout(()=>{_(this,ms,null),l(this,ti).classList.add("show"),l(this,Qn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,ms)&&(clearTimeout(l(this,ms)),_(this,ms,null)),(u=l(this,ti))==null||u.classList.remove("show")},{signal:c})}l(this,ei)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,Kt)),t.parentNode||e.append(t);const s=l(this,Qn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},x(Dn,da,null),q(Dn,"_l10n",null);let lx=Dn;var cn,Zs,Yl,tt,ug,Ql,Sr,Jl,Zl,ec,dg,rE;class bv{constructor(e){x(this,dg);x(this,cn,null);x(this,Zs,null);x(this,Yl,!1);x(this,tt,null);x(this,ug,null);x(this,Ql,null);x(this,Sr,null);x(this,Jl,null);x(this,Zl,!1);x(this,ec,null);_(this,tt,e)}renderForToolbar(){const e=_(this,Zs,document.createElement("button"));return e.className="comment",C(this,dg,rE).call(this,e,!1)}renderForStandalone(){const e=_(this,cn,document.createElement("button"));e.className="annotationCommentButton";const t=l(this,tt).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(l(this,tt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=l(this,tt).commentButtonColor;r&&(s.backgroundColor=r)}return C(this,dg,rE).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=l(this,cn)??l(this,Zs))==null||e.focus()},0)}onUpdatedColor(){if(!l(this,cn))return;const e=l(this,tt).commentButtonColor;e&&(l(this,cn).style.backgroundColor=e),l(this,tt)._uiManager.updatePopupColor(l(this,tt))}get commentButtonWidth(){var e;return(((e=l(this,cn))==null?void 0:e.getBoundingClientRect().width)??0)/l(this,tt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(l(this,ec))return l(this,ec);if(!l(this,cn))return null;const{x:e,y:t,height:s}=l(this,cn).getBoundingClientRect(),{x:r,y:i,width:o,height:a}=l(this,tt).parent.boundingClientRect;return[(e-r)/o,(t+s-i)/a]}set commentPopupPositionInLayer(e){_(this,ec,e)}hasDefaultPopupPosition(){return l(this,ec)===null}removeStandaloneCommentButton(){var e;(e=l(this,cn))==null||e.remove(),_(this,cn,null)}removeToolbarCommentButton(){var e;(e=l(this,Zs))==null||e.remove(),_(this,Zs,null)}setCommentButtonStates({selected:e,hasPopup:t}){l(this,cn)&&(l(this,cn).classList.toggle("selected",e),l(this,cn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,r;if(t)[s,r]=t;else{[s,r]=l(this,tt).commentButtonPosition;const{width:d,height:h,x:p,y:m}=l(this,tt);s=p+s*d,r=m+r*h}const i=l(this,tt).parent.boundingClientRect,{x:o,y:a,width:c,height:u}=i;l(this,tt)._uiManager.editComment(l(this,tt),o+s*c,a+r*u,{...e,parentDimensions:i})}finish(){l(this,Zs)&&(l(this,Zs).focus({focusVisible:l(this,Yl)}),_(this,Yl,!1))}isDeleted(){return l(this,Zl)||l(this,Sr)===""}isEmpty(){return l(this,Sr)===null}hasBeenEdited(){return this.isDeleted()||l(this,Sr)!==l(this,ug)}serialize(){return this.data}get data(){return{text:l(this,Sr),richText:l(this,Ql),date:l(this,Jl),deleted:this.isDeleted()}}set data(e){if(e!==l(this,Sr)&&_(this,Ql,null),e===null){_(this,Sr,""),_(this,Zl,!0);return}_(this,Sr,e),_(this,Jl,new Date),_(this,Zl,!1)}setInitialText(e,t=null){_(this,ug,e),this.data=e,_(this,Jl,null),_(this,Ql,t)}shown(){}destroy(){var e,t;(e=l(this,Zs))==null||e.remove(),_(this,Zs,null),(t=l(this,cn))==null||t.remove(),_(this,cn,null),_(this,Sr,""),_(this,Ql,null),_(this,Jl,null),_(this,tt,null),_(this,Yl,!1),_(this,Zl,!1)}}cn=new WeakMap,Zs=new WeakMap,Yl=new WeakMap,tt=new WeakMap,ug=new WeakMap,Ql=new WeakMap,Sr=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,ec=new WeakMap,dg=new WeakSet,rE=function(e,t){if(!l(this,tt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[l(this,tt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=l(this,tt)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",Bs,{signal:s}),t&&(e.addEventListener("focusin",i=>{l(this,tt)._focusEventsAllowed=!1,vt(i)},{capture:!0,signal:s}),e.addEventListener("focusout",i=>{l(this,tt)._focusEventsAllowed=!0,vt(i)},{capture:!0,signal:s})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),e===l(this,Zs)?this.edit():l(this,tt).toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(_(this,Yl,!0),r(i))},{signal:s}),e.addEventListener("pointerenter",()=>{l(this,tt).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{l(this,tt).toggleComment(!1,!1)},{signal:s}),e};var Hd,tc,hg,fg,pg,mg,gg,Bi,nc,$i,sc,zi,Bx,PO,$x,NO,zx,RO;const TT=class TT{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:o=null,signal:a}){x(this,Bx);x(this,$x);x(this,zx);x(this,Hd,void 0);x(this,tc,!1);x(this,hg,null);x(this,fg,void 0);x(this,pg,void 0);x(this,mg,void 0);x(this,gg,void 0);x(this,Bi,null);x(this,nc,void 0);x(this,$i,null);x(this,sc,void 0);x(this,zi,null);_(this,Hd,e),_(this,hg,s),_(this,fg,t),_(this,pg,r),_(this,mg,i),_(this,gg,o),_(this,sc,new AbortController),_(this,nc,AbortSignal.any([a,l(this,sc).signal])),e.addEventListener("touchstart",C(this,Bx,PO).bind(this),{passive:!1,signal:l(this,nc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/$r.pixelRatio}destroy(){var e,t;(e=l(this,sc))==null||e.abort(),_(this,sc,null),(t=l(this,Bi))==null||t.abort(),_(this,Bi,null)}};Hd=new WeakMap,tc=new WeakMap,hg=new WeakMap,fg=new WeakMap,pg=new WeakMap,mg=new WeakMap,gg=new WeakMap,Bi=new WeakMap,nc=new WeakMap,$i=new WeakMap,sc=new WeakMap,zi=new WeakMap,Bx=new WeakSet,PO=function(e){var r,i,o;if((r=l(this,fg))!=null&&r.call(this))return;if(e.touches.length===1){if(l(this,Bi))return;const a=_(this,Bi,new AbortController),c=AbortSignal.any([l(this,nc),a.signal]),u=l(this,Hd),d={capture:!0,signal:c,passive:!1},h=p=>{var m;p.pointerType==="touch"&&((m=l(this,Bi))==null||m.abort(),_(this,Bi,null))};u.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(vt(p),h(p))},d),u.addEventListener("pointerup",h,d),u.addEventListener("pointercancel",h,d);return}if(!l(this,zi)){_(this,zi,new AbortController);const a=AbortSignal.any([l(this,nc),l(this,zi).signal]),c=l(this,Hd),u={signal:a,capture:!1,passive:!1};c.addEventListener("touchmove",C(this,$x,NO).bind(this),u);const d=C(this,zx,RO).bind(this);c.addEventListener("touchend",d,u),c.addEventListener("touchcancel",d,u),u.capture=!0,c.addEventListener("pointerdown",vt,u),c.addEventListener("pointermove",vt,u),c.addEventListener("pointercancel",vt,u),c.addEventListener("pointerup",vt,u),(i=l(this,pg))==null||i.call(this)}if(vt(e),e.touches.length!==2||(o=l(this,hg))!=null&&o.call(this)){_(this,$i,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),_(this,$i,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},$x=new WeakSet,NO=function(e){var E;if(!l(this,$i)||e.touches.length!==2)return;vt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:r,screenY:i}=t,{screenX:o,screenY:a}=s,c=l(this,$i),{touch0X:u,touch0Y:d,touch1X:h,touch1Y:p}=c,m=h-u,y=p-d,g=o-r,w=a-i,v=Math.hypot(g,w)||1,b=Math.hypot(m,y)||1;if(!l(this,tc)&&Math.abs(b-v)<=TT.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=r,c.touch0Y=i,c.touch1X=o,c.touch1Y=a,!l(this,tc)){_(this,tc,!0);return}const S=[(r+o)/2,(i+a)/2];(E=l(this,mg))==null||E.call(this,S,b,v)},zx=new WeakSet,RO=function(e){var t;e.touches.length>=2||(l(this,zi)&&(l(this,zi).abort(),_(this,zi,null),(t=l(this,gg))==null||t.call(this)),l(this,$i)&&(vt(e),_(this,$i,null),_(this,tc,!1)))};let Dm=TT;var rc,_r,ut,Xe,Vi,Gd,ha,yg,un,ic,Ui,ri,fa,vg,oc,gs,bg,ac,Hi,ii,qd,Wd,er,lc,xg,Vx,wg,iE,Sg,oE,Kd,Qv,Ux,jO,Hx,MO,_g,aE,Xd,Jv,Ag,lE,Gx,LO,qx,IO,Wx,DO,Eg,cE,Kx,OO,Cg,uE,Xx,FO,Yx,BO,Qx,$O,kg,dE,cc,Pp;const me=class me{constructor(e){x(this,wg);x(this,Kd);x(this,Ux);x(this,Hx);x(this,_g);x(this,Xd);x(this,Ag);x(this,Gx);x(this,qx);x(this,Wx);x(this,Eg);x(this,Kx);x(this,Cg);x(this,Xx);x(this,Yx);x(this,Qx);x(this,kg);x(this,cc);x(this,rc,null);x(this,_r,null);x(this,ut,null);x(this,Xe,null);x(this,Vi,null);x(this,Gd,!1);x(this,ha,null);x(this,yg,"");x(this,un,null);x(this,ic,null);x(this,Ui,null);x(this,ri,null);x(this,fa,null);x(this,vg,"");x(this,oc,!1);x(this,gs,null);x(this,bg,!1);x(this,ac,!1);x(this,Hi,!1);x(this,ii,null);x(this,qd,0);x(this,Wd,0);x(this,er,null);x(this,lc,null);q(this,"isSelected",!1);q(this,"_isCopy",!1);q(this,"_editToolbar",null);q(this,"_initialOptions",Object.create(null));q(this,"_initialData",null);q(this,"_isVisible",!0);q(this,"_uiManager",null);q(this,"_focusEventsAllowed",!0);x(this,xg,!1);x(this,Vx,me._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[i,o];const[a,c]=this.parentDimensions;this.x=e.x/a,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=me.prototype._resizeWithKeyboard,t=hl.TRANSLATE_SMALL,s=hl.TRANSLATE_BIG;return be(this,"_resizerKeyboardManager",new Iy([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],me.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return be(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Tq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(me._l10n??(me._l10n=e),me._l10nResizer||(me._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),me._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);me._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Je("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,xg)}set _isDraggable(e){var t;_(this,xg,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Vx)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(C(this,cc,Pp).call(this),(t=l(this,ri))==null||t.remove(),_(this,ri,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,oc)?_(this,oc,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,r){const[i,o]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(e+s)/i,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,r]=this.parentDimensions;this.setAt(e*s,t*r,this.width*s,this.height*r),this._onTranslated()}translate(e,t){C(this,wg,iE).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,gs)||_(this,gs,[this.x,this.y,this.width,this.height]),C(this,wg,iE).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){l(this,gs)||_(this,gs,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,u]=this.getBaseTranslation();o+=c,a+=u;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,gs)&&(l(this,gs)[0]!==this.x||l(this,gs)[1]!==this.y)}get _hasBeenResized(){return!!l(this,gs)&&(l(this,gs)[2]!==this.width||l(this,gs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=me,r=s/e,i=s/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,r]}=this;let{x:i,y:o,width:a,height:c}=this;if(a*=s,c*=r,i*=s,o*=r,this._mustFixPosition)switch(e){case 0:i=Tn(i,0,s-a),o=Tn(o,0,r-c);break;case 90:i=Tn(i,0,s-c),o=Tn(o,a,r);break;case 180:i=Tn(i,a,s),o=Tn(o,c,r);break;case 270:i=Tn(i,c,s),o=Tn(o,0,r-a);break}this.x=i/=s,this.y=o/=r;const[u,d]=this.getBaseTranslation();i+=u,o+=d,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return C(s=me,Sg,oE).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return C(s=me,Sg,oE).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,ut))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||l(this,ac))return this._editToolbar;this._editToolbar=new KA(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=l(this,ut))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return l(this,ut)||(lx.initialize(me._l10n),_(this,ut,new lx(this)),l(this,rc)&&(l(this,ut).data=l(this,rc),_(this,rc,null))),l(this,ut)}get altTextData(){var e;return(e=l(this,ut))==null?void 0:e.data}set altTextData(e){l(this,ut)&&(l(this,ut).data=e)}get guessedAltText(){var e;return(e=l(this,ut))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,ut))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,ut))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,ut)&&!l(this,ut).isEmpty()}hasAltTextData(){var e;return((e=l(this,ut))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=l(this,Xe))==null||e.focusButton()}addCommentButton(){return l(this,Xe)||_(this,Xe,new bv(this))}addStandaloneCommentButton(){if(l(this,Vi)){this._uiManager.isEditingMode()&&l(this,Vi).classList.remove("hidden");return}this.hasComment&&(_(this,Vi,l(this,Xe).renderForStandalone()),this.div.append(l(this,Vi)))}removeStandaloneCommentButton(){l(this,Xe).removeStandaloneCommentButton(),_(this,Vi,null)}hideStandaloneCommentButton(){var e;(e=l(this,Vi))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:r}}=l(this,Xe);return{text:t,richText:e,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){l(this,Xe)||_(this,Xe,new bv(this)),l(this,Xe).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(l(this,Xe)||_(this,Xe,new bv(this)),l(this,Xe).setInitialText(e,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var e;return(e=l(this,Xe))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=l(this,Xe))==null?void 0:e.isDeleted()}get hasComment(){return!!l(this,Xe)&&!l(this,Xe).isEmpty()&&!l(this,Xe).isDeleted()}async editComment(e){l(this,Xe)||_(this,Xe,new bv(this)),l(this,Xe).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){l(this,Xe).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,a=o+i+1,c=r-100,u=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,c,u,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){l(this,Xe).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=l(this,Gd)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),C(this,Cg,uE).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),yO(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,lc)||_(this,lc,new Dm({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:C(this,Gx,LO).bind(this),onPinching:C(this,qx,IO).bind(this),onPinchEnd:C(this,Wx,DO).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=rn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(_(this,oc,!0),this._isDraggable){C(this,Kx,OO).call(this,e);return}C(this,Eg,cE).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,ii)&&clearTimeout(l(this,ii)),_(this,ii,setTimeout(()=>{var e;_(this,ii,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const r=this.parentScale,[i,o]=this.pageDimensions,[a,c]=this.pageTranslation,u=e/r,d=t/r,h=this.x*i,p=this.y*o,m=this.width*i,y=this.height*o;switch(s){case 0:return[h+u+a,o-p-d-y+c,h+u+m+a,o-p-d+c];case 90:return[h+d+a,o-p+u+c,h+d+y+a,o-p+u+m+c];case 180:return[h-u-m+a,o-p+d+c,h-u+a,o-p+d+y+c];case 270:return[h-d-y+a,o-p-u-m+c,h-d+a,o-p-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,r,i,o]=e,a=i-s,c=o-r;switch(this.rotation){case 0:return[s,t-o,a,c];case 90:return[s,t-r,c,a];case 180:return[i,t-r,a,c];case 270:return[i,t-o,c,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&me._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=l(this,Xe))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:r,deleted:i,richText:o},uid:a,pageIndex:c,creationDate:u,modificationDate:d}=this;return{id:a,pageIndex:c,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:u,modificationDate:s||d,popupRef:!i,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),_(this,ac,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),_(this,ac,!1),!0):!1}isInEditMode(){return l(this,ac)}shouldGetKeyboardEvents(){return l(this,Hi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&r>0&&e<i&&s>0}rebuild(){C(this,Cg,uE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,_(r,rc,e.accessibilityData),r._isCopy=e.isCopy||!1;const[i,o]=r.pageDimensions,[a,c,u,d]=r.getRectInCurrentCoords(e.rect,o);return r.x=a/i,r.y=c/o,r.width=u/i,r.height=d/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,fa))==null||e.abort(),_(this,fa,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,ii)&&(clearTimeout(l(this,ii)),_(this,ii,null)),C(this,cc,Pp).call(this),this.removeEditToolbar(),l(this,er)){for(const s of l(this,er).values())clearTimeout(s);_(this,er,null)}this.parent=null,(t=l(this,lc))==null||t.destroy(),_(this,lc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,Ux,jO).call(this),l(this,un).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,r,i,o]=this.getPDFRect();return[me._round(s+(i-s)*e),me._round(r+(o-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return l(this,Xe).commentPopupPositionInLayer}set commentPopupPosition(e){l(this,Xe).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return l(this,Xe).hasDefaultPopupPosition()}get commentButtonWidth(){return l(this,Xe).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){l(this,Xe).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,Ui,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,un).children;if(!l(this,_r)){_(this,_r,Array.from(t));const o=C(this,Xx,FO).bind(this),a=C(this,Yx,BO).bind(this),c=this._uiManager._signal;for(const u of l(this,_r)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",a,{signal:c}),u.addEventListener("focus",C(this,Qx,$O).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",me._l10nResizer[d])}}const s=l(this,_r)[0];let r=0;for(const o of t){if(o===s)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(l(this,_r).length/4);if(i!==r){if(i<r)for(let a=0;a<r-i;a++)l(this,un).append(l(this,un).firstChild);else if(i>r)for(let a=0;a<i-r;a++)l(this,un).firstChild.before(l(this,un).lastChild);let o=0;for(const a of t){const u=l(this,_r)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",me._l10nResizer[u])}}C(this,kg,dE).call(this,0),_(this,Hi,!0),l(this,un).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,Hi)&&C(this,Ag,lE).call(this,l(this,vg),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){C(this,cc,Pp).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,i;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,ut))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,r,i;this.isSelected&&(this.isSelected=!1,(e=l(this,un))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(i=l(this,ut))==null||i.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,bg)}set isEditing(e){_(this,bg,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,er)||_(this,er,new Map);const{action:s}=e;let r=l(this,er).get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),l(this,er).delete(s),l(this,er).size===0&&_(this,er,null)},me._telemetryTimeout),l(this,er).set(s,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,Gd,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,Gd,!0)}updateFakeAnnotationElement(e){if(!l(this,ri)&&!this.deleted){_(this,ri,e.addFakeAnnotation(this));return}if(this.deleted){l(this,ri).remove(),_(this,ri,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&l(this,ri).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};rc=new WeakMap,_r=new WeakMap,ut=new WeakMap,Xe=new WeakMap,Vi=new WeakMap,Gd=new WeakMap,ha=new WeakMap,yg=new WeakMap,un=new WeakMap,ic=new WeakMap,Ui=new WeakMap,ri=new WeakMap,fa=new WeakMap,vg=new WeakMap,oc=new WeakMap,gs=new WeakMap,bg=new WeakMap,ac=new WeakMap,Hi=new WeakMap,ii=new WeakMap,qd=new WeakMap,Wd=new WeakMap,er=new WeakMap,lc=new WeakMap,xg=new WeakMap,Vx=new WeakMap,wg=new WeakSet,iE=function([e,t],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Sg=new WeakSet,oE=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Kd=new WeakSet,Qv=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Ux=new WeakSet,jO=function(){if(l(this,un))return;_(this,un,document.createElement("div")),l(this,un).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const r=document.createElement("div");l(this,un).append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",C(this,Hx,MO).bind(this,s),{signal:t}),r.addEventListener("contextmenu",Bs,{signal:t}),r.tabIndex=-1}this.div.prepend(l(this,un))},Hx=new WeakSet,MO=function(e,t){var d;t.preventDefault();const{isMac:s}=rn.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=l(this,ut))==null||d.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,_(this,ic,[t.screenX,t.screenY]);const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C(this,Ag,lE).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",vt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Bs,{signal:o}),_(this,Ui,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;i.abort(),this.parent.togglePointerEvents(!0),(h=l(this,ut))==null||h.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=a,this.div.style.cursor=c,C(this,Xd,Jv).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},_g=new WeakSet,aE=function(e,t,s,r){this.width=s,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Xd=new WeakSet,Jv=function(){if(!l(this,Ui))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:r}=l(this,Ui);_(this,Ui,null);const i=this.x,o=this.y,a=this.width,c=this.height;i===e&&o===t&&a===s&&c===r||this.addCommands({cmd:C(this,_g,aE).bind(this,i,o,a,c),undo:C(this,_g,aE).bind(this,e,t,s,r),mustExec:!0})},Ag=new WeakSet,lE=function(e,t){const[s,r]=this.parentDimensions,i=this.x,o=this.y,a=this.width,c=this.height,u=me.MIN_SIZE/s,d=me.MIN_SIZE/r,h=C(this,Kd,Qv).call(this,this.rotation),p=(j,F)=>[h[0]*j+h[2]*F,h[1]*j+h[3]*F],m=C(this,Kd,Qv).call(this,360-this.rotation),y=(j,F)=>[m[0]*j+m[2]*F,m[1]*j+m[3]*F];let g,w,v=!1,b=!1;switch(e){case"topLeft":v=!0,g=(j,F)=>[0,0],w=(j,F)=>[j,F];break;case"topMiddle":g=(j,F)=>[j/2,0],w=(j,F)=>[j/2,F];break;case"topRight":v=!0,g=(j,F)=>[j,0],w=(j,F)=>[0,F];break;case"middleRight":b=!0,g=(j,F)=>[j,F/2],w=(j,F)=>[0,F/2];break;case"bottomRight":v=!0,g=(j,F)=>[j,F],w=(j,F)=>[0,0];break;case"bottomMiddle":g=(j,F)=>[j/2,F],w=(j,F)=>[j/2,0];break;case"bottomLeft":v=!0,g=(j,F)=>[0,F],w=(j,F)=>[j,0];break;case"middleLeft":b=!0,g=(j,F)=>[0,F/2],w=(j,F)=>[j,F/2];break}const S=g(a,c),E=w(a,c);let k=p(...E);const T=me._round(i+k[0]),P=me._round(o+k[1]);let N=1,M=1,L,O;if(t.fromKeyboard)({deltaX:L,deltaY:O}=t);else{const{screenX:j,screenY:F}=t,[$,z]=l(this,ic);[L,O]=this.screenToPageTranslation(j-$,F-z),l(this,ic)[0]=j,l(this,ic)[1]=F}if([L,O]=y(L/s,O/r),v){const j=Math.hypot(a,c);N=M=Math.max(Math.min(Math.hypot(E[0]-S[0]-L,E[1]-S[1]-O)/j,1/a,1/c),u/a,d/c)}else b?N=Tn(Math.abs(E[0]-S[0]-L),u,1)/a:M=Tn(Math.abs(E[1]-S[1]-O),d,1)/c;const D=me._round(a*N),V=me._round(c*M);k=p(...w(D,V));const I=T-k[0],R=P-k[1];l(this,gs)||_(this,gs,[this.x,this.y,this.width,this.height]),this.width=D,this.height=V,this.x=I,this.y=R,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Gx=new WeakSet,LO=function(){var e;_(this,Ui,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,ut))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},qx=new WeakSet,IO=function(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const o=C(this,Kd,Qv).call(this,this.rotation),a=(T,P)=>[o[0]*T+o[2]*P,o[1]*T+o[3]*P],[c,u]=this.parentDimensions,d=this.x,h=this.y,p=this.width,m=this.height,y=me.MIN_SIZE/c,g=me.MIN_SIZE/u;i=Math.max(Math.min(i,1/p,1/m),y/p,g/m);const w=me._round(p*i),v=me._round(m*i);if(w===p&&v===m)return;l(this,gs)||_(this,gs,[d,h,p,m]);const b=a(p/2,m/2),S=me._round(d+b[0]),E=me._round(h+b[1]),k=a(w/2,v/2);this.x=S-k[0],this.y=E-k[1],this.width=w,this.height=v,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Wx=new WeakSet,DO=function(){var e;(e=l(this,ut))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),C(this,Xd,Jv).call(this)},Eg=new WeakSet,cE=function(e){const{isMac:t}=rn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Kx=new WeakSet,OO=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:i},a=u=>{r.abort(),_(this,ha,null),_(this,oc,!1),this._uiManager.endDragSession()||C(this,Eg,cE).call(this,u),s&&this._onStopDragging()};t&&(_(this,qd,e.clientX),_(this,Wd,e.clientY),_(this,ha,e.pointerId),_(this,yg,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:h,pointerId:p}=u;if(p!==l(this,ha)){vt(u);return}const[m,y]=this.screenToPageTranslation(d-l(this,qd),h-l(this,Wd));_(this,qd,d),_(this,Wd,h),this._uiManager.dragSelectedEditors(m,y)},o),window.addEventListener("touchmove",vt,o),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,yg)&&(l(this,lc)||u.isPrimary)&&a(u),vt(u)},o));const c=u=>{if(!l(this,ha)||l(this,ha)===u.pointerId){a(u);return}vt(u)};window.addEventListener("pointerup",c,{signal:i}),window.addEventListener("blur",c,{signal:i})},Cg=new WeakSet,uE=function(){if(l(this,fa)||!this.div)return;_(this,fa,new AbortController);const e=this._uiManager.combinedSignal(l(this,fa));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Xx=new WeakSet,FO=function(e){me._resizerKeyboardManager.exec(this,e)},Yx=new WeakSet,BO=function(e){var t;l(this,Hi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,un)&&C(this,cc,Pp).call(this)},Qx=new WeakSet,$O=function(e){_(this,vg,l(this,Hi)?e:"")},kg=new WeakSet,dE=function(e){if(l(this,_r))for(const t of l(this,_r))t.tabIndex=e},cc=new WeakSet,Pp=function(){_(this,Hi,!1),C(this,kg,dE).call(this,-1),C(this,Xd,Jv).call(this)},x(me,Sg),q(me,"_l10n",null),q(me,"_l10nResizer",null),q(me,"_borderLineWidth",-1),q(me,"_colorManager",new QA),q(me,"_zIndex",1),q(me,"_telemetryTimeout",1e3);let rt=me;class Tq extends rt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const fR=3285377520,Hs=4294901760,qr=65535;class zO{constructor(e){this.h1=e?e&4294967295:fR,this.h2=e?e&4294967295:fR}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let g=0,w=e.length;g<w;g++){const v=e.charCodeAt(g);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,i=s-r*4,o=new Uint32Array(t.buffer,0,r);let a=0,c=0,u=this.h1,d=this.h2;const h=3432918353,p=461845907,m=h&qr,y=p&qr;for(let g=0;g<r;g++)g&1?(a=o[g],a=a*h&Hs|a*m&qr,a=a<<15|a>>>17,a=a*p&Hs|a*y&qr,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[g],c=c*h&Hs|c*m&qr,c=c<<15|c>>>17,c=c*p&Hs|c*y&qr,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,i){case 3:a^=t[r*4+2]<<16;case 2:a^=t[r*4+1]<<8;case 1:a^=t[r*4],a=a*h&Hs|a*m&qr,a=a<<15|a>>>17,a=a*p&Hs|a*y&qr,r&1?u^=a:d^=a}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Hs|e*36045&qr,t=t*4283543511&Hs|((t<<16|e>>>16)*2950163797&Hs)>>>16,e^=t>>>1,e=e*444984403&Hs|e*60499&qr,t=t*3301882366&Hs|((t<<16|e>>>16)*3120437893&Hs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const hE=Object.freeze({map:null,hash:"",transfer:void 0});var uc,dc,Gi,dn,Jx,VO;class uT{constructor(){x(this,Jx);x(this,uc,!1);x(this,dc,null);x(this,Gi,null);x(this,dn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,dn).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,dn).get(e)}remove(e){const t=l(this,dn).get(e);if(t!==void 0&&(t instanceof rt&&l(this,Gi).delete(t.annotationElementId),l(this,dn).delete(e),l(this,dn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of l(this,dn).values())if(s instanceof rt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,dn).get(e);let r=!1;if(s!==void 0)for(const[i,o]of Object.entries(t))s[i]!==o&&(r=!0,s[i]=o);else r=!0,l(this,dn).set(e,t);r&&C(this,Jx,VO).call(this),t instanceof rt&&((l(this,Gi)||_(this,Gi,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return l(this,dn).has(e)}get size(){return l(this,dn).size}resetModified(){l(this,uc)&&(_(this,uc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new UO(this)}get serializable(){if(l(this,dn).size===0)return hE;const e=new Map,t=new zO,s=[],r=Object.create(null);let i=!1;for(const[o,a]of l(this,dn)){const c=a instanceof rt?a.serialize(!1,r):a;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:hE}get editorStats(){let e=null;const t=new Map;let s=0,r=0;for(const i of l(this,dn).values()){if(!(i instanceof rt)){i.popup&&(i.popup.deleted?r+=1:s+=1);continue}i.isCommentDeleted?r+=1:i.hasEditedComment&&(s+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:a}=o;t.has(a)||t.set(a,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const c=e[a]||(e[a]=new Map);for(const[u,d]of Object.entries(o)){if(u==="type")continue;let h=c.get(u);h||(h=new Map,c.set(u,h));const p=h.get(d)??0;h.set(d,p+1)}}if((r>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:r,edited:s}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){_(this,dc,null)}updateEditor(e,t){var r;const s=(r=l(this,Gi))==null?void 0:r.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=l(this,Gi))==null?void 0:t.get(e))||null}get modifiedIds(){if(l(this,dc))return l(this,dc);const e=[];if(l(this,Gi))for(const t of l(this,Gi).values())t.serialize()&&e.push(t.annotationElementId);return _(this,dc,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return l(this,dn).entries()}}uc=new WeakMap,dc=new WeakMap,Gi=new WeakMap,dn=new WeakMap,Jx=new WeakSet,VO=function(){l(this,uc)||(_(this,uc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Tg;class UO extends uT{constructor(t){super();x(this,Tg,void 0);const{map:s,hash:r,transfer:i}=t.serializable,o=structuredClone(s,i?{transfer:i}:null);_(this,Tg,{map:o,hash:r,transfer:i})}get print(){Je("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,Tg)}get modifiedIds(){return be(this,"modifiedIds",{ids:new Set,hash:""})}}Tg=new WeakMap;var Yd;class Pq{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){x(this,Yd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,Yd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||l(this,Yd).has(e.loadedName))){if(Ne(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:o}=e,a=new FontFace(r,i,o);this.addNativeFontFace(a);try{await a.load(),l(this,Yd).add(r),s==null||s(e)}catch{pe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Je("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw pe(`Failed to load font '${s.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return be(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return be(this,"isSyncFontLoadingSupported",zn||rn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Ne(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:t,callback:e};return s.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return be(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,k){return E.charCodeAt(k)<<24|E.charCodeAt(k+1)<<16|E.charCodeAt(k+2)<<8|E.charCodeAt(k+3)&255}function r(E,k,T,P){const N=E.substring(0,k),M=E.substring(k+T);return N+P+M}let i,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let u=0;function d(E,k){if(++u>30){pe("Load test font never loaded."),k();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(d.bind(null,E,k))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=r(p,976,h.length,h);const y=16,g=1482184792;let w=s(p,y);for(i=0,o=h.length-3;i<o;i+=4)w=w-g+s(h,i)|0;i<h.length&&(w=w-g+s(h+"XXX",i)|0),p=r(p,y,4,gq(w));const v=`url(data:font/opentype;base64,${btoa(p)});`,b=`@font-face {font-family:"${h}";src:${v}}`;this.insertRule(b);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const E of[e.loadedName,h]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=E,S.append(k)}this._document.body.append(S),d(h,()=>{S.remove(),t.complete()})}}Yd=new WeakMap;var Ge;class Nq{constructor(e,t=null,s,r){x(this,Ge,void 0);this.compiledGlyphs=Object.create(null),_(this,Ge,e),this._inspectFont=t,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${iO(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let r;try{r=e.get(s)}catch(o){pe(`getPathGenerator - ignoring character: "${o}".`)}const i=new Path2D(r||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}get black(){return l(this,Ge).black}get bold(){return l(this,Ge).bold}get disableFontFace(){return l(this,Ge).disableFontFace??!1}get fontExtraProperties(){return l(this,Ge).fontExtraProperties??!1}get isInvalidPDFjsFont(){return l(this,Ge).isInvalidPDFjsFont}get isType3Font(){return l(this,Ge).isType3Font}get italic(){return l(this,Ge).italic}get missingFile(){return l(this,Ge).missingFile}get remeasure(){return l(this,Ge).remeasure}get vertical(){return l(this,Ge).vertical}get ascent(){return l(this,Ge).ascent}get defaultWidth(){return l(this,Ge).defaultWidth}get descent(){return l(this,Ge).descent}get bbox(){return l(this,Ge).bbox}get fontMatrix(){return l(this,Ge).fontMatrix}get fallbackName(){return l(this,Ge).fallbackName}get loadedName(){return l(this,Ge).loadedName}get mimetype(){return l(this,Ge).mimetype}get name(){return l(this,Ge).name}get data(){return l(this,Ge).data}clearData(){l(this,Ge).clearData()}get cssFontInfo(){return l(this,Ge).cssFontInfo}get systemFontInfo(){return l(this,Ge).systemFontInfo}get defaultVMetrics(){return l(this,Ge).defaultVMetrics}}Ge=new WeakMap;function Rq(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(zn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function jq(n){if(zn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return jy(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function xv(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const fE=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,Mq=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",HO=xq.bind(null,fE,Mq);var qi,Zx;class Lq{constructor(){x(this,qi,new Map);x(this,Zx,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Zx).then(()=>{for(const[r]of l(this,qi))r.call(this,s)})}addEventListener(e,t,s=null){let r=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:i}=s;if(i.aborted){pe("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}l(this,qi).set(t,r)}removeEventListener(e,t){const s=l(this,qi).get(t);s==null||s(),l(this,qi).delete(t)}terminate(){for(const[,e]of l(this,qi))e==null||e();l(this,qi).clear()}}qi=new WeakMap,Zx=new WeakMap;const wv={DATA:1,ERROR:2},Mt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function pR(){}function Xn(n){if(n instanceof Mo||n instanceof ox||n instanceof oR||n instanceof Mm||n instanceof t_)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Je('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Mo(n.message);case"InvalidPDFException":return new ox(n.message);case"PasswordException":return new oR(n.message,n.code);case"ResponseException":return new Mm(n.message,n.status,n.missing);case"UnknownErrorException":return new t_(n.message,n.details)}return new t_(n.message,n.toString())}var Qd,ew,GO,tw,qO,nw,WO,Jd,Zv;class Np{constructor(e,t,s){x(this,ew);x(this,tw);x(this,nw);x(this,Jd);x(this,Qd,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",C(this,ew,GO).bind(this),{signal:l(this,Qd).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},s)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,s,r){const i=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:e,streamId:i,data:t,desiredSize:u.desiredSize},r),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[i].pullCall=d,c.postMessage({sourceName:o,targetName:a,stream:Mt.PULL,streamId:i,desiredSize:u.desiredSize}),d.promise},cancel:u=>{Ne(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[i].cancelCall=d,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:Mt.CANCEL,streamId:i,reason:Xn(u)}),d.promise}},s)}destroy(){var e;(e=l(this,Qd))==null||e.abort(),_(this,Qd,null)}}Qd=new WeakMap,ew=new WeakSet,GO=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){C(this,nw,WO).call(this,e);return}if(e.callback){const s=e.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===wv.DATA)r.resolve(e.data);else if(e.callback===wv.ERROR)r.reject(Xn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:s,targetName:r,callback:wv.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:s,targetName:r,callback:wv.ERROR,callbackId:e.callbackId,reason:Xn(o)})});return}if(e.streamId){C(this,tw,qO).call(this,e);return}t(e.data)},tw=new WeakSet,qO=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this,a=this.actionHandler[e.action],c={enqueue(u,d=1,h){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:r,stream:Mt.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Mt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){Ne(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:Mt.ERROR,streamId:t,reason:Xn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(a,e.data,c).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Mt.START_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:Mt.START_COMPLETE,streamId:t,reason:Xn(u)})})},nw=new WeakSet,WO=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Mt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Xn(e.reason));break;case Mt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Xn(e.reason));break;case Mt.PULL:if(!a){i.postMessage({sourceName:s,targetName:r,stream:Mt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||pR).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Mt.PULL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:Mt.PULL_COMPLETE,streamId:t,reason:Xn(u)})});break;case Mt.ENQUEUE:if(Ne(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Mt.CLOSE:if(Ne(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),C(this,Jd,Zv).call(this,o,t);break;case Mt.ERROR:Ne(o,"error should have stream controller"),o.controller.error(Xn(e.reason)),C(this,Jd,Zv).call(this,o,t);break;case Mt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Xn(e.reason)),C(this,Jd,Zv).call(this,o,t);break;case Mt.CANCEL:if(!a)break;const c=Xn(e.reason);Promise.try(a.onCancel||pR,c).then(function(){i.postMessage({sourceName:s,targetName:r,stream:Mt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:Mt.CANCEL_COMPLETE,streamId:t,reason:Xn(u)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Jd=new WeakSet,Zv=async function(e,t){var s,r,i;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(r=e.pullCall)==null?void 0:r.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var Pg;class KO{constructor({enableHWA:e=!1}){x(this,Pg,!1);_(this,Pg,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Pg)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Je("Abstract method `_createCanvas` called.")}}Pg=new WeakMap;class Iq extends KO{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class XO{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Je("Abstract method `_fetch` called.")}}class mR extends XO{async _fetch(e){const t=await Hf(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):jy(t)}}class YO{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,r,i){return"none"}destroy(e=!1){}}var hc,Zd,Wi,Ki,_n,fc,pc,Xt,xn,mc,Rp,pa,Uu,eh,eb,ma,Hu,sw,QO,Ng,pE,ga,Gu,gc,jp,yc,Mp,Rg,mE,vc,Lp;class Dq extends YO{constructor({docId:t,ownerDocument:s=globalThis.document}){super();x(this,Xt);x(this,mc);x(this,pa);x(this,eh);x(this,ma);x(this,sw);x(this,Ng);x(this,ga);x(this,gc);x(this,yc);x(this,Rg);x(this,vc);x(this,hc,void 0);x(this,Zd,void 0);x(this,Wi,void 0);x(this,Ki,void 0);x(this,_n,void 0);x(this,fc,void 0);x(this,pc,0);_(this,Ki,t),_(this,_n,s)}addFilter(t){if(!t)return"none";let s=l(this,Xt,xn).get(t);if(s)return s;const[r,i,o]=C(this,eh,eb).call(this,t),a=t.length===1?r:`${r}${i}${o}`;if(s=l(this,Xt,xn).get(a),s)return l(this,Xt,xn).set(t,s),s;const c=`g_${l(this,Ki)}_transfer_map_${$t(this,pc)._++}`,u=C(this,ma,Hu).call(this,c);l(this,Xt,xn).set(t,u),l(this,Xt,xn).set(a,u);const d=C(this,ga,Gu).call(this,c);return C(this,yc,Mp).call(this,r,i,o,d),u}addHCMFilter(t,s){var y;const r=`${t}-${s}`,i="base";let o=l(this,mc,Rp).get(i);if((o==null?void 0:o.key)===r||(o?((y=o.filter)==null||y.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},l(this,mc,Rp).set(i,o)),!t||!s))return o.url;const a=C(this,vc,Lp).call(this,t);t=Z.makeHexColor(...a);const c=C(this,vc,Lp).call(this,s);if(s=Z.makeHexColor(...c),l(this,pa,Uu).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let g=0;g<=255;g++){const w=g/255;u[g]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=u.join(","),h=`g_${l(this,Ki)}_hcm_filter`,p=o.filter=C(this,ga,Gu).call(this,h);C(this,yc,Mp).call(this,d,d,d,p),C(this,Ng,pE).call(this,p);const m=(g,w)=>{const v=a[g]/255,b=c[g]/255,S=new Array(w+1);for(let E=0;E<=w;E++)S[E]=v+E/w*(b-v);return S.join(",")};return C(this,yc,Mp).call(this,m(0,5),m(1,5),m(2,5),p),o.url=C(this,ma,Hu).call(this,h),o.url}addAlphaFilter(t){let s=l(this,Xt,xn).get(t);if(s)return s;const[r]=C(this,eh,eb).call(this,[t]),i=`alpha_${r}`;if(s=l(this,Xt,xn).get(i),s)return l(this,Xt,xn).set(t,s),s;const o=`g_${l(this,Ki)}_alpha_map_${$t(this,pc)._++}`,a=C(this,ma,Hu).call(this,o);l(this,Xt,xn).set(t,a),l(this,Xt,xn).set(i,a);const c=C(this,ga,Gu).call(this,o);return C(this,Rg,mE).call(this,r,c),a}addLuminosityFilter(t){let s=l(this,Xt,xn).get(t||"luminosity");if(s)return s;let r,i;if(t?([r]=C(this,eh,eb).call(this,[t]),i=`luminosity_${r}`):i="luminosity",s=l(this,Xt,xn).get(i),s)return l(this,Xt,xn).set(t,s),s;const o=`g_${l(this,Ki)}_luminosity_map_${$t(this,pc)._++}`,a=C(this,ma,Hu).call(this,o);l(this,Xt,xn).set(t,a),l(this,Xt,xn).set(i,a);const c=C(this,ga,Gu).call(this,o);return C(this,sw,QO).call(this,c),t&&C(this,Rg,mE).call(this,r,c),a}addHighlightHCMFilter(t,s,r,i,o){var b;const a=`${s}-${r}-${i}-${o}`;let c=l(this,mc,Rp).get(t);if((c==null?void 0:c.key)===a||(c?((b=c.filter)==null||b.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,mc,Rp).set(t,c)),!s||!r))return c.url;const[u,d]=[s,r].map(C(this,vc,Lp).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[m,y]=[i,o].map(C(this,vc,Lp).bind(this));p<h&&([h,p,m,y]=[p,h,y,m]),l(this,pa,Uu).style.color="";const g=(S,E,k)=>{const T=new Array(256),P=(p-h)/k,N=S/255,M=(E-S)/(255*k);let L=0;for(let O=0;O<=k;O++){const D=Math.round(h+O*P),V=N+O*M;for(let I=L;I<=D;I++)T[I]=V;L=D+1}for(let O=L;O<256;O++)T[O]=T[L-1];return T.join(",")},w=`g_${l(this,Ki)}_hcm_${t}_filter`,v=c.filter=C(this,ga,Gu).call(this,w);return C(this,Ng,pE).call(this,v),C(this,yc,Mp).call(this,g(m[0],y[0],5),g(m[1],y[1],5),g(m[2],y[2],5),v),c.url=C(this,ma,Hu).call(this,w),c.url}destroy(t=!1){var s,r,i,o;t&&((s=l(this,fc))!=null&&s.size)||((r=l(this,Wi))==null||r.parentNode.parentNode.remove(),_(this,Wi,null),(i=l(this,Zd))==null||i.clear(),_(this,Zd,null),(o=l(this,fc))==null||o.clear(),_(this,fc,null),_(this,pc,0))}}hc=new WeakMap,Zd=new WeakMap,Wi=new WeakMap,Ki=new WeakMap,_n=new WeakMap,fc=new WeakMap,pc=new WeakMap,Xt=new WeakSet,xn=function(){return l(this,Zd)||_(this,Zd,new Map)},mc=new WeakSet,Rp=function(){return l(this,fc)||_(this,fc,new Map)},pa=new WeakSet,Uu=function(){if(!l(this,Wi)){const t=l(this,_n).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const r=l(this,_n).createElementNS(ki,"svg");r.setAttribute("width",0),r.setAttribute("height",0),_(this,Wi,l(this,_n).createElementNS(ki,"defs")),t.append(r),r.append(l(this,Wi)),l(this,_n).body.append(t)}return l(this,Wi)},eh=new WeakSet,eb=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=u[p]/255;const h=d.join(",");return[h,h,h]}const[s,r,i]=t,o=new Array(256),a=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=r[u]/255,c[u]=i[u]/255;return[o.join(","),a.join(","),c.join(",")]},ma=new WeakSet,Hu=function(t){if(l(this,hc)===void 0){_(this,hc,"");const s=l(this,_n).URL;s!==l(this,_n).baseURI&&(Ly(s)?pe('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,hc,iT(s,"")))}return`url(${l(this,hc)}#${t})`},sw=new WeakSet,QO=function(t){const s=l(this,_n).createElementNS(ki,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Ng=new WeakSet,pE=function(t){const s=l(this,_n).createElementNS(ki,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},ga=new WeakSet,Gu=function(t){const s=l(this,_n).createElementNS(ki,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,pa,Uu).append(s),s},gc=new WeakSet,jp=function(t,s,r){const i=l(this,_n).createElementNS(ki,s);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)},yc=new WeakSet,Mp=function(t,s,r,i){const o=l(this,_n).createElementNS(ki,"feComponentTransfer");i.append(o),C(this,gc,jp).call(this,o,"feFuncR",t),C(this,gc,jp).call(this,o,"feFuncG",s),C(this,gc,jp).call(this,o,"feFuncB",r)},Rg=new WeakSet,mE=function(t,s){const r=l(this,_n).createElementNS(ki,"feComponentTransfer");s.append(r),C(this,gc,jp).call(this,r,"feFuncA",t)},vc=new WeakSet,Lp=function(t){return l(this,pa,Uu).style.color=t,Gf(getComputedStyle(l(this,pa,Uu)).getPropertyValue("color"))};class JO{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Je("Abstract method `_fetch` called.")}}class gR extends JO{async _fetch(e){const t=await Hf(e,"arraybuffer");return new Uint8Array(t)}}class ZO{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Je("Abstract method `_fetch` called.")}}class yR extends ZO{async _fetch(e){const t=await Hf(e,"arraybuffer");return new Uint8Array(t)}}zn&&pe("Please use the `legacy` build in Node.js environments.");async function dT(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class Oq extends YO{}class Fq extends KO{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Bq extends XO{async _fetch(e){return dT(e)}}class $q extends JO{async _fetch(e){return dT(e)}}class zq extends ZO{async _fetch(e){return dT(e)}}const Bu="__forcedDependency",{floor:vR,ceil:bR}=Math;function Sv(n,e,t,s,r,i){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],r),n[e*4+3]=Math.max(n[e*4+3],i)}const gE=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var th,ya;class Vq{constructor(e,t){x(this,th,void 0);x(this,ya,void 0);_(this,th,e),_(this,ya,t)}get length(){return l(this,th).length}isEmpty(e){return l(this,th)[e]===gE}minX(e){return l(this,ya)[e*4+0]/256}minY(e){return l(this,ya)[e*4+1]/256}maxX(e){return(l(this,ya)[e*4+2]+1)/256}maxY(e){return(l(this,ya)[e*4+3]+1)/256}}th=new WeakMap,ya=new WeakMap;const _v=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Jn,Zn,bc,Ar,xc,Xi,ze,qe,Yi,es,jg,nh,wc,Sc,Qi,An,oi,Mg,yE;class Uq{constructor(e,t,s=!1){x(this,Mg);x(this,Jn,{__proto__:null});x(this,Zn,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Bu]:[]});x(this,bc,new Map);x(this,Ar,[]);x(this,xc,[]);x(this,Xi,[[1,0,0,1,0,0]]);x(this,ze,[-1/0,-1/0,1/0,1/0]);x(this,qe,new Float64Array([1/0,1/0,-1/0,-1/0]));x(this,Yi,-1);x(this,es,new Set);x(this,jg,new Map);x(this,nh,new Map);x(this,wc,void 0);x(this,Sc,void 0);x(this,Qi,void 0);x(this,An,void 0);x(this,oi,void 0);_(this,wc,e.width),_(this,Sc,e.height),C(this,Mg,yE).call(this,t),s&&_(this,oi,new Map)}growOperationsCount(e){e>=l(this,An).length&&C(this,Mg,yE).call(this,e,l(this,An))}save(e){return _(this,Jn,{__proto__:l(this,Jn)}),_(this,Zn,{__proto__:l(this,Zn),transform:{__proto__:l(this,Zn).transform},moveText:{__proto__:l(this,Zn).moveText},sameLineText:{__proto__:l(this,Zn).sameLineText},[Bu]:{__proto__:l(this,Zn)[Bu]}}),_(this,ze,{__proto__:l(this,ze)}),l(this,Ar).push(e),this}restore(e){var r;const t=Object.getPrototypeOf(l(this,Jn));if(t===null)return this;_(this,Jn,t),_(this,Zn,Object.getPrototypeOf(l(this,Zn))),_(this,ze,Object.getPrototypeOf(l(this,ze)));const s=l(this,Ar).pop();return s!==void 0&&((r=_v(l(this,oi),e))==null||r.dependencies.add(s),l(this,An)[e]=l(this,An)[s]),this}recordOpenMarker(e){return l(this,Ar).push(e),this}getOpenMarker(){return l(this,Ar).length===0?null:l(this,Ar).at(-1)}recordCloseMarker(e){var s;const t=l(this,Ar).pop();return t!==void 0&&((s=_v(l(this,oi),e))==null||s.dependencies.add(t),l(this,An)[e]=l(this,An)[t]),this}beginMarkedContent(e){return l(this,xc).push(e),this}endMarkedContent(e){var s;const t=l(this,xc).pop();return t!==void 0&&((s=_v(l(this,oi),e))==null||s.dependencies.add(t),l(this,An)[e]=l(this,An)[t]),this}pushBaseTransform(e){return l(this,Xi).push(Z.multiplyByDOMMatrix(l(this,Xi).at(-1),e.getTransform())),this}popBaseTransform(){return l(this,Xi).length>1&&l(this,Xi).pop(),this}recordSimpleData(e,t){return l(this,Jn)[e]=t,this}recordIncrementalData(e,t){return l(this,Zn)[e].push(t),this}resetIncrementalData(e,t){return l(this,Zn)[e].length=0,this}recordNamedData(e,t){return l(this,bc).set(e,t),this}recordSimpleDataFromNamed(e,t,s){l(this,Jn)[e]=l(this,bc).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Bu,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in l(this,Jn)&&this.recordFutureForcedDependency(t,l(this,Jn)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of l(this,es))this.recordFutureForcedDependency(Bu,e);return this}resetBBox(e){return l(this,Yi)!==e&&(_(this,Yi,e),l(this,qe)[0]=1/0,l(this,qe)[1]=1/0,l(this,qe)[2]=-1/0,l(this,qe)[3]=-1/0),this}recordClipBox(e,t,s,r,i,o){const a=Z.multiplyByDOMMatrix(l(this,Xi).at(-1),t.getTransform()),c=[1/0,1/0,-1/0,-1/0];Z.axialAlignedBoundingBox([s,i,r,o],a,c);const u=Z.intersect(l(this,ze),c);return u?(l(this,ze)[0]=u[0],l(this,ze)[1]=u[1],l(this,ze)[2]=u[2],l(this,ze)[3]=u[3]):(l(this,ze)[0]=l(this,ze)[1]=1/0,l(this,ze)[2]=l(this,ze)[3]=-1/0),this}recordBBox(e,t,s,r,i,o){const a=l(this,ze);if(a[0]===1/0)return this;const c=Z.multiplyByDOMMatrix(l(this,Xi).at(-1),t.getTransform());if(a[0]===-1/0)return Z.axialAlignedBoundingBox([s,i,r,o],c,l(this,qe)),this;const u=[1/0,1/0,-1/0,-1/0];return Z.axialAlignedBoundingBox([s,i,r,o],c,u),l(this,qe)[0]=Math.min(l(this,qe)[0],Math.max(u[0],a[0])),l(this,qe)[1]=Math.min(l(this,qe)[1],Math.max(u[1],a[1])),l(this,qe)[2]=Math.max(l(this,qe)[2],Math.min(u[2],a[2])),l(this,qe)[3]=Math.max(l(this,qe)[3],Math.min(u[3],a[3])),this}recordCharacterBBox(e,t,s,r=1,i=0,o=0,a){const c=s.bbox;let u,d;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&l(this,nh).get(s),u!==!1&&(d=[0,0,0,0],Z.axialAlignedBoundingBox(c,s.fontMatrix,d),(r!==1||i!==0||o!==0)&&Z.scaleMinMax([r,0,0,-r,i,o],d),u)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!a)return this.recordFullPageBBox(e);const h=a();return c&&d&&u===void 0&&(u=d[0]<=i-h.actualBoundingBoxLeft&&d[2]>=i+h.actualBoundingBoxRight&&d[1]<=o-h.actualBoundingBoxAscent&&d[3]>=o+h.actualBoundingBoxDescent,l(this,nh).set(s,u),u)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,i-h.actualBoundingBoxLeft,i+h.actualBoundingBoxRight,o-h.actualBoundingBoxAscent,o+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return l(this,qe)[0]=Math.max(0,l(this,ze)[0]),l(this,qe)[1]=Math.max(0,l(this,ze)[1]),l(this,qe)[2]=Math.min(l(this,wc),l(this,ze)[2]),l(this,qe)[3]=Math.min(l(this,Sc),l(this,ze)[3]),this}getSimpleIndex(e){return l(this,Jn)[e]}recordDependencies(e,t){const s=l(this,es),r=l(this,Jn),i=l(this,Zn);for(const o of t)o in l(this,Jn)?s.add(r[o]):o in i&&i[o].forEach(s.add,s);return this}recordNamedDependency(e,t){return l(this,bc).has(t)&&l(this,es).add(l(this,bc).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Bu]),l(this,oi)){const s=_v(l(this,oi),e),{dependencies:r}=s;l(this,es).forEach(r.add,r),l(this,Ar).forEach(r.add,r),l(this,xc).forEach(r.add,r),r.delete(e),s.isRenderingOperation=!0}if(l(this,Yi)===e){const s=vR(l(this,qe)[0]*256/l(this,wc)),r=vR(l(this,qe)[1]*256/l(this,Sc)),i=bR(l(this,qe)[2]*256/l(this,wc)),o=bR(l(this,qe)[3]*256/l(this,Sc));Sv(l(this,Qi),e,s,r,i,o);for(const a of l(this,es))a!==e&&Sv(l(this,Qi),a,s,r,i,o);for(const a of l(this,Ar))a!==e&&Sv(l(this,Qi),a,s,r,i,o);for(const a of l(this,xc))a!==e&&Sv(l(this,Qi),a,s,r,i,o);t||(l(this,es).clear(),_(this,Yi,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(l(this,es));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return l(this,Yi)===e&&(_(this,Yi,-1),l(this,ze)[0]=Math.max(l(this,ze)[0],l(this,qe)[0]),l(this,ze)[1]=Math.max(l(this,ze)[1],l(this,qe)[1]),l(this,ze)[2]=Math.min(l(this,ze)[2],l(this,qe)[2]),l(this,ze)[3]=Math.min(l(this,ze)[3],l(this,qe)[3]),t||l(this,es).clear()),this}_takePendingDependencies(){const e=l(this,es);return _(this,es,new Set),e}_extractOperation(e){const t=l(this,jg).get(e);return l(this,jg).delete(e),t}_pushPendingDependencies(e){for(const t of e)l(this,es).add(t)}take(){return l(this,nh).clear(),new Vq(l(this,An),l(this,Qi))}takeDebugMetadata(){return l(this,oi)}}Jn=new WeakMap,Zn=new WeakMap,bc=new WeakMap,Ar=new WeakMap,xc=new WeakMap,Xi=new WeakMap,ze=new WeakMap,qe=new WeakMap,Yi=new WeakMap,es=new WeakMap,jg=new WeakMap,nh=new WeakMap,wc=new WeakMap,Sc=new WeakMap,Qi=new WeakMap,An=new WeakMap,oi=new WeakMap,Mg=new WeakSet,yE=function(e,t){const s=new ArrayBuffer(e*4);_(this,Qi,new Uint8ClampedArray(s)),_(this,An,new Uint32Array(s)),t&&t.length>0?(l(this,An).set(t),l(this,An).fill(gE,t.length)):l(this,An).fill(gE)};var Ye,Et,Er,sh,rh;const PT=class PT{constructor(e,t,s){x(this,Ye,void 0);x(this,Et,void 0);x(this,Er,void 0);x(this,sh,0);x(this,rh,0);if(e instanceof PT&&l(e,Er)===!!s)return e;_(this,Ye,e),_(this,Et,t),_(this,Er,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return $t(this,rh)._++,l(this,Ye).save(l(this,Et)),this}restore(e){return l(this,rh)>0&&(l(this,Ye).restore(l(this,Et)),$t(this,rh)._--),this}recordOpenMarker(e){return $t(this,sh)._++,this}getOpenMarker(){return l(this,sh)>0?l(this,Et):l(this,Ye).getOpenMarker()}recordCloseMarker(e){return $t(this,sh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return l(this,Ye).pushBaseTransform(e),this}popBaseTransform(){return l(this,Ye).popBaseTransform(),this}recordSimpleData(e,t){return l(this,Ye).recordSimpleData(e,l(this,Et)),this}recordIncrementalData(e,t){return l(this,Ye).recordIncrementalData(e,l(this,Et)),this}resetIncrementalData(e,t){return l(this,Ye).resetIncrementalData(e,l(this,Et)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return l(this,Ye).recordSimpleDataFromNamed(e,t,l(this,Et)),this}recordFutureForcedDependency(e,t){return l(this,Ye).recordFutureForcedDependency(e,l(this,Et)),this}inheritSimpleDataAsFutureForcedDependencies(e){return l(this,Ye).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return l(this,Ye).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return l(this,Er)||l(this,Ye).resetBBox(l(this,Et)),this}recordClipBox(e,t,s,r,i,o){return l(this,Er)||l(this,Ye).recordClipBox(l(this,Et),t,s,r,i,o),this}recordBBox(e,t,s,r,i,o){return l(this,Er)||l(this,Ye).recordBBox(l(this,Et),t,s,r,i,o),this}recordCharacterBBox(e,t,s,r,i,o,a){return l(this,Er)||l(this,Ye).recordCharacterBBox(l(this,Et),t,s,r,i,o,a),this}recordFullPageBBox(e){return l(this,Er)||l(this,Ye).recordFullPageBBox(l(this,Et)),this}getSimpleIndex(e){return l(this,Ye).getSimpleIndex(e)}recordDependencies(e,t){return l(this,Ye).recordDependencies(l(this,Et),t),this}recordNamedDependency(e,t){return l(this,Ye).recordNamedDependency(l(this,Et),t),this}recordOperation(e){return l(this,Ye).recordOperation(l(this,Et),!0),this}recordShowTextOperation(e){return l(this,Ye).recordShowTextOperation(l(this,Et),!0),this}bboxToClipBoxDropOperation(e){return l(this,Er)||l(this,Ye).bboxToClipBoxDropOperation(l(this,Et),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Ye=new WeakMap,Et=new WeakMap,Er=new WeakMap,sh=new WeakMap,rh=new WeakMap;let cx=PT;const Gs={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},mn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function vE(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,s),n.clip(r)}class hT{isModifyingCurrentTransform(){return!1}getPattern(){Je("Abstract method `getPattern` called.")}}class Hq extends hT{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,r){let i;if(r===mn.STROKE||r===mn.FILL){const o=t.current.getClippedPathBoundingBox(r,gt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=Z.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),vE(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),i=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(s);i.setTransform(h)}else vE(e,this._bbox),i=this._createGradient(e);return i}}function r_(n,e,t,s,r,i,o,a){const c=e.coords,u=e.colors,d=n.data,h=n.width*4;let p;c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=i,i=o,o=p),c[s+1]>c[r+1]&&(p=s,s=r,r=p,p=o,o=a,a=p),c[t+1]>c[s+1]&&(p=t,t=s,s=p,p=i,i=o,o=p);const m=(c[t]+e.offsetX)*e.scaleX,y=(c[t+1]+e.offsetY)*e.scaleY,g=(c[s]+e.offsetX)*e.scaleX,w=(c[s+1]+e.offsetY)*e.scaleY,v=(c[r]+e.offsetX)*e.scaleX,b=(c[r+1]+e.offsetY)*e.scaleY;if(y>=b)return;const S=u[i],E=u[i+1],k=u[i+2],T=u[o],P=u[o+1],N=u[o+2],M=u[a],L=u[a+1],O=u[a+2],D=Math.round(y),V=Math.round(b);let I,R,j,F,$,z,B,H;for(let U=D;U<=V;U++){if(U<w){const oe=U<y?0:(y-U)/(y-w);I=m-(m-g)*oe,R=S-(S-T)*oe,j=E-(E-P)*oe,F=k-(k-N)*oe}else{let oe;U>b?oe=1:w===b?oe=0:oe=(w-U)/(w-b),I=g-(g-v)*oe,R=T-(T-M)*oe,j=P-(P-L)*oe,F=N-(N-O)*oe}let Y;U<y?Y=0:U>b?Y=1:Y=(y-U)/(y-b),$=m-(m-v)*Y,z=S-(S-M)*Y,B=E-(E-L)*Y,H=k-(k-O)*Y;const Q=Math.round(Math.min(I,$)),ge=Math.round(Math.max(I,$));let Ce=h*U+Q*4;for(let oe=Q;oe<=ge;oe++)Y=(I-oe)/(I-$),Y<0?Y=0:Y>1&&(Y=1),d[Ce++]=R-(R-z)*Y|0,d[Ce++]=j-(j-B)*Y|0,d[Ce++]=F-(F-H)*Y|0,d[Ce++]=255}}function Gq(n,e,t){const s=e.coords,r=e.colors;let i,o;switch(e.type){case"lattice":const a=e.verticesPerRow,c=Math.floor(s.length/a)-1,u=a-1;for(i=0;i<c;i++){let d=i*a;for(let h=0;h<u;h++,d++)r_(n,t,s[d],s[d+1],s[d+a],r[d],r[d+1],r[d+a]),r_(n,t,s[d+a+1],s[d+1],s[d+a],r[d+a+1],r[d+1],r[d+a])}break;case"triangles":for(i=0,o=s.length;i<o;i+=3)r_(n,t,s[i],s[i+1],s[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class qq extends hT{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),m=u/h,y=d/p,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/m,scaleY:1/y},w=h+2*2,v=p+2*2,b=s.getCanvas("mesh",w,v),S=b.context,E=S.createImageData(h,p);if(t){const T=E.data;for(let P=0,N=T.length;P<N;P+=4)T[P]=t[0],T[P+1]=t[1],T[P+2]=t[2],T[P+3]=255}for(const T of this._figures)Gq(E,T,g);return S.putImageData(E,2,2),{canvas:b.canvas,offsetX:a-2*m,offsetY:c-2*y,scaleX:m,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,r){vE(e,this._bbox);const i=new Float32Array(2);if(r===mn.SHADING)Z.singularValueDecompose2dScale(gt(e),i);else if(this.matrix){Z.singularValueDecompose2dScale(this.matrix,i);const[a,c]=i;Z.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=a,i[1]*=c}else Z.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,r===mn.SHADING?null:this._background,t.cachedCanvases);return r!==mn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class Wq extends hT{getPattern(){return"hotpink"}}function Kq(n){switch(n[0]){case"RadialAxial":return new Hq(n);case"Mesh":return new qq(n);case"Dummy":return new Wq}throw new Error(`Unknown IR type: ${n[0]}`)}const xR={COLORED:1,UNCOLORED:2},rw=class rw{constructor(e,t,s,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e,t){var z,B;const{bbox:s,operatorList:r,paintType:i,tilingType:o,color:a,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:d}=this;u=Math.abs(u),d=Math.abs(d),W1("TilingType: "+o);const h=s[0],p=s[1],m=s[2],y=s[3],g=m-h,w=y-p,v=new Float32Array(2);Z.singularValueDecompose2dScale(this.matrix,v);const[b,S]=v;Z.singularValueDecompose2dScale(this.baseTransform,v);const E=b*v[0],k=S*v[1];let T=g,P=w,N=!1,M=!1;const L=Math.ceil(u*E),O=Math.ceil(d*k),D=Math.ceil(g*E),V=Math.ceil(w*k);L>=D?T=u:N=!0,O>=V?P=d:M=!0;const I=this.getSizeAndScale(T,this.ctx.canvas.width,E),R=this.getSizeAndScale(P,this.ctx.canvas.height,k),j=e.cachedCanvases.getCanvas("pattern",I.size,R.size),F=j.context,$=c.createCanvasGraphics(F,t);if($.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext($,i,a),F.translate(-I.scale*h,-R.scale*p),$.transform(0,I.scale,0,0,R.scale,0,0),F.save(),(z=$.dependencyTracker)==null||z.save(),this.clipBbox($,h,p,m,y),$.baseTransform=gt($.ctx),$.executeOperatorList(r),$.endDrawing(),(B=$.dependencyTracker)==null||B.restore(),F.restore(),N||M){const H=j.canvas;N&&(T=u),M&&(P=d);const U=this.getSizeAndScale(T,this.ctx.canvas.width,E),Y=this.getSizeAndScale(P,this.ctx.canvas.height,k),Q=U.size,ge=Y.size,Ce=e.cachedCanvases.getCanvas("pattern-workaround",Q,ge),oe=Ce.context,je=N?Math.floor(g/u):0,Ue=M?Math.floor(w/d):0;for(let ye=0;ye<=je;ye++)for(let Be=0;Be<=Ue;Be++)oe.drawImage(H,Q*ye,ge*Be,Q,ge,0,0,Q,ge);return{canvas:Ce.canvas,scaleX:U.scale,scaleY:Y.scale,offsetX:h,offsetY:p}}return{canvas:j.canvas,scaleX:I.scale,scaleY:R.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,s){const r=Math.max(rw.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=r?i=r:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,r,i){const o=r-t,a=i-s;e.ctx.rect(t,s,o,a),Z.axialAlignedBoundingBox([t,s,r,i],gt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const r=e.ctx,i=e.current;switch(t){case xR.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;r.fillStyle=i.fillColor=o,r.strokeStyle=i.strokeColor=a;break;case xR.UNCOLORED:r.fillStyle=r.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new mq(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,r,i){let o=s;r!==mn.SHADING&&(o=Z.transform(o,t.baseTransform),this.matrix&&(o=Z.transform(o,this.matrix)));const a=this.createPatternCanvas(t,i);let c=new DOMMatrix(o);c=c.translate(a.offsetX,a.offsetY),c=c.scale(1/a.scaleX,1/a.scaleY);const u=e.createPattern(a.canvas,"repeat");return u.setTransform(c),u}};q(rw,"MAX_PATTERN_SIZE",3e3);let bE=rw;function Xq({src:n,srcPos:e=0,dest:t,width:s,height:r,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const a=rn.isLittleEndian?4278190080:255,[c,u]=o?[i,a]:[a,i],d=s>>3,h=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let y=0;y<r;y++){for(const w=e+d;e<w;e++){const v=e<p?n[e]:255;t[m++]=v&128?u:c,t[m++]=v&64?u:c,t[m++]=v&32?u:c,t[m++]=v&16?u:c,t[m++]=v&8?u:c,t[m++]=v&4?u:c,t[m++]=v&2?u:c,t[m++]=v&1?u:c}if(h===0)continue;const g=e<p?n[e++]:255;for(let w=0;w<h;w++)t[m++]=g&1<<7-w?u:c}return{srcPos:e,destPos:m}}const wR=16,SR=100,Yq=15,_R=10,rs=16,i_=new DOMMatrix,Ls=new Float32Array(2),dd=new Float32Array([1/0,1/0,-1/0,-1/0]);function Qq(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,r,i,o,a){e.transform(t,s,r,i,o,a),this.__originalTransform(t,s,r,i,o,a)},n.setTransform=function(t,s,r,i,o,a){e.setTransform(t,s,r,i,o,a),this.__originalSetTransform(t,s,r,i,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,r,i,o,a){e.bezierCurveTo(t,s,r,i,o,a),this.__originalBezierCurveTo(t,s,r,i,o,a)},n.rect=function(t,s,r,i){e.rect(t,s,r,i),this.__originalRect(t,s,r,i)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Jq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,s)):(r=this.canvasFactory.create(t,s),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Av(n,e,t,s,r,i,o,a,c,u){const[d,h,p,m,y,g]=gt(n);if(h===0&&p===0){const b=o*d+y,S=Math.round(b),E=a*m+g,k=Math.round(E),T=(o+c)*d+y,P=Math.abs(Math.round(T)-S)||1,N=(a+u)*m+g,M=Math.abs(Math.round(N)-k)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(m),S,k),n.drawImage(e,t,s,r,i,0,0,P,M),n.setTransform(d,h,p,m,y,g),[P,M]}if(d===0&&m===0){const b=a*p+y,S=Math.round(b),E=o*h+g,k=Math.round(E),T=(a+u)*p+y,P=Math.abs(Math.round(T)-S)||1,N=(o+c)*h+g,M=Math.abs(Math.round(N)-k)||1;return n.setTransform(0,Math.sign(h),Math.sign(p),0,S,k),n.drawImage(e,t,s,r,i,0,0,M,P),n.setTransform(d,h,p,m,y,g),[M,P]}n.drawImage(e,t,s,r,i,o,a,c,u);const w=Math.hypot(d,h),v=Math.hypot(p,m);return[w*c,v*u]}class AR{constructor(e,t,s){q(this,"alphaIsShape",!1);q(this,"fontSize",0);q(this,"fontSizeScale",1);q(this,"textMatrix",null);q(this,"textMatrixScale",1);q(this,"fontMatrix",GA);q(this,"leading",0);q(this,"x",0);q(this,"y",0);q(this,"lineX",0);q(this,"lineY",0);q(this,"charSpacing",0);q(this,"wordSpacing",0);q(this,"textHScale",1);q(this,"textRenderingMode",an.FILL);q(this,"textRise",0);q(this,"fillColor","#000000");q(this,"strokeColor","#000000");q(this,"patternFill",!1);q(this,"patternStroke",!1);q(this,"fillAlpha",1);q(this,"strokeAlpha",1);q(this,"lineWidth",1);q(this,"activeSMask",null);q(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=dd.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=mn.FILL,t=null){const s=this.minMax.slice();if(e===mn.STROKE){t||Je("Stroke bounding box must include transform."),Z.singularValueDecompose2dScale(t,Ls);const r=Ls[0]*this.lineWidth/2,i=Ls[1]*this.lineWidth/2;s[0]-=r,s[1]-=i,s[2]+=r,s[3]+=i}return s}updateClipFromPath(){const e=Z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(dd,0)}getClippedPathBoundingBox(e=mn.FILL,t=null){return Z.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function ER(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,r=t%rs,i=(t-r)/rs,o=r===0?i:i+1,a=n.createImageData(s,rs);let c=0,u;const d=e.data,h=a.data;let p,m,y,g;if(e.kind===cm.GRAYSCALE_1BPP){const w=d.byteLength,v=new Uint32Array(h.buffer,0,h.byteLength>>2),b=v.length,S=s+7>>3,E=4294967295,k=rn.isLittleEndian?4278190080:255;for(p=0;p<o;p++){for(y=p<i?rs:r,u=0,m=0;m<y;m++){const T=w-c;let P=0;const N=T>S?s:T*8-7,M=N&-8;let L=0,O=0;for(;P<M;P+=8)O=d[c++],v[u++]=O&128?E:k,v[u++]=O&64?E:k,v[u++]=O&32?E:k,v[u++]=O&16?E:k,v[u++]=O&8?E:k,v[u++]=O&4?E:k,v[u++]=O&2?E:k,v[u++]=O&1?E:k;for(;P<N;P++)L===0&&(O=d[c++],L=128),v[u++]=O&L?E:k,L>>=1}for(;u<b;)v[u++]=0;n.putImageData(a,0,p*rs)}}else if(e.kind===cm.RGBA_32BPP){for(m=0,g=s*rs*4,p=0;p<i;p++)h.set(d.subarray(c,c+g)),c+=g,n.putImageData(a,0,m),m+=rs;p<o&&(g=s*r*4,h.set(d.subarray(c,c+g)),n.putImageData(a,0,m))}else if(e.kind===cm.RGB_24BPP)for(y=rs,g=s*y,p=0;p<o;p++){for(p>=i&&(y=r,g=s*y),u=0,m=g;m--;)h[u++]=d[c++],h[u++]=d[c++],h[u++]=d[c++],h[u++]=255;n.putImageData(a,0,p*rs)}else throw new Error(`bad image kind: ${e.kind}`)}function CR(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,r=t%rs,i=(t-r)/rs,o=r===0?i:i+1,a=n.createImageData(s,rs);let c=0;const u=e.data,d=a.data;for(let h=0;h<o;h++){const p=h<i?rs:r;({srcPos:c}=Xq({src:u,srcPos:c,dest:d,width:s,height:p,nonBlackColor:0})),n.putImageData(a,0,h*rs)}}function hp(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Ev(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function kR(n,e){if(e)return!0;Z.singularValueDecompose2dScale(n,Ls);const t=Math.fround($r.pixelRatio*Lo.PDF_TO_CSS_UNITS);return Ls[0]<=t&&Ls[1]<=t}const Zq=["butt","round","square"],eW=["miter","round","bevel"],tW={},TR={};var Lg,xE,Ig,wE,Dg,SE;const NT=class NT{constructor(e,t,s,r,i,{optionalContentConfig:o,markedContentStack:a=null},c,u,d){x(this,Lg);x(this,Ig);x(this,Dg);this.ctx=e,this.current=new AR(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new Jq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,s=null){var r;return typeof t=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:r=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...gt(this.compositeCtx))}this.ctx.save(),Ev(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=gt(this.ctx)}executeOperatorList(e,t,s,r,i){var v;const o=e.argsArray,a=e.fnArray;let c=t||0;const u=o.length;if(u===c)return c;const d=u-c>_R&&typeof s=="function",h=d?Date.now()+Yq:0;let p=0;const m=this.commonObjs,y=this.objs;let g,w;for(;;){if(r!==void 0&&c===r.nextBreakPoint)return r.breakIt(c,s),c;if(!i||i(c))if(g=a[c],w=o[c]??null,g!==If.dependency)w===null?this[g](c):this[g](c,...w);else for(const b of w){(v=this.dependencyTracker)==null||v.recordNamedData(b,c);const S=b.startsWith("g_")?m:y;if(!S.has(b))return S.get(b,s),c}if(c++,c===u)return c;if(d&&++p>_R){if(Date.now()>h)return s(),c;p=0}}}endDrawing(){C(this,Lg,xE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),C(this,Ig,wE).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,c=r,u="prescale1",d,h;for(;i>2&&a>1||o>2&&c>1;){let p=a,m=c;i>2&&a>1&&(p=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),i/=a/p),o>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/m),d=this.cachedCanvases.getCanvas(u,p,m),h=d.context,h.clearRect(0,0,p,m),h.drawImage(e,0,0,a,c,0,0,p,m),e=d.canvas,a=p,c=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:c}}_createMaskCanvas(e,t){var L,O;const s=this.ctx,{width:r,height:i}=t,o=this.current.fillColor,a=this.current.patternFill,c=gt(s);let u,d,h,p;if((t.bitmap||t.data)&&t.count>1){const D=t.bitmap||t.data.buffer;d=JSON.stringify(a?c:[c.slice(0,4),o]),u=this._cachedBitmapsMap.get(D),u||(u=new Map,this._cachedBitmapsMap.set(D,u));const V=u.get(d);if(V&&!a){const I=Math.round(Math.min(c[0],c[2])+c[4]),R=Math.round(Math.min(c[1],c[3])+c[5]);return(L=this.dependencyTracker)==null||L.recordDependencies(e,Gs.transformAndFill),{canvas:V,offsetX:I,offsetY:R}}h=V}h||(p=this.cachedCanvases.getCanvas("maskCanvas",r,i),CR(p.context,t));let m=Z.transform(c,[1/r,0,0,-1/i,0,0]);m=Z.transform(m,[1,0,0,1,0,-i]);const y=dd.slice();Z.axialAlignedBoundingBox([0,0,r,i],m,y);const[g,w,v,b]=y,S=Math.round(v-g)||1,E=Math.round(b-w)||1,k=this.cachedCanvases.getCanvas("fillCanvas",S,E),T=k.context,P=g,N=w;T.translate(-P,-N),T.transform(...m),h||(h=this._scaleImage(p.canvas,Gr(T)),h=h.img,u&&a&&u.set(d,h)),T.imageSmoothingEnabled=kR(gt(T),t.interpolate),Av(T,h,0,0,h.width,h.height,0,0,r,i),T.globalCompositeOperation="source-in";const M=Z.transform(Gr(T),[1,0,0,1,-P,-N]);return T.fillStyle=a?o.getPattern(s,this,M,mn.FILL,e):o,T.fillRect(0,0,r,i),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(d,k.canvas)),(O=this.dependencyTracker)==null||O.recordDependencies(e,Gs.transformAndFill),{canvas:k.canvas,offsetX:Math.round(P),offsetY:Math.round(N)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=Zq[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=eW[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,r,i,o,a;for(const[c,u]of t)switch(c){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(i=this.dependencyTracker)==null||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(a=this.dependencyTracker)==null||a.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,s);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),hp(this.suspendedCtx,o),Qq(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),hp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,r){const i=r[0],o=r[1],a=r[2]-i,c=r[3]-o;a===0||c===0||(this.genericComposeSMask(t.context,s,a,c,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,r,i,o,a,c,u,d,h){let p=e.canvas,m=c-d,y=u-h;if(o)if(m<0||y<0||m+s>p.width||y+r>p.height){const w=this.cachedCanvases.getCanvas("maskExtension",s,r),v=w.context;v.drawImage(p,-m,-y),v.globalCompositeOperation="destination-atop",v.fillStyle=o,v.fillRect(0,0,s,r),v.globalCompositeOperation="source-over",p=w.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(m,y,s,r),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(m,y,s,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(c,u,s,r),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(p,m,y,s,r,c,u,s,r),t.restore()}save(e){var s;this.inSMaskMode&&hp(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&hp(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,r,i,o,a){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",e),this.ctx.transform(t,s,r,i,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,r){let[i]=s;if(!r){i||(i=s[0]=new Path2D),this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===If.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}if(!(i instanceof Path2D)){const o=s[0]=new Path2D;for(let a=0,c=i.length;a<c;)switch(i[a++]){case vv.moveTo:o.moveTo(i[a++],i[a++]);break;case vv.lineTo:o.lineTo(i[a++],i[a++]);break;case vv.curveTo:o.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);break;case vv.closePath:o.closePath();break;default:pe(`Unrecognized drawing path operator: ${i[a-1]}`);break}i=o}Z.axialAlignedBoundingBox(r,gt(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var o;const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const a=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,Gr(r),mn.STROKE,e),a){const c=new Path2D;c.addPath(t,r.getTransform().invertSelf().multiplySelf(a)),t=c}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,Gs.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(mn.STROKE,gt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var u,d,h;const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const p=i.isModifyingCurrentTransform()?r.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),r.save(),r.fillStyle=i.getPattern(r,this,Gr(r),mn.FILL,e),p){const m=new Path2D;m.addPath(t,r.getTransform().invertSelf().multiplySelf(p)),t=m}a=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,Gs.fill),a&&(r.restore(),(h=this.dependencyTracker)==null||h.restore(e)),s&&this.consumePath(e,t,c)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,Gs.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=tW}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=TR}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,i=s.getTransform().invertSelf();for(const{transform:o,x:a,y:c,fontSize:u,path:d}of t)d&&r.addPath(d,new DOMMatrix(o).preMultiplySelf(i).translate(a,c).scale(u,-u));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var h,p;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||GA,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&pe("Invalid font matrix for font "+t),s<0?(s=-s,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const o=r.loadedName||"sans-serif",a=((p=r.systemFontInfo)==null?void 0:p.css)||`"${o}", ${r.fallbackName}`;let c="normal";r.black?c="900":r.bold&&(c="bold");const u=r.italic?"italic":"normal";let d=s;s<wR?d=wR:s>SR&&(d=SR),this.current.fontSizeScale=s/d,this.ctx.font=`${u} ${c} ${d}px ${a}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,r,i,o){var v,b,S,E;const a=this.ctx,c=this.current,u=c.font,d=c.textRenderingMode,h=c.fontSize/c.fontSizeScale,p=d&an.FILL_STROKE_MASK,m=!!(d&an.ADD_TO_PATH_FLAG),y=c.patternFill&&!u.missingFile,g=c.patternStroke&&!u.missingFile;let w;if((u.disableFontFace||m||y||g)&&!u.missingFile&&(w=u.getPathGenerator(this.commonObjs,t)),w&&(u.disableFontFace||y||g)){a.save(),a.translate(s,r),a.scale(h,-h),(v=this.dependencyTracker)==null||v.recordCharacterBBox(e,a,u);let k;if(p===an.FILL||p===an.FILL_STROKE)if(i){k=a.getTransform(),a.setTransform(...i);const T=C(this,Dg,SE).call(this,w,k,i);a.fill(T)}else a.fill(w);if(p===an.STROKE||p===an.FILL_STROKE)if(o){k||(k=a.getTransform()),a.setTransform(...o);const{a:T,b:P,c:N,d:M}=k,L=Z.inverseTransform(o),O=Z.transform([T,P,N,M,0,0],L);Z.singularValueDecompose2dScale(O,Ls),a.lineWidth*=Math.max(Ls[0],Ls[1])/h,a.stroke(C(this,Dg,SE).call(this,w,k,o))}else a.lineWidth/=h,a.stroke(w);a.restore()}else(p===an.FILL||p===an.FILL_STROKE)&&(a.fillText(t,s,r),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,a,u,h,s,r,()=>a.measureText(t))),(p===an.STROKE||p===an.FILL_STROKE)&&(this.dependencyTracker&&((S=this.dependencyTracker)==null||S.recordCharacterBBox(e,a,u,h,s,r,()=>a.measureText(t)).recordDependencies(e,Gs.stroke)),a.strokeText(t,s,r));m&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:gt(a),x:s,y:r,fontSize:h,path:w}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,a,u,h,s,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){s=!0;break}return be(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var N,M,L,O;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Gs.showText).resetBBox(e),this.current.textRenderingMode&an.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(e,t),(N=this.dependencyTracker)==null||N.recordShowTextOperation(e);return}const i=s.fontSize;if(i===0){(M=this.dependencyTracker)==null||M.recordOperation(e);return}const o=this.ctx,a=s.fontSizeScale,c=s.charSpacing,u=s.wordSpacing,d=s.fontDirection,h=s.textHScale*d,p=t.length,m=r.vertical,y=m?1:-1,g=r.defaultVMetrics,w=i*s.fontMatrix[0],v=s.textRenderingMode===an.FILL&&!r.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),d>0?o.scale(h,-1):o.scale(h,1);let b,S;if(s.patternFill){o.save();const D=s.fillColor.getPattern(o,this,Gr(o),mn.FILL,e);b=gt(o),o.restore(),o.fillStyle=D}if(s.patternStroke){o.save();const D=s.strokeColor.getPattern(o,this,Gr(o),mn.STROKE,e);S=gt(o),o.restore(),o.strokeStyle=D}let E=s.lineWidth;const k=s.textMatrixScale;if(k===0||E===0){const D=s.textRenderingMode&an.FILL_STROKE_MASK;(D===an.STROKE||D===an.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=k;if(a!==1&&(o.scale(a,a),E/=a),o.lineWidth=E,r.isInvalidPDFjsFont){const D=[];let V=0;for(const R of t)D.push(R.unicode),V+=R.width;const I=D.join("");if(o.fillText(I,0,0),this.dependencyTracker!==null){const R=o.measureText(I);this.dependencyTracker.recordBBox(e,this.ctx,-R.actualBoundingBoxLeft,R.actualBoundingBoxRight,-R.actualBoundingBoxAscent,R.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=V*w*h,o.restore(),this.compose();return}let T=0,P;for(P=0;P<p;++P){const D=t[P];if(typeof D=="number"){T+=y*D*i/1e3;continue}let V=!1;const I=(D.isSpace?u:0)+c,R=D.fontChar,j=D.accent;let F,$,z=D.width;if(m){const U=D.vmetric||g,Y=-(D.vmetric?U[1]:z*.5)*w,Q=U[2]*w;z=U?-U[0]:z,F=Y/a,$=(T+Q)/a}else F=T/a,$=0;let B;if(r.remeasure&&z>0){B=o.measureText(R);const U=B.width*1e3/i*a;if(z<U&&this.isFontSubpixelAAEnabled){const Y=z/U;V=!0,o.save(),o.scale(Y,1),F/=Y}else z!==U&&(F+=(z-U)/2e3*i/a)}if(this.contentVisible&&(D.isInFont||r.missingFile)){if(v&&!j)o.fillText(R,F,$),(L=this.dependencyTracker)==null||L.recordCharacterBBox(e,o,B?{bbox:null}:r,i/a,F,$,()=>B??o.measureText(R));else if(this.paintChar(e,R,F,$,b,S),j){const U=F+i*j.offset.x/a,Y=$-i*j.offset.y/a;this.paintChar(e,j.fontChar,U,Y,b,S)}}const H=m?z*w-I*d:z*w+I*d;T+=H,V&&o.restore()}m?s.y-=T:s.x+=T*h,o.restore(),this.compose(),(O=this.dependencyTracker)==null||O.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,r=this.current,i=r.font,o=r.fontSize,a=r.fontDirection,c=i.vertical?1:-1,u=r.charSpacing,d=r.wordSpacing,h=r.textHScale*a,p=r.fontMatrix||GA,m=t.length,y=r.textRenderingMode===an.INVISIBLE;let g,w,v,b;if(y||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(h,a);const S=this.dependencyTracker;for(this.dependencyTracker=S?new cx(S,e):null,g=0;g<m;++g){if(w=t[g],typeof w=="number"){b=c*w*o/1e3,this.ctx.translate(b,0),r.x+=b*h;continue}const E=(w.isSpace?d:0)+u,k=i.charProcOperatorList[w.operatorListId];k?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...p),this.executeOperatorList(k),this.restore()):pe(`Type3 character "${w.operatorListId}" is not available.`);const T=[w.width,0];Z.applyTransform(T,p),v=T[0]*o+E,s.translate(v,0),r.x+=v*h}s.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,r,i,o,a){var u;const c=new Path2D;c.rect(r,i,o-r,a-i),this.ctx.clip(c),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,r,o,i,a).recordClipBox(e,this.ctx,r,o,i,a),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const r=this.baseTransform||gt(this.ctx),i={createCanvasGraphics:(o,a)=>new NT(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new cx(this.dependencyTracker,a,!0):null)};s=new bE(t,this.ctx,i,r)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=Kq(this.getObject(e,t)),this.cachedPatterns.set(t,r)),s&&(r.matrix=s),r}shadingFill(e,t){var o;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const r=this._getPattern(e,t);s.fillStyle=r.getPattern(s,this,Gr(s),mn.SHADING,e);const i=Gr(s);if(i){const{width:a,height:c}=s.canvas,u=dd.slice();Z.axialAlignedBoundingBox([0,0,a,c],i,u);const[d,h,p,m]=u;this.ctx.fillRect(d,h,p-d,m-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Gs.transform).recordDependencies(e,Gs.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Je("Should not call beginInlineImage")}beginImageData(){Je("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var r;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=gt(this.ctx),s)){Z.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[i,o,a,c]=s,u=new Path2D;u.rect(i,o,a-i,c-o),this.ctx.clip(u),(r=this.dependencyTracker)==null||r.recordClipBox(e,this.ctx,i,a,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var S;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||W1("TODO: Support non-isolated groups."),t.knockout&&pe("Knockout groups not supported.");const r=gt(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=dd.slice();Z.axialAlignedBoundingBox(t.bbox,gt(s),i);const o=[0,0,s.canvas.width,s.canvas.height];i=Z.intersect(i,o)||[0,0,0,0];const a=Math.floor(i[0]),c=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-a,1),d=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,d]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,u,d),m=p.context;m.translate(-a,-c),m.transform(...r);let y=new Path2D;const[g,w,v,b]=t.bbox;if(y.rect(g,w,v-g,b-w),t.matrix){const E=new Path2D;E.addPath(y,new DOMMatrix(t.matrix)),y=E}m.clip(y),t.smask&&this.smaskStack.push({canvas:p.canvas,context:m,offsetX:a,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(a,c),s.save()),hp(s,m),this.ctx=m,(S=this.dependencyTracker)==null||S.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var i;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(i=this.dependencyTracker)==null||i.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=gt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=dd.slice();Z.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,a),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,s,r,i,o){if(C(this,Lg,xE).call(this),Ev(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const a=s[2]-s[0],c=s[3]-s[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=a,s[3]=c,Z.singularValueDecompose2dScale(gt(this.ctx),Ls);const{viewportScale:u}=this,d=Math.ceil(a*this.outputScaleX*u),h=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(Ls[0],0,0,-Ls[1],0,c*Ls[1]),Ev(this.ctx)}else{Ev(this.ctx),this.endPath(e);const u=new Path2D;u.rect(s[0],s[1],a,c),this.ctx.clip(u)}}this.current=new AR(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),C(this,Ig,wE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var a;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const r=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),(a=this.dependencyTracker)==null||a.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,r=0,i=0,o,a){var h,p,m;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=gt(c);c.transform(s,r,i,o,0,0);const d=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,d.offsetX-u[4],d.offsetY-u[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let y=0,g=a.length;y<g;y+=2){const w=Z.transform(u,[s,r,i,o,a[y],a[y+1]]);c.drawImage(d.canvas,w[4],w[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,w[4],w[4]+d.canvas.width,w[5],w[5]+d.canvas.height)}c.restore(),this.compose(),(m=this.dependencyTracker)==null||m.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,a,c;if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,i=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,Gs.transformAndFill);for(const u of t){const{data:d,width:h,height:p,transform:m}=u,y=this.cachedCanvases.getCanvas("maskCanvas",h,p),g=y.context;g.save();const w=this.getObject(e,d,u);CR(g,w),g.globalCompositeOperation="source-in",g.fillStyle=i?r.getPattern(g,this,Gr(s),mn.FILL,e):r,g.fillRect(0,0,h,p),g.restore(),s.save(),s.transform(...m),s.scale(1,-1),Av(s,y.canvas,0,0,h,p,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,s,0,h,0,p),s.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){pe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,r,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){pe("Dependent image isn't ready yet");return}const a=o.width,c=o.height,u=[];for(let d=0,h=i.length;d<h;d+=2)u.push({transform:[s,0,0,r,i[d],i[d+1]],x:0,y:0,w:a,h:c});this.paintInlineImageXObjectGroup(e,o,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,r),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const s=t.width,r=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/s,-1/r);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",s,r).context;ER(h,t),a=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(a,Gr(i));i.imageSmoothingEnabled=kR(gt(i),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,i,0,s,-r,0).recordDependencies(e,Gs.imageXObject).recordOperation(e),Av(i,c.img,0,0,c.paintWidth,c.paintHeight,0,-r,s,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var o,a,c;if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const u=t.width,d=t.height,p=this.cachedCanvases.getCanvas("inlineImage",u,d).context;ER(p,t),i=this.applyTransferMapsToCanvas(p)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const u of s)r.save(),r.transform(...u.transform),r.scale(1,-1),Av(r,i,u.x,u.y,u.w,u.h,0,-1,1,1),(a=this.dependencyTracker)==null||a.recordBBox(e,r,0,1,-1,0),r.restore();(c=this.dependencyTracker)==null||c.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Gs.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var o,a;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip?(r||(this.pendingClip===TR?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(a=this.dependencyTracker)==null||a.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=gt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:r,d:i}=this.ctx.getTransform();let o,a;if(s===0&&r===0){const c=Math.abs(t),u=Math.abs(i);if(c===u)if(e===0)o=a=1/c;else{const d=c*e;o=a=d<1?1/d:1}else if(e===0)o=1/c,a=1/u;else{const d=c*e,h=u*e;o=d<1?1/d:1,a=h<1?1/h:1}}else{const c=Math.abs(t*i-s*r),u=Math.hypot(t,s),d=Math.hypot(r,i);if(e===0)o=d/c,a=u/c;else{const h=e*c;o=d>h?d/h:1,a=u>h?u/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:r}}=this,[i,o]=this.getScaleForStroking();if(i===o){s.lineWidth=(r||1)*i,s.stroke(e);return}const a=s.getLineDash();t&&s.save(),s.scale(i,o),i_.a=1/i,i_.d=1/o;const c=new Path2D;if(c.addPath(e,i_),a.length>0){const u=Math.max(i,o);s.setLineDash(a.map(d=>d/u)),s.lineDashOffset/=u}s.lineWidth=r||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Lg=new WeakSet,xE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ig=new WeakSet,wE=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Dg=new WeakSet,SE=function(e,t,s){const r=new Path2D;return r.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),r};let Sd=NT;for(const n in If)Sd.prototype[n]!==void 0&&(Sd.prototype[If[n]]=Sd.prototype[n]);var ih,oh,Og,ah,tb;const fd=class fd{constructor(e){x(this,ah);x(this,ih,void 0);x(this,oh,void 0);x(this,Og,void 0);_(this,ih,e),_(this,oh,new DataView(l(this,ih))),_(this,Og,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let r=0;for(const u of fd.strings){const d=t.encode(e[u]);s[u]=d,r+=4+d.length}const i=new ArrayBuffer(r),o=new Uint8Array(i),a=new DataView(i);let c=0;for(const u of fd.strings){const d=s[u],h=d.length;a.setUint32(c,h),o.set(d,c+4),c+=4+h}return Ne(c===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}get fontFamily(){return C(this,ah,tb).call(this,0)}get fontWeight(){return C(this,ah,tb).call(this,1)}get italicAngle(){return C(this,ah,tb).call(this,2)}};ih=new WeakMap,oh=new WeakMap,Og=new WeakMap,ah=new WeakSet,tb=function(e){Ne(e<fd.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=l(this,oh).getUint32(t)+4;const s=l(this,oh).getUint32(t);return l(this,Og).decode(new Uint8Array(l(this,ih),t+4,s))},q(fd,"strings",["fontFamily","fontWeight","italicAngle"]);let ux=fd;var va,ai,_c,Ac,Ip;const pd=class pd{constructor(e){x(this,Ac);x(this,va,void 0);x(this,ai,void 0);x(this,_c,void 0);_(this,va,e),_(this,ai,new DataView(l(this,va))),_(this,_c,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let r=0;for(const p of pd.strings){const m=t.encode(e[p]);s[p]=m,r+=4+m.length}r+=4;let i,o,a=1+r;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),a+=4+i.length+4+o.length);const c=new ArrayBuffer(a),u=new Uint8Array(c),d=new DataView(c);let h=0;d.setUint8(h++,e.guessFallback?1:0),d.setUint32(h,0),h+=4,r=0;for(const p of pd.strings){const m=s[p],y=m.length;r+=4+y,d.setUint32(h,y),u.set(m,h+4),h+=4+y}return d.setUint32(h-r-4,r),e.style&&(d.setUint32(h,i.length),u.set(i,h+4),h+=4+i.length,d.setUint32(h,o.length),u.set(o,h+4),h+=4+o.length),Ne(h<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(h)}get guessFallback(){return l(this,ai).getUint8(0)!==0}get css(){return C(this,Ac,Ip).call(this,0)}get loadedName(){return C(this,Ac,Ip).call(this,1)}get baseFontName(){return C(this,Ac,Ip).call(this,2)}get src(){return C(this,Ac,Ip).call(this,3)}get style(){let e=1;e+=4+l(this,ai).getUint32(e);const t=l(this,ai).getUint32(e),s=l(this,_c).decode(new Uint8Array(l(this,va),e+4,t));e+=4+t;const r=l(this,ai).getUint32(e),i=l(this,_c).decode(new Uint8Array(l(this,va),e+4,r));return{style:s,weight:i}}};va=new WeakMap,ai=new WeakMap,_c=new WeakMap,Ac=new WeakSet,Ip=function(e){Ne(e<pd.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=l(this,ai).getUint32(t)+4;const s=l(this,ai).getUint32(t);return l(this,_c).decode(new Uint8Array(l(this,va),t+4,s))},q(pd,"strings",["css","loadedName","baseFontName","src"]);let dx=pd;var lh,ch,uh,dh,ys,li,Fg,We,vs,yr,hh,nb,Ec,Dp;const ve=class ve{constructor({data:e,extra:t}){x(this,vs);x(this,hh);x(this,Ec);x(this,li,void 0);x(this,Fg,void 0);x(this,We,void 0);_(this,li,e),_(this,Fg,new TextDecoder),_(this,We,new DataView(l(this,li))),t&&Object.assign(this,t)}get black(){return C(this,vs,yr).call(this,0)}get bold(){return C(this,vs,yr).call(this,1)}get disableFontFace(){return C(this,vs,yr).call(this,2)}get fontExtraProperties(){return C(this,vs,yr).call(this,3)}get isInvalidPDFjsFont(){return C(this,vs,yr).call(this,4)}get isType3Font(){return C(this,vs,yr).call(this,5)}get italic(){return C(this,vs,yr).call(this,6)}get missingFile(){return C(this,vs,yr).call(this,7)}get remeasure(){return C(this,vs,yr).call(this,8)}get vertical(){return C(this,vs,yr).call(this,9)}get ascent(){return C(this,hh,nb).call(this,0)}get defaultWidth(){return C(this,hh,nb).call(this,1)}get descent(){return C(this,hh,nb).call(this,2)}get bbox(){let e=l(ve,ch);if(l(this,We).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<4;r++)s.push(l(this,We).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=l(ve,uh);if(l(this,We).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<6;r++)s.push(l(this,We).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=l(ve,dh);if(l(this,We).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<3;r++)s.push(l(this,We).getInt16(e,!0)),e+=2;return s}get fallbackName(){return C(this,Ec,Dp).call(this,0)}get loadedName(){return C(this,Ec,Dp).call(this,1)}get mimetype(){return C(this,Ec,Dp).call(this,2)}get name(){return C(this,Ec,Dp).call(this,3)}get data(){let e=l(ve,ys);const t=l(this,We).getUint32(e);e+=4+t;const s=l(this,We).getUint32(e);e+=4+s;const r=l(this,We).getUint32(e);e+=4+r;const i=l(this,We).getUint32(e);if(i!==0)return new Uint8Array(l(this,li),e+4,i)}clearData(){let e=l(ve,ys);const t=l(this,We).getUint32(e);e+=4+t;const s=l(this,We).getUint32(e);e+=4+s;const r=l(this,We).getUint32(e);e+=4+r;const i=l(this,We).getUint32(e);new Uint8Array(l(this,li),e+4,i).fill(0),l(this,We).setUint32(e,0)}get cssFontInfo(){let e=l(ve,ys);const t=l(this,We).getUint32(e);e+=4+t;const s=l(this,We).getUint32(e);e+=4+s;const r=l(this,We).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(l(this,li),e+4,r)),new ux(i.buffer)}get systemFontInfo(){let e=l(ve,ys);const t=l(this,We).getUint32(e);e+=4+t;const s=l(this,We).getUint32(e);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(l(this,li),e+4,s)),new dx(r.buffer)}static write(e){const t=e.systemFontInfo?dx.write(e.systemFontInfo):null,s=e.cssFontInfo?ux.write(e.cssFontInfo):null,r=new TextEncoder,i={};let o=0;for(const g of ve.strings)i[g]=r.encode(e[g]),o+=4+i[g].length;const a=l(ve,ys)+4+o+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),c=new ArrayBuffer(a),u=new Uint8Array(c),d=new DataView(c);let h=0;const p=ve.bools.length;let m=0,y=0;for(let g=0;g<p;g++){const w=e[ve.bools[g]];m|=(w===void 0?0:w?2:1)<<y,y+=2,(y===8||g===p-1)&&(d.setUint8(h++,m),m=0,y=0)}Ne(h===l(ve,lh),"FontInfo.write: Boolean properties offset mismatch");for(const g of ve.numbers)d.setFloat64(h,e[g]),h+=8;if(Ne(h===l(ve,ch),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(h++,4);for(const g of e.bbox)d.setInt16(h,g,!0),h+=2}else d.setUint8(h++,0),h+=2*4;if(Ne(h===l(ve,uh),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(h++,6);for(const g of e.fontMatrix)d.setFloat64(h,g,!0),h+=8}else d.setUint8(h++,0),h+=8*6;if(Ne(h===l(ve,dh),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(h++,1);for(const g of e.defaultVMetrics)d.setInt16(h,g,!0),h+=2}else d.setUint8(h++,0),h+=3*2;Ne(h===l(ve,ys),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(l(ve,ys),0),h+=4;for(const g of ve.strings){const w=i[g],v=w.length;d.setUint32(h,v),u.set(w,h+4),h+=4+v}if(d.setUint32(l(ve,ys),h-l(ve,ys)-4),!t)d.setUint32(h,0),h+=4;else{const g=t.byteLength;d.setUint32(h,g),Ne(h+4+g<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),h+4),h+=4+g}if(!s)d.setUint32(h,0),h+=4;else{const g=s.byteLength;d.setUint32(h,g),Ne(h+4+g<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(s),h+4),h+=4+g}return e.data===void 0?(d.setUint32(h,0),h+=4):(d.setUint32(h,e.data.length),u.set(e.data,h+4),h+=4+e.data.length),Ne(h<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(h)}};lh=new WeakMap,ch=new WeakMap,uh=new WeakMap,dh=new WeakMap,ys=new WeakMap,li=new WeakMap,Fg=new WeakMap,We=new WeakMap,vs=new WeakSet,yr=function(e){Ne(e<ve.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,r=l(this,We).getUint8(t)>>s&3;return r===0?void 0:r===2},hh=new WeakSet,nb=function(e){return Ne(e<ve.numbers.length,"Invalid number index"),l(this,We).getFloat64(l(ve,lh)+e*8)},Ec=new WeakSet,Dp=function(e){Ne(e<ve.strings.length,"Invalid string index");let t=l(ve,ys)+4;for(let i=0;i<e;i++)t+=l(this,We).getUint32(t)+4;const s=l(this,We).getUint32(t),r=new Uint8Array(s);return r.set(new Uint8Array(l(this,li),t+4,s)),l(this,Fg).decode(r)},q(ve,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),q(ve,"numbers",["ascent","defaultWidth","descent"]),q(ve,"strings",["fallbackName","loadedName","mimetype","name"]),x(ve,lh,Math.ceil(ve.bools.length*2/8)),x(ve,ch,l(ve,lh)+ve.numbers.length*8),x(ve,uh,l(ve,ch)+1+2*4),x(ve,dh,l(ve,uh)+1+8*6),x(ve,ys,l(ve,dh)+1+2*3);let _E=ve;var Bg,$g;class ar{static get workerPort(){return l(this,Bg)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");_(this,Bg,e)}static get workerSrc(){return l(this,$g)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");_(this,$g,e)}}Bg=new WeakMap,$g=new WeakMap,x(ar,Bg,null),x(ar,$g,"");var fh,zg;class nW{constructor({parsedData:e,rawData:t}){x(this,fh,void 0);x(this,zg,void 0);_(this,fh,e),_(this,zg,t)}getRaw(){return l(this,zg)}get(e){return l(this,fh).get(e)??null}[Symbol.iterator](){return l(this,fh).entries()}}fh=new WeakMap,zg=new WeakMap;const qu=Symbol("INTERNAL");var Vg,Ug,Hg,ph;class sW{constructor(e,{name:t,intent:s,usage:r,rbGroups:i}){x(this,Vg,!1);x(this,Ug,!1);x(this,Hg,!1);x(this,ph,!0);_(this,Vg,!!(e&js.DISPLAY)),_(this,Ug,!!(e&js.PRINT)),this.name=t,this.intent=s,this.usage=r,this.rbGroups=i}get visible(){if(l(this,Hg))return l(this,ph);if(!l(this,ph))return!1;const{print:e,view:t}=this.usage;return l(this,Vg)?(t==null?void 0:t.viewState)!=="OFF":l(this,Ug)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==qu&&Je("Internal method `_setVisible` called."),_(this,Hg,s),_(this,ph,t)}}Vg=new WeakMap,Ug=new WeakMap,Hg=new WeakMap,ph=new WeakMap;var ba,Ke,mh,gh,Gg,AE;class rW{constructor(e,t=js.DISPLAY){x(this,Gg);x(this,ba,null);x(this,Ke,new Map);x(this,mh,null);x(this,gh,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,_(this,gh,e.order);for(const s of e.groups)l(this,Ke).set(s.id,new sW(t,s));if(e.baseState==="OFF")for(const s of l(this,Ke).values())s._setVisible(qu,!1);for(const s of e.on)l(this,Ke).get(s)._setVisible(qu,!0);for(const s of e.off)l(this,Ke).get(s)._setVisible(qu,!1);_(this,mh,this.getHash())}}isVisible(e){if(l(this,Ke).size===0)return!0;if(!e)return W1("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,Ke).has(e.id)?l(this,Ke).get(e.id).visible:(pe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return C(this,Gg,AE).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,Ke).has(t))return pe(`Optional content group not found: ${t}`),!0;if(l(this,Ke).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,Ke).has(t))return pe(`Optional content group not found: ${t}`),!0;if(!l(this,Ke).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,Ke).has(t))return pe(`Optional content group not found: ${t}`),!0;if(!l(this,Ke).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,Ke).has(t))return pe(`Optional content group not found: ${t}`),!0;if(l(this,Ke).get(t).visible)return!1}return!0}return pe(`Unknown optional content policy ${e.policy}.`),!0}return pe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var i;const r=l(this,Ke).get(e);if(!r){pe(`Optional content group not found: ${e}`);return}if(s&&t&&r.rbGroups.length)for(const o of r.rbGroups)for(const a of o)a!==e&&((i=l(this,Ke).get(a))==null||i._setVisible(qu,!1,!0));r._setVisible(qu,!!t,!0),_(this,ba,null)}setOCGState({state:e,preserveRB:t}){let s;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const i=l(this,Ke).get(r);if(i)switch(s){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}_(this,ba,null)}get hasInitialVisibility(){return l(this,mh)===null||this.getHash()===l(this,mh)}getOrder(){return l(this,Ke).size?l(this,gh)?l(this,gh).slice():[...l(this,Ke).keys()]:null}getGroup(e){return l(this,Ke).get(e)||null}getHash(){if(l(this,ba)!==null)return l(this,ba);const e=new zO;for(const[t,s]of l(this,Ke))e.update(`${t}:${s.visible}`);return _(this,ba,e.hexdigest())}[Symbol.iterator](){return l(this,Ke).entries()}}ba=new WeakMap,Ke=new WeakMap,mh=new WeakMap,gh=new WeakMap,Gg=new WeakSet,AE=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let r=1;r<t;r++){const i=e[r];let o;if(Array.isArray(i))o=C(this,Gg,AE).call(this,i);else if(l(this,Ke).has(i))o=l(this,Ke).get(i).visible;else return pe(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class iW{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ne(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});Ne(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,r,i;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(i=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||i.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ne(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new oW(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new aW(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class oW{constructor(e,t,s=!1,r=null){this._stream=e,this._done=s||!1,this._filename=X1(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class aW{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function lW(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=a(t);return d=unescape(d),d=c(d),d=u(d),i(d)}if(t=o(n),t){const d=u(t);return i(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=a(t);return d=u(d),i(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function r(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const p=new TextDecoder(d,{fatal:!0}),m=jy(h);h=p.decode(m),e=!1}catch{}}return h}function i(d){return e&&/[\x80-\xff]/.test(d)&&(d=r("utf-8",d),e&&(d=r("iso-8859-1",d))),d}function o(d){const h=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(d))!==null;){let[,g,w,v]=p;if(g=parseInt(g,10),g in h){if(g===0)break;continue}h[g]=[w,v]}const y=[];for(let g=0;g<h.length&&g in h;++g){let[w,v]=h[g];v=a(v),w&&(v=unescape(v),g===0&&(v=c(v))),y.push(v)}return y.join("")}function a(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let p=0;p<h.length;++p){const m=h[p].indexOf('"');m!==-1&&(h[p]=h[p].slice(0,m),h.length=p+1),h[p]=h[p].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function c(d){const h=d.indexOf("'");if(h===-1)return d;const p=d.slice(0,h),y=d.slice(h+1).replace(/^[^']*'/,"");return r(p,y)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,p,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,w){return String.fromCharCode(parseInt(w,16))}),r(p,y);try{y=atob(y)}catch{}return r(p,y)})}return""}function eF(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const r=e[s];r!==void 0&&t.append(s,r)}return t}function Y1(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function tF({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function nF(n){const e=n.get("Content-Disposition");if(e){let t=lW(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(X1(t))return t}return null}function Dy(n,e){return new Mm(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function sF(n){return n===200||n===206}function rF(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function iF(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(pe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class cW{constructor(e){q(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=eF(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ne(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new uW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new dW(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class uW{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),r=t.url;fetch(r,rF(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Y1(i.url),!sF(i.status))throw Dy(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:a,suggestedLength:c}=tF({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=nF(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Mo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:iF(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class dW{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const o=r.url;fetch(o,rF(i,this._withCredentials,this._abortController)).then(a=>{const c=Y1(a.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!sF(a.status))throw Dy(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:iF(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const o_=200,a_=206;function hW(n){const e=n.response;return typeof e!="string"?e:jy(e).buffer}class fW{constructor({url:e,httpHeaders:t,withCredentials:s}){q(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=eF(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=a_):r.expectedStatus=o_,t.responseType="arraybuffer",Ne(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var r;const s=this.pendingRequests[e];s&&((r=s.onProgress)==null||r.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){s.onError(r.status);return}const i=r.status||o_;if(!(i===o_&&s.expectedStatus===a_)&&i!==s.expectedStatus){s.onError(r.status);return}const a=hW(r);if(i===a_){const c=r.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:a}):(pe('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class pW{constructor(e){this._source=e,this._manager=new fW(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ne(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new mW(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new gW(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class mW{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Y1(t.responseURL);const s=t.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...u]=a.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=tF({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=nF(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Dy(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class gW{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Y1((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Dy(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const yW=/^[a-z][a-z0-9\-+.]+:/i;function vW(n){if(yW.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class bW{constructor(e){this.source=e,this.url=vW(e.url),Ne(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ne(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new xW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new wW(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class xW{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Dy(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Mo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class wW{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const fp=Symbol("INITIAL_DATA");var bs,qg,EE;class oF{constructor(){x(this,qg);x(this,bs,Object.create(null))}get(e,t=null){if(t){const r=C(this,qg,EE).call(this,e);return r.promise.then(()=>t(r.data)),null}const s=l(this,bs)[e];if(!s||s.data===fp)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,bs)[e];return!!t&&t.data!==fp}delete(e){const t=l(this,bs)[e];return!t||t.data===fp?!1:(delete l(this,bs)[e],!0)}resolve(e,t=null){const s=C(this,qg,EE).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,bs)){const{data:s}=l(this,bs)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}_(this,bs,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,bs)){const{data:t}=l(this,bs)[e];t!==fp&&(yield[e,t])}}}bs=new WeakMap,qg=new WeakSet,EE=function(e){var t;return(t=l(this,bs))[e]||(t[e]={...Promise.withResolvers(),data:fp})};const SW=1e5,PR=30;var QR,xa,ts,Wg,Kg,Cc,Ji,Xg,Yg,kc,yh,vh,wa,bh,Qg,xh,Tc,Jg,Zg,ht,wh,Pc,e0,Sa,Sh,iw,aF,ow,lF,t0,CE,_h,sb,n0,kE,aw,cF,lw,uF;let Om=(ht=class{constructor({textContentSource:e,container:t,viewport:s}){x(this,iw);x(this,ow);x(this,t0);x(this,xa,Promise.withResolvers());x(this,ts,null);x(this,Wg,!1);x(this,Kg,!!((QR=globalThis.FontInspector)!=null&&QR.enabled));x(this,Cc,null);x(this,Ji,null);x(this,Xg,0);x(this,Yg,0);x(this,kc,null);x(this,yh,null);x(this,vh,0);x(this,wa,0);x(this,bh,Object.create(null));x(this,Qg,[]);x(this,xh,null);x(this,Tc,[]);x(this,Jg,new WeakMap);x(this,Zg,null);var c;if(e instanceof ReadableStream)_(this,xh,e);else if(typeof e=="object")_(this,xh,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,ts,_(this,yh,t)),_(this,wa,s.scale*$r.pixelRatio),_(this,vh,s.rotation),_(this,Ji,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:i,pageX:o,pageY:a}=s.rawDims;_(this,Zg,[1,0,0,-1,-o,a+i]),_(this,Yg,r),_(this,Xg,i),C(c=ht,aw,cF).call(c),dl(t,s),l(this,xa).promise.finally(()=>{l(ht,Sh).delete(this),_(this,Ji,null),_(this,bh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=rn.platform;return be(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,kc).read().then(({value:t,done:s})=>{if(s){l(this,xa).resolve();return}l(this,Cc)??_(this,Cc,t.lang),Object.assign(l(this,bh),t.styles),C(this,iw,aF).call(this,t.items),e()},l(this,xa).reject)};return _(this,kc,l(this,xh).getReader()),l(ht,Sh).add(this),e(),l(this,xa).promise}update({viewport:e,onBefore:t=null}){var i;const s=e.scale*$r.pixelRatio,r=e.rotation;if(r!==l(this,vh)&&(t==null||t(),_(this,vh,r),dl(l(this,yh),{rotation:r})),s!==l(this,wa)){t==null||t(),_(this,wa,s);const o={div:null,properties:null,ctx:C(i=ht,_h,sb).call(i,l(this,Cc))};for(const a of l(this,Tc))o.properties=l(this,Jg).get(a),o.div=a,C(this,t0,CE).call(this,o)}}cancel(){var t;const e=new Mo("TextLayer task cancelled.");(t=l(this,kc))==null||t.cancel(e).catch(()=>{}),_(this,kc,null),l(this,xa).reject(e)}get textDivs(){return l(this,Tc)}get textContentItemsStr(){return l(this,Qg)}static cleanup(){if(!(l(this,Sh).size>0)){l(this,wh).clear();for(const{canvas:e}of l(this,Pc).values())e.remove();l(this,Pc).clear()}}},xa=new WeakMap,ts=new WeakMap,Wg=new WeakMap,Kg=new WeakMap,Cc=new WeakMap,Ji=new WeakMap,Xg=new WeakMap,Yg=new WeakMap,kc=new WeakMap,yh=new WeakMap,vh=new WeakMap,wa=new WeakMap,bh=new WeakMap,Qg=new WeakMap,xh=new WeakMap,Tc=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,wh=new WeakMap,Pc=new WeakMap,e0=new WeakMap,Sa=new WeakMap,Sh=new WeakMap,iw=new WeakSet,aF=function(e){var r,i;if(l(this,Wg))return;(i=l(this,Ji)).ctx??(i.ctx=C(r=ht,_h,sb).call(r,l(this,Cc)));const t=l(this,Tc),s=l(this,Qg);for(const o of e){if(t.length>SW){pe("Ignoring additional textDivs for performance reasons."),_(this,Wg,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,ts);_(this,ts,document.createElement("span")),l(this,ts).classList.add("markedContent"),o.id&&l(this,ts).setAttribute("id",`${o.id}`),a.append(l(this,ts))}else o.type==="endMarkedContent"&&_(this,ts,l(this,ts).parentNode);continue}s.push(o.str),C(this,ow,lF).call(this,o)}},ow=new WeakSet,lF=function(e){var g;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Tc).push(t);const r=Z.transform(l(this,Zg),e.transform);let i=Math.atan2(r[1],r[0]);const o=l(this,bh)[e.fontName];o.vertical&&(i+=Math.PI/2);let a=l(this,Kg)&&o.fontSubstitution||o.fontFamily;a=ht.fontFamilyMap.get(a)||a;const c=Math.hypot(r[2],r[3]),u=c*C(g=ht,lw,uF).call(g,a,o,l(this,Cc));let d,h;i===0?(d=r[4],h=r[5]-u):(d=r[4]+u*Math.sin(i),h=r[5]-u*Math.cos(i));const p="calc(var(--total-scale-factor) *",m=t.style;l(this,ts)===l(this,yh)?(m.left=`${(100*d/l(this,Yg)).toFixed(2)}%`,m.top=`${(100*h/l(this,Xg)).toFixed(2)}%`):(m.left=`${p}${d.toFixed(2)}px)`,m.top=`${p}${h.toFixed(2)}px)`),m.fontSize=`${p}${(l(ht,Sa)*c).toFixed(2)}px)`,m.fontFamily=a,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Kg)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);w!==v&&Math.max(w,v)/Math.min(w,v)>1.5&&(y=!0)}if(y&&(s.canvasWidth=o.vertical?e.height:e.width),l(this,Jg).set(t,s),l(this,Ji).div=t,l(this,Ji).properties=s,C(this,t0,CE).call(this,l(this,Ji)),s.hasText&&l(this,ts).append(t),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),l(this,ts).append(w)}},t0=new WeakSet,CE=function(e){var a;const{div:t,properties:s,ctx:r}=e,{style:i}=t;let o="";if(l(ht,Sa)>1&&(o=`scale(${1/l(ht,Sa)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=i,{canvasWidth:u,fontSize:d}=s;C(a=ht,n0,kE).call(a,r,d*l(this,wa),c);const{width:h}=r.measureText(t.textContent);h>0&&(o=`scaleX(${u*l(this,wa)/h}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(i.transform=o)},_h=new WeakSet,sb=function(e=null){let t=l(this,Pc).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Pc).set(e,t),l(this,e0).set(t,{size:0,family:""})}return t},n0=new WeakSet,kE=function(e,t,s){const r=l(this,e0).get(e);t===r.size&&s===r.family||(e.font=`${t}px ${s}`,r.size=t,r.family=s)},aw=new WeakSet,cF=function(){if(l(this,Sa)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),_(this,Sa,e.getBoundingClientRect().height),e.remove()},lw=new WeakSet,uF=function(e,t,s){const r=l(this,wh).get(e);if(r)return r;const i=C(this,_h,sb).call(this,s);i.canvas.width=i.canvas.height=PR,C(this,n0,kE).call(this,i,PR,e);const o=i.measureText(""),a=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let u=.8;return a?u=a/(a+c):(rn.platform.isFirefox&&pe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),l(this,wh).set(e,u),u},x(ht,_h),x(ht,n0),x(ht,aw),x(ht,lw),x(ht,wh,new Map),x(ht,Pc,new Map),x(ht,e0,new WeakMap),x(ht,Sa,null),x(ht,Sh,new Set),ht);const _W=100;function fT(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new TE,{docId:t}=e,s=n.url?Rq(n.url):null,r=n.data?jq(n.data):null,i=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof pT?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof Df?n.worker:null;const h=n.verbosity,p=typeof n.docBaseUrl=="string"&&!Ly(n.docBaseUrl)?n.docBaseUrl:null,m=xv(n.cMapUrl),y=n.cMapPacked!==!1,g=n.CMapReaderFactory||(zn?Bq:mR),w=xv(n.iccUrl),v=xv(n.standardFontDataUrl),b=n.StandardFontDataFactory||(zn?$q:gR),S=xv(n.wasmUrl),E=n.WasmFactory||(zn?zq:yR),k=n.stopAtErrors!==!0,T=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,P=n.isEvalSupported!==!1,N=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!zn,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!zn&&(rn.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,O=typeof n.disableFontFace=="boolean"?n.disableFontFace:zn,D=n.fontExtraProperties===!0,V=n.enableXfa===!0,I=n.ownerDocument||globalThis.document,R=n.disableRange===!0,j=n.disableStream===!0,F=n.disableAutoFetch===!0,$=n.pdfBug===!0,z=n.CanvasFactory||(zn?Fq:Iq),B=n.FilterFactory||(zn?Oq:Dq),H=n.enableHWA===!0,U=n.useWasm!==!1,Y=c?c.length:n.length??NaN,Q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!zn&&!O,ge=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(g===mR&&b===gR&&E===yR&&m&&v&&S&&Ap(m,document.baseURI)&&Ap(v,document.baseURI)&&Ap(S,document.baseURI)),Ce=null;hq(h);const oe={canvasFactory:new z({ownerDocument:I,enableHWA:H}),filterFactory:new B({docId:t,ownerDocument:I}),cMapReaderFactory:ge?null:new g({baseUrl:m,isCompressed:y}),standardFontDataFactory:ge?null:new b({baseUrl:v}),wasmFactory:ge?null:new E({baseUrl:S})};d||(d=Df.create({verbosity:h,port:ar.workerPort}),e._worker=d);const je={docId:t,apiVersion:"5.4.296",data:r,password:a,disableAutoFetch:F,rangeChunkSize:u,length:Y,docBaseUrl:p,enableXfa:V,evaluatorOptions:{maxImageSize:T,disableFontFace:O,ignoreErrors:k,isEvalSupported:P,isOffscreenCanvasSupported:N,isImageDecoderSupported:M,canvasMaxAreaInBytes:L,fontExtraProperties:D,useSystemFonts:Q,useWasm:U,useWorkerFetch:ge,cMapUrl:m,iccUrl:w,standardFontDataUrl:v,wasmUrl:S}},Ue={ownerDocument:I,pdfBug:$,styleElement:Ce,loadingParams:{disableAutoFetch:F,enableXfa:V}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ye=d.messageHandler.sendWithPromise("GetDocRequest",je,r?[r.buffer]:null);let Be;if(c)Be=new iW(c,{disableRange:R,disableStream:j});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ft=Ap(s)?cW:zn?bW:pW;Be=new Ft({url:s,length:Y,httpHeaders:i,withCredentials:o,rangeChunkSize:u,disableRange:R,disableStream:j})}return ye.then(Ft=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const X=new Np(t,Ft,d.port),J=new CW(X,e,Be,Ue,oe,H);e._transport=J,X.send("Ready",null)})}).catch(e._capability.reject),e}var cw;const uw=class uw{constructor(){q(this,"_capability",Promise.withResolvers());q(this,"_transport",null);q(this,"_worker",null);q(this,"docId",`d${$t(uw,cw)._++}`);q(this,"destroyed",!1);q(this,"onPassword",null);q(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};cw=new WeakMap,x(uw,cw,0);let TE=uw;var Nc,s0,r0,i0,o0,JR;let pT=(JR=class{constructor(e,t,s=!1,r=null){x(this,Nc,Promise.withResolvers());x(this,s0,[]);x(this,r0,[]);x(this,i0,[]);x(this,o0,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(e){l(this,o0).push(e)}addProgressListener(e){l(this,i0).push(e)}addProgressiveReadListener(e){l(this,r0).push(e)}addProgressiveDoneListener(e){l(this,s0).push(e)}onDataRange(e,t){for(const s of l(this,o0))s(e,t)}onDataProgress(e,t){l(this,Nc).promise.then(()=>{for(const s of l(this,i0))s(e,t)})}onDataProgressiveRead(e){l(this,Nc).promise.then(()=>{for(const t of l(this,r0))t(e)})}onDataProgressiveDone(){l(this,Nc).promise.then(()=>{for(const e of l(this,s0))e()})}transportReady(){l(this,Nc).resolve()}requestDataRange(e,t){Je("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Nc=new WeakMap,s0=new WeakMap,r0=new WeakMap,i0=new WeakMap,o0=new WeakMap,JR);class AW{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return be(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Zi,Rc,Op;class EW{constructor(e,t,s,r=!1){x(this,Rc);x(this,Zi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=r?new lR:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new oF,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:i=!1}={}){return new My({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return be(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:r="display",annotationMode:i=wi.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:d=null,printAnnotationStorage:h=null,isEditing:p=!1,recordOperations:m=!1,operationsFilter:y=null}){var M,L,O;(M=this._stats)==null||M.time("Overall");const g=this._transport.getRenderingIntent(r,i,h,p),{renderingIntent:w,cacheKey:v}=g;_(this,Zi,!1),c||(c=this._transport.getOptionalContentConfig(w));let b=this._intentStates.get(v);b||(b=Object.create(null),this._intentStates.set(v,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const S=!!(w&js.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(L=this._stats)==null||L.time("Page Request"),this._pumpOperatorList(g));const E=!!(this._pdfBug&&((O=globalThis.StepperManager)!=null&&O.enabled)),k=!this.recordedBBoxes&&(m||E),T=D=>{var V,I;if(b.renderTasks.delete(P),k){const R=(V=P.gfx)==null?void 0:V.dependencyTracker.take();R&&(P.stepper&&P.stepper.setOperatorBBoxes(R,P.gfx.dependencyTracker.takeDebugMetadata()),m&&(this.recordedBBoxes=R))}S&&_(this,Zi,!0),C(this,Rc,Op).call(this),D?(P.capability.reject(D),this._abortOperatorList({intentState:b,reason:D instanceof Error?D:new Error(D)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(I=globalThis.Stats)!=null&&I.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new PE({callback:T,params:{canvas:t,canvasContext:e,dependencyTracker:k?new Uq(t,b.operatorList.length,E):null,viewport:s,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:y});(b.renderTasks||(b.renderTasks=new Set)).add(P);const N=P.task;return Promise.all([b.displayReadyCapability.promise,c]).then(([D,V])=>{var I;if(this.destroyed){T();return}if((I=this._stats)==null||I.time("Rendering"),!(V.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:D,optionalContentConfig:V}),P.operatorListChanged()}).catch(T),N}getOperatorList({intent:e="display",annotationMode:t=wi.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){var u;function i(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,r,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Lm.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,r){function i(){o.read().then(function({value:c,done:u}){if(u){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),i()},r)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),_(this,Zi,!1),Promise.all(e)}cleanup(e=!1){_(this,Zi,!0);const t=C(this,Rc,Op).call(this);return e&&t&&this._stats&&(this._stats=new lR),t}_startRenderPage(e,t){var r,i;const s=this._intentStates.get(t);s&&((r=this._stats)==null||r.timeEnd("Page Request"),(i=s.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let s=0,r=e.length;s<r;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&C(this,Rc,Op).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:r}){const{map:i,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:h,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),d())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();C(this,Rc,Op).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof K1){let r=_W;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Mo(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}Zi=new WeakMap,Rc=new WeakSet,Op=function(){if(!l(this,Zi)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,Zi,!1),!0};var _a,Cr,eo,jc,dw,Mc,Lc,Ah,rb,hw,dF,fw,hF,Ic,Fp,Eh,ib;const ct=class ct{constructor({name:e=null,port:t=null,verbosity:s=fq()}={}){x(this,Ah);x(this,hw);x(this,fw);x(this,Ic);x(this,_a,Promise.withResolvers());x(this,Cr,null);x(this,eo,null);x(this,jc,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(l(ct,Lc).has(t))throw new Error("Cannot use more than one PDFWorker per port.");l(ct,Lc).set(t,this),C(this,hw,dF).call(this,t)}else C(this,fw,hF).call(this)}get promise(){return l(this,_a).promise}get port(){return l(this,eo)}get messageHandler(){return l(this,Cr)}destroy(){var e,t;this.destroyed=!0,(e=l(this,jc))==null||e.terminate(),_(this,jc,null),l(ct,Lc).delete(l(this,eo)),_(this,eo,null),(t=l(this,Cr))==null||t.destroy(),_(this,Cr,null)}static create(e){const t=l(this,Lc).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ct(e)}static get workerSrc(){if(ar.workerSrc)return ar.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return be(this,"_setupFakeWorkerGlobal",(async()=>l(this,Eh,ib)?l(this,Eh,ib):(await Do(()=>import(this.workerSrc),[])).WorkerMessageHandler)())}};_a=new WeakMap,Cr=new WeakMap,eo=new WeakMap,jc=new WeakMap,dw=new WeakMap,Mc=new WeakMap,Lc=new WeakMap,Ah=new WeakSet,rb=function(){l(this,_a).resolve(),l(this,Cr).send("configure",{verbosity:this.verbosity})},hw=new WeakSet,dF=function(e){_(this,eo,e),_(this,Cr,new Np("main","worker",e)),l(this,Cr).on("ready",()=>{}),C(this,Ah,rb).call(this)},fw=new WeakSet,hF=function(){if(l(ct,Mc)||l(ct,Eh,ib)){C(this,Ic,Fp).call(this);return}let{workerSrc:e}=ct;try{ct._isSameOrigin(window.location,e)||(e=ct._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Np("main","worker",t),r=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?l(this,_a).reject(new Error("Worker was destroyed")):C(this,Ic,Fp).call(this)},i=new AbortController;t.addEventListener("error",()=>{l(this,jc)||r()},{signal:i.signal}),s.on("test",a=>{if(i.abort(),this.destroyed||!a){r();return}_(this,Cr,s),_(this,eo,t),_(this,jc,t),C(this,Ah,rb).call(this)}),s.on("ready",a=>{if(i.abort(),this.destroyed){r();return}try{o()}catch{C(this,Ic,Fp).call(this)}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{W1("The worker has been disabled.")}C(this,Ic,Fp).call(this)},Ic=new WeakSet,Fp=function(){l(ct,Mc)||(pe("Setting up fake worker."),_(ct,Mc,!0)),ct._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){l(this,_a).reject(new Error("Worker was destroyed"));return}const t=new Lq;_(this,eo,t);const s=`fake${$t(ct,dw)._++}`,r=new Np(s+"_worker",s,t);e.setup(r,t),_(this,Cr,new Np(s,s+"_worker",t)),C(this,Ah,rb).call(this)}).catch(e=>{l(this,_a).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Eh=new WeakSet,ib=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},x(ct,Eh),x(ct,dw,0),x(ct,Mc,!1),x(ct,Lc,new WeakMap),zn&&(_(ct,Mc,!0),ar.workerSrc||(ar.workerSrc="./pdf.worker.mjs")),ct._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const r=new URL(t,s);return s.origin===r.origin},ct._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},ct.fromPort=e=>{if(Sq("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return ct.create(e)};let Df=ct;var to,ci,Ch,kh,no,Dc,Bp;class CW{constructor(e,t,s,r,i,o){x(this,Dc);x(this,to,new Map);x(this,ci,new Map);x(this,Ch,new Map);x(this,kh,new Map);x(this,no,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new oF,this.fontLoader=new Pq({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return be(this,"annotationStorage",new uT)}getRenderingIntent(e,t=wi.ENABLE,s=null,r=!1,i=!1){let o=js.DISPLAY,a=hE;switch(e){case"any":o=js.ANY;break;case"display":break;case"print":o=js.PRINT;break;default:pe(`getRenderingIntent - invalid intent: ${e}`)}const c=o&js.PRINT&&s instanceof UO?s:this.annotationStorage;switch(t){case wi.DISABLE:o+=js.ANNOTATIONS_DISABLE;break;case wi.ENABLE:break;case wi.ENABLE_FORMS:o+=js.ANNOTATIONS_FORMS;break;case wi.ENABLE_STORAGE:o+=js.ANNOTATIONS_STORAGE,a=c.serializable;break;default:pe(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=js.IS_EDITING),i&&(o+=js.OPLIST);const{ids:u,hash:d}=c.modifiedIds,h=[o,a.hash,d];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,no))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of l(this,ci).values())e.push(r._destroy());l(this,ci).clear(),l(this,Ch).clear(),l(this,kh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,i;this.commonObjs.clear(),this.fontLoader.clear(),l(this,to).clear(),this.filterFactory.destroy(),Om.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new Mo("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,r)=>{Ne(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){r.close();return}Ne(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:o}=this._fullReader;return(!r||!i)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(s,r)=>{Ne(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:o,done:a}){if(a){r.close();return}Ne(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{i.cancel(o),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new AW(s,this))}),e.on("DocException",s=>{t._capability.reject(Xn(s))}),e.on("PasswordRequest",s=>{_(this,no,Promise.withResolvers());try{if(!t.onPassword)throw Xn(s);const r=i=>{i instanceof Error?l(this,no).reject(i):l(this,no).resolve({password:i})};t.onPassword(r,s.code)}catch(r){l(this,no).reject(r)}return l(this,no).promise}),e.on("DataLoaded",s=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,ci).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,r,i])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in i){const h=i.error;pe(`Error during font loading: ${h}`),this.commonObjs.resolve(s,h);break}const a=new _E(i),c=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(h,p)=>globalThis.FontInspector.fontAdded(h,p):null,u=new Nq(a,c,i.extra,i.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:d}=i;Ne(d,"The imageRef must be defined.");for(const h of l(this,ci).values())for(const[,p]of h.objs)if((p==null?void 0:p.ref)===d)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([s,r,i,o])=>{var c;if(this.destroyed)return;const a=l(this,ci).get(r);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(i){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&pe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Ch).get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&l(this,kh).set(i.refStr,e);const o=new EW(t,i,this,this._params.pdfBug);return l(this,ci).set(t,o),o});return l(this,Ch).set(t,r),r}getPageIndex(e){return fE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return C(this,Dc,Bp).call(this,"GetFieldObjects")}hasJSActions(){return C(this,Dc,Bp).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return C(this,Dc,Bp).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return C(this,Dc,Bp).call(this,"GetOptionalContentConfig").then(t=>new rW(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,to).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(r=>{var i,o;return{info:r[0],metadata:r[1]?new nW(r[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,to).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,ci).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,to).clear(),this.filterFactory.destroy(!0),Om.cleanup()}}cachedPageNumber(e){if(!fE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,kh).get(t)??null}}to=new WeakMap,ci=new WeakMap,Ch=new WeakMap,kh=new WeakMap,no=new WeakMap,Dc=new WeakSet,Bp=function(e,t=null){const s=l(this,to).get(e);if(s)return s;const r=this.messageHandler.sendWithPromise(e,t);return l(this,to).set(e,r),r};var Aa;class kW{constructor(e){x(this,Aa,null);q(this,"onContinue",null);q(this,"onError",null);_(this,Aa,e)}get promise(){return l(this,Aa).capability.promise}cancel(e=0){l(this,Aa).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,Aa).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,Aa);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Aa=new WeakMap;var Ea,Oc;const Il=class Il{constructor({callback:e,params:t,objs:s,commonObjs:r,annotationCanvasMap:i,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:p=null,enableHWA:m=!1,operationsFilter:y=null}){x(this,Ea,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=h,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new kW(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=m,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=y}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,u;if(this.cancelled)return;if(this._canvas){if(l(Il,Oc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Il,Oc).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:i,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Sd(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var s,r,i;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,Ea)&&(window.cancelAnimationFrame(l(this,Ea)),_(this,Ea,null)),l(Il,Oc).delete(this._canvas),e||(e=new K1(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(r=this.task).onError)==null||i.call(r,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,Ea,window.requestAnimationFrame(()=>{_(this,Ea,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Il,Oc).delete(this._canvas),this.callback())))}};Ea=new WeakMap,Oc=new WeakMap,x(Il,Oc,new WeakSet);let PE=Il;const mT="5.4.296",fF="f56dc8601";var xs,Fc,Th,Ht,a0,Ph,so,l0,Ca,kr,c0,u0,NE,d0,RE,h0,jE,ro,Pl,pw,pF,ui,Uo;const Yn=class Yn{constructor({editor:e=null,uiManager:t=null}){x(this,u0);x(this,d0);x(this,h0);x(this,ro);x(this,pw);x(this,ui);x(this,xs,null);x(this,Fc,null);x(this,Th,void 0);x(this,Ht,null);x(this,a0,!1);x(this,Ph,!1);x(this,so,null);x(this,l0,void 0);x(this,Ca,null);x(this,kr,null);var s,r;e?(_(this,Ph,!1),_(this,so,e)):_(this,Ph,!0),_(this,kr,(e==null?void 0:e._uiManager)||t),_(this,l0,l(this,kr)._eventBus),_(this,Th,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((r=l(this,kr))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),l(Yn,c0)||_(Yn,c0,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return be(this,"_keyboardManager",new Iy([[["Escape","mac+Escape"],Yn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Yn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Yn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Yn.prototype._moveToPrevious],[["Home","mac+Home"],Yn.prototype._moveToBeginning],[["End","mac+End"],Yn.prototype._moveToEnd]]))}renderButton(){const e=_(this,xs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",l(this,so)&&(e.ariaControls=`${l(this,so).id}_colorpicker_dropdown`);const t=l(this,kr)._signal;e.addEventListener("click",C(this,ro,Pl).bind(this),{signal:t}),e.addEventListener("keydown",C(this,h0,jE).bind(this),{signal:t});const s=_(this,Fc,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=l(this,Th),e.append(s),e}renderMainDropdown(){const e=_(this,Ht,C(this,u0,NE).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===l(this,xs)){C(this,ro,Pl).call(this,e);return}const t=e.target.getAttribute("data-color");t&&C(this,d0,RE).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,ui,Uo)){C(this,ro,Pl).call(this,e);return}if(e.target===l(this,xs)){(t=l(this,Ht).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,Ht))==null?void 0:t.firstChild)||e.target===l(this,xs)){l(this,ui,Uo)&&this._hideDropdownFromKeyboard();return}l(this,ui,Uo)||C(this,ro,Pl).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,ui,Uo)){C(this,ro,Pl).call(this,e);return}(t=l(this,Ht).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,ui,Uo)){C(this,ro,Pl).call(this,e);return}(t=l(this,Ht).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,Ht))==null||e.classList.add("hidden"),l(this,xs).ariaExpanded="false",(t=l(this,Ca))==null||t.abort(),_(this,Ca,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Ph)){if(!l(this,ui,Uo)){(e=l(this,so))==null||e.unselect();return}this.hideDropdown(),l(this,xs).focus({preventScroll:!0,focusVisible:l(this,a0)})}}updateColor(e){if(l(this,Fc)&&(l(this,Fc).style.backgroundColor=e),!l(this,Ht))return;const t=l(this,kr).highlightColors.values();for(const s of l(this,Ht).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=l(this,xs))==null||e.remove(),_(this,xs,null),_(this,Fc,null),(t=l(this,Ht))==null||t.remove(),_(this,Ht,null)}};xs=new WeakMap,Fc=new WeakMap,Th=new WeakMap,Ht=new WeakMap,a0=new WeakMap,Ph=new WeakMap,so=new WeakMap,l0=new WeakMap,Ca=new WeakMap,kr=new WeakMap,c0=new WeakMap,u0=new WeakSet,NE=function(){const e=document.createElement("div"),t=l(this,kr)._signal;e.addEventListener("contextmenu",Bs,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),l(this,so)&&(e.id=`${l(this,so).id}_colorpicker_dropdown`);for(const[s,r]of l(this,kr).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=s,i.setAttribute("data-l10n-id",l(Yn,c0)[s]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=r,i.ariaSelected=r===l(this,Th),i.addEventListener("click",C(this,d0,RE).bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",C(this,h0,jE).bind(this),{signal:t}),e},d0=new WeakSet,RE=function(e,t){t.stopPropagation(),l(this,l0).dispatch("switchannotationeditorparams",{source:this,type:Te.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},h0=new WeakSet,jE=function(e){Yn._keyboardManager.exec(this,e)},ro=new WeakSet,Pl=function(e){if(l(this,ui,Uo)){this.hideDropdown();return}if(_(this,a0,e.detail===0),l(this,Ca)||(_(this,Ca,new AbortController),window.addEventListener("pointerdown",C(this,pw,pF).bind(this),{signal:l(this,kr).combinedSignal(l(this,Ca))})),l(this,xs).ariaExpanded="true",l(this,Ht)){l(this,Ht).classList.remove("hidden");return}const t=_(this,Ht,C(this,u0,NE).call(this));l(this,xs).append(t)},pw=new WeakSet,pF=function(e){var t;(t=l(this,Ht))!=null&&t.contains(e.target)||this.hideDropdown()},ui=new WeakSet,Uo=function(){return l(this,Ht)&&!l(this,Ht).classList.contains("hidden")},x(Yn,c0,null);let Fm=Yn;var di,f0,Nh,p0;const Dl=class Dl{constructor(e){x(this,di,null);x(this,f0,null);x(this,Nh,null);_(this,f0,e),_(this,Nh,e._uiManager),l(Dl,p0)||_(Dl,p0,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(l(this,di))return l(this,di);const{editorType:e,colorType:t,colorValue:s}=l(this,f0),r=_(this,di,document.createElement("input"));return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",l(Dl,p0)[e]),r.addEventListener("input",()=>{l(this,Nh).updateParams(t,r.value)},{signal:l(this,Nh)._signal}),r}update(e){l(this,di)&&(l(this,di).value=e)}destroy(){var e;(e=l(this,di))==null||e.remove(),_(this,di,null)}hideDropdown(){}};di=new WeakMap,f0=new WeakMap,Nh=new WeakMap,p0=new WeakMap,x(Dl,p0,null);let hx=Dl;function NR(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function pp(n){return Math.max(0,Math.min(255,255*n))}class RR{static CMYK_G([e,t,s,r]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=pp(e),[e,e,e]}static G_HTML([e]){const t=NR(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(pp)}static RGB_HTML(e){return`#${e.map(NR).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,s+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,s,r]){return[pp(1-Math.min(1,e+r)),pp(1-Math.min(1,s+r)),pp(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const r=1-e,i=1-t,o=1-s,a=Math.min(r,i,o);return["CMYK",r,i,o,a]}}class TW{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Je("Abstract method `_createSVG` called.")}}class Bm extends TW{_createSVG(e){return document.createElementNS(ki,e)}}const PW=9,Eu=new WeakSet,NW=new Date().getTimezoneOffset()*60*1e3;class jR{static create(e){switch(e.data.annotationType){case Pt.LINK:return new gT(e);case Pt.TEXT:return new jW(e);case Pt.WIDGET:switch(e.data.fieldType){case"Tx":return new MW(e);case"Btn":return e.data.radioButton?new yF(e):e.data.checkBox?new IW(e):new DW(e);case"Ch":return new OW(e);case"Sig":return new LW(e)}return new Lu(e);case Pt.POPUP:return new LE(e);case Pt.FREETEXT:return new SF(e);case Pt.LINE:return new BW(e);case Pt.SQUARE:return new $W(e);case Pt.CIRCLE:return new zW(e);case Pt.POLYLINE:return new _F(e);case Pt.CARET:return new UW(e);case Pt.INK:return new yT(e);case Pt.POLYGON:return new VW(e);case Pt.HIGHLIGHT:return new AF(e);case Pt.UNDERLINE:return new HW(e);case Pt.SQUIGGLY:return new GW(e);case Pt.STRIKEOUT:return new qW(e);case Pt.STAMP:return new EF(e);case Pt.FILEATTACHMENT:return new WW(e);default:return new wt(e)}}}var Bc,Rh,tr,m0,ME;const RT=class RT{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){x(this,m0);x(this,Bc,null);x(this,Rh,!1);x(this,tr,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return RT._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var a;const e=(a=this.annotationStorage)==null?void 0:a.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:r}=this.data;let i=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],i=t[c+2]):t[c+1]===o&&(i=Math.max(i,t[c+2]));return[i,o]}if((s==null?void 0:s.length)>=1){for(const c of s)for(let u=0,d=c.length;u<d;u+=2)c[u+1]>o?(o=c[u+1],i=c[u]):c[u+1]===o&&(i=Math.max(i,c[u]));if(i!==1/0)return[i,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/s,e[1]=100*(e[1]-o)/r,e}get commentText(){var t,s,r;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${jm}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((r=e.contentsObj)==null?void 0:r.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${jm}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=l(this,tr))==null?void 0:e.popup)||this.popup)==null||t.remove(),_(this,tr,this.popup=null)}updateEdited(e){var i;if(!this.container)return;e.rect&&(l(this,Bc)||_(this,Bc,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&C(this,m0,ME).call(this,t);let r=((i=l(this,tr))==null?void 0:i.popup)||this.popup;!r&&(s!=null&&s.text)&&(this._createPopup(s),r=l(this,tr).popup),r&&(r.updateEdited(e),s!=null&&s.deleted&&(r.remove(),_(this,tr,null),this.popup=null))}resetEdited(){var e;l(this,Bc)&&(C(this,m0,ME).call(this,l(this,Bc).rect),(e=l(this,tr))==null||e.popup.resetEdited(),_(this,Bc,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof Lu)&&!(this instanceof gT)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof LE){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,i),i}const{width:a,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(g>0||w>0){const b=`calc(${g}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;o.borderRadius=b}else if(this instanceof yF){const b=`calc(${a}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=b}switch(t.borderStyle.style){case zu.SOLID:o.borderStyle="solid";break;case zu.DASHED:o.borderStyle="dashed";break;case zu.BEVELED:pe("Unimplemented border style: beveled");break;case zu.INSET:pe("Unimplemented border style: inset");break;case zu.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(_(this,Rh,!0),o.borderColor=Z.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const u=Z.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:p,pageY:m}=r.rawDims;o.left=`${100*(u[0]-p)/d}%`,o.top=`${100*(u[1]-m)/h}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/d}%`,o.height=`${100*c/h}%`):this.setRotation(y,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,r)=>{const i=r.detail[t],o=i[0],a=i.slice(1);r.target.style[s]=RR[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:RR[`${o}_rgb`](a)})};return be(this,"_commonActions",{display:t=>{const{display:s}=t.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const r of Object.keys(t.detail)){const i=e[r]||s[r];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[r,i]of Object.entries(t)){const o=s[r];if(o){const a={detail:{[r]:i},target:e};o(a),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,r,i]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,w,v,b]=e.subarray(2,6);if(r===g&&i===w&&t===v&&s===b)return}const{style:o}=this.container;let a;if(l(this,Rh)){const{borderColor:g,borderWidth:w}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const c=r-t,u=i-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const p=d.createElement("defs");h.append(p);const m=d.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let g=2,w=e.length;g<w;g+=8){const v=e[g],b=e[g+1],S=e[g+2],E=e[g+3],k=d.createElement("rect"),T=(S-t)/c,P=(i-b)/u,N=(v-S)/c,M=(b-E)/u;k.setAttribute("x",T),k.setAttribute("y",P),k.setAttribute("width",N),k.setAttribute("height",M),m.append(k),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${P}" width="${N}" height="${M}"/>`)}l(this,Rh)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:t}=this;let s,r;e?(s={str:e.text},r=e.date):(s=t.contentsObj,r=t.modificationDate);const i=_(this,tr,new LE({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(i.render())}get hasPopupElement(){return!!(l(this,tr)||this.popup||this.data.popupRef)}get extraPopupElement(){return l(this,tr)}render(){Je("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:o,exportValues:a}of r){if(i===-1||o===t)continue;const c=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!Eu.has(u)){pe(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,o=r.getAttribute("data-element-id");o!==t&&Eu.has(r)&&s.push({id:o,exportValue:i,domElement:r})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Bc=new WeakMap,Rh=new WeakMap,tr=new WeakMap,m0=new WeakSet,ME=function(e){const{container:{style:t},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-a)/i}%`,t.top=`${100*(o-e[3]+c)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)};let wt=RT;class RW extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var io,Nl,mw,mF,gw,gF;class gT extends wt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});x(this,io);x(this,mw);x(this,gw);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(s.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),i=!0):t.attachment?(C(this,mw,mF).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(C(this,gw,gF).call(this,r,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}_bindLink(t,s,r=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&C(this,io,Nl).call(this),r&&(t.title=r)}_bindNamedAction(t,s,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),r&&(t.title=r),C(this,io,Nl).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(s.actions)){const o=r.get(i);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:i}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),C(this,io,Nl).call(this)}_bindResetFormAction(t,s){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),C(this,io,Nl).call(this),!this._fieldObjects){pe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var h;r==null||r();const{fields:i,refs:o,include:a}=s,c=[];if(i.length!==0||o.length!==0){const p=new Set(o);for(const m of i){const y=this._fieldObjects[m]||[];for(const{id:g}of y)p.add(g)}for(const m of Object.values(this._fieldObjects))for(const y of m)p.has(y.id)===a&&c.push(y)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const u=this.annotationStorage,d=[];for(const p of c){const{id:m}=p;switch(d.push(m),p.type){case"text":{const g=p.defaultValue||"";u.setValue(m,{value:g});break}case"checkbox":case"radiobutton":{const g=p.defaultValue===p.exportValues;u.setValue(m,{value:g});break}case"combobox":case"listbox":{const g=p.defaultValue||"";u.setValue(m,{value:g});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!Eu.has(y)){pe(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}io=new WeakSet,Nl=function(){this.container.setAttribute("data-internal-link","")},mw=new WeakSet,mF=function(t,s,r="",i=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:r&&(t.title=r),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(s.content,s.filename,i),!1},C(this,io,Nl).call(this)},gw=new WeakSet,gF=function(t,s,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),r&&(t.title=r),C(this,io,Nl).call(this)};class jW extends wt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Lu extends wt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return rn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,r,i){s.includes("mouse")?e.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var a;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o)}}))})}_setEventListeners(e,t,s,r){var i,o,a;for(const[c,u]of s)(u==="Action"||(i=this.data.actions)!=null&&i[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,r),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Z.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||PW,i=e.style;let o;const a=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(u/(e_*r))||1,h=u/d;o=Math.min(r,c(h/e_))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(r,c(u/e_))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=Z.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class MW extends Lu{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,r){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),i.setValue(o.id,{[r]:s})}render(){var r,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let u=o.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Eu.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:h,datetimeType:p,timeStep:m}=this.data,y=!!p&&this.enableScripting;h&&(s.title=h),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",w=>{const v=this.data.defaultFieldValue??"";s.value=d.userValue=v,d.formattedValue=null});let g=w=>{const{formattedValue:v}=d;v!=null&&(w.target.value=v),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",v=>{var S;if(d.focused)return;const{target:b}=v;if(y&&(b.type=p,m&&(b.step=m)),d.userValue){const E=d.userValue;if(y)if(p==="time"){const k=new Date(E),T=[k.getHours(),k.getMinutes(),k.getSeconds()];b.value=T.map(P=>P.toString().padStart(2,"0")).join(":")}else b.value=new Date(E-NW).toISOString().split(p==="date"?"T":".",1)[0];else b.value=E}d.lastCommittedValue=b.value,d.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const b={value(S){d.userValue=S.detail.value??"",y||e.setValue(t,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:E}=S.detail;d.formattedValue=E,E!=null&&S.target!==document.activeElement&&(S.target.value=E);const k={formattedValue:E};y&&(k.value=E),e.setValue(t,k)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var P;const{charLimit:E}=S.detail,{target:k}=S;if(E===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",E);let T=d.userValue;!T||T.length<=E||(T=T.slice(0,E),k.value=d.userValue=T,e.setValue(t,{value:T}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(b,v)}),s.addEventListener("keydown",v=>{var E;d.commitKey=1;let b=-1;if(v.key==="Escape"?b=0:v.key==="Enter"&&!this.data.multiLine?b=2:v.key==="Tab"&&(d.commitKey=3),b===-1)return;const{value:S}=v.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:b,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const w=g;g=null,s.addEventListener("blur",v=>{var E,k;if(!d.focused||!v.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(d.focused=!1);const{target:b}=v;let{value:S}=b;if(y){if(S&&p==="time"){const T=S.split(":").map(P=>parseInt(P,10));S=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),b.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();b.type="text"}d.userValue=S,d.lastCommittedValue!==S&&((k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}})),w(v)}),(i=this.data.actions)!=null&&i.Keystroke&&s.addEventListener("beforeinput",v=>{var M;d.lastCommittedValue=null;const{data:b,target:S}=v,{value:E,selectionStart:k,selectionEnd:T}=S;let P=k,N=T;switch(v.inputType){case"deleteWordBackward":{const L=E.substring(0,k).match(/\w*[^\w]*$/);L&&(P-=L[0].length);break}case"deleteWordForward":{const L=E.substring(k).match(/^[^\w]*\w*/);L&&(N+=L[0].length);break}case"deleteContentBackward":k===T&&(P-=1);break;case"deleteContentForward":k===T&&(N+=1);break}v.preventDefault(),(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:b||"",willCommit:!1,selStart:P,selEnd:N}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(g&&s.addEventListener("blur",g),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${v}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class LW extends Lu{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class IW extends Lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return Eu.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),i.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class yF extends Lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(s,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(Eu.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),i.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",a=>{const c={value:u=>{const d=o===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const p=d&&h.id===s;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class DW extends gT{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class OW extends Lu{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Eu.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const p of r.options)p.selected=p.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),i=!1),r.append(h)}let o=null;if(i){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),r.prepend(d),o=()=>{d.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const a=d=>{const h=d?"value":"textContent",{options:p,multiple:m}=r;return m?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[h]):p.selectedIndex===-1?null:p[p.selectedIndex][h]};let c=a(!1);const u=d=>{const h=d.target.options;return Array.prototype.map.call(h,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",d=>{const h={value(p){o==null||o();const m=p.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const g of r.options)g.selected=y.has(g.value);e.setValue(t,{value:a(!0)}),c=a(!1)},multipleSelection(p){r.multiple=!0},remove(p){const m=r.options,y=p.detail.remove;m[y].selected=!1,r.remove(y),m.length>0&&Array.prototype.findIndex.call(m,w=>w.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:a(!0),items:u(p)}),c=a(!1)},clear(p){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),c=a(!1)},insert(p){const{index:m,displayValue:y,exportValue:g}=p.detail.insert,w=r.children[m],v=document.createElement("option");v.textContent=y,v.value=g,w?w.before(v):r.append(v),e.setValue(t,{value:a(!0),items:u(p)}),c=a(!1)},items(p){const{items:m}=p.detail;for(;r.length!==0;)r.remove(0);for(const y of m){const{displayValue:g,exportValue:w}=y,v=document.createElement("option");v.textContent=g,v.value=w,r.append(v)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(p)}),c=a(!1)},indices(p){const m=new Set(p.detail.indices);for(const y of p.target.options)y.selected=m.has(y.index);e.setValue(t,{value:a(!0)}),c=a(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(h,d)}),r.addEventListener("input",d=>{var m;const h=a(!0),p=a(!1);e.setValue(t,{value:h}),d.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:p,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):r.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}var g0,IE;class LE extends wt{constructor(t){const{data:s,elements:r,parent:i}=t,o=!!i._commentManager;super(t,{isRenderable:!o&&wt._hasPopupData(s)});x(this,g0);if(this.elements=r,o&&wt._hasPopupData(s)){const a=this.popup=C(this,g0,IE).call(this);for(const c of r)c.popup=a}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=C(this,g0,IE).call(this),r=[];for(const i of this.elements)i.popup=s,i.container.ariaHasPopup="dialog",r.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",r.map(i=>`${aT}${i}`).join(",")),this.container}}g0=new WeakSet,IE=function(){return new FW({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var ws,ka,yw,vw,jh,Mh,Ct,hi,Ta,$c,Lh,Ih,fi,Ss,oo,ao,Yt,lo,Pa,y0,co,Dh,zc,Na,En,Ra,Oh,ob,v0,DE,b0,OE,x0,FE,Fh,ab,w0,BE,bw,vF,xw,bF,ww,xF,Sw,wF,Bh,lb,$h,cb,S0,$E;class FW{constructor({container:e,color:t,elements:s,titleObj:r,modificationDate:i,contentsObj:o,richText:a,parent:c,rect:u,parentRect:d,open:h,commentManager:p=null}){x(this,Oh);x(this,v0);x(this,b0);x(this,x0);x(this,Fh);x(this,w0);x(this,bw);x(this,xw);x(this,ww);x(this,Sw);x(this,Bh);x(this,$h);x(this,S0);x(this,ws,null);x(this,ka,C(this,ww,xF).bind(this));x(this,yw,C(this,S0,$E).bind(this));x(this,vw,C(this,$h,cb).bind(this));x(this,jh,C(this,Bh,lb).bind(this));x(this,Mh,null);x(this,Ct,null);x(this,hi,null);x(this,Ta,null);x(this,$c,null);x(this,Lh,null);x(this,Ih,null);x(this,fi,!1);x(this,Ss,null);x(this,oo,null);x(this,ao,null);x(this,Yt,null);x(this,lo,null);x(this,Pa,null);x(this,y0,null);x(this,co,null);x(this,Dh,null);x(this,zc,null);x(this,Na,!1);x(this,En,null);x(this,Ra,null);_(this,Ct,e),_(this,Dh,r),_(this,hi,o),_(this,co,a),_(this,Lh,c),_(this,Mh,t),_(this,y0,u),_(this,Ih,d),_(this,$c,s),_(this,ws,p),_(this,En,s[0]),_(this,Ta,Im.toDateObject(i)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup()),p?this.renderCommentButton():(C(this,Oh,ob).call(this),l(this,Ct).hidden=!0,h&&C(this,Bh,lb).call(this))}renderCommentButton(){if(l(this,Yt)||(l(this,lo)||C(this,v0,DE).call(this),!l(this,lo)))return;const{signal:e}=_(this,oo,new AbortController),t=!!l(this,En).extraPopupElement,s=()=>{l(this,ws).toggleCommentPopup(this,!0,void 0,!t)},r=()=>{l(this,ws).toggleCommentPopup(this,!1,!0,!t)},i=()=>{l(this,ws).toggleCommentPopup(this,!1,!1)};if(t){_(this,Yt,l(this,En).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",l(this,ka),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=_(this,Yt,document.createElement("button"));o.className="annotationCommentButton";const a=l(this,En).container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),C(this,x0,FE).call(this),C(this,b0,OE).call(this),o.addEventListener("keydown",l(this,ka),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),a.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=l(this,En).commentData;return e?l(this,Lh)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=l(this,Yt))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}=l(this,En).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}}get elementBeforePopup(){return l(this,Yt)}get comment(){return l(this,Ra)||_(this,Ra,l(this,En).commentText),l(this,Ra)}set comment(e){e!==this.comment&&(l(this,En).commentText=_(this,Ra,e))}get parentBoundingClientRect(){return l(this,En).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){l(this,Yt)&&(l(this,Yt).classList.toggle("selected",e),l(this,Yt).ariaExpanded=t)}setSelectedCommentButton(e){l(this,Yt).classList.toggle("selected",e)}get commentPopupPosition(){if(l(this,Pa))return l(this,Pa);const{x:e,y:t,height:s}=l(this,Yt).getBoundingClientRect(),{x:r,y:i,width:o,height:a}=l(this,En).layer.getBoundingClientRect();return[(e-r)/o,(t+s-i)/a]}set commentPopupPosition(e){_(this,Pa,e)}hasDefaultPopupPosition(){return l(this,Pa)===null}get commentButtonPosition(){return l(this,lo)}get commentButtonWidth(){return l(this,Yt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=l(this,Pa)||this.commentButtonPosition.map(u=>u/100),r=this.parentBoundingClientRect,{x:i,y:o,width:a,height:c}=r;l(this,ws).showDialog(null,this,i+t*a,o+s*c,{...e,parentDimensions:r})}render(){var s,r;if(l(this,Ss))return;const e=_(this,Ss,document.createElement("div"));if(e.className="popup",l(this,Mh)){const i=e.style.outlineColor=Z.makeHexColor(...l(this,Mh));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=l(this,Dh))!=null&&s.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=l(this,Dh)}if(e.append(t),l(this,Ta)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Ta).valueOf()})),i.dateTime=l(this,Ta).toISOString(),t.append(i)}cT({html:l(this,Fh,ab)||l(this,hi).str,dir:(r=l(this,hi))==null?void 0:r.dir,className:"popupContent"},e),l(this,Ct).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var r;if(l(this,ws)){s?(this.remove(),_(this,Ra,null)):t&&(t.deleted?this.remove():(C(this,x0,FE).call(this),_(this,Ra,t.text))),e&&(_(this,lo,null),C(this,v0,DE).call(this),C(this,b0,OE).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}C(this,Oh,ob).call(this),l(this,zc)||_(this,zc,{contentsObj:l(this,hi),richText:l(this,co)}),e&&_(this,ao,null),t&&t.text&&(_(this,co,C(this,xw,bF).call(this,t.text)),_(this,Ta,Im.toDateObject(t.date)),_(this,hi,null)),(r=l(this,Ss))==null||r.remove(),_(this,Ss,null)}resetEdited(){var e;l(this,zc)&&({contentsObj:$t(this,hi)._,richText:$t(this,co)._}=l(this,zc),_(this,zc,null),(e=l(this,Ss))==null||e.remove(),_(this,Ss,null),_(this,ao,null))}remove(){var e,t,s;if((e=l(this,oo))==null||e.abort(),_(this,oo,null),(t=l(this,Ss))==null||t.remove(),_(this,Ss,null),_(this,Na,!1),_(this,fi,!1),(s=l(this,Yt))==null||s.remove(),_(this,Yt,null),this.trigger)for(const r of this.trigger)r.classList.remove("popupTriggerArea")}forceHide(){_(this,Na,this.isVisible),l(this,Na)&&(l(this,Ct).hidden=!0)}maybeShow(){l(this,ws)||(C(this,Oh,ob).call(this),l(this,Na)&&(l(this,Ss)||C(this,$h,cb).call(this),_(this,Na,!1),l(this,Ct).hidden=!1))}get isVisible(){return l(this,ws)?!1:l(this,Ct).hidden===!1}}ws=new WeakMap,ka=new WeakMap,yw=new WeakMap,vw=new WeakMap,jh=new WeakMap,Mh=new WeakMap,Ct=new WeakMap,hi=new WeakMap,Ta=new WeakMap,$c=new WeakMap,Lh=new WeakMap,Ih=new WeakMap,fi=new WeakMap,Ss=new WeakMap,oo=new WeakMap,ao=new WeakMap,Yt=new WeakMap,lo=new WeakMap,Pa=new WeakMap,y0=new WeakMap,co=new WeakMap,Dh=new WeakMap,zc=new WeakMap,Na=new WeakMap,En=new WeakMap,Ra=new WeakMap,Oh=new WeakSet,ob=function(){var t;if(l(this,oo))return;_(this,oo,new AbortController);const{signal:e}=l(this,oo);for(const s of this.trigger)s.addEventListener("click",l(this,jh),{signal:e}),s.addEventListener("pointerenter",l(this,vw),{signal:e}),s.addEventListener("pointerleave",l(this,yw),{signal:e}),s.classList.add("popupTriggerArea");for(const s of l(this,$c))(t=s.container)==null||t.addEventListener("keydown",l(this,ka),{signal:e})},v0=new WeakSet,DE=function(){const e=l(this,$c).find(t=>t.hasCommentButton);e&&_(this,lo,e._normalizePoint(e.commentButtonPosition))},b0=new WeakSet,OE=function(){if(l(this,En).extraPopupElement&&!l(this,En).editor)return;this.renderCommentButton();const[e,t]=l(this,lo),{style:s}=l(this,Yt);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},x0=new WeakSet,FE=function(){l(this,En).extraPopupElement||(this.renderCommentButton(),l(this,Yt).style.backgroundColor=this.commentButtonColor||"")},Fh=new WeakSet,ab=function(){const e=l(this,co),t=l(this,hi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,co).html||null},w0=new WeakSet,BE=function(){var e,t,s;return((s=(t=(e=l(this,Fh,ab))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},bw=new WeakSet,vF=function(){var e,t,s;return((s=(t=(e=l(this,Fh,ab))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},xw=new WeakSet,bF=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:l(this,bw,vF),fontSize:l(this,w0,BE)?`calc(${l(this,w0,BE)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return s},ww=new WeakSet,xF=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,fi))&&C(this,Bh,lb).call(this)},Sw=new WeakSet,wF=function(){if(l(this,ao)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:r,pageY:i}}}=l(this,Lh);let o=!!l(this,Ih),a=o?l(this,Ih):l(this,y0);for(const y of l(this,$c))if(!a||Z.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const c=Z.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),u=5,d=o?a[2]-a[0]+u:0,h=c[0]+d,p=c[1];_(this,ao,[100*(h-r)/t,100*(p-i)/s]);const{style:m}=l(this,Ct);m.left=`${l(this,ao)[0]}%`,m.top=`${l(this,ao)[1]}%`},Bh=new WeakSet,lb=function(){if(l(this,ws)){l(this,ws).toggleCommentPopup(this,!1);return}_(this,fi,!l(this,fi)),l(this,fi)?(C(this,$h,cb).call(this),l(this,Ct).addEventListener("click",l(this,jh)),l(this,Ct).addEventListener("keydown",l(this,ka))):(C(this,S0,$E).call(this),l(this,Ct).removeEventListener("click",l(this,jh)),l(this,Ct).removeEventListener("keydown",l(this,ka)))},$h=new WeakSet,cb=function(){l(this,Ss)||this.render(),this.isVisible?l(this,fi)&&l(this,Ct).classList.add("focused"):(C(this,Sw,wF).call(this),l(this,Ct).hidden=!1,l(this,Ct).style.zIndex=parseInt(l(this,Ct).style.zIndex)+1e3)},S0=new WeakSet,$E=function(){l(this,Ct).classList.remove("focused"),!(l(this,fi)||!this.isVisible)&&(l(this,Ct).hidden=!0,l(this,Ct).style.zIndex=parseInt(l(this,Ct).style.zIndex)-1e3)};class SF extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=fe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var _0;class BW extends wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,_0,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=_(this,_0,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,_0)}addHighlightArea(){this.container.classList.add("highlightArea")}}_0=new WeakMap;var A0;class $W extends wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,A0,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=t.borderStyle.width,a=_(this,A0,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",r-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,A0)}addHighlightArea(){this.container.classList.add("highlightArea")}}A0=new WeakMap;var E0;class zW extends wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,E0,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=t.borderStyle.width,a=_(this,E0,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",r/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",r/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,E0)}addHighlightArea(){this.container.classList.add("highlightArea")}}E0=new WeakMap;var C0;class _F extends wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,C0,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:r,popupRef:i},width:o,height:a}=this;if(!s)return this.container;const c=this.svgFactory.create(o,a,!0);let u=[];for(let h=0,p=s.length;h<p;h+=2){const m=s[h]-t[0],y=t[3]-s[h+1];u.push(`${m},${y}`)}u=u.join(" ");const d=_(this,C0,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,C0)}addHighlightArea(){this.container.classList.add("highlightArea")}}C0=new WeakMap;class VW extends _F{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class UW extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var k0,Vc,T0,zE;class yT extends wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,T0);x(this,k0,null);x(this,Vc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?fe.HIGHLIGHT:fe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:r,borderStyle:i,popupRef:o}}=this,{transform:a,width:c,height:u}=C(this,T0,zE).call(this,s,t),d=this.svgFactory.create(c,u,!0),h=_(this,k0,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let p=0,m=r.length;p<m;p++){const y=this.svgFactory.createElement(this.svgElementName);l(this,Vc).push(y),y.setAttribute("points",r[p].join(",")),h.append(y)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:r,rect:i}=t,o=l(this,k0);if(s>=0&&o.setAttribute("stroke-width",s||1),r)for(let a=0,c=l(this,Vc).length;a<c;a++)l(this,Vc)[a].setAttribute("points",r[a].join(","));if(i){const{transform:a,width:c,height:u}=C(this,T0,zE).call(this,this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,Vc)}addHighlightArea(){this.container.classList.add("highlightArea")}}k0=new WeakMap,Vc=new WeakMap,T0=new WeakSet,zE=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class AF extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=fe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class HW extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class GW extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class qW extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class EF extends wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=fe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var P0,N0,VE;class WW extends wt{constructor(t){var r;super(t,{isRenderable:!0});x(this,N0);x(this,P0,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let r;s.hasAppearance||s.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),r.addEventListener("dblclick",C(this,N0,VE).bind(this)),_(this,P0,r);const{isMac:i}=rn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&C(this,N0,VE).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return l(this,P0)}addHighlightArea(){this.container.classList.add("highlightArea")}}P0=new WeakMap,N0=new WeakSet,VE=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var zh,Uc,Vh,ja,R0,Hc,j0,UE,M0,HE,L0;let vT=(L0=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:r,page:i,viewport:o,structTreeLayer:a,commentManager:c,linkService:u,annotationStorage:d}){x(this,j0);x(this,M0);x(this,zh,null);x(this,Uc,null);x(this,Vh,null);x(this,ja,new Map);x(this,R0,null);x(this,Hc,null);this.div=e,_(this,zh,t),_(this,Uc,s),_(this,R0,a||null),_(this,Hc,u||null),_(this,Vh,d||new uT),this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=c||null}hasEditableAnnotations(){return l(this,ja).size>0}async render(e){var o,a,c;const{annotations:t}=e,s=this.div;dl(s,this.viewport);const r=new Map,i={data:null,layer:s,linkService:l(this,Hc),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Bm,annotationStorage:l(this,Vh),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const u of t){if(u.noHTML)continue;const d=u.annotationType===Pt.POPUP;if(d){const m=r.get(u.id);if(!m)continue;i.elements=m}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;i.data=u;const h=jR.create(i);if(!h.isRenderable)continue;if(!d&&u.popupRef){const m=r.get(u.popupRef);m?m.push(h):r.set(u.popupRef,[h])}const p=h.render();u.hidden&&(p.style.visibility="hidden"),await C(this,j0,UE).call(this,p,u.id,i.elements),(a=(o=h.extraPopupElement)==null?void 0:o.popup)==null||a.renderCommentButton(),h._isEditable&&(l(this,ja).set(h.data.id,h),(c=this._annotationEditorUIManager)==null||c.renderAnnotationElement(h))}C(this,M0,HE).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:l(this,Hc),svgFactory:new Bm,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=L0._defaultBorderStyle),t.data=s;const r=jR.create(t);if(!r.isRenderable)continue;const i=r.render();await C(this,j0,UE).call(this,i,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,dl(t,{rotation:e.rotation}),C(this,M0,HE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ja).values())}getEditableAnnotation(e){return l(this,ja).get(e)}addFakeAnnotation(e){var a;const{div:t}=this,{id:s,rotation:r}=e,i=new RW({data:{id:s,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:l(this,Hc),annotationStorage:l(this,Vh)}),o=i.render();return t.append(o),(a=l(this,zh))==null||a.moveElementInDOM(t,o,o,!1),i.createOrUpdatePopup(),i}static get _defaultBorderStyle(){return be(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:zu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},zh=new WeakMap,Uc=new WeakMap,Vh=new WeakMap,ja=new WeakMap,R0=new WeakMap,Hc=new WeakMap,j0=new WeakSet,UE=async function(e,t,s){var a,c;const r=e.firstChild||e,i=r.id=`${aT}${t}`,o=await((a=l(this,R0))==null?void 0:a.getAriaAttributes(i));if(o)for(const[u,d]of o)r.setAttribute(u,d);s?s.at(-1).container.after(e):(this.div.append(e),(c=l(this,zh))==null||c.moveElementInDOM(this.div,e,r,!1))},M0=new WeakSet,HE=function(){var t;if(!l(this,Uc))return;const e=this.div;for(const[s,r]of l(this,Uc)){const i=e.querySelector(`[data-annotation-id="${s}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:o}=i;o?o.nodeName==="CANVAS"?o.replaceWith(r):o.classList.contains("annotationContent")?o.after(r):o.before(r):i.append(r);const a=l(this,ja).get(s);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,i.id,r),a._hasNoCanvas=!1):a.canvas=r)}l(this,Uc).clear()},L0);const Cv=/\r\n?|\n/g;var _s,I0,Gc,As,_w,CF,Aw,kF,Ew,TF,Uh,ub,Hh,db,Gh,hb,Cw,PF,D0,qE,kw,NF;const et=class et extends rt{constructor(t){super({...t,name:"freeTextEditor"});x(this,_w);x(this,Aw);x(this,Ew);x(this,Uh);x(this,Gh);x(this,Cw);x(this,kw);x(this,_s,"");x(this,I0,`${this.id}-editor`);x(this,Gc,null);x(this,As,void 0);q(this,"_colorPicker",null);this.color=t.color||et._defaultColor||rt._defaultLineColor,_(this,As,t.fontSize||et._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=et.prototype,s=o=>o.isEmpty(),r=hl.TRANSLATE_SMALL,i=hl.TRANSLATE_BIG;return be(this,"_keyboardManager",new Iy([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}]]))}static initialize(t,s){rt.initialize(t,s);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Te.FREETEXT_SIZE:et._defaultFontSize=s;break;case Te.FREETEXT_COLOR:et._defaultColor=s;break}}updateParams(t,s){switch(t){case Te.FREETEXT_SIZE:C(this,_w,CF).call(this,s);break;case Te.FREETEXT_COLOR:C(this,Aw,kF).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Te.FREETEXT_SIZE,et._defaultFontSize],[Te.FREETEXT_COLOR,et._defaultColor||rt._defaultLineColor]]}get propertiesToUpdate(){return[[Te.FREETEXT_SIZE,l(this,As)],[Te.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new hx(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-et._internalPadding*t,-(et._internalPadding+l(this,As))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,Gc,new AbortController);const t=this._uiManager.combinedSignal(l(this,Gc));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,I0)),this._isDraggable=!0,(t=l(this,Gc))==null||t.abort(),_(this,Gc,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,_s),s=_(this,_s,C(this,Ew,TF).call(this).trimEnd());if(t===s)return;const r=i=>{if(_(this,_s,i),!i){this.remove();return}C(this,Gh,hb).call(this),this._uiManager.rebuild(this),C(this,Uh,ub).call(this)};this.addCommands({cmd:()=>{r(s)},undo:()=>{r(t)},mustExec:!1}),C(this,Uh,ub).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){et._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,I0)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${l(this,As)}px * var(--total-scale-factor))`,r.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,h]=this.pageDimensions,[p,m]=this.pageTranslation;let y,g;switch(this.rotation){case 0:y=t+(a[0]-p)/d,g=s+this.height-(a[1]-m)/h;break;case 90:y=t+(a[0]-p)/d,g=s-(a[1]-m)/h,[c,u]=[u,-c];break;case 180:y=t-this.width+(a[0]-p)/d,g=s-(a[1]-m)/h,[c,u]=[-c,-u];break;case 270:y=t+(a[0]-p-this.height*h)/d,g=s+(a[1]-m-this.width*d)/h,[c,u]=[-u,c];break}this.setAt(y*i,g*o,c,u)}else this._moveAfterPaste(t,s);C(this,Gh,hb).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,g,w;const s=t.clipboardData||window.clipboardData,{types:r}=s;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=C(y=et,D0,qE).call(y,s.getData("text")||"").replaceAll(Cv,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!i.includes(`
`)){a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=a,d=[],h=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(h.push(c.nodeValue.slice(u).replaceAll(Cv,"")),v!==this.editorDiv){let b=d;for(const S of this.editorDiv.childNodes){if(S===v){b=h;continue}b.push(C(g=et,Hh,db).call(g,S))}}d.push(c.nodeValue.slice(0,u).replaceAll(Cv,""))}else if(c===this.editorDiv){let v=d,b=0;for(const S of this.editorDiv.childNodes)b++===u&&(v=h),v.push(C(w=et,Hh,db).call(w,S))}_(this,_s,`${d.join(`
`)}${i}${h.join(`
`)}`),C(this,Gh,hb).call(this);const p=new Range;let m=Math.sumPrecise(d.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const b=v.nodeValue.length;if(m<=b){p.setStart(v,m),p.setEnd(v,m);break}m-=b}o.removeAllRanges(),o.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=et._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,r){var a;let i=null;if(t instanceof SF){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:h,id:p,popupRef:m,richText:y,contentsObj:g,creationDate:w,modificationDate:v},textContent:b,textPosition:S,parent:{page:{pageNumber:E}}}=t;if(!b||b.length===0)return null;i=t={annotationType:fe.FREETEXT,color:Array.from(u),fontSize:c,value:b.join(`
`),position:S,pageIndex:E-1,rect:d.slice(0),rotation:h,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:(g==null?void 0:g.str)||null,richText:y,creationDate:w,modificationDate:v}}const o=await super.deserialize(t,s,r);return _(o,As,t.fontSize),o.color=Z.makeHexColor(...t.color),_(o,_s,C(a=et,D0,qE).call(a,t.value)),o._initialData=i,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),r=Object.assign(super.serialize(t),{color:s,fontSize:l(this,As),value:C(this,Cw,PF).call(this)});return this.addComment(r),t?(r.isCopy=!0,r):this.annotationElementId&&!C(this,kw,NF).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:r}=s;r.fontSize=`calc(${l(this,As)}px * var(--total-scale-factor))`,r.color=this.color,s.replaceChildren();for(const i of l(this,_s).split(`
`)){const o=document.createElement("div");o.append(i?document.createTextNode(i):document.createElement("br")),s.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:l(this,_s)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};_s=new WeakMap,I0=new WeakMap,Gc=new WeakMap,As=new WeakMap,_w=new WeakSet,CF=function(t){const s=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-l(this,As))*this.parentScale),_(this,As,i),C(this,Uh,ub).call(this)},r=l(this,As);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Aw=new WeakSet,kF=function(t){const s=i=>{this.color=i,this.onUpdatedColor()},r=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ew=new WeakSet,TF=function(){var r;const t=[];this.editorDiv.normalize();let s=null;for(const i of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(C(r=et,Hh,db).call(r,i)),s=i);return t.join(`
`)},Uh=new WeakSet,ub=function(){const[t,s]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),r=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/s):(this.width=r.height/t,this.height=r.width/s),this.fixAndSetPosition()},Hh=new WeakSet,db=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Cv,"")},Gh=new WeakSet,hb=function(){if(this.editorDiv.replaceChildren(),!!l(this,_s))for(const t of l(this,_s).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Cw=new WeakSet,PF=function(){return l(this,_s).replaceAll(""," ")},D0=new WeakSet,qE=function(t){return t.replaceAll(" ","")},kw=new WeakSet,NF=function(t){const{value:s,fontSize:r,color:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==r||t.color.some((a,c)=>a!==i[c])||t.pageIndex!==o},x(et,Hh),x(et,D0),q(et,"_freeTextDefaultContent",""),q(et,"_internalPadding",0),q(et,"_defaultColor",null),q(et,"_defaultFontSize",10),q(et,"_type","freetext"),q(et,"_editorType",fe.FREETEXT);let GE=et;class ee{toSVGPath(){Je("Abstract method `toSVGPath` must be implemented.")}get box(){Je("Abstract getter `box` must be implemented.")}serialize(e,t){Je("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,r,i,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a]*r,o[a+1]=s+e[a+1]*i;return o}static _rescaleAndSwap(e,t,s,r,i,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a+1]*r,o[a+1]=s+e[a]*i;return o}static _translate(e,t,s,r){r||(r=new Float32Array(e.length));for(let i=0,o=e.length;i<o;i+=2)r[i]=t+e[i],r[i+1]=s+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,r,i){switch(i){case 90:return[1-t/s,e/r];case 180:return[1-e/s,1-t/r];case 270:return[t/s,1-e/r];default:return[e/s,t/r]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,r,i,o){return[(e+5*s)/6,(t+5*r)/6,(5*s+i)/6,(5*r+o)/6,(s+i)/2,(r+o)/2]}}q(ee,"PRECISION",1e-4);var Es,Tr,qh,Wh,pi,Se,qc,Wc,O0,F0,Kh,Xh,Ma,B0,Tw,Pw,Kc,$p,Nw,RF,Rw,jF,jw,MF,Mw,LF,Lw,IF,Iw,DF;const Mi=class Mi{constructor({x:e,y:t},s,r,i,o,a=0){x(this,Kc);x(this,Nw);x(this,Rw);x(this,jw);x(this,Mw);x(this,Lw);x(this,Iw);x(this,Es,void 0);x(this,Tr,[]);x(this,qh,void 0);x(this,Wh,void 0);x(this,pi,[]);x(this,Se,new Float32Array(18));x(this,qc,void 0);x(this,Wc,void 0);x(this,O0,void 0);x(this,F0,void 0);x(this,Kh,void 0);x(this,Xh,void 0);x(this,Ma,[]);_(this,Es,s),_(this,Xh,i*r),_(this,Wh,o),l(this,Se).set([NaN,NaN,NaN,NaN,e,t],6),_(this,qh,a),_(this,F0,l(Mi,B0)*r),_(this,O0,l(Mi,Pw)*r),_(this,Kh,r),l(this,Ma).push(e,t)}isEmpty(){return isNaN(l(this,Se)[8])}add({x:e,y:t}){var M;_(this,qc,e),_(this,Wc,t);const[s,r,i,o]=l(this,Es);let[a,c,u,d]=l(this,Se).subarray(8,12);const h=e-u,p=t-d,m=Math.hypot(h,p);if(m<l(this,O0))return!1;const y=m-l(this,F0),g=y/m,w=g*h,v=g*p;let b=a,S=c;a=u,c=d,u+=w,d+=v,(M=l(this,Ma))==null||M.push(e,t);const E=-v/y,k=w/y,T=E*l(this,Xh),P=k*l(this,Xh);return l(this,Se).set(l(this,Se).subarray(2,8),0),l(this,Se).set([u+T,d+P],4),l(this,Se).set(l(this,Se).subarray(14,18),12),l(this,Se).set([u-T,d-P],16),isNaN(l(this,Se)[6])?(l(this,pi).length===0&&(l(this,Se).set([a+T,c+P],2),l(this,pi).push(NaN,NaN,NaN,NaN,(a+T-s)/i,(c+P-r)/o),l(this,Se).set([a-T,c-P],14),l(this,Tr).push(NaN,NaN,NaN,NaN,(a-T-s)/i,(c-P-r)/o)),l(this,Se).set([b,S,a,c,u,d],6),!this.isEmpty()):(l(this,Se).set([b,S,a,c,u,d],6),Math.abs(Math.atan2(S-c,b-a)-Math.atan2(v,w))<Math.PI/2?([a,c,u,d]=l(this,Se).subarray(2,6),l(this,pi).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/i,((c+d)/2-r)/o),[a,c,b,S]=l(this,Se).subarray(14,18),l(this,Tr).push(NaN,NaN,NaN,NaN,((b+a)/2-s)/i,((S+c)/2-r)/o),!0):([b,S,a,c,u,d]=l(this,Se).subarray(0,6),l(this,pi).push(((b+5*a)/6-s)/i,((S+5*c)/6-r)/o,((5*a+u)/6-s)/i,((5*c+d)/6-r)/o,((a+u)/2-s)/i,((c+d)/2-r)/o),[u,d,a,c,b,S]=l(this,Se).subarray(12,18),l(this,Tr).push(((b+5*a)/6-s)/i,((S+5*c)/6-r)/o,((5*a+u)/6-s)/i,((5*c+d)/6-r)/o,((a+u)/2-s)/i,((c+d)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,pi),t=l(this,Tr);if(isNaN(l(this,Se)[6])&&!this.isEmpty())return C(this,Nw,RF).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);C(this,jw,MF).call(this,s);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return C(this,Rw,jF).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,r,i,o){return new OF(e,t,s,r,i,o)}getOutlines(){var h;const e=l(this,pi),t=l(this,Tr),s=l(this,Se),[r,i,o,a]=l(this,Es),c=new Float32Array((((h=l(this,Ma))==null?void 0:h.length)??0)+2);for(let p=0,m=c.length-2;p<m;p+=2)c[p]=(l(this,Ma)[p]-r)/o,c[p+1]=(l(this,Ma)[p+1]-i)/a;if(c[c.length-2]=(l(this,qc)-r)/o,c[c.length-1]=(l(this,Wc)-i)/a,isNaN(s[6])&&!this.isEmpty())return C(this,Mw,LF).call(this,c);const u=new Float32Array(l(this,pi).length+24+l(this,Tr).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}d=C(this,Iw,DF).call(this,u,d);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[p+m],u[d+1]=t[p+m+1],d+=2}return C(this,Lw,IF).call(this,u,d),this.newFreeDrawOutline(u,c,l(this,Es),l(this,Kh),l(this,qh),l(this,Wh))}};Es=new WeakMap,Tr=new WeakMap,qh=new WeakMap,Wh=new WeakMap,pi=new WeakMap,Se=new WeakMap,qc=new WeakMap,Wc=new WeakMap,O0=new WeakMap,F0=new WeakMap,Kh=new WeakMap,Xh=new WeakMap,Ma=new WeakMap,B0=new WeakMap,Tw=new WeakMap,Pw=new WeakMap,Kc=new WeakSet,$p=function(){const e=l(this,Se).subarray(4,6),t=l(this,Se).subarray(16,18),[s,r,i,o]=l(this,Es);return[(l(this,qc)+(e[0]-t[0])/2-s)/i,(l(this,Wc)+(e[1]-t[1])/2-r)/o,(l(this,qc)+(t[0]-e[0])/2-s)/i,(l(this,Wc)+(t[1]-e[1])/2-r)/o]},Nw=new WeakSet,RF=function(){const[e,t,s,r]=l(this,Es),[i,o,a,c]=C(this,Kc,$p).call(this);return`M${(l(this,Se)[2]-e)/s} ${(l(this,Se)[3]-t)/r} L${(l(this,Se)[4]-e)/s} ${(l(this,Se)[5]-t)/r} L${i} ${o} L${a} ${c} L${(l(this,Se)[16]-e)/s} ${(l(this,Se)[17]-t)/r} L${(l(this,Se)[14]-e)/s} ${(l(this,Se)[15]-t)/r} Z`},Rw=new WeakSet,jF=function(e){const t=l(this,Tr);e.push(`L${t[4]} ${t[5]} Z`)},jw=new WeakSet,MF=function(e){const[t,s,r,i]=l(this,Es),o=l(this,Se).subarray(4,6),a=l(this,Se).subarray(16,18),[c,u,d,h]=C(this,Kc,$p).call(this);e.push(`L${(o[0]-t)/r} ${(o[1]-s)/i} L${c} ${u} L${d} ${h} L${(a[0]-t)/r} ${(a[1]-s)/i}`)},Mw=new WeakSet,LF=function(e){const t=l(this,Se),[s,r,i,o]=l(this,Es),[a,c,u,d]=C(this,Kc,$p).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-r)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-r)/o],0),this.newFreeDrawOutline(h,e,l(this,Es),l(this,Kh),l(this,qh),l(this,Wh))},Lw=new WeakSet,IF=function(e,t){const s=l(this,Tr);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},Iw=new WeakSet,DF=function(e,t){const s=l(this,Se).subarray(4,6),r=l(this,Se).subarray(16,18),[i,o,a,c]=l(this,Es),[u,d,h,p]=C(this,Kc,$p).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(r[0]-i)/a,(r[1]-o)/c],t),t+=24},x(Mi,B0,8),x(Mi,Tw,2),x(Mi,Pw,l(Mi,B0)+l(Mi,Tw));let fx=Mi;var Yh,Xc,uo,$0,Cs,z0,Rt,Dw,FF;class OF extends ee{constructor(t,s,r,i,o,a){super();x(this,Dw);x(this,Yh,void 0);x(this,Xc,new Float32Array(4));x(this,uo,void 0);x(this,$0,void 0);x(this,Cs,void 0);x(this,z0,void 0);x(this,Rt,void 0);_(this,Rt,t),_(this,Cs,s),_(this,Yh,r),_(this,z0,i),_(this,uo,o),_(this,$0,a),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],C(this,Dw,FF).call(this,a);const[c,u,d,h]=l(this,Xc);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-c)/d,t[p+1]=(t[p+1]-u)/h;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-c)/d,s[p+1]=(s[p+1]-u)/h}toSVGPath(){const t=[`M${l(this,Rt)[4]} ${l(this,Rt)[5]}`];for(let s=6,r=l(this,Rt).length;s<r;s+=6){if(isNaN(l(this,Rt)[s])){t.push(`L${l(this,Rt)[s+4]} ${l(this,Rt)[s+5]}`);continue}t.push(`C${l(this,Rt)[s]} ${l(this,Rt)[s+1]} ${l(this,Rt)[s+2]} ${l(this,Rt)[s+3]} ${l(this,Rt)[s+4]} ${l(this,Rt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,r,i],o){const a=r-t,c=i-s;let u,d;switch(o){case 0:u=ee._rescale(l(this,Rt),t,i,a,-c),d=ee._rescale(l(this,Cs),t,i,a,-c);break;case 90:u=ee._rescaleAndSwap(l(this,Rt),t,s,a,c),d=ee._rescaleAndSwap(l(this,Cs),t,s,a,c);break;case 180:u=ee._rescale(l(this,Rt),r,s,-a,c),d=ee._rescale(l(this,Cs),r,s,-a,c);break;case 270:u=ee._rescaleAndSwap(l(this,Rt),r,i,-a,-c),d=ee._rescaleAndSwap(l(this,Cs),r,i,-a,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return l(this,Xc)}newOutliner(t,s,r,i,o,a=0){return new fx(t,s,r,i,o,a)}getNewOutline(t,s){const[r,i,o,a]=l(this,Xc),[c,u,d,h]=l(this,Yh),p=o*d,m=a*h,y=r*d+c,g=i*h+u,w=this.newOutliner({x:l(this,Cs)[0]*p+y,y:l(this,Cs)[1]*m+g},l(this,Yh),l(this,z0),t,l(this,$0),s??l(this,uo));for(let v=2;v<l(this,Cs).length;v+=2)w.add({x:l(this,Cs)[v]*p+y,y:l(this,Cs)[v+1]*m+g});return w.getOutlines()}}Yh=new WeakMap,Xc=new WeakMap,uo=new WeakMap,$0=new WeakMap,Cs=new WeakMap,z0=new WeakMap,Rt=new WeakMap,Dw=new WeakSet,FF=function(t){const s=l(this,Rt);let r=s[4],i=s[5];const o=[r,i,r,i];let a=r,c=i,u=r,d=i;const h=t?Math.max:Math.min,p=new Float32Array(4);for(let y=6,g=s.length;y<g;y+=6){const w=s[y+4],v=s[y+5];isNaN(s[y])?(Z.pointBoundingBox(w,v,o),c>v?(a=w,c=v):c===v&&(a=h(a,w)),d<v?(u=w,d=v):d===v&&(u=h(u,w))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,Z.bezierBoundingBox(r,i,...s.slice(y,y+6),p),Z.rectBoundingBox(p[0],p[1],p[2],p[3],o),c>p[1]?(a=p[0],c=p[1]):c===p[1]&&(a=h(a,p[0])),d<p[3]?(u=p[2],d=p[3]):d===p[3]&&(u=h(u,p[2]))),r=w,i=v}const m=l(this,Xc);m[0]=o[0]-l(this,uo),m[1]=o[1]-l(this,uo),m[2]=o[2]-o[0]+2*l(this,uo),m[3]=o[3]-o[1]+2*l(this,uo),this.firstPoint=[a,c],this.lastPoint=[u,d]};var V0,U0,H0,La,Pr,Ow,BF,Qh,fb,Fw,$F,Bw,zF,G0,KE;class WE{constructor(e,t=0,s=0,r=!0){x(this,Ow);x(this,Qh);x(this,Fw);x(this,Bw);x(this,G0);x(this,V0,void 0);x(this,U0,void 0);x(this,H0,void 0);x(this,La,[]);x(this,Pr,[]);const i=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:w,y:v,width:b,height:S}of e){const E=Math.floor((w-t)/a)*a,k=Math.ceil((w+b+t)/a)*a,T=Math.floor((v-t)/a)*a,P=Math.ceil((v+S+t)/a)*a,N=[E,T,P,!0],M=[k,T,P,!1];l(this,La).push(N,M),Z.rectBoundingBox(E,T,k,P,i)}const c=i[2]-i[0]+2*s,u=i[3]-i[1]+2*s,d=i[0]-s,h=i[1]-s;let p=r?-1/0:1/0,m=1/0;const y=l(this,La).at(r?-1:-2),g=[y[0],y[2]];for(const w of l(this,La)){const[v,b,S,E]=w;!E&&r?b<m?(m=b,p=v):b===m&&(p=Math.max(p,v)):E&&!r&&(b<m?(m=b,p=v):b===m&&(p=Math.min(p,v))),w[0]=(v-d)/c,w[1]=(b-h)/u,w[2]=(S-h)/u}_(this,V0,new Float32Array([d,h,c,u])),_(this,U0,[p,m]),_(this,H0,g)}getOutlines(){l(this,La).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,La))t[3]?(e.push(...C(this,G0,KE).call(this,t)),C(this,Fw,$F).call(this,t)):(C(this,Bw,zF).call(this,t),e.push(...C(this,G0,KE).call(this,t)));return C(this,Ow,BF).call(this,e)}}V0=new WeakMap,U0=new WeakMap,H0=new WeakMap,La=new WeakMap,Pr=new WeakMap,Ow=new WeakSet,BF=function(e){const t=[],s=new Set;for(const o of e){const[a,c,u]=o;t.push([a,c,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const r=[];let i;for(;s.size>0;){const o=s.values().next().value;let[a,c,u,d,h]=o;s.delete(o);let p=a,m=c;for(i=[a,u],r.push(i);;){let y;if(s.has(d))y=d;else if(s.has(h))y=h;else break;s.delete(y),[a,c,u,d,h]=y,p!==a&&(i.push(p,m,a,m===c?c:u),p=a),m=m===c?u:c}i.push(p,m)}return new KW(r,l(this,V0),l(this,U0),l(this,H0))},Qh=new WeakSet,fb=function(e){const t=l(this,Pr);let s=0,r=t.length-1;for(;s<=r;){const i=s+r>>1,o=t[i][0];if(o===e)return i;o<e?s=i+1:r=i-1}return r+1},Fw=new WeakSet,$F=function([,e,t]){const s=C(this,Qh,fb).call(this,e);l(this,Pr).splice(s,0,[e,t])},Bw=new WeakSet,zF=function([,e,t]){const s=C(this,Qh,fb).call(this,e);for(let r=s;r<l(this,Pr).length;r++){const[i,o]=l(this,Pr)[r];if(i!==e)break;if(i===e&&o===t){l(this,Pr).splice(r,1);return}}for(let r=s-1;r>=0;r--){const[i,o]=l(this,Pr)[r];if(i!==e)break;if(i===e&&o===t){l(this,Pr).splice(r,1);return}}},G0=new WeakSet,KE=function(e){const[t,s,r]=e,i=[[t,s,r]],o=C(this,Qh,fb).call(this,r);for(let a=0;a<o;a++){const[c,u]=l(this,Pr)[a];for(let d=0,h=i.length;d<h;d++){const[,p,m]=i[d];if(!(u<=p||m<=c)){if(p>=c){if(m>u)i[d][1]=u;else{if(h===1)return[];i.splice(d,1),d--,h--}continue}i[d][2]=c,m>u&&i.push([t,u,m])}}}return i};var q0,Jh;class KW extends ee{constructor(t,s,r,i){super();x(this,q0,void 0);x(this,Jh,void 0);_(this,Jh,t),_(this,q0,s),this.firstPoint=r,this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Jh)){let[r,i]=s;t.push(`M${r} ${i}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===r?(t.push(`V${c}`),i=c):c===i&&(t.push(`H${a}`),r=a)}t.push("Z")}return t.join(" ")}serialize([t,s,r,i],o){const a=[],c=r-t,u=i-s;for(const d of l(this,Jh)){const h=new Array(d.length);for(let p=0;p<d.length;p+=2)h[p]=t+d[p]*c,h[p+1]=i-d[p+1]*u;a.push(h)}return a}get box(){return l(this,q0)}get classNamesForOutlining(){return["highlightOutline"]}}q0=new WeakMap,Jh=new WeakMap;class XE extends fx{newFreeDrawOutline(e,t,s,r,i,o){return new XW(e,t,s,r,i,o)}}class XW extends OF{newOutliner(e,t,s,r,i,o=0){return new XE(e,t,s,r,i,o)}}var Zh,W0,ho,Yc,K0,ns,X0,Y0,Qc,ks,Ts,hn,ef,tf,Cn,nf,nr,Q0,J0,YE,sf,pb,$w,VF,zw,UF,Vw,HF,Z0,QE,fo,Rl,Ia,Wu,Uw,GF,rf,mb,of,gb,Hw,qF,Gw,WF,qw,KF,Ww,XF,Kw,YF;const Me=class Me extends rt{constructor(t){super({...t,name:"highlightEditor"});x(this,J0);x(this,sf);x(this,$w);x(this,zw);x(this,Vw);x(this,Z0);x(this,fo);x(this,Uw);x(this,rf);x(this,of);x(this,Hw);x(this,Gw);x(this,Kw);x(this,Zh,null);x(this,W0,0);x(this,ho,void 0);x(this,Yc,null);x(this,K0,null);x(this,ns,null);x(this,X0,null);x(this,Y0,0);x(this,Qc,null);x(this,ks,null);x(this,Ts,null);x(this,hn,!1);x(this,ef,null);x(this,tf,null);x(this,Cn,null);x(this,nf,"");x(this,nr,void 0);x(this,Q0,"");this.color=t.color||Me._defaultColor,_(this,nr,t.thickness||Me._defaultThickness),this.opacity=t.opacity||Me._defaultOpacity,_(this,ho,t.boxes||null),_(this,Q0,t.methodOfCreation||""),_(this,nf,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(_(this,hn,!0),C(this,sf,pb).call(this,t),C(this,fo,Rl).call(this)):l(this,ho)&&(_(this,Zh,t.anchorNode),_(this,W0,t.anchorOffset),_(this,X0,t.focusNode),_(this,Y0,t.focusOffset),C(this,J0,YE).call(this),C(this,fo,Rl).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Me.prototype;return be(this,"_keyboardManager",new Iy([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,hn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:l(this,nr),methodOfCreation:l(this,Q0)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var r;rt.initialize(t,s),Me._defaultColor||(Me._defaultColor=((r=s.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case Te.HIGHLIGHT_COLOR:Me._defaultColor=s;break;case Te.HIGHLIGHT_THICKNESS:Me._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,tf)}get commentButtonPosition(){return l(this,ef)}updateParams(t,s){switch(t){case Te.HIGHLIGHT_COLOR:C(this,$w,VF).call(this,s);break;case Te.HIGHLIGHT_THICKNESS:C(this,zw,UF).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,Me._defaultColor],[Te.HIGHLIGHT_THICKNESS,Me._defaultThickness]]}get propertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,this.color||Me._defaultColor],[Te.HIGHLIGHT_THICKNESS,l(this,nr)||Me._defaultThickness],[Te.HIGHLIGHT_FREE,l(this,hn)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Ts),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=l(this,K0))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",_(this,K0,new Fm({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,of,gb).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,C(this,of,gb).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){C(this,Z0,QE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,fo,Rl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?C(this,Z0,QE).call(this):t&&(C(this,fo,Rl).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var i,o,a;const{drawLayer:s}=this.parent;let r;l(this,hn)?(t=(t-this.rotation+360)%360,r=C(i=Me,Ia,Wu).call(i,l(this,ks).box,t)):r=C(o=Me,Ia,Wu).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Ts),{bbox:r,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Cn),{bbox:C(a=Me,Ia,Wu).call(a,l(this,ns).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,nf)&&(t.setAttribute("aria-label",l(this,nf)),t.setAttribute("role","mark")),l(this,hn)?t.classList.add("free"):this.div.addEventListener("keydown",C(this,Uw,GF).bind(this),{signal:this._uiManager._signal});const s=_(this,Qc,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Yc),this.setDims(this.width,this.height),yO(this,l(this,Qc),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Cn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Cn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:C(this,rf,mb).call(this,!0);break;case 1:case 3:C(this,rf,mb).call(this,!1);break}}select(){var t;super.select(),l(this,Cn)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Cn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Cn)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Cn),{rootClass:{selected:!1}}),l(this,hn)||C(this,rf,mb).call(this,!1))}get _mustFixPosition(){return!l(this,hn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Ts),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Cn),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:r,x:i,y:o}){const{x:a,y:c,width:u,height:d}=r.getBoundingClientRect(),h=new AbortController,p=t.combinedSignal(h),m=y=>{h.abort(),C(this,Ww,XF).call(this,t,y)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",vt,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Bs,{signal:p}),r.addEventListener("pointermove",C(this,qw,KF).bind(this,t),{signal:p}),this._freeHighlight=new XE({x:i,y:o},[a,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,r){var g,w,v,b;let i=null;if(t instanceof AF){const{data:{quadPoints:S,rect:E,rotation:k,id:T,color:P,opacity:N,popupRef:M,richText:L,contentsObj:O,creationDate:D,modificationDate:V},parent:{page:{pageNumber:I}}}=t;i=t={annotationType:fe.HIGHLIGHT,color:Array.from(P),opacity:N,quadPoints:S,boxes:null,pageIndex:I-1,rect:E.slice(0),rotation:k,annotationElementId:T,id:T,deleted:!1,popupRef:M,richText:L,comment:(O==null?void 0:O.str)||null,creationDate:D,modificationDate:V}}else if(t instanceof yT){const{data:{inkLists:S,rect:E,rotation:k,id:T,color:P,borderStyle:{rawWidth:N},popupRef:M,richText:L,contentsObj:O,creationDate:D,modificationDate:V},parent:{page:{pageNumber:I}}}=t;i=t={annotationType:fe.HIGHLIGHT,color:Array.from(P),thickness:N,inkLists:S,boxes:null,pageIndex:I-1,rect:E.slice(0),rotation:k,annotationElementId:T,id:T,deleted:!1,popupRef:M,richText:L,comment:(O==null?void 0:O.str)||null,creationDate:D,modificationDate:V}}const{color:o,quadPoints:a,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,r);d.color=Z.makeHexColor(...o),d.opacity=u||1,c&&_(d,nr,t.thickness),d._initialData=i,t.comment&&d.setCommentData(t);const[h,p]=d.pageDimensions,[m,y]=d.pageTranslation;if(a){const S=_(d,ho,[]);for(let E=0;E<a.length;E+=8)S.push({x:(a[E]-m)/h,y:1-(a[E+1]-y)/p,width:(a[E+2]-a[E])/h,height:(a[E+1]-a[E+5])/p});C(g=d,J0,YE).call(g),C(w=d,fo,Rl).call(w),d.rotate(d.rotation)}else if(c){_(d,hn,!0);const S=c[0],E={x:S[0]-m,y:p-(S[1]-y)},k=new XE(E,[0,0,h,p],1,l(d,nr)/2,!0,.001);for(let N=0,M=S.length;N<M;N+=2)E.x=S[N]-m,E.y=p-(S[N+1]-y),k.add(E);const{id:T,clipPathId:P}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);C(v=d,sf,pb).call(v,{highlightOutlines:k.getOutlines(),highlightId:T,clipPathId:P}),C(b=d,fo,Rl).call(b),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r=super.serialize(t);return Object.assign(r,{color:s,opacity:this.opacity,thickness:l(this,nr),quadPoints:C(this,Hw,qF).call(this),outlines:C(this,Gw,WF).call(this,r.rect)}),this.addComment(r),this.annotationElementId&&!C(this,Kw,YF).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Zh=new WeakMap,W0=new WeakMap,ho=new WeakMap,Yc=new WeakMap,K0=new WeakMap,ns=new WeakMap,X0=new WeakMap,Y0=new WeakMap,Qc=new WeakMap,ks=new WeakMap,Ts=new WeakMap,hn=new WeakMap,ef=new WeakMap,tf=new WeakMap,Cn=new WeakMap,nf=new WeakMap,nr=new WeakMap,Q0=new WeakMap,J0=new WeakSet,YE=function(){const t=new WE(l(this,ho),.001);_(this,ks,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,ks).box;const s=new WE(l(this,ho),.0025,.001,this._uiManager.direction==="ltr");_(this,ns,s.getOutlines());const{firstPoint:r}=l(this,ks);_(this,ef,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]);const{lastPoint:i}=l(this,ns);_(this,tf,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},sf=new WeakSet,pb=function({highlightOutlines:t,highlightId:s,clipPathId:r}){var p,m;_(this,ks,t);const i=1.5;if(_(this,ns,t.getNewOutline(l(this,nr)/2+i,.0025)),s>=0)_(this,Ts,s),_(this,Yc,r),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),_(this,Cn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,ns).box,path:{d:l(this,ns).toSVGPath()}},!0));else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Ts),{bbox:C(p=Me,Ia,Wu).call(p,l(this,ks).box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Cn),{bbox:C(m=Me,Ia,Wu).call(m,l(this,ns).box,y),path:{d:l(this,ns).toSVGPath()}})}const[o,a,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=u;break;case 90:{const[y,g]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*g/y,this.height=u*y/g;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=u;break;case 270:{const[y,g]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*g/y,this.height=u*y/g;break}}const{firstPoint:d}=t;_(this,ef,[(d[0]-o)/c,(d[1]-a)/u]);const{lastPoint:h}=l(this,ns);_(this,tf,[(h[0]-o)/c,(h[1]-a)/u])},$w=new WeakSet,VF=function(t){const s=(o,a)=>{this.color=o,this.opacity=a,this.onUpdatedColor()},r=this.color,i=this.opacity;this.addCommands({cmd:s.bind(this,t,Me._defaultOpacity),undo:s.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},zw=new WeakSet,UF=function(t){const s=l(this,nr),r=i=>{_(this,nr,i),C(this,Vw,HF).call(this,i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},Vw=new WeakSet,HF=function(t){l(this,hn)&&(C(this,sf,pb).call(this,{highlightOutlines:l(this,ks).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},Z0=new WeakSet,QE=function(){l(this,Ts)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Ts)),_(this,Ts,null),this.parent.drawLayer.remove(l(this,Cn)),_(this,Cn,null))},fo=new WeakSet,Rl=function(t=this.parent){l(this,Ts)===null&&({id:$t(this,Ts)._,clipPathId:$t(this,Yc)._}=t.drawLayer.draw({bbox:l(this,ks).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:l(this,hn)},path:{d:l(this,ks).toSVGPath()}},!1,!0),_(this,Cn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,hn)},bbox:l(this,ns).box,path:{d:l(this,ns).toSVGPath()}},l(this,hn))),l(this,Qc)&&(l(this,Qc).style.clipPath=l(this,Yc)))},Ia=new WeakSet,Wu=function([t,s,r,i],o){switch(o){case 90:return[1-s-i,t,i,r];case 180:return[1-t-r,1-s-i,r,i];case 270:return[s,1-t-r,i,r]}return[t,s,r,i]},Uw=new WeakSet,GF=function(t){Me._keyboardManager.exec(this,t)},rf=new WeakSet,mb=function(t){if(!l(this,Zh))return;const s=window.getSelection();t?s.setPosition(l(this,Zh),l(this,W0)):s.setPosition(l(this,X0),l(this,Y0))},of=new WeakSet,gb=function(){return l(this,hn)?this.rotation:0},Hw=new WeakSet,qF=function(){if(l(this,hn))return null;const[t,s]=this.pageDimensions,[r,i]=this.pageTranslation,o=l(this,ho),a=new Float32Array(o.length*8);let c=0;for(const{x:u,y:d,width:h,height:p}of o){const m=u*t+r,y=(1-d)*s+i;a[c]=a[c+4]=m,a[c+1]=a[c+3]=y,a[c+2]=a[c+6]=m+h*t,a[c+5]=a[c+7]=y-p*s,c+=8}return a},Gw=new WeakSet,WF=function(t){return l(this,ks).serialize(t,C(this,of,gb).call(this))},qw=new WeakSet,KF=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Ww=new WeakSet,XF=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Kw=new WeakSet,YF=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((r,i)=>r!==s[i])},x(Me,Ia),x(Me,qw),x(Me,Ww),q(Me,"_defaultColor",null),q(Me,"_defaultOpacity",1),q(Me,"_defaultThickness",12),q(Me,"_type","highlight"),q(Me,"_editorType",fe.HIGHLIGHT),q(Me,"_freeHighlightId",-1),q(Me,"_freeHighlight",null),q(Me,"_freeHighlightClipId","");let px=Me;var Jc;class QF{constructor(){x(this,Jc,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,Jc)[e]=t}toSVGProperties(){const e=l(this,Jc);return _(this,Jc,Object.create(null)),{root:e}}reset(){_(this,Jc,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Je("Not implemented")}}Jc=new WeakMap;var Ps,af,Qt,Zc,eu,Da,Oa,Fa,tu,ey,JE,ty,ZE,ny,eC,nu,zp,Xw,JF,lf,yb,su,Vp,Ba,Ku;const ne=class ne extends rt{constructor(t){super(t);x(this,ey);x(this,ty);x(this,ny);x(this,nu);x(this,Xw);x(this,lf);x(this,su);x(this,Ba);x(this,Ps,null);x(this,af,void 0);q(this,"_colorPicker",null);q(this,"_drawId",null);_(this,af,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(C(this,ey,JE).call(this,t),C(this,nu,zp).call(this))}static _mergeSVGProperties(t,s){const r=new Set(Object.keys(t));for(const[i,o]of Object.entries(s))r.has(i)?Object.assign(t[i],o):t[i]=o;return t}static getDefaultDrawingOptions(t){Je("Not implemented")}static get typesMap(){Je("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,s),this._currentParent&&(l(ne,Qt).updateProperty(r,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,s[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,s[i]]);return t}_updateProperty(t,s,r){const i=this._drawingOptions,o=i[s],a=c=>{var d;i.updateProperty(s,c);const u=l(this,Ps).updateProperty(s,c);u&&C(this,su,Vp).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,r),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(l(this,Ps).getPathResizingSVGProperties(C(this,lf,yb).call(this)),{bbox:C(this,Ba,Ku).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(l(this,Ps).getPathResizedSVGProperties(C(this,lf,yb).call(this)),{bbox:C(this,Ba,Ku).call(this)}))}_onTranslating(t,s){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:C(this,Ba,Ku).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(l(this,Ps).getPathTranslatedSVGProperties(C(this,lf,yb).call(this),this.parentDimensions),{bbox:C(this,Ba,Ku).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,af)&&(_(this,af,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){C(this,ny,eC).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,nu,zp).call(this),C(this,su,Vp).call(this,l(this,Ps).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),C(this,ny,eC).call(this)):t&&(this._uiManager.addShouldRescale(this),C(this,nu,zp).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties({bbox:C(this,Ba,Ku).call(this)},l(this,Ps).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&C(this,su,Vp).call(this,l(this,Ps).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");return r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),r}static createDrawerInstance(t,s,r,i,o){Je("Not implemented")}static startDrawing(t,s,r,i){var w;const{target:o,offsetX:a,offsetY:c,pointerId:u,pointerType:d}=i;if(l(ne,Oa)&&l(ne,Oa)!==d)return;const{viewport:{rotation:h}}=t,{width:p,height:m}=o.getBoundingClientRect(),y=_(ne,Zc,new AbortController),g=t.combinedSignal(y);if(l(ne,Da)||_(ne,Da,u),l(ne,Oa)??_(ne,Oa,d),window.addEventListener("pointerup",v=>{var b;l(ne,Da)===v.pointerId?this._endDraw(v):(b=l(ne,Fa))==null||b.delete(v.pointerId)},{signal:g}),window.addEventListener("pointercancel",v=>{var b;l(ne,Da)===v.pointerId?this._currentParent.endDrawingSession():(b=l(ne,Fa))==null||b.delete(v.pointerId)},{signal:g}),window.addEventListener("pointerdown",v=>{l(ne,Oa)===v.pointerType&&((l(ne,Fa)||_(ne,Fa,new Set)).add(v.pointerId),l(ne,Qt).isCancellable()&&(l(ne,Qt).removeLastElement(),l(ne,Qt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Bs,{signal:g}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),o.addEventListener("touchmove",v=>{v.timeStamp===l(ne,tu)&&vt(v)},{signal:g}),t.toggleDrawing(),(w=s._editorUndoBar)==null||w.hide(),l(ne,Qt)){t.drawLayer.updateProperties(this._currentDrawId,l(ne,Qt).startNew(a,c,p,m,h));return}s.updateUIForDefaultProperties(this),_(ne,Qt,this.createDrawerInstance(a,c,p,m,h)),_(ne,eu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(ne,eu).toSVGProperties(),l(ne,Qt).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(_(ne,tu,-1),!l(ne,Qt))return;const{offsetX:s,offsetY:r,pointerId:i}=t;if(l(ne,Da)===i){if(((o=l(ne,Fa))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(ne,Qt).add(s,r)),_(ne,tu,t.timeStamp),vt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_(ne,Qt,null),_(ne,eu,null),_(ne,Oa,null),_(ne,tu,NaN)),l(ne,Zc)&&(l(ne,Zc).abort(),_(ne,Zc,null),_(ne,Da,NaN),_(ne,Fa,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,l(ne,Qt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=l(ne,Qt),i=this._currentDrawId,o=r.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,r.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:Te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Te.DRAW_STEP),!l(ne,Qt).isEmpty()){const{pageDimensions:[r,i],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(ne,Qt).getOutlines(r*o,i*o,o,this._INNER_MARGIN),drawingOptions:l(ne,eu),mustBeCommitted:!t});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,r,i,o,a){Je("Not implemented")}static async deserialize(t,s,r){var h,p;const{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:c}}=s.viewport,u=this.deserializeDraw(a,c,i,o,this._INNER_MARGIN,t),d=await super.deserialize(t,s,r);return d.createDrawingOptions(t),C(h=d,ey,JE).call(h,{drawOutlines:u}),C(p=d,nu,zp).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,r]=this.pageTranslation,[i,o]=this.pageDimensions;return l(this,Ps).serialize([s,r,i,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Ps=new WeakMap,af=new WeakMap,Qt=new WeakMap,Zc=new WeakMap,eu=new WeakMap,Da=new WeakMap,Oa=new WeakMap,Fa=new WeakMap,tu=new WeakMap,ey=new WeakSet,JE=function({drawOutlines:t,drawId:s,drawingOptions:r}){_(this,Ps,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=C(this,ty,ZE).call(this,t,this.parent),C(this,su,Vp).call(this,t.box)},ty=new WeakSet,ZE=function(t,s){const{id:r}=s.drawLayer.draw(ne._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},ny=new WeakSet,eC=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},nu=new WeakSet,zp=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=C(this,ty,ZE).call(this,l(this,Ps),t)}},Xw=new WeakSet,JF=function([t,s,r,i]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-t,r*(a/o),i*(o/a)];case 180:return[1-t,1-s,r,i];case 270:return[1-s,t,r*(a/o),i*(o/a)];default:return[t,s,r,i]}},lf=new WeakSet,yb=function(){const{x:t,y:s,width:r,height:i,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,t,r*(o/a),i*(a/o)];case 180:return[1-t,1-s,r,i];case 270:return[s,1-t,r*(o/a),i*(a/o)];default:return[t,s,r,i]}},su=new WeakSet,Vp=function(t){[this.x,this.y,this.width,this.height]=C(this,Xw,JF).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ba=new WeakSet,Ku=function(){const{x:t,y:s,width:r,height:i,rotation:o,parentRotation:a,parentDimensions:[c,u]}=this;switch((o*4+a)/90){case 1:return[1-s-i,t,i,r];case 2:return[1-t-r,1-s-i,r,i];case 3:return[s,1-t-r,i,r];case 4:return[t,s-r*(c/u),i*(u/c),r*(c/u)];case 5:return[1-s,t,r*(c/u),i*(u/c)];case 6:return[1-t-i*(u/c),1-s,i*(u/c),r*(c/u)];case 7:return[s-r*(c/u),1-t-i*(u/c),r*(c/u),i*(u/c)];case 8:return[t-r,s-i,r,i];case 9:return[1-s,t-r,i,r];case 10:return[1-t,1-s,r,i];case 11:return[s-i,1-t,i,r];case 12:return[t-i*(u/c),s,i*(u/c),r*(c/u)];case 13:return[1-s-r*(c/u),t-i*(u/c),r*(c/u),i*(u/c)];case 14:return[1-t,1-s-r*(c/u),i*(u/c),r*(c/u)];case 15:return[s,1-t,r*(c/u),i*(u/c)];default:return[t,s,r,i]}},q(ne,"_currentDrawId",-1),q(ne,"_currentParent",null),x(ne,Qt,null),x(ne,Zc,null),x(ne,eu,null),x(ne,Da,NaN),x(ne,Oa,null),x(ne,Fa,null),x(ne,tu,NaN),q(ne,"_INNER_MARGIN",3);let mx=ne;var mi,Jt,Zt,ru,cf,On,fn,sr,iu,ou,au,uf,vb;class YW{constructor(e,t,s,r,i,o){x(this,uf);x(this,mi,new Float64Array(6));x(this,Jt,void 0);x(this,Zt,void 0);x(this,ru,void 0);x(this,cf,void 0);x(this,On,void 0);x(this,fn,"");x(this,sr,0);x(this,iu,new Oy);x(this,ou,void 0);x(this,au,void 0);_(this,ou,s),_(this,au,r),_(this,ru,i),_(this,cf,o),[e,t]=C(this,uf,vb).call(this,e,t);const a=_(this,Jt,[NaN,NaN,NaN,NaN,e,t]);_(this,On,[e,t]),_(this,Zt,[{line:a,points:l(this,On)}]),l(this,mi).set(a,0)}updateProperty(e,t){e==="stroke-width"&&_(this,cf,t)}isEmpty(){return!l(this,Zt)||l(this,Zt).length===0}isCancellable(){return l(this,On).length<=10}add(e,t){[e,t]=C(this,uf,vb).call(this,e,t);const[s,r,i,o]=l(this,mi).subarray(2,6),a=e-i,c=t-o;return Math.hypot(l(this,ou)*a,l(this,au)*c)<=2?null:(l(this,On).push(e,t),isNaN(s)?(l(this,mi).set([i,o,e,t],2),l(this,Jt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,mi)[0])&&l(this,Jt).splice(6,6),l(this,mi).set([s,r,i,o,e,t],0),l(this,Jt).push(...ee.createBezierPoints(s,r,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,On).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,r,i){_(this,ou,s),_(this,au,r),_(this,ru,i),[e,t]=C(this,uf,vb).call(this,e,t);const o=_(this,Jt,[NaN,NaN,NaN,NaN,e,t]);_(this,On,[e,t]);const a=l(this,Zt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,Zt).push({line:o,points:l(this,On)}),l(this,mi).set(o,0),_(this,sr,0),this.toSVGPath(),null}getLastElement(){return l(this,Zt).at(-1)}setLastElement(e){return l(this,Zt)?(l(this,Zt).push(e),_(this,Jt,e.line),_(this,On,e.points),_(this,sr,0),{path:{d:this.toSVGPath()}}):l(this,iu).setLastElement(e)}removeLastElement(){if(!l(this,Zt))return l(this,iu).removeLastElement();l(this,Zt).pop(),_(this,fn,"");for(let e=0,t=l(this,Zt).length;e<t;e++){const{line:s,points:r}=l(this,Zt)[e];_(this,Jt,s),_(this,On,r),_(this,sr,0),this.toSVGPath()}return{path:{d:l(this,fn)}}}toSVGPath(){const e=ee.svgRound(l(this,Jt)[4]),t=ee.svgRound(l(this,Jt)[5]);if(l(this,On).length===2)return _(this,fn,`${l(this,fn)} M ${e} ${t} Z`),l(this,fn);if(l(this,On).length<=6){const r=l(this,fn).lastIndexOf("M");_(this,fn,`${l(this,fn).slice(0,r)} M ${e} ${t}`),_(this,sr,6)}if(l(this,On).length===4){const r=ee.svgRound(l(this,Jt)[10]),i=ee.svgRound(l(this,Jt)[11]);return _(this,fn,`${l(this,fn)} L ${r} ${i}`),_(this,sr,12),l(this,fn)}const s=[];l(this,sr)===0&&(s.push(`M ${e} ${t}`),_(this,sr,6));for(let r=l(this,sr),i=l(this,Jt).length;r<i;r+=6){const[o,a,c,u,d,h]=l(this,Jt).slice(r,r+6).map(ee.svgRound);s.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}return _(this,fn,l(this,fn)+s.join(" ")),_(this,sr,l(this,Jt).length),l(this,fn)}getOutlines(e,t,s,r){const i=l(this,Zt).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),l(this,iu).build(l(this,Zt),e,t,s,l(this,ru),l(this,cf),r),_(this,mi,null),_(this,Jt,null),_(this,Zt,null),_(this,fn,null),l(this,iu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}mi=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,ru=new WeakMap,cf=new WeakMap,On=new WeakMap,fn=new WeakMap,sr=new WeakMap,iu=new WeakMap,ou=new WeakMap,au=new WeakMap,uf=new WeakSet,vb=function(e,t){return ee._normalizePoint(e,t,l(this,ou),l(this,au),l(this,ru))};var Fn,sy,ry,Ns,gi,yi,df,hf,lu,Nr,Pi,Yw,ZF,Qw,e3,Jw,t3;class Oy extends ee{constructor(){super(...arguments);x(this,Nr);x(this,Yw);x(this,Qw);x(this,Jw);x(this,Fn,void 0);x(this,sy,0);x(this,ry,void 0);x(this,Ns,void 0);x(this,gi,void 0);x(this,yi,void 0);x(this,df,void 0);x(this,hf,void 0);x(this,lu,void 0)}build(t,s,r,i,o,a,c){_(this,gi,s),_(this,yi,r),_(this,df,i),_(this,hf,o),_(this,lu,a),_(this,ry,c??0),_(this,Ns,t),C(this,Qw,e3).call(this)}get thickness(){return l(this,lu)}setLastElement(t){return l(this,Ns).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Ns).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Ns)){if(t.push(`M${ee.svgRound(s[4])} ${ee.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${ee.svgRound(s[10])} ${ee.svgRound(s[11])}`);continue}for(let r=6,i=s.length;r<i;r+=6){const[o,a,c,u,d,h]=s.subarray(r,r+6).map(ee.svgRound);t.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}}return t.join("")}serialize([t,s,r,i],o){const a=[],c=[],[u,d,h,p]=C(this,Yw,ZF).call(this);let m,y,g,w,v,b,S,E,k;switch(l(this,hf)){case 0:k=ee._rescale,m=t,y=s+i,g=r,w=-i,v=t+u*r,b=s+(1-d-p)*i,S=t+(u+h)*r,E=s+(1-d)*i;break;case 90:k=ee._rescaleAndSwap,m=t,y=s,g=r,w=i,v=t+d*r,b=s+u*i,S=t+(d+p)*r,E=s+(u+h)*i;break;case 180:k=ee._rescale,m=t+r,y=s,g=-r,w=i,v=t+(1-u-h)*r,b=s+d*i,S=t+(1-u)*r,E=s+(d+p)*i;break;case 270:k=ee._rescaleAndSwap,m=t+r,y=s+i,g=-r,w=-i,v=t+(1-d-p)*r,b=s+(1-u-h)*i,S=t+(1-d)*r,E=s+(1-u)*i;break}for(const{line:T,points:P}of l(this,Ns))a.push(k(T,m,y,g,w,o?new Array(T.length):null)),c.push(k(P,m,y,g,w,o?new Array(P.length):null));return{lines:a,points:c,rect:[v,b,S,E]}}static deserialize(t,s,r,i,o,{paths:{lines:a,points:c},rotation:u,thickness:d}){const h=[];let p,m,y,g,w;switch(u){case 0:w=ee._rescale,p=-t/r,m=s/i+1,y=1/r,g=-1/i;break;case 90:w=ee._rescaleAndSwap,p=-s/i,m=-t/r,y=1/i,g=1/r;break;case 180:w=ee._rescale,p=t/r+1,m=-s/i,y=-1/r,g=1/i;break;case 270:w=ee._rescaleAndSwap,p=s/i+1,m=t/r+1,y=-1/i,g=-1/r;break}if(!a){a=[];for(const b of c){const S=b.length;if(S===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(S===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const E=new Float32Array(3*(S-2));a.push(E);let[k,T,P,N]=b.subarray(0,4);E.set([NaN,NaN,NaN,NaN,k,T],0);for(let M=4;M<S;M+=2){const L=b[M],O=b[M+1];E.set(ee.createBezierPoints(k,T,P,N,L,O),(M-2)*3),[k,T,P,N]=[P,N,L,O]}}}for(let b=0,S=a.length;b<S;b++)h.push({line:w(a[b].map(E=>E??NaN),p,m,y,g),points:w(c[b].map(E=>E??NaN),p,m,y,g)});const v=new this.prototype.constructor;return v.build(h,r,i,1,u,d,o),v}get box(){return l(this,Fn)}updateProperty(t,s){return t==="stroke-width"?C(this,Jw,t3).call(this,s):null}updateParentDimensions([t,s],r){const[i,o]=C(this,Nr,Pi).call(this);_(this,gi,t),_(this,yi,s),_(this,df,r);const[a,c]=C(this,Nr,Pi).call(this),u=a-i,d=c-o,h=l(this,Fn);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h}updateRotation(t){return _(this,sy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,Fn).map(ee.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,Fn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,Fn);let r=0,i=0,o=0,a=0,c=0,u=0;switch(l(this,sy)){case 90:i=s/t,o=-t/s,c=t;break;case 180:r=-1,a=-1,c=t,u=s;break;case 270:i=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${r} ${i} ${o} ${a} ${ee.svgRound(c)} ${ee.svgRound(u)})`}getPathResizingSVGProperties([t,s,r,i]){const[o,a]=C(this,Nr,Pi).call(this),[c,u,d,h]=l(this,Fn);if(Math.abs(d-o)<=ee.PRECISION||Math.abs(h-a)<=ee.PRECISION){const w=t+r/2-(c+d/2),v=s+i/2-(u+h/2);return{path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:`${this.rotationTransform} translate(${w} ${v})`}}}const p=(r-2*o)/(d-2*o),m=(i-2*a)/(h-2*a),y=d/r,g=h/i;return{path:{"transform-origin":`${ee.svgRound(c)} ${ee.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${g}) translate(${ee.svgRound(o)} ${ee.svgRound(a)}) scale(${p} ${m}) translate(${ee.svgRound(-o)} ${ee.svgRound(-a)})`}}}getPathResizedSVGProperties([t,s,r,i]){const[o,a]=C(this,Nr,Pi).call(this),c=l(this,Fn),[u,d,h,p]=c;if(c[0]=t,c[1]=s,c[2]=r,c[3]=i,Math.abs(h-o)<=ee.PRECISION||Math.abs(p-a)<=ee.PRECISION){const v=t+r/2-(u+h/2),b=s+i/2-(d+p/2);for(const{line:S,points:E}of l(this,Ns))ee._translate(S,v,b,S),ee._translate(E,v,b,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*o)/(h-2*o),y=(i-2*a)/(p-2*a),g=-m*(u+o)+t+o,w=-y*(d+a)+s+a;if(m!==1||y!==1||g!==0||w!==0)for(const{line:v,points:b}of l(this,Ns))ee._rescale(v,g,w,m,y,v),ee._rescale(b,g,w,m,y,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],r){const[i,o]=r,a=l(this,Fn),c=t-a[0],u=s-a[1];if(l(this,gi)===i&&l(this,yi)===o)for(const{line:d,points:h}of l(this,Ns))ee._translate(d,c,u,d),ee._translate(h,c,u,h);else{const d=l(this,gi)/i,h=l(this,yi)/o;_(this,gi,i),_(this,yi,o);for(const{line:p,points:m}of l(this,Ns))ee._rescale(p,c,u,d,h,p),ee._rescale(m,c,u,d,h,m);a[2]*=d,a[3]*=h}return a[0]=t,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,Fn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ee.svgRound(t[0])} ${ee.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Fn=new WeakMap,sy=new WeakMap,ry=new WeakMap,Ns=new WeakMap,gi=new WeakMap,yi=new WeakMap,df=new WeakMap,hf=new WeakMap,lu=new WeakMap,Nr=new WeakSet,Pi=function(t=l(this,lu)){const s=l(this,ry)+t/2*l(this,df);return l(this,hf)%180===0?[s/l(this,gi),s/l(this,yi)]:[s/l(this,yi),s/l(this,gi)]},Yw=new WeakSet,ZF=function(){const[t,s,r,i]=l(this,Fn),[o,a]=C(this,Nr,Pi).call(this,0);return[t+o,s+a,r-2*o,i-2*a]},Qw=new WeakSet,e3=function(){const t=_(this,Fn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of l(this,Ns)){if(i.length<=12){for(let c=4,u=i.length;c<u;c+=6)Z.pointBoundingBox(i[c],i[c+1],t);continue}let o=i[4],a=i[5];for(let c=6,u=i.length;c<u;c+=6){const[d,h,p,m,y,g]=i.subarray(c,c+6);Z.bezierBoundingBox(o,a,d,h,p,m,y,g,t),o=y,a=g}}const[s,r]=C(this,Nr,Pi).call(this);t[0]=Tn(t[0]-s,0,1),t[1]=Tn(t[1]-r,0,1),t[2]=Tn(t[2]+s,0,1),t[3]=Tn(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},Jw=new WeakSet,t3=function(t){const[s,r]=C(this,Nr,Pi).call(this);_(this,lu,t);const[i,o]=C(this,Nr,Pi).call(this),[a,c]=[i-s,o-r],u=l(this,Fn);return u[0]-=a,u[1]-=c,u[2]+=2*a,u[3]+=2*c,u};class Q1 extends QF{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Q1(this._viewParameters);return e.updateAll(this),e}}var Zw,n3;const md=class md extends mx{constructor(t){super({...t,name:"inkEditor"});x(this,Zw);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){rt.initialize(t,s),this._defaultDrawingOptions=new Q1(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return be(this,"typesMap",new Map([[Te.INK_THICKNESS,"stroke-width"],[Te.INK_COLOR,"stroke"],[Te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,r,i,o){return new YW(t,s,r,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,r,i,o,a){return Oy.deserialize(t,s,r,i,o,a)}static async deserialize(t,s,r){let i=null;if(t instanceof yT){const{data:{inkLists:a,rect:c,rotation:u,id:d,color:h,opacity:p,borderStyle:{rawWidth:m},popupRef:y,richText:g,contentsObj:w,creationDate:v,modificationDate:b},parent:{page:{pageNumber:S}}}=t;i=t={annotationType:fe.INK,color:Array.from(h),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:S-1,rect:c.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:y,richText:g,comment:(w==null?void 0:w.str)||null,creationDate:v,modificationDate:b}}const o=await super.deserialize(t,s,r);return o._initialData=i,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new hx(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:r}=this;s.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:r}){this._drawingOptions=md.getDefaultDrawingOptions({stroke:Z.makeHexColor(...t),"stroke-width":s,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:r}=this.serializeDraw(t),{_drawingOptions:{stroke:i,"stroke-opacity":o,"stroke-width":a}}=this,c=Object.assign(super.serialize(t),{color:rt._colorManager.convert(i),opacity:o,thickness:a,paths:{lines:s,points:r}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!C(this,Zw,n3).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};Zw=new WeakSet,n3=function(t){const{color:s,thickness:r,opacity:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,c)=>a!==s[c])||t.thickness!==r||t.opacity!==i||t.pageIndex!==o},q(md,"_type","ink"),q(md,"_editorType",fe.INK),q(md,"_defaultDrawingOptions",null);let tC=md;class nC extends Oy{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const kv=8,mp=3;var cu,iy,sC,Rr,e1,s3,t1,r3,oy,rC,ff,bb,n1,i3,s1,o3,r1,a3,ay,iC,ly,oC,i1,l3;class Dt{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:r},i,o,a,c){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const h=200,p=d.font=`${s} ${r} ${h}px ${t}`,{actualBoundingBoxLeft:m,actualBoundingBoxRight:y,actualBoundingBoxAscent:g,actualBoundingBoxDescent:w,fontBoundingBoxAscent:v,fontBoundingBoxDescent:b,width:S}=d.measureText(e),E=1.5,k=Math.ceil(Math.max(Math.abs(m)+Math.abs(y)||0,S)*E),T=Math.ceil(Math.max(Math.abs(g)+Math.abs(w)||h,Math.abs(v)+Math.abs(b)||h)*E);u=new OffscreenCanvas(k,T),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,k,T),d.fillStyle="black",d.fillText(e,k*(E-1)/2,T*(3-E)/2);const P=C(this,ay,iC).call(this,d.getImageData(0,0,k,T).data),N=C(this,r1,a3).call(this,P),M=C(this,ly,oC).call(this,N),L=C(this,oy,rC).call(this,P,k,T,M);return this.processDrawnLines({lines:{curves:L,width:k,height:T},pageWidth:i,pageHeight:o,rotation:a,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,r,i){const[o,a,c]=C(this,i1,l3).call(this,e),[u,d]=C(this,s1,o3).call(this,o,a,c,Math.hypot(a,c)*l(this,cu).sigmaSFactor,l(this,cu).sigmaR,l(this,cu).kernelSize),h=C(this,ly,oC).call(this,d),p=C(this,oy,rC).call(this,u,a,c,h);return this.processDrawnLines({lines:{curves:p,width:a,height:c},pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:o,areContours:a}){r%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:d}=e,h=e.thickness??0,p=[],m=Math.min(t/u,s/d),y=m/t,g=m/s,w=[];for(const{points:b}of c){const S=o?C(this,n1,i3).call(this,b):b;if(!S)continue;w.push(S);const E=S.length,k=new Float32Array(E),T=new Float32Array(3*(E===2?2:E-2));if(p.push({line:T,points:k}),E===2){k[0]=S[0]*y,k[1]=S[1]*g,T.set([NaN,NaN,NaN,NaN,k[0],k[1]],0);continue}let[P,N,M,L]=S;P*=y,N*=g,M*=y,L*=g,k.set([P,N,M,L],0),T.set([NaN,NaN,NaN,NaN,P,N],0);for(let O=4;O<E;O+=2){const D=k[O]=S[O]*y,V=k[O+1]=S[O+1]*g;T.set(ee.createBezierPoints(P,N,M,L,D,V),(O-2)*3),[P,N,M,L]=[M,L,D,V]}}if(p.length===0)return null;const v=a?new nC:new Oy;return v.build(p,t,s,1,r,a?0:h,i),{outline:v,newCurves:w,areContours:a,thickness:h,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:r,height:i}){let o=1/0,a=-1/0,c=0;for(const S of e){c+=S.length;for(let E=2,k=S.length;E<k;E++){const T=S[E]-S[E-2];o=Math.min(o,T),a=Math.max(a,T)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const d=e.length,h=kv+mp*d,p=new Uint32Array(h);let m=0;p[m++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*u.BYTES_PER_ELEMENT,p[m++]=0,p[m++]=r,p[m++]=i,p[m++]=t?0:1,p[m++]=Math.max(0,Math.floor(s??0)),p[m++]=d,p[m++]=u.BYTES_PER_ELEMENT;for(const S of e)p[m++]=S.length-2,p[m++]=S[0],p[m++]=S[1];const y=new CompressionStream("deflate-raw"),g=y.writable.getWriter();await g.ready,g.write(p);const w=u.prototype.constructor;for(const S of e){const E=new w(S.length-2);for(let k=2,T=S.length;k<T;k++)E[k-2]=S[k]-S[k-2];g.write(E)}g.close();const v=await new Response(y.readable).arrayBuffer(),b=new Uint8Array(v);return iO(b)}static async decompressSignature(e){try{const t=wq(e),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,a=0;for await(const S of s)o||(o=new Uint8Array(new Uint32Array(S.buffer,0,4)[0])),o.set(S,a),a+=S.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=c[2],h=c[3],p=c[4]===0,m=c[5],y=c[6],g=c[7],w=[],v=(kv+mp*y)*Uint32Array.BYTES_PER_ELEMENT;let b;switch(g){case Int8Array.BYTES_PER_ELEMENT:b=new Int8Array(o.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:b=new Int16Array(o.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:b=new Int32Array(o.buffer,v);break}a=0;for(let S=0;S<y;S++){const E=c[mp*S+kv],k=new Float32Array(E+2);w.push(k);for(let T=0;T<mp-1;T++)k[T]=c[mp*S+kv+T+1];for(let T=0;T<E;T++)k[T+2]=k[T]+b[a++]}return{areContours:p,thickness:m,outlines:w,width:d,height:h}}catch(t){return pe(`decompressSignature: ${t}`),null}}}cu=new WeakMap,iy=new WeakSet,sC=function(e,t,s,r){return s-=e,r-=t,s===0?r>0?0:4:s===1?r+6:2-r},Rr=new WeakMap,e1=new WeakSet,s3=function(e,t,s,r,i,o,a){const c=C(this,iy,sC).call(this,s,r,i,o);for(let u=0;u<8;u++){const d=(-u+c-a+16)%8,h=l(this,Rr)[2*d],p=l(this,Rr)[2*d+1];if(e[(s+h)*t+(r+p)]!==0)return d}return-1},t1=new WeakSet,r3=function(e,t,s,r,i,o,a){const c=C(this,iy,sC).call(this,s,r,i,o);for(let u=0;u<8;u++){const d=(u+c+a+16)%8,h=l(this,Rr)[2*d],p=l(this,Rr)[2*d+1];if(e[(s+h)*t+(r+p)]!==0)return d}return-1},oy=new WeakSet,rC=function(e,t,s,r){const i=e.length,o=new Int32Array(i);for(let d=0;d<i;d++)o[d]=e[d]<=r?1:0;for(let d=1;d<s-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*s-1-d]=0;let a=1,c;const u=[];for(let d=1;d<s-1;d++){c=1;for(let h=1;h<t-1;h++){const p=d*t+h,m=o[p];if(m===0)continue;let y=d,g=h;if(m===1&&o[p-1]===0)a+=1,g-=1;else if(m>=1&&o[p+1]===0)a+=1,g+=1,m>1&&(c=m);else{m!==1&&(c=Math.abs(m));continue}const w=[h,d],v=g===h+1,b={isHole:v,points:w,id:a,parent:0};u.push(b);let S;for(const O of u)if(O.id===c){S=O;break}S?S.isHole?b.parent=v?S.parent:c:b.parent=v?c:S.parent:b.parent=v?c:0;const E=C(this,e1,s3).call(this,o,t,d,h,y,g,0);if(E===-1){o[p]=-a,o[p]!==1&&(c=Math.abs(o[p]));continue}let k=l(this,Rr)[2*E],T=l(this,Rr)[2*E+1];const P=d+k,N=h+T;y=P,g=N;let M=d,L=h;for(;;){const O=C(this,t1,r3).call(this,o,t,M,L,y,g,1);k=l(this,Rr)[2*O],T=l(this,Rr)[2*O+1];const D=M+k,V=L+T;w.push(V,D);const I=M*t+L;if(o[I+1]===0?o[I]=-a:o[I]===1&&(o[I]=a),D===d&&V===h&&M===P&&L===N){o[p]!==1&&(c=Math.abs(o[p]));break}else y=M,g=L,M=D,L=V}}}return u},ff=new WeakSet,bb=function(e,t,s,r){if(s-t<=4){for(let P=t;P<s-2;P+=2)r.push(e[P],e[P+1]);return}const i=e[t],o=e[t+1],a=e[s-4]-i,c=e[s-3]-o,u=Math.hypot(a,c),d=a/u,h=c/u,p=d*o-h*i,m=c/a,y=1/u,g=Math.atan(m),w=Math.cos(g),v=Math.sin(g),b=y*(Math.abs(w)+Math.abs(v)),S=y*(1-b+b**2),E=Math.max(Math.atan(Math.abs(v+w)*S),Math.atan(Math.abs(v-w)*S));let k=0,T=t;for(let P=t+2;P<s-2;P+=2){const N=Math.abs(p-d*e[P+1]+h*e[P]);N>k&&(T=P,k=N)}k>(u*E)**2?(C(this,ff,bb).call(this,e,t,T+2,r),C(this,ff,bb).call(this,e,T,s,r)):r.push(i,o)},n1=new WeakSet,i3=function(e){const t=[],s=e.length;return C(this,ff,bb).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},s1=new WeakSet,o3=function(e,t,s,r,i,o){const a=new Float32Array(o**2),c=-2*r**2,u=o>>1;for(let g=0;g<o;g++){const w=(g-u)**2;for(let v=0;v<o;v++)a[g*o+v]=Math.exp((w+(v-u)**2)/c)}const d=new Float32Array(256),h=-2*i**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/h);const p=e.length,m=new Uint8Array(p),y=new Uint32Array(256);for(let g=0;g<s;g++)for(let w=0;w<t;w++){const v=g*t+w,b=e[v];let S=0,E=0;for(let T=0;T<o;T++){const P=g+T-u;if(!(P<0||P>=s))for(let N=0;N<o;N++){const M=w+N-u;if(M<0||M>=t)continue;const L=e[P*t+M],O=a[T*o+N]*d[Math.abs(L-b)];S+=L*O,E+=O}}const k=m[v]=Math.round(S/E);y[k]++}return[m,y]},r1=new WeakSet,a3=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},ay=new WeakSet,iC=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let r=-1/0,i=1/0;for(let a=0,c=s.length;a<c;a++){const u=s[a]=e[a<<2];r=Math.max(r,u),i=Math.min(i,u)}const o=255/(r-i);for(let a=0,c=s.length;a<c;a++)s[a]=(s[a]-i)*o;return s},ly=new WeakSet,oC=function(e){let t,s=-1/0,r=-1/0;const i=e.findIndex(c=>c!==0);let o=i,a=i;for(t=i;t<256;t++){const c=e[t];c>s&&(t-o>r&&(r=t-o,a=t-1),s=c,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},i1=new WeakSet,l3=function(e){const t=e,{width:s,height:r}=e,{maxDim:i}=l(this,cu);let o=s,a=r;if(s>i||r>i){let p=s,m=r,y=Math.log2(Math.max(s,r)/i);const g=Math.floor(y);y=y===g?g-1:g;for(let v=0;v<y;v++){o=Math.ceil(p/2),a=Math.ceil(m/2);const b=new OffscreenCanvas(o,a);b.getContext("2d").drawImage(e,0,0,p,m,0,0,o,a),p=o,m=a,e!==t&&e.close(),e=b.transferToImageBitmap()}const w=Math.min(i/o,i/a);o=Math.round(o*w),a=Math.round(a*w)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,o,a),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=u.getImageData(0,0,o,a).data;return[C(this,ay,iC).call(this,d),o,a]},x(Dt,iy),x(Dt,e1),x(Dt,t1),x(Dt,oy),x(Dt,ff),x(Dt,n1),x(Dt,s1),x(Dt,r1),x(Dt,ay),x(Dt,ly),x(Dt,i1),x(Dt,cu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),x(Dt,Rr,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class bT extends QF{constructor(){super(),super.updateProperties({fill:rt._defaultLineColor,"stroke-width":0})}clone(){const e=new bT;return e.updateAll(this),e}}class xT extends Q1{constructor(e){super(e),super.updateProperties({stroke:rt._defaultLineColor,"stroke-width":1})}clone(){const e=new xT(this._viewParameters);return e.updateAll(this),e}}var $a,vi,za,uu;const fs=class fs extends mx{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});x(this,$a,!1);x(this,vi,null);x(this,za,null);x(this,uu,null);this._willKeepAspectRatio=!0,_(this,za,t.signatureData||null),_(this,vi,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){rt.initialize(t,s),this._defaultDrawingOptions=new bT,this._defaultDrawnSignatureOptions=new xT(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return be(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,vi)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(l(this,za)){const{lines:i,mustSmooth:o,areContours:a,description:c,uuid:u,heightInPage:d}=l(this,za),{rawDims:{pageWidth:h,pageHeight:p},rotation:m}=this.parent.viewport,y=Dt.processDrawnLines({lines:i,pageWidth:h,pageHeight:p,rotation:m,innerMargin:fs._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(y,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:l(this,vi)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){_(this,uu,t),this.addEditToolbar()}getUuid(){return l(this,uu)}get description(){return l(this,vi)}set description(t){_(this,vi,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:r,width:i,height:o}=l(this,za),a=Math.max(i,o),c=Dt.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:r,width:i,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,r,i){const{x:o,y:a}=this,{outline:c}=_(this,za,t);_(this,$a,c instanceof nC),this.description=r;let u;l(this,$a)?u=fs.getDefaultDrawingOptions():(u=fs._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,d]=this.pageDimensions;let h=s/d;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return Dt.process(t,s,r,i,fs._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:r,pageHeight:i},rotation:o}=this.parent.viewport;return Dt.extractContoursFromText(t,s,r,i,o,fs._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return Dt.processDrawnLines({lines:t,pageWidth:s,pageHeight:r,rotation:i,innerMargin:fs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=fs.getDefaultDrawingOptions():(this._drawingOptions=fs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":i}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:l(this,$a),color:[0,0,0],thickness:l(this,$a)?0:i});return this.addComment(o),t?(o.paths={lines:s,points:r},o.uuid=l(this,uu),o.isCopy=!0):o.lines=s,l(this,vi)&&(o.accessibilityData={type:"Figure",alt:l(this,vi)}),o}static deserializeDraw(t,s,r,i,o,a){return a.areContours?nC.deserialize(t,s,r,i,o,a):Oy.deserialize(t,s,r,i,o,a)}static async deserialize(t,s,r){var o;const i=await super.deserialize(t,s,r);return _(i,$a,t.areContours),i.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",_(i,uu,t.uuid),i}};$a=new WeakMap,vi=new WeakMap,za=new WeakMap,uu=new WeakMap,q(fs,"_type","signature"),q(fs,"_editorType",fe.SIGNATURE),q(fs,"_defaultDrawingOptions",null);let aC=fs;var dt,en,Va,po,Ua,pf,mo,du,bi,Rs,mf,hu,Up,fu,Hp,gf,xb,yf,wb,vf,Sb,cy,cC,bf,_b,o1,c3;class lC extends rt{constructor(t){super({...t,name:"stampEditor"});x(this,hu);x(this,fu);x(this,gf);x(this,yf);x(this,vf);x(this,cy);x(this,bf);x(this,o1);x(this,dt,null);x(this,en,null);x(this,Va,null);x(this,po,null);x(this,Ua,null);x(this,pf,"");x(this,mo,null);x(this,du,!1);x(this,bi,null);x(this,Rs,!1);x(this,mf,!1);_(this,po,t.bitmapUrl),_(this,Ua,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){rt.initialize(t,s)}static isHandlingMimeForPasting(t){return ax.includes(t)}static paste(t,s){s.pasteEditor({mode:fe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,c=await r.guess({name:"altText",request:{data:i,width:o,height:a,channels:i.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,en)&&(_(this,dt,null),this._uiManager.imageManager.deleteId(l(this,en)),(t=l(this,mo))==null||t.remove(),_(this,mo,null),l(this,bi)&&(clearTimeout(l(this,bi)),_(this,bi,null))),super.remove()}rebuild(){if(!this.parent){l(this,en)&&C(this,gf,xb).call(this);return}super.rebuild(),this.div!==null&&(l(this,en)&&l(this,mo)===null&&C(this,gf,xb).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,Va)||l(this,dt)||l(this,po)||l(this,Ua)||l(this,en)||l(this,du))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),l(this,du)||(l(this,dt)?C(this,yf,wb).call(this):C(this,gf,xb).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(_(this,en,r),i&&_(this,dt,i),_(this,du,!1),C(this,yf,wb).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,bi)!==null&&clearTimeout(l(this,bi)),_(this,bi,setTimeout(()=>{_(this,bi,null),C(this,cy,cC).call(this)},200))}copyCanvas(t,s,r=!1){t||(t=224);const{width:i,height:o}=l(this,dt),a=new $r;let c=l(this,dt),u=i,d=o,h=null;if(s){if(i>s||o>s){const P=Math.min(s/i,s/o);u=Math.floor(i*P),d=Math.floor(o*P)}h=document.createElement("canvas");const m=h.width=Math.ceil(u*a.sx),y=h.height=Math.ceil(d*a.sy);l(this,Rs)||(c=C(this,vf,Sb).call(this,m,y));const g=h.getContext("2d");g.filter=this._uiManager.hcmFilter;let w="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":Aq.isDarkMode&&(w="#8f8f9d",v="#42414d");const b=15,S=b*a.sx,E=b*a.sy,k=new OffscreenCanvas(S*2,E*2),T=k.getContext("2d");T.fillStyle=w,T.fillRect(0,0,S*2,E*2),T.fillStyle=v,T.fillRect(0,0,S,E),T.fillRect(S,E,S,E),g.fillStyle=g.createPattern(k,"repeat"),g.fillRect(0,0,m,y),g.drawImage(c,0,0,c.width,c.height,0,0,m,y)}let p=null;if(r){let m,y;if(a.symmetric&&c.width<t&&c.height<t)m=c.width,y=c.height;else if(c=l(this,dt),i>t||o>t){const v=Math.min(t/i,t/o);m=Math.floor(i*v),y=Math.floor(o*v),l(this,Rs)||(c=C(this,vf,Sb).call(this,m,y))}const w=new OffscreenCanvas(m,y).getContext("2d",{willReadFrequently:!0});w.drawImage(c,0,0,c.width,c.height,0,0,m,y),p={width:m,height:y,data:w.getImageData(0,0,m,y).data}}return{canvas:h,width:u,height:d,imageData:p}}static async deserialize(t,s,r){var w;let i=null,o=!1;if(t instanceof EF){const{data:{rect:v,rotation:b,id:S,structParent:E,popupRef:k,richText:T,contentsObj:P,creationDate:N,modificationDate:M},container:L,parent:{page:{pageNumber:O}},canvas:D}=t;let V,I;D?(delete t.canvas,{id:V,bitmap:I}=r.imageManager.getFromCanvas(L.id,D),D.remove()):(o=!0,t._hasNoCanvas=!0);const R=((w=await s._structTree.getAriaAttributes(`${aT}${S}`))==null?void 0:w.get("aria-label"))||"";i=t={annotationType:fe.STAMP,bitmapId:V,bitmap:I,pageIndex:O-1,rect:v.slice(0),rotation:b,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:E,popupRef:k,richText:T,comment:(P==null?void 0:P.str)||null,creationDate:N,modificationDate:M}}const a=await super.deserialize(t,s,r),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:p,accessibilityData:m}=t;o?(r.addMissingCanvas(t.id,a),_(a,du,!0)):h&&r.imageManager.isValidId(h)?(_(a,en,h),u&&_(a,dt,u)):_(a,po,d),_(a,Rs,p);const[y,g]=a.pageDimensions;return a.width=(c[2]-c[0])/y,a.height=(c[3]-c[1])/g,m&&(a.altTextData=m),a._initialData=i,t.comment&&a.setCommentData(t),_(a,mf,!!i),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Object.assign(super.serialize(t),{bitmapId:l(this,en),isSvg:l(this,Rs)});if(this.addComment(r),t)return r.bitmapUrl=C(this,bf,_b).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(r.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=C(this,o1,c3).call(this,r);return c.isSame?null:(c.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1,r.id=this.annotationElementId,delete r.bitmapId,r)}if(s===null)return r;s.stamps||(s.stamps=new Map);const a=l(this,Rs)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!s.stamps.has(l(this,en)))s.stamps.set(l(this,en),{area:a,serialized:r}),r.bitmap=C(this,bf,_b).call(this,!1);else if(l(this,Rs)){const c=s.stamps.get(l(this,en));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=C(this,bf,_b).call(this,!1))}return r}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}dt=new WeakMap,en=new WeakMap,Va=new WeakMap,po=new WeakMap,Ua=new WeakMap,pf=new WeakMap,mo=new WeakMap,du=new WeakMap,bi=new WeakMap,Rs=new WeakMap,mf=new WeakMap,hu=new WeakSet,Up=function(t,s=!1){if(!t){this.remove();return}_(this,dt,t.bitmap),s||(_(this,en,t.id),_(this,Rs,t.isSvg)),t.file&&_(this,pf,t.file.name),C(this,yf,wb).call(this)},fu=new WeakSet,Hp=function(){if(_(this,Va,null),this._uiManager.enableWaiting(!1),!!l(this,mo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,dt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,dt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},gf=new WeakSet,xb=function(){if(l(this,en)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,en)).then(r=>C(this,hu,Up).call(this,r,!0)).finally(()=>C(this,fu,Hp).call(this));return}if(l(this,po)){const r=l(this,po);_(this,po,null),this._uiManager.enableWaiting(!0),_(this,Va,this._uiManager.imageManager.getFromUrl(r).then(i=>C(this,hu,Up).call(this,i)).finally(()=>C(this,fu,Hp).call(this)));return}if(l(this,Ua)){const r=l(this,Ua);_(this,Ua,null),this._uiManager.enableWaiting(!0),_(this,Va,this._uiManager.imageManager.getFromFile(r).then(i=>C(this,hu,Up).call(this,i)).finally(()=>C(this,fu,Hp).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=ax.join(",");const s=this._uiManager._signal;_(this,Va,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),C(this,hu,Up).call(this,i)}r()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:s})}).finally(()=>C(this,fu,Hp).call(this))),t.click()},yf=new WeakSet,wb=function(){var u;const{div:t}=this;let{width:s,height:r}=l(this,dt);const[i,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*i,r=this.height*o;else if(s>a*i||r>a*o){const d=Math.min(a*i/s,a*o/r);s*=d,r*=d}this._uiManager.enableWaiting(!1);const c=_(this,mo,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=s/i,this.height=r/o,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),C(this,cy,cC).call(this),l(this,mf)||(this.parent.addUndoableEditor(this),_(this,mf,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,pf)&&this.div.setAttribute("aria-description",l(this,pf)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},vf=new WeakSet,Sb=function(t,s){const{width:r,height:i}=l(this,dt);let o=r,a=i,c=l(this,dt);for(;o>2*t||a>2*s;){const u=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(o,a);h.getContext("2d").drawImage(c,0,0,u,d,0,0,o,a),c=h.transferToImageBitmap()}return c},cy=new WeakSet,cC=function(){const[t,s]=this.parentDimensions,{width:r,height:i}=this,o=new $r,a=Math.ceil(r*t*o.sx),c=Math.ceil(i*s*o.sy),u=l(this,mo);if(!u||u.width===a&&u.height===c)return;u.width=a,u.height=c;const d=l(this,Rs)?l(this,dt):C(this,vf,Sb).call(this,a,c),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,a,c)},bf=new WeakSet,_b=function(t){if(t){if(l(this,Rs)){const i=this._uiManager.imageManager.getSvgUrl(l(this,en));if(i)return i}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,dt),s.getContext("2d").drawImage(l(this,dt),0,0),s.toDataURL()}if(l(this,Rs)){const[s,r]=this.pageDimensions,i=Math.round(this.width*s*Lo.PDF_TO_CSS_UNITS),o=Math.round(this.height*r*Lo.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,o);return a.getContext("2d").drawImage(l(this,dt),0,0,l(this,dt).width,l(this,dt).height,0,0,i,o),a.transferToImageBitmap()}return structuredClone(l(this,dt))},o1=new WeakSet,c3=function(t){var a;const{pageIndex:s,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===s,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}},q(lC,"_type","stamp"),q(lC,"_editorType",fe.STAMP);var pu,xf,Ha,Ga,go,ss,qa,wf,Sf,jr,yo,tn,vo,Wa,_f,ie,Ka,uy,uC,a1,u3,rr,Wr,dy,dC,hy,hC,Af,Ab;const vr=class vr{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:r,accessibilityManager:i,annotationLayer:o,drawLayer:a,textLayer:c,viewport:u,l10n:d}){x(this,uy);x(this,a1);x(this,rr);x(this,dy);x(this,hy);x(this,Af);x(this,pu,void 0);x(this,xf,!1);x(this,Ha,null);x(this,Ga,null);x(this,go,null);x(this,ss,new Map);x(this,qa,!1);x(this,wf,!1);x(this,Sf,!1);x(this,jr,null);x(this,yo,null);x(this,tn,null);x(this,vo,null);x(this,Wa,null);x(this,_f,-1);x(this,ie,void 0);const h=[...l(vr,Ka).values()];if(!vr._initialized){vr._initialized=!0;for(const p of h)p.initialize(d,e)}e.registerEditorTypes(h),_(this,ie,e),this.pageIndex=t,this.div=s,_(this,pu,i),_(this,Ha,o),this.viewport=u,_(this,tn,c),this.drawLayer=a,this._structTree=r,l(this,ie).addLayer(this)}get isEmpty(){return l(this,ss).size===0}get isInvisible(){return this.isEmpty&&l(this,ie).getMode()===fe.NONE}updateToolbar(e){l(this,ie).updateToolbar(e)}updateMode(e=l(this,ie).getMode()){switch(C(this,Af,Ab).call(this),e){case fe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case fe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case fe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===fe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of l(vr,Ka).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,tn))==null?void 0:t.div)}setEditingState(e){l(this,ie).setEditingState(e)}addCommands(e){l(this,ie).addCommands(e)}cleanUndoStack(e){l(this,ie).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,Ha))==null||t.div.classList.toggle("disabled",!e)}async enable(){var s;_(this,Sf,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=l(this,Wa))==null||s.abort(),_(this,Wa,null);const e=new Set;for(const r of l(this,uy,uC))r.enableEditing(),r.show(!0),r.annotationElementId&&(l(this,ie).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));const t=l(this,Ha);if(t)for(const r of t.getEditableAnnotations()){if(r.hide(),l(this,ie).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}_(this,Sf,!1),l(this,ie)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var s;if(_(this,wf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),l(this,tn)&&!l(this,Wa)){_(this,Wa,new AbortController);const r=l(this,ie).combinedSignal(l(this,Wa));l(this,tn).div.addEventListener("pointerdown",i=>{const{clientX:a,clientY:c,timeStamp:u}=i,d=l(this,_f);if(u-d>500){_(this,_f,u);return}_(this,_f,-1);const{classList:h}=this.div;h.toggle("getElements",!0);const p=document.elementsFromPoint(a,c);if(h.toggle("getElements",!1),!this.div.contains(p[0]))return;let m;const y=new RegExp(`^${jm}[0-9]+$`);for(const w of p)if(y.test(w.id)){m=w.id;break}if(!m)return;const g=l(this,ss).get(m);(g==null?void 0:g.annotationElementId)===null&&(i.stopPropagation(),i.preventDefault(),g.dblclick(i))},{signal:r,capture:!0})}const e=l(this,Ha);if(e){const r=new Map,i=new Map;for(const a of l(this,uy,uC)){if(a.disableEditing(),!a.annotationElementId){a.updateFakeAnnotationElement(e);continue}if(a.serialize()!==null){r.set(a.annotationElementId,a);continue}else i.set(a.annotationElementId,a);(s=this.getEditableAnnotation(a.annotationElementId))==null||s.show(),a.remove()}const o=e.getEditableAnnotations();for(const a of o){const{id:c}=a.data;if(l(this,ie).isDeletedAnnotationElement(c)){a.updateEdited({deleted:!0});continue}let u=i.get(c);if(u){u.resetAnnotationElement(a),u.show(!1),a.show();continue}u=r.get(c),u&&(l(this,ie).addChangedExistingAnnotation(u),u.renderAnnotationElement(a)&&u.show(!1)),a.show()}}C(this,Af,Ab).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const r of l(vr,Ka).values())t.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),_(this,wf,!1)}getEditableAnnotation(e){var t;return((t=l(this,Ha))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,ie).getActive()!==e&&l(this,ie).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,tn))!=null&&e.div&&!l(this,vo)){_(this,vo,new AbortController);const t=l(this,ie).combinedSignal(l(this,vo));l(this,tn).div.addEventListener("pointerdown",C(this,a1,u3).bind(this),{signal:t}),l(this,tn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,tn))!=null&&e.div&&l(this,vo)&&(l(this,vo).abort(),_(this,vo,null),l(this,tn).div.classList.remove("highlighting"))}enableClick(){if(l(this,Ga))return;_(this,Ga,new AbortController);const e=l(this,ie).combinedSignal(l(this,Ga));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Ga))==null||e.abort(),_(this,Ga,null)}attach(e){l(this,ss).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,ie).isDeletedAnnotationElement(t)&&l(this,ie).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,ss).delete(e.id),(t=l(this,pu))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,wf)&&e.annotationElementId&&l(this,ie).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,ie).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,ie).addDeletedAnnotationElement(e.annotationElementId),rt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,ie).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,Sf)),l(this,ie).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,go)&&(e._focusEventsAllowed=!1,_(this,go,setTimeout(()=>{_(this,go,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,ie)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,pu))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of l(this,ss).values())if(t.uid===e)return t;return null}getNextId(){return l(this,ie).getId()}combinedSignal(e){return l(this,ie).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,rr,Wr))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await l(this,ie).updateMode(e.mode);const{offsetX:s,offsetY:r}=C(this,hy,hC).call(this),i=this.getNextId(),o=C(this,dy,dC).call(this,{parent:this,id:i,x:s,y:r,uiManager:l(this,ie),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=l(vr,Ka).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,ie)))||null}createAndAddNewEditor(e,t,s={}){const r=this.getNextId(),i=C(this,dy,dC).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:l(this,ie),isCentered:t,...s});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(C(this,hy,hC).call(this),!0,e)}setSelected(e){l(this,ie).setSelected(e)}toggleSelected(e){l(this,ie).toggleSelected(e)}unselect(e){l(this,ie).unselect(e)}pointerup(e){var r;const{isMac:t}=rn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!l(this,qa)||(_(this,qa,!1),(r=l(this,rr,Wr))!=null&&r.isDrawer&&l(this,rr,Wr).supportMultipleDrawings))return;if(!l(this,xf)){_(this,xf,!0);return}const s=l(this,ie).getMode();if(s===fe.STAMP||s===fe.SIGNATURE){l(this,ie).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(l(this,ie).getMode()===fe.HIGHLIGHT&&this.enableTextSelection(),l(this,qa)){_(this,qa,!1);return}const{isMac:t}=rn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(_(this,qa,!0),(r=l(this,rr,Wr))!=null&&r.isDrawer){this.startDrawingSession(e);return}const s=l(this,ie).getActive();_(this,xf,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),l(this,jr)){l(this,rr,Wr).startDrawing(this,l(this,ie),!1,e);return}l(this,ie).setCurrentDrawingSession(this),_(this,jr,new AbortController);const t=l(this,ie).combinedSignal(l(this,jr));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(_(this,yo,null),this.commitOrRemove())},{signal:t}),l(this,rr,Wr).startDrawing(this,l(this,ie),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&_(this,yo,t);return}l(this,yo)&&setTimeout(()=>{var t;(t=l(this,yo))==null||t.focus(),_(this,yo,null)},0)}endDrawingSession(e=!1){return l(this,jr)?(l(this,ie).setCurrentDrawingSession(null),l(this,jr).abort(),_(this,jr,null),_(this,yo,null),l(this,rr,Wr).endDrawing(e)):null}findNewParent(e,t,s){const r=l(this,ie).findParent(t,s);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return l(this,jr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,jr)&&l(this,rr,Wr).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,ie).getActive())==null?void 0:e.parent)===this&&(l(this,ie).commitOrRemove(),l(this,ie).setActiveEditor(null)),l(this,go)&&(clearTimeout(l(this,go)),_(this,go,null));for(const s of l(this,ss).values())(t=l(this,pu))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,ss).clear(),l(this,ie).removeLayer(this)}render({viewport:e}){this.viewport=e,dl(this.div,e);for(const t of l(this,ie).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,ie).commitOrRemove(),C(this,Af,Ab).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,dl(this.div,{rotation:s}),t!==s)for(const r of l(this,ss).values())r.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,ie).viewParameters.realScale}};pu=new WeakMap,xf=new WeakMap,Ha=new WeakMap,Ga=new WeakMap,go=new WeakMap,ss=new WeakMap,qa=new WeakMap,wf=new WeakMap,Sf=new WeakMap,jr=new WeakMap,yo=new WeakMap,tn=new WeakMap,vo=new WeakMap,Wa=new WeakMap,_f=new WeakMap,ie=new WeakMap,Ka=new WeakMap,uy=new WeakSet,uC=function(){return l(this,ss).size!==0?l(this,ss).values():l(this,ie).getEditors(this.pageIndex)},a1=new WeakSet,u3=function(e){l(this,ie).unselectAll();const{target:t}=e;if(t===l(this,tn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,tn).div.contains(t)){const{isMac:s}=rn.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,ie).showAllEditors("highlight",!0,!0),l(this,tn).div.classList.add("free"),this.toggleDrawing(),px.startHighlighting(this,l(this,ie).direction==="ltr",{target:l(this,tn).div,x:e.x,y:e.y}),l(this,tn).div.addEventListener("pointerup",()=>{l(this,tn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,ie)._signal}),e.preventDefault()}},rr=new WeakSet,Wr=function(){return l(vr,Ka).get(l(this,ie).getMode())},dy=new WeakSet,dC=function(e){const t=l(this,rr,Wr);return t?new t.prototype.constructor(e):null},hy=new WeakSet,hC=function(){const{x:e,y:t,width:s,height:r}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+r),u=(i+a)/2-e,d=(o+c)/2-t,[h,p]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:h,offsetY:p}},Af=new WeakSet,Ab=function(){for(const e of l(this,ss).values())e.isEmpty()&&e.remove()},q(vr,"_initialized",!1),x(vr,Ka,new Map([GE,tC,lC,px,aC].map(e=>[e._editorType,e])));let gx=vr;var Mr,Bn,mu,fy,l1,d3,py,fC,c1,h3,my,pC;const Vt=class Vt{constructor({pageIndex:e}){x(this,py);x(this,c1);x(this,my);x(this,Mr,null);x(this,Bn,new Map);x(this,mu,new Map);this.pageIndex=e}setParent(e){if(!l(this,Mr)){_(this,Mr,e);return}if(l(this,Mr)!==e){if(l(this,Bn).size>0)for(const t of l(this,Bn).values())t.remove(),e.append(t);_(this,Mr,e)}}static get _svgFactory(){return be(this,"_svgFactory",new Bm)}draw(e,t=!1,s=!1){const r=$t(Vt,fy)._++,i=C(this,py,fC).call(this),o=Vt._svgFactory.createElement("defs");i.append(o);const a=Vt._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,mu).set(r,a);const u=s?C(this,c1,h3).call(this,o,c):null,d=Vt._svgFactory.createElement("use");return i.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(i,e),l(this,Bn).set(r,i),{id:r,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=$t(Vt,fy)._++,r=C(this,py,fC).call(this),i=Vt._svgFactory.createElement("defs");r.append(i);const o=Vt._svgFactory.createElement("path");i.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=Vt._svgFactory.createElement("mask");i.append(h),c=`mask_p${this.pageIndex}_${s}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const p=Vt._svgFactory.createElement("rect");h.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=Vt._svgFactory.createElement("use");h.append(m),m.setAttribute("href",`#${a}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=Vt._svgFactory.createElement("use");r.append(u),u.setAttribute("href",`#${a}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return r.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(r,e),l(this,Bn).set(s,r),s}finalizeDraw(e,t){l(this,mu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:r,rootClass:i,path:o}=t,a=typeof e=="number"?l(this,Bn).get(e):e;if(a){if(s&&C(this,my,pC).call(this,a,s),r&&C(c=Vt,l1,d3).call(c,a,r),i){const{classList:u}=a;for(const[d,h]of Object.entries(i))u.toggle(d,h)}if(o){const d=a.firstChild.firstChild;C(this,my,pC).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const s=l(this,Bn).get(e);s&&(l(t,Mr).append(s),l(this,Bn).delete(e),l(t,Bn).set(e,s))}remove(e){l(this,mu).delete(e),l(this,Mr)!==null&&(l(this,Bn).get(e).remove(),l(this,Bn).delete(e))}destroy(){_(this,Mr,null);for(const e of l(this,Bn).values())e.remove();l(this,Bn).clear(),l(this,mu).clear()}};Mr=new WeakMap,Bn=new WeakMap,mu=new WeakMap,fy=new WeakMap,l1=new WeakSet,d3=function(e,[t,s,r,i]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*i}%`},py=new WeakSet,fC=function(){const e=Vt._svgFactory.create(1,1,!0);return l(this,Mr).append(e),e.setAttribute("aria-hidden",!0),e},c1=new WeakSet,h3=function(e,t){const s=Vt._svgFactory.createElement("clipPath");e.append(s);const r=`clip_${t}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const i=Vt._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r},my=new WeakSet,pC=function(e,t){for(const[s,r]of Object.entries(t))r===null?e.removeAttribute(s):e.setAttribute(s,r)},x(Vt,l1),x(Vt,fy,0);let yx=Vt;globalThis._pdfjsTestingUtils={HighlightOutliner:WE};globalThis.pdfjsLib={AbortException:Mo,AnnotationEditorLayer:gx,AnnotationEditorParamsType:Te,AnnotationEditorType:fe,AnnotationEditorUIManager:hl,AnnotationLayer:vT,AnnotationMode:wi,AnnotationType:Pt,applyOpacity:uO,build:fF,ColorPicker:Fm,createValidAbsoluteUrl:rT,CSSConstants:cO,DOMSVGFactory:Bm,DrawLayer:yx,FeatureTest:rn,fetchData:Hf,findContrastColor:dO,getDocument:fT,getFilenameFromUrl:oO,getPdfFilenameFromUrl:aO,getRGB:Gf,getUuid:oT,getXfaPageViewport:lO,GlobalWorkerOptions:ar,ImageKind:cm,InvalidPDFException:ox,isDataScheme:Ly,isPdfFile:X1,isValidExplicitDest:HO,MathClamp:Tn,noContextMenu:Bs,normalizeUnicode:rO,OPS:If,OutputScale:$r,PasswordResponses:nO,PDFDataRangeTransport:pT,PDFDateString:Im,PDFWorker:Df,PermissionFlag:tO,PixelsPerInch:Lo,RenderingCancelledException:K1,renderRichText:cT,ResponseException:Mm,setLayerDimensions:dl,shadow:be,SignatureExtractor:Dt,stopEvent:vt,SupportedImageMimeTypes:ax,TextLayer:Om,TouchManager:Dm,updateUrlHash:iT,Util:Z,VerbosityLevel:Ry,version:mT,XfaLayer:lT};const QW=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Mo,AnnotationEditorLayer:gx,AnnotationEditorParamsType:Te,AnnotationEditorType:fe,AnnotationEditorUIManager:hl,AnnotationLayer:vT,AnnotationMode:wi,AnnotationType:Pt,CSSConstants:cO,ColorPicker:Fm,DOMSVGFactory:Bm,DrawLayer:yx,FeatureTest:rn,GlobalWorkerOptions:ar,ImageKind:cm,InvalidPDFException:ox,MathClamp:Tn,OPS:If,OutputScale:$r,PDFDataRangeTransport:pT,PDFDateString:Im,PDFWorker:Df,PasswordResponses:nO,PermissionFlag:tO,PixelsPerInch:Lo,RenderingCancelledException:K1,ResponseException:Mm,SignatureExtractor:Dt,SupportedImageMimeTypes:ax,TextLayer:Om,TouchManager:Dm,Util:Z,VerbosityLevel:Ry,XfaLayer:lT,applyOpacity:uO,build:fF,createValidAbsoluteUrl:rT,fetchData:Hf,findContrastColor:dO,getDocument:fT,getFilenameFromUrl:oO,getPdfFilenameFromUrl:aO,getRGB:Gf,getUuid:oT,getXfaPageViewport:lO,isDataScheme:Ly,isPdfFile:X1,isValidExplicitDest:HO,noContextMenu:Bs,normalizeUnicode:rO,renderRichText:cT,setLayerDimensions:dl,shadow:be,stopEvent:vt,updateUrlHash:iT,version:mT},Symbol.toStringTag,{value:"Module"}));var MR=Object.prototype.hasOwnProperty;function LR(n,e,t){for(t of n.keys())if(_d(t,e))return t}function _d(n,e){var t,s,r;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&_d(n[s],e[s]););return s===-1}if(t===Set){if(n.size!==e.size)return!1;for(s of n)if(r=s,r&&typeof r=="object"&&(r=LR(e,r),!r)||!e.has(r))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(s of n)if(r=s[0],r&&typeof r=="object"&&(r=LR(e,r),!r)||!_d(s[1],e.get(r)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((s=n.byteLength)===e.byteLength)for(;s--&&n.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(n)){if((s=n.byteLength)===e.byteLength)for(;s--&&n[s]===e[s];);return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(MR.call(n,t)&&++s&&!MR.call(e,t)||!(t in e)||!_d(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}function Fy(n){let e=!1;return{promise:new Promise((s,r)=>{n.then(i=>!e&&s(i)).catch(i=>!e&&r(i))}),cancel(){e=!0}}}const JW=["onCopy","onCut","onPaste"],ZW=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],e9=["onFocus","onBlur"],t9=["onInput","onInvalid","onReset","onSubmit"],n9=["onLoad","onError"],s9=["onKeyDown","onKeyPress","onKeyUp"],r9=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],i9=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],o9=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],a9=["onSelect"],l9=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],c9=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],u9=["onScroll"],d9=["onWheel"],h9=["onAnimationStart","onAnimationEnd","onAnimationIteration"],f9=["onTransitionEnd"],p9=["onToggle"],m9=["onChange"],g9=[...JW,...ZW,...e9,...t9,...n9,...s9,...r9,...i9,...o9,...a9,...l9,...c9,...u9,...d9,...h9,...f9,...m9,...p9];function f3(n,e){const t={};for(const s of g9){const r=n[s];r&&(e?t[s]=i=>r(i,e(s)):t[s]=r)}return t}var y9=!0,l_="Invariant failed";function Qe(n,e){if(!n){if(y9)throw new Error(l_);var t=typeof e=="function"?e():e,s=t?"".concat(l_,": ").concat(t):l_;throw new Error(s)}}var v9=function(){},b9=v9;const Nn=u1(b9),x9=A.createContext(null),p3=x9,w9="noopener noreferrer nofollow";class S9{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Qe(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){Qe(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,s){e.href=t,e.rel=this.externalLinkRel||w9,e.target=s?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Qe(this.pdfDocument,"PDF document not loaded."),Qe(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Qe(Array.isArray(t),`"${t}" is not a valid destination array.`);const s=t[0];new Promise(r=>{Qe(this.pdfDocument,"PDF document not loaded."),s instanceof Object?this.pdfDocument.getPageIndex(s).then(i=>{r(i)}).catch(()=>{Qe(!1,`"${s}" is not a valid page reference.`)}):typeof s=="number"?r(s):Qe(!1,`"${s}" is not a valid destination reference.`)}).then(r=>{const i=r+1;Qe(this.pdfViewer,"PDF viewer is not initialized."),Qe(i>=1&&i<=this.pagesCount,`"${i}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:r,pageNumber:i})})})}goToPage(e){const t=e-1;Qe(this.pdfViewer,"PDF viewer is not initialized."),Qe(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function Ad({children:n,type:e}){return f.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const _9={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},IR=_9;function A9(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function Of(){return A.useReducer(A9,{value:void 0,error:void 0})}const J1=typeof window<"u",m3=J1&&window.location.protocol==="file:";function E9(n){return typeof n<"u"}function wl(n){return E9(n)&&n!==null}function C9(n){return typeof n=="string"}function k9(n){return n instanceof ArrayBuffer}function T9(n){return Qe(J1,"isBlob can only be used in a browser environment"),n instanceof Blob}function mC(n){return C9(n)&&/^data:/.test(n)}function DR(n){Qe(mC(n),"Invalid data URI.");const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function P9(){return J1&&window.devicePixelRatio||1}const g3="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function OR(){Nn(!m3,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${g3}`)}function N9(){Nn(!m3,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${g3}`)}function Cu(n){n!=null&&n.cancel&&n.cancel()}function gC(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function R9(n){return n.name==="RenderingCancelledException"}function j9(n){return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{if(!s.result)return t(new Error("Error while reading a file."));e(s.result)},s.onerror=r=>{if(!r.target)return t(new Error("Error while reading a file."));const{error:i}=r.target;if(!i)return t(new Error("Error while reading a file."));switch(i.code){case i.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case i.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case i.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},s.readAsArrayBuffer(n)})}const{PDFDataRangeTransport:M9}=QW,L9=(n,e)=>{switch(e){case IR.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case IR.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function FR(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const I9=A.forwardRef(function({children:e,className:t,error:s="Failed to load PDF file.",externalLinkRel:r,externalLinkTarget:i,file:o,inputRef:a,imageResourcesPath:c,loading:u="Loading PDF",noData:d="No PDF file specified.",onItemClick:h,onLoadError:p,onLoadProgress:m,onLoadSuccess:y,onPassword:g=L9,onSourceError:w,onSourceSuccess:v,options:b,renderMode:S,rotate:E,scale:k,...T},P){const[N,M]=Of(),{value:L,error:O}=N,[D,V]=Of(),{value:I,error:R}=D,j=A.useRef(new S9),F=A.useRef([]),$=A.useRef(void 0),z=A.useRef(void 0);o&&o!==$.current&&FR(o)&&(Nn(!_d(o,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=o),b&&b!==z.current&&(Nn(!_d(b,z.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),z.current=b);const B=A.useRef({scrollPageIntoView:X=>{const{dest:J,pageNumber:le,pageIndex:he=le-1}=X;if(h){h({dest:J,pageIndex:he,pageNumber:le});return}const Bt=F.current[he];if(Bt){Bt.scrollIntoView();return}Nn(!1,`An internal link leading to page ${le} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});A.useImperativeHandle(P,()=>({linkService:j,pages:F,viewer:B}),[]);function H(){v&&v()}function U(){O&&(Nn(!1,O.toString()),w&&w(O))}function Y(){M({type:"RESET"})}A.useEffect(Y,[o,M]);const Q=A.useCallback(async()=>{if(!o)return null;if(typeof o=="string")return mC(o)?{data:DR(o)}:(OR(),{url:o});if(o instanceof M9)return{range:o};if(k9(o))return{data:o};if(J1&&T9(o))return{data:await j9(o)};if(Qe(typeof o=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),Qe(FR(o),"Invalid parameter object: need either .data, .range or .url"),"url"in o&&typeof o.url=="string"){if(mC(o.url)){const{url:X,...J}=o;return{data:DR(X),...J}}OR()}return o},[o]);A.useEffect(()=>{const X=Fy(Q());return X.promise.then(J=>{M({type:"RESOLVE",value:J})}).catch(J=>{M({type:"REJECT",error:J})}),()=>{Cu(X)}},[Q,M]),A.useEffect(()=>{if(!(typeof L>"u")){if(L===!1){U();return}H()}},[L]);function ge(){I&&(y&&y(I),F.current=new Array(I.numPages),j.current.setDocument(I))}function Ce(){R&&(Nn(!1,R.toString()),p&&p(R))}A.useEffect(function(){V({type:"RESET"})},[V,L]),A.useEffect(function(){if(!L)return;const J=b?{...L,...b}:L,le=fT(J);m&&(le.onProgress=m),g&&(le.onPassword=g);const he=le,Bt=he.promise.then(hs=>{V({type:"RESOLVE",value:hs})}).catch(hs=>{he.destroyed||V({type:"REJECT",error:hs})});return()=>{Bt.finally(()=>he.destroy())}},[b,V,L]),A.useEffect(()=>{if(!(typeof I>"u")){if(I===!1){Ce();return}ge()}},[I]),A.useEffect(function(){j.current.setViewer(B.current),j.current.setExternalLinkRel(r),j.current.setExternalLinkTarget(i)},[r,i]);const oe=A.useCallback((X,J)=>{F.current[X]=J},[]),je=A.useCallback(X=>{delete F.current[X]},[]),Ue=A.useMemo(()=>({imageResourcesPath:c,linkService:j.current,onItemClick:h,pdf:I,registerPage:oe,renderMode:S,rotate:E,scale:k,unregisterPage:je}),[c,h,I,oe,S,E,k,je]),ye=A.useMemo(()=>f3(T,()=>I),[T,I]);function Be(){function X(le){return!!(le!=null&&le.pdf)}if(!X(Ue))throw new Error("pdf is undefined");const J=typeof e=="function"?e(Ue):e;return f.jsx(p3.Provider,{value:Ue,children:J})}function Ft(){return o?I==null?f.jsx(Ad,{type:"loading",children:typeof u=="function"?u():u}):I===!1?f.jsx(Ad,{type:"error",children:typeof s=="function"?s():s}):Be():f.jsx(Ad,{type:"no-data",children:typeof d=="function"?d():d})}return f.jsx("div",{className:zf("react-pdf__Document",t),ref:a,...ye,children:Ft()})}),D9=I9;function y3(){return A.useContext(p3)}function v3(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var s=t[0];return s||null}return function(i){for(var o=0,a=t;o<a.length;o++){var c=a[o];typeof c=="function"?c(i):c&&(c.current=i)}}}const O9=A.createContext(null),b3=O9;function Z1(){return A.useContext(b3)}function F9(){const n=y3(),e=Z1();Qe(e,"Unable to find Page context.");const t={...n,...e},{imageResourcesPath:s,linkService:r,onGetAnnotationsError:i,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:a,onRenderAnnotationLayerSuccess:c,page:u,pdf:d,renderForms:h,rotate:p,scale:m=1}=t;Qe(d,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),Qe(u,"Attempted to load page annotations, but no page was specified."),Qe(r,"Attempted to load page annotations, but no linkService was specified.");const[y,g]=Of(),{value:w,error:v}=y,b=A.useRef(null);Nn(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){w&&o&&o(w)}function E(){v&&(Nn(!1,v.toString()),i&&i(v))}A.useEffect(function(){g({type:"RESET"})},[g,u]),A.useEffect(function(){if(!u)return;const M=Fy(u.getAnnotations()),L=M;return M.promise.then(O=>{g({type:"RESOLVE",value:O})}).catch(O=>{g({type:"REJECT",error:O})}),()=>{Cu(L)}},[g,u]),A.useEffect(()=>{if(w!==void 0){if(w===!1){E();return}S()}},[w]);function k(){c&&c()}function T(N){Nn(!1,`${N}`),a&&a(N)}const P=A.useMemo(()=>u.getViewport({scale:m,rotation:p}),[u,p,m]);return A.useEffect(function(){if(!d||!u||!r||!w)return;const{current:M}=b;if(!M)return;const L=P.clone({dontFlip:!0}),O={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:d.annotationStorage,commentManager:null,div:M,l10n:null,linkService:r,page:u,structTreeLayer:null,viewport:L},D={annotations:w,annotationStorage:d.annotationStorage,div:M,imageResourcesPath:s,linkService:r,page:u,renderForms:h,viewport:L};M.innerHTML="";try{new vT(O).render(D),k()}catch(V){T(V)}return()=>{}},[w,s,r,u,d,h,P]),f.jsx("div",{className:zf("react-pdf__Page__annotations","annotationLayer"),ref:b})}const x3={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},B9=/^H(\d+)$/;function $9(n){return n in x3}function eS(n){return"children"in n}function w3(n){return eS(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function z9(n){const e={};if(eS(n)){const{role:t}=n,s=t.match(B9);if(s)e.role="heading",e["aria-level"]=Number(s[1]);else if($9(t)){const r=x3[t];r&&(e.role=r)}}return e}function S3(n){const e={};if(eS(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),w3(n)){const[t]=n.children;if(t){const s=S3(t);return{...e,...s}}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function V9(n){return n?{...z9(n),...S3(n)}:null}function _3({className:n,node:e}){const t=A.useMemo(()=>V9(e),[e]),s=A.useMemo(()=>!eS(e)||w3(e)?null:e.children.map((r,i)=>f.jsx(_3,{node:r},i)),[e]);return f.jsx("span",{className:n,...t,children:s})}function U9(){const n=Z1();Qe(n,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[s,r]=Of(),{value:i,error:o}=s,{customTextRenderer:a,page:c}=n;function u(){i&&t&&t(i)}function d(){o&&(Nn(!1,o.toString()),e&&e(o))}return A.useEffect(function(){r({type:"RESET"})},[r,c]),A.useEffect(function(){if(a||!c)return;const p=Fy(c.getStructTree()),m=p;return p.promise.then(y=>{r({type:"RESOLVE",value:y})}).catch(y=>{r({type:"REJECT",error:y})}),()=>Cu(m)},[a,c,r]),A.useEffect(()=>{if(i!==void 0){if(i===!1){d();return}u()}},[i]),i?f.jsx(_3,{className:"react-pdf__Page__structTree structTree",node:i}):null}const BR=wi;function H9(n){const e=Z1();Qe(e,"Unable to find Page context.");const t={...e,...n},{_className:s,canvasBackground:r,devicePixelRatio:i=P9(),onRenderError:o,onRenderSuccess:a,page:c,renderForms:u,renderTextLayer:d,rotate:h,scale:p}=t,{canvasRef:m}=n;Qe(c,"Attempted to render page canvas, but no page was specified.");const y=A.useRef(null);function g(){c&&a&&a(gC(c,p))}function w(E){R9(E)||(Nn(!1,E.toString()),o&&o(E))}const v=A.useMemo(()=>c.getViewport({scale:p*i,rotation:h}),[i,c,h,p]),b=A.useMemo(()=>c.getViewport({scale:p,rotation:h}),[c,h,p]);A.useEffect(function(){if(!c)return;c.cleanup();const{current:k}=y;if(!k)return;k.width=v.width,k.height=v.height,k.style.width=`${Math.floor(b.width)}px`,k.style.height=`${Math.floor(b.height)}px`,k.style.visibility="hidden";const T={annotationMode:u?BR.ENABLE_FORMS:BR.ENABLE,canvas:k,canvasContext:k.getContext("2d",{alpha:!1}),viewport:v};r&&(T.background=r);const P=c.render(T),N=P;return P.promise.then(()=>{k.style.visibility="",g()}).catch(w),()=>Cu(N)},[r,c,u,v,b]);const S=A.useCallback(()=>{const{current:E}=y;E&&(E.width=0,E.height=0)},[]);return A.useEffect(()=>S,[S]),f.jsx("canvas",{className:`${s}__canvas`,dir:"ltr",ref:v3(m,y),style:{display:"block",userSelect:"none"},children:d?f.jsx(U9,{}):null})}function G9(n){return"str"in n}function q9(){const n=Z1();Qe(n,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:s,onRenderTextLayerError:r,onRenderTextLayerSuccess:i,page:o,pageIndex:a,pageNumber:c,rotate:u,scale:d}=n;Qe(o,"Attempted to load page text content, but no page was specified.");const[h,p]=Of(),{value:m,error:y}=h,g=A.useRef(null);Nn(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){m&&s&&s(m)}function v(){y&&(Nn(!1,y.toString()),t&&t(y))}A.useEffect(function(){p({type:"RESET"})},[o,p]),A.useEffect(function(){if(!o)return;const N=Fy(o.getTextContent()),M=N;return N.promise.then(L=>{p({type:"RESOLVE",value:L})}).catch(L=>{p({type:"REJECT",error:L})}),()=>Cu(M)},[o,p]),A.useEffect(()=>{if(m!==void 0){if(m===!1){v();return}w()}},[m]);const b=A.useCallback(()=>{i&&i()},[i]),S=A.useCallback(P=>{Nn(!1,P.toString()),r&&r(P)},[r]);function E(){const P=g.current;P&&P.classList.add("selecting")}function k(){const P=g.current;P&&P.classList.remove("selecting")}const T=A.useMemo(()=>o.getViewport({scale:d,rotation:u}),[o,u,d]);return A.useLayoutEffect(function(){if(!o||!m)return;const{current:N}=g;if(!N)return;N.innerHTML="";const M=o.streamTextContent({includeMarkedContent:!0}),L={container:N,textContentSource:M,viewport:T},O=new Om(L),D=O;return O.render().then(()=>{const V=document.createElement("div");V.className="endOfContent",N.append(V);const I=N.querySelectorAll('[role="presentation"]');if(e){let R=0;m.items.forEach((j,F)=>{if(!G9(j))return;const $=I[R];if(!$)return;const z=e({pageIndex:a,pageNumber:c,itemIndex:F,...j});$.innerHTML=z,R+=j.str&&j.hasEOL?2:1})}b()}).catch(S),()=>Cu(D)},[e,S,b,o,a,c,m,T]),f.jsx("div",{className:zf("react-pdf__Page__textContent","textLayer"),onMouseUp:k,onMouseDown:E,ref:g})}const $R=1;function W9(n){const t={...y3(),...n},{_className:s="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:i,canvasRef:o,children:a,className:c,customRenderer:u,customTextRenderer:d,devicePixelRatio:h,error:p="Failed to load the page.",height:m,inputRef:y,loading:g="Loading page",noData:w="No page specified.",onGetAnnotationsError:v,onGetAnnotationsSuccess:b,onGetStructTreeError:S,onGetStructTreeSuccess:E,onGetTextError:k,onGetTextSuccess:T,onLoadError:P,onLoadSuccess:N,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:L,onRenderError:O,onRenderSuccess:D,onRenderTextLayerError:V,onRenderTextLayerSuccess:I,pageIndex:R,pageNumber:j,pdf:F,registerPage:$,renderAnnotationLayer:z=!0,renderForms:B=!1,renderMode:H="canvas",renderTextLayer:U=!0,rotate:Y,scale:Q=$R,unregisterPage:ge,width:Ce,...oe}=t,[je,Ue]=Of(),{value:ye,error:Be}=je,Ft=A.useRef(null);Qe(F,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const X=wl(j)?j-1:R??null,J=j??(wl(R)?R+1:null),le=Y??(ye?ye.rotate:null),he=A.useMemo(()=>{if(!ye)return null;let fr=1;const Fo=Q??$R;if(Ce||m){const Ur=ye.getViewport({scale:1,rotation:le});Ce?fr=Ce/Ur.width:m&&(fr=m/Ur.height)}return Fo*fr},[m,ye,le,Q,Ce]);A.useEffect(function(){return()=>{wl(X)&&r&&ge&&ge(X)}},[r,F,X,ge]);function Bt(){if(N){if(!ye||!he)return;N(gC(ye,he))}if(r&&$){if(!wl(X)||!Ft.current)return;$(X,Ft.current)}}function hs(){Be&&(Nn(!1,Be.toString()),P&&P(Be))}A.useEffect(function(){Ue({type:"RESET"})},[Ue,F,X]),A.useEffect(function(){if(!F||!J)return;const Fo=Fy(F.getPage(J)),Ur=Fo;return Fo.promise.then(W=>{Ue({type:"RESOLVE",value:W})}).catch(W=>{Ue({type:"REJECT",error:W})}),()=>Cu(Ur)},[Ue,F,J]),A.useEffect(()=>{if(ye!==void 0){if(ye===!1){hs();return}Bt()}},[ye,he]);const hr=A.useMemo(()=>wl(X)&&J&&wl(le)&&wl(he)?{_className:s,canvasBackground:i,customTextRenderer:d,devicePixelRatio:h,onGetAnnotationsError:v,onGetAnnotationsSuccess:b,onGetStructTreeError:S,onGetStructTreeSuccess:E,onGetTextError:k,onGetTextSuccess:T,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:L,onRenderError:O,onRenderSuccess:D,onRenderTextLayerError:V,onRenderTextLayerSuccess:I,page:ye,pageIndex:X,pageNumber:J,renderForms:B,renderTextLayer:U,rotate:le,scale:he}:null,[s,i,d,h,v,b,S,E,k,T,M,L,O,D,V,I,ye,X,J,B,U,le,he]),qf=A.useMemo(()=>f3(oe,()=>ye&&(he?gC(ye,he):void 0)),[oe,ye,he]),Oo=`${X}@${he}/${le}`;function re(){switch(H){case"custom":return Qe(u,'renderMode was set to "custom", but no customRenderer was passed.'),f.jsx(u,{},`${Oo}_custom`);case"none":return null;case"canvas":default:return f.jsx(H9,{canvasRef:o},`${Oo}_canvas`)}}function De(){return U?f.jsx(q9,{},`${Oo}_text`):null}function Vs(){return z?f.jsx(F9,{},`${Oo}_annotations`):null}function Iu(){function fr(Ur){return!!(Ur!=null&&Ur.page)}if(!fr(hr))throw new Error("page is undefined");const Fo=typeof a=="function"?a(hr):a;return f.jsxs(b3.Provider,{value:hr,children:[re(),De(),Vs(),Fo]})}function rS(){return J?F===null||ye===void 0||ye===null?f.jsx(Ad,{type:"loading",children:typeof g=="function"?g():g}):F===!1||ye===!1?f.jsx(Ad,{type:"error",children:typeof p=="function"?p():p}):Iu():f.jsx(Ad,{type:"no-data",children:typeof w=="function"?w():w})}return f.jsx("div",{className:zf(s,c),"data-page-number":J,ref:v3(y,Ft),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${he}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:i||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...qf,children:rS()})}N9();ar.workerSrc="pdf.worker.mjs";const K9={idle:"Para activar la experiencia WebAR necesitamos permiso para usar tu cmara.",requesting:"Solicitando acceso a la cmara",granted:"Cmara lista. Si no ves la previsualizacin, asegrate de apuntar a la taza.",error:"No pudimos usar la cmara de tu dispositivo."},X9=({onGranted:n,className:e="",copy:t={},variant:s="card"})=>{const[r,i]=A.useState("idle"),o=A.useMemo(()=>({...K9,...t}),[t]),a=async()=>{var u;if(!((u=navigator.mediaDevices)!=null&&u.getUserMedia)){i("error");return}i("requesting");try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(h=>h.stop()),i("granted"),n==null||n()}catch(d){console.error("[CameraPermissionPrompt] Error al iniciar cmara:",d),i("error")}},c=s==="overlay"?"w-full max-w-xs rounded-3xl border border-white/20 bg-black/70 p-6 text-center space-y-4 text-slate-200 backdrop-blur":"rounded-2xl border border-white/10 bg-black/40 p-4 space-y-3 text-slate-300/90";return f.jsxs("div",{className:`${c} ${e}`,children:[f.jsx("p",{className:"text-sm leading-relaxed",children:o[r]}),r!=="granted"?f.jsx("button",{type:"button",onClick:a,className:"inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold bg-purple-500/80 hover:bg-purple-500 transition text-white disabled:opacity-50",disabled:r==="requesting",children:r==="requesting"?"Abriendo cmara":"Activar cmara"}):null]})},Y9="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js";let c_=null;function Q9(){var n,e;return typeof window>"u"?Promise.reject(new Error("MindAR solo est disponible en el navegador.")):(e=(n=window.MINDAR)==null?void 0:n.IMAGE)!=null&&e.MindARThree?Promise.resolve(window.MINDAR.IMAGE):(c_||(c_=Do(()=>import(Y9),[]).then(t=>{var s,r;if(t!=null&&t.MindARThree)return t;if((r=(s=window.MINDAR)==null?void 0:s.IMAGE)!=null&&r.MindARThree)return window.MINDAR.IMAGE;throw new Error("MindAR no se inicializ correctamente.")}).catch(t=>{throw console.error("[loadMindAR] Error al importar MindAR:",t),t})),c_)}const J9="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.module.js";let u_=null;function Z9(){return typeof window>"u"?Promise.reject(new Error("Three.js solo est disponible en el navegador.")):window.__THREE_INSTANCE__?Promise.resolve(window.__THREE_INSTANCE__):(u_||(u_=Do(()=>import(J9),[]).then(n=>(window.__THREE_INSTANCE__=n,n))),u_)}const e7=n=>{const e=new n.Group,t=new n.Mesh(new n.IcosahedronGeometry(.35,1),new n.MeshStandardMaterial({color:"#c084fc",emissive:"#6b21a8",metalness:.2,roughness:.35,transparent:!0,opacity:.9})),s=new n.Mesh(new n.TorusGeometry(.5,.035,14,48),new n.MeshBasicMaterial({color:"#e879f9",transparent:!0,opacity:.65}));s.rotation.x=Math.PI/2;const r=new n.Mesh(new n.SphereGeometry(.18,16,16),new n.MeshBasicMaterial({color:"#a5b4fc",transparent:!0,opacity:.35}));return e.add(t),e.add(s),e.add(r),e},t7=A.forwardRef(({targetSrc:n="/assets/targets.mind",isCameraReady:e=!1,className:t="",message:s="La taza te escucha.",overlay:r=null},i)=>{const o=A.useMemo(()=>{if(!n||/^(https?:)?\/\//i.test(n))return n;const y="/";if(n.startsWith(y))return n;const g=y.endsWith("/")?y:`${y}/`,w=n.replace(/^\/+/,"");return`${g}${w}`},[n]),a=A.useRef(null),c=A.useRef(null),[u,d]=A.useState("idle"),[h,p]=A.useState("");return A.useEffect(()=>{if(!e||!a.current||!o)return;let m=null,y=null,g=null,w=null,v=null;return(async()=>{d("loading"),p("");try{const S=await Z9(),E=await Q9();m=new E.MindARThree({container:a.current,imageTargetSrc:o,uiLoading:"no",uiError:"no",uiScanning:"no"});const{renderer:k,scene:T,camera:P}=m;y=k;const N=new S.HemisphereLight("#ffffff","#333344",1);T.add(N);const M=new S.DirectionalLight("#ffffff",.8);M.position.set(.5,1,.5),T.add(M);const L=m.addAnchor(0),{GLTFLoader:O}=await Do(()=>import("./GLTFLoader-ab5cd9e3.js"),[]),D=new O;let V=null;try{V=(await D.loadAsync("/webar/taza/gato-abstracto.glb")).scene}catch(j){console.warn("[MindARScene] No se pudo cargar /webar/taza/gato-abstracto.glb, usando modelo fallback.",j),V=e7(S)}v=V,v.scale.set(.6,.6,.6),v.position.set(0,.3,0),v.rotation.set(0,Math.PI,0),L.group.add(v),await m.start();const I=m.video;I&&!a.current.contains(I)&&(I.setAttribute("playsinline","true"),I.muted=!0,I.style.position="absolute",I.style.top="0",I.style.left="0",I.style.width="100%",I.style.height="100%",I.style.objectFit="cover",I.style.zIndex="0",I.style.display="block",a.current.appendChild(I),w=I,c.current=I),d("running");const R=new S.Clock;g=()=>{const j=R.getElapsedTime();if(v){v.rotation.y=j*.4;const F=.6+Math.sin(j*.8)*.03;v.scale.set(F,F,F)}y.render(T,P)},y.setAnimationLoop(g)}catch(S){console.error("[MindARScene] Error al iniciar AR:",S),p((S==null?void 0:S.message)??"No pudimos iniciar la experiencia AR."),d("error")}})(),()=>{var S;y&&g&&y.setAnimationLoop(null),m&&(m.stop(),(S=m.renderer)==null||S.dispose()),c.current=null,w&&w.parentElement===a.current&&a.current.removeChild(w)}},[e,o]),A.useEffect(()=>{},[s]),A.useImperativeHandle(i,()=>({async captureFrame(){const m=c.current;if(!m||m.videoWidth===0||m.videoHeight===0)return null;const y=document.createElement("canvas");return y.width=m.videoWidth,y.height=m.videoHeight,y.getContext("2d").drawImage(m,0,0,y.width,y.height),await new Promise(w=>{y.toBlob(v=>w(v),"image/jpeg",.95)})}})),f.jsxs("div",{className:`relative w-full bg-transparent rounded-3xl overflow-hidden ${t}`,"data-ar-container":"true",children:[f.jsx("div",{ref:a,className:"absolute inset-0"}),u==="idle"&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-slate-400 text-sm pointer-events-none",children:"Esperando a que actives la cmara"}),u==="loading"&&f.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-slate-200 text-sm bg-black/40 pointer-events-none",children:[f.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-2 border-purple-300 border-t-transparent mb-3"}),"Preparando portal..."]}),u==="error"&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-center px-6 text-sm text-red-300 bg-black/70 pointer-events-none",children:h}),r&&f.jsx("div",{className:"absolute inset-0",children:typeof r=="function"?r():r})]})}),zR=["La taza te escucha."],VR=({targetSrc:n="/assets/targets.mind",phrases:e=zR,onExit:t})=>{const[s,r]=A.useState(!1),[i,o]=A.useState(0),a=A.useRef(null),c=A.useMemo(()=>Array.isArray(e)&&e.length>0?e:zR,[e]);A.useEffect(()=>{o(0)},[n]);const u=()=>{o(y=>(y+1)%c.length)},d=()=>{t==null||t()},h=A.useCallback(async()=>{var y,g;if(!((y=a.current)!=null&&y.captureFrame)){Ae({description:"La cmara an no est lista para capturar."});return}try{const w=await a.current.captureFrame();if(!w){Ae({description:"No pudimos obtener la captura. Intenta de nuevo."});return}const v=new File([w],"miniverso-taza.jpg",{type:"image/jpeg"}),b="#EstoNoEsUnaTaza  Comparte tu portal y etiqueta a @gatoencerradoai para aparecer en la galera.";if(navigator.share&&((g=navigator.canShare)!=null&&g.call(navigator,{files:[v]})))await navigator.share({files:[v],title:"Miniverso Taza",text:b});else{const S=URL.createObjectURL(w),E=document.createElement("a");E.href=S,E.download="miniverso-taza.jpg",document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(S),Ae({description:"Guardamos la captura. Comprtela desde tu galera con #EstoNoEsUnaTaza."})}}catch(w){console.error("[ARExperience] Error al compartir captura:",w),Ae({description:"No pudimos compartir la captura. Intenta ms tarde."})}},[]),p="rounded-full bg-black/55 text-white p-3 shadow-lg border border-white/15 hover:bg-black/70 transition backdrop-blur",m=s?f.jsx("div",{className:"absolute inset-x-0 bottom-5 flex justify-center pointer-events-none",children:f.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto",children:[f.jsx("button",{type:"button",onClick:u,className:p,"aria-label":"Nueva frase",children:f.jsx(N$,{size:18})}),f.jsx("button",{type:"button",onClick:h,className:p,"aria-label":"Compartir captura",children:f.jsx(M$,{size:18})}),f.jsx("button",{type:"button",onClick:d,className:p,"aria-label":"Salir de AR",children:f.jsx(R1,{size:18})})]})}):f.jsx("div",{className:"absolute inset-0 flex items-center justify-center px-6",children:f.jsx(X9,{onGranted:()=>r(!0),variant:"overlay",copy:{idle:"Activa tu cmara para revelar la frase de tu taza."}})});return f.jsxs("section",{className:"space-y-4 -mx-4 sm:mx-0",children:[f.jsx(t7,{ref:a,targetSrc:n,isCameraReady:s,message:c[i],className:"w-full min-h-[75vh] sm:min-h-[80vh]",overlay:m}),f.jsx("p",{className:"text-sm text-slate-400/80 px-4 sm:px-0",children:"Si el marcador no se detecta de inmediato, ajusta la iluminacin y mantn la taza completa dentro del encuadre."})]})},n7=(n=[])=>{const e=[...n];for(let t=e.length-1;t>0;t-=1){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},d_=n=>n?String(n).toLowerCase().trim():"",vx=(n,e)=>{for(const t of e)if(n[t])return n[t];return""},h_=(n,e)=>({id:n.id??`audio-${e}`,label:n.label??n.title??"Pista",title:n.title??n.label??"",url_audio:vx(n,["url_audio","audio_url","audioUrl","url"])}),f_=(n,e)=>({id:n.id??`poema-${e}`,label:n.label??n.title??"Poema ritual",title:n.title??n.label??"",poem_text:n.poem_text??n.text??n.poemText??"",poem_lines:n.poem_lines??null}),p_=(n,e)=>({id:n.id??`video-${e}`,url_video:vx(n,["url_video","video_url","videoUrl","url"]),title:n.title??n.label??"Video ritual",artist:n.artist??n.author??"Residencia #GatoEncerrado"}),UR=(n=[])=>n.some(t=>t.id==="silencio")?n:[{id:"silencio",label:"Silencio",title:"Silencio",url_audio:""},...n],s7=(n=[])=>{var t;const e=n.find(s=>s.id==="silencio");return e?e.id:((t=n[0])==null?void 0:t.id)??""},r7=({fallbackVideoUrl:n,fallbackVideoTitle:e="Video ritual",fallbackVideoArtist:t="Residencia #GatoEncerrado",fallbackAudioOptions:s=[],fallbackPoemOptions:r=[],videoLimit:i=null,audioLimit:o=null,poemLimit:a=null,fragmentLines:c=4}={})=>{const[u,d]=A.useState(!0),[h,p]=A.useState(""),[m,y]=A.useState([]),[g,w]=A.useState(0),[v,b]=A.useState([]),[S,E]=A.useState([]);A.useState([]),A.useEffect(()=>{let M=!1;return(async()=>{d(!0),p("");try{const{data:O,error:D}=await nt.from("sonoro_media").select("*");if(M)return;if(D)throw D;const V=O??[],I=V.filter(B=>{const H=d_(B.kind||B.type),U=vx(B,["url_video","video_url","videoUrl","url"]);return H==="video"&&!!U}).map(p_),R=V.filter(B=>{const H=d_(B.kind||B.type),U=vx(B,["url_audio","audio_url","audioUrl","url"]);return H==="audio"&&!!U}).map(h_),j=V.filter(B=>{const H=d_(B.kind||B.type),U=typeof B.poem_text=="string"&&B.poem_text.trim()!==""||Array.isArray(B.poem_lines)&&B.poem_lines.length>0||typeof B.text=="string"&&B.text.trim()!==""||typeof B.poemText=="string"&&B.poemText.trim()!=="";return(H==="poema"||H==="poem"||H==="poetry")&&U}).map((B,H)=>{const U=f_(B,H);if(!U.poem_lines&&U.poem_text){const Y=U.poem_text.split(`
`).map(Q=>Q.trim()).filter(Boolean);U.poem_lines=Y.slice(0,c)}return U.poem_lines&&c&&(U.poem_lines=U.poem_lines.slice(0,c)),U}),F=I.length>0?n7(i?I.slice(0,i):I):n?[p_({url_video:n,title:e,artist:t},0)]:[],$=UR(R.length>0?o?R.slice(0,o):R:(s??[]).map(h_)),z=j.length>0?a?j.slice(0,a):j:(r??[]).map(f_);y(F),w(0),b($),E(z),I.length===0&&R.length===0&&j.length===0&&p("Cargando con datos de respaldo. No hay registros recientes en sonoro_media.")}catch(O){const D=n?[p_({url_video:n,title:e,artist:t},0)]:[],V=UR((s??[]).map(h_)),I=(r??[]).map(f_);y(D),w(0),b(V),E(I),p((O==null?void 0:O.message)??"No pudimos cargar el miniverso sonoro.")}finally{M||d(!1)}})(),()=>{M=!0}},[s,r,t,e,n]);const k=A.useMemo(()=>m.length>0?m[g%m.length]:null,[m,g]),T=A.useMemo(()=>s7(v),[v]),P=A.useMemo(()=>"",[S]);return{videoQueue:m,currentVideoIndex:g,currentVideo:k,audioOptions:v,poemOptions:S,initialAudioId:T,initialPoemId:P,isLoading:u,errorMessage:h,nextVideo:()=>{w(M=>m.length===0?M:(M+1)%m.length)}}};const m_=[{id:"neblina",label:"Modo",short:"Neblina-Suave",copy:"Neblina suave que difumina los bordes del sueo."},{id:"sombras",label:"Modo",short:"Deep-Shadow",copy:"Contrastes ms profundos, como si todo ocurriera a media luz."},{id:"respiracion",label:"Modo",short:"Pulse-Bloom",copy:"La luz late con la escena, como si el sueo respirara."},{id:"umbral",label:"Modo",short:"Umbral-Deep",copy:"Un tnel suave y profundo que suspende la temporalidad."}];function HR({videoUrl:n,videoTitle:e="Video ritual",videoArtist:t="Residencia #GatoEncerrado",audioOptions:s=[],poemOptions:r=[],initialAudioId:i="",initialPoemId:o="",isLoading:a=!1,errorMessage:c,showHeader:u=!0,showCTA:d=!0,onEnterExperience:h,experienceHref:p="/miniverso-sonoro"}){const{currentVideo:m,audioOptions:y,poemOptions:g,initialAudioId:w,initialPoemId:v,videoQueue:b,isLoading:S,errorMessage:E,nextVideo:k}=r7({fallbackVideoUrl:n,fallbackVideoTitle:e,fallbackVideoArtist:t,fallbackAudioOptions:s,fallbackPoemOptions:r}),[T,P]=A.useState("neblina"),[N,M]=A.useState(!1),[L,O]=A.useState(w||i||""),[D,V]=A.useState(o||v||""),[I,R]=A.useState([]),[j,F]=A.useState(null),[$,z]=A.useState(!1),[B,H]=A.useState(!1),U=!!L&&!!D,Y=A.useRef(null),Q=A.useRef(null),ge=A.useRef(0),Ce=S||a,oe=A.useMemo(()=>y.find(re=>re.id===L),[y,L]),je=A.useMemo(()=>g.find(re=>re.id===D),[g,D]),Ue=(je==null?void 0:je.poem_text)||(je==null?void 0:je.text)||"",ye=A.useMemo(()=>m_.find(re=>re.id===T)||m_[0],[T]);A.useEffect(()=>{var re;if(!L&&w){O(w);return}y.find(De=>De.id===L)||O(((re=y[0])==null?void 0:re.id)||w||"")},[y,w,L]),A.useEffect(()=>{if(!D&&v){V(v);return}D!==""&&(g.find(re=>re.id===D)||V(""))},[g,v,D]),A.useEffect(()=>{if(!je){R([]),F(0);return}const re=je.poem_lines&&Array.isArray(je.poem_lines)&&je.poem_lines.length>0?je.poem_lines:typeof Ue=="string"?Ue.split(`
`).map(De=>De.trim()).filter(Boolean):[];R(re),F(re.length>0?0:null),z(re.length>0)},[je,Ue]),A.useEffect(()=>{if(!I||I.length===0||j===null)return;const re=j===I.length-1,De=setTimeout(()=>{re?z(!1):F(Vs=>Vs===null?0:Vs+1)},1500);return()=>clearTimeout(De)},[I,j,B]),A.useEffect(()=>{if(typeof window>"u")return;const re=window.matchMedia("(max-width: 768px)"),De=()=>M(re.matches);return De(),re.addEventListener("change",De),()=>re.removeEventListener("change",De)},[]),A.useEffect(()=>{if(!(typeof document>"u"))return B?(document.body.classList.add("overflow-hidden"),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})):document.body.classList.remove("overflow-hidden"),()=>document.body.classList.remove("overflow-hidden")},[B]),A.useEffect(()=>{if(N&&!B)return;const re=Y.current;!re||!(m!=null&&m.url_video)||re.play().catch(()=>{})},[N,m]),A.useEffect(()=>{if(!Y.current)return;if(N&&!B){Y.current.pause();return}const re=Y.current,De=re.play();De&&De.catch&&De.catch(()=>{setTimeout(()=>re.play().catch(()=>{}),250)})},[m==null?void 0:m.url_video,B,N]),A.useEffect(()=>{Q.current&&(B&&oe&&oe.url_audio?Q.current.play().catch(()=>{}):Q.current.pause())},[oe,B]);const Be=re=>{O(re.target.value);const De=Q.current;De&&De.play().catch(()=>{})},Ft=re=>{V(re.target.value)},X=()=>{if(b.length>1){k();return}const re=Y.current;re&&(re.currentTime=0,re.play().catch(()=>{}))},J=()=>{typeof window<"u"&&(ge.current=window.scrollY||0),H(!0),h&&h()},le=()=>{H(!1),typeof window<"u"&&window.scrollTo({top:ge.current||0,behavior:"auto"})};A.useEffect(()=>{const re=Y.current,De=Q.current;if(B){if(re){try{re.currentTime=0}catch{}re.play().catch(()=>{})}if(De&&(oe!=null&&oe.url_audio)){try{De.currentTime=0}catch{}De.play().catch(()=>{})}I.length>0&&(F(0),z(!0))}else re&&N&&re.pause(),De&&De.pause(),z(!1),F(I.length>0?0:null)},[B,N,I.length,oe==null?void 0:oe.url_audio]);const he=(re="")=>f.jsxs("div",{className:`sonoro-preview-video-card mode-${T} ${re}`,children:[f.jsxs("div",{className:"sonoro-preview-hud",children:[f.jsxs("div",{children:[f.jsx("p",{className:"sonoro-preview-hud__kicker",children:"Cmara de resonancia"}),f.jsx("p",{className:"sonoro-preview-hud__title",children:(m==null?void 0:m.title)||e||"Video ritual"}),f.jsx("p",{className:"sonoro-preview-hud__artist",children:(m==null?void 0:m.artist)||t||"Residencia #GatoEncerrado"})]}),f.jsxs("div",{className:"sonoro-preview-hud__mode",children:[f.jsx("span",{className:"sonoro-preview-pill",children:ye.label}),f.jsx("small",{children:ye.short})]})]}),f.jsxs("div",{className:"sonoro-ambient",children:[f.jsxs("div",{className:"sonoro-ambient-video",children:[m!=null&&m.url_video?f.jsx("video",{ref:Y,className:"sonoro-preview-video",src:m==null?void 0:m.url_video,muted:!0,autoPlay:!N||B,playsInline:!0,loop:!N||B,onEnded:X},(m==null?void 0:m.id)||(m==null?void 0:m.url_video)):f.jsx("div",{className:"sonoro-preview-video-placeholder",children:f.jsx("p",{children:Ce?"Cargando el archivo sonoro":"Pronto se abrir un video ritual."})}),f.jsx("div",{className:`dream-overlay dream-${T}`,"aria-hidden":"true"})]}),f.jsx("div",{className:"sonoro-ambient-fog","aria-hidden":"true"}),f.jsx("div",{className:"sonoro-ambient-shadow","aria-hidden":"true"}),f.jsx("div",{className:"sonoro-ambient-breath","aria-hidden":"true"}),f.jsx("div",{className:"sonoro-ambient-grain","aria-hidden":"true"}),f.jsxs("div",{className:"sonoro-video-overlay","aria-hidden":"true",children:[f.jsx("span",{className:"sonoro-video-overlay__layer layer-1"}),f.jsx("span",{className:"sonoro-video-overlay__layer layer-2"}),f.jsx("span",{className:"sonoro-video-overlay__layer layer-3"}),f.jsx("span",{className:"sonoro-video-overlay__layer layer-4"})]})]}),((I==null?void 0:I.length)||Ue)&&f.jsx("div",{className:"sonoro-preview-poem-overlay poem-overlay",children:I!=null&&I.length?I.map((De,Vs)=>f.jsx("p",{className:`poem-line ${Vs===j&&$?"is-visible":""}`,style:{zIndex:Vs===j?2:1},children:De},`${(je==null?void 0:je.id)||"poema"}-${Vs}`)):f.jsx("p",{className:"poem-line is-visible",children:Ue})})]}),Bt=f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"sonoro-preview-control-group sonoro-preview-control-group--modes",children:[f.jsx("p",{className:"sonoro-preview-control-label",children:"Modos de sueo"}),f.jsx("div",{className:"sonoro-preview-mode-pills",children:m_.map(re=>f.jsxs("button",{type:"button",className:`sonoro-preview-mode-pill ${T===re.id?"is-active":""}`,onClick:()=>P(re.id),"aria-pressed":T===re.id,children:[f.jsxs("div",{className:"sonoro-preview-mode-pill__header",children:[f.jsx("span",{children:re.label}),f.jsx("small",{children:re.short})]}),f.jsx("p",{children:re.copy})]},re.id))})]}),f.jsxs("div",{className:"sonoro-preview-control-group",children:[f.jsx("p",{className:"sonoro-preview-control-label",children:"Elige la msica"}),f.jsx("select",{value:(oe==null?void 0:oe.id)??"",onChange:Be,className:"sonoro-preview-select",children:y.map(re=>f.jsx("option",{value:re.id,children:re.label||re.title},re.id))})]}),f.jsxs("div",{className:"sonoro-preview-control-group",children:[f.jsx("p",{className:"sonoro-preview-control-label",children:"Elige un poema"}),f.jsxs("select",{value:(je==null?void 0:je.id)??"",onChange:Ft,className:"sonoro-preview-select",children:[f.jsx("option",{value:"",children:"Ninguno"}),g.map(re=>f.jsx("option",{value:re.id,children:re.label||re.title||"Poema ritual"},re.id))]})]})]}),hs=f.jsxs("div",{className:`sonoro-preview-layout ${N?"is-mobile":"is-desktop"}`,children:[f.jsx("aside",{className:"sonoro-preview-controls",children:Bt}),f.jsxs("section",{className:"sonoro-preview-stage",children:[he(),d&&f.jsx("button",{type:"button",className:"sonoro-preview-cta",onClick:J,disabled:!U,children:"Entrar a la cmara de resonancia"})]})]}),hr=f.jsxs("div",{className:"sonoro-preview-layout is-desktop",children:[f.jsx("aside",{className:"sonoro-preview-controls",children:Bt}),f.jsxs("section",{className:"sonoro-preview-stage",children:[he(),d&&f.jsx("button",{type:"button",className:"sonoro-preview-cta",onClick:J,disabled:!U,children:"Entrar a la cmara de resonancia"})]})]}),qf=typeof document<"u"&&B?wy.createPortal(f.jsxs("div",{className:"sonoro-fullscreen-layer",children:[f.jsxs("div",{className:"sonoro-fullscreen-header",children:[f.jsx("p",{className:"sonoro-fullscreen-kicker",children:"Cmara de resonancia"}),f.jsx("button",{type:"button",className:"sonoro-fullscreen-close",onClick:le,children:"Cerrar experiencia"})]}),f.jsx("div",{className:"sonoro-fullscreen-body",children:he("is-full-experience")})]}),document.body):null,Oo=f.jsxs(f.Fragment,{children:[u&&f.jsxs("div",{className:"sonoro-preview-header",children:[f.jsxs("div",{className:"sonoro-preview-header__top",children:[f.jsx("p",{className:"sonoro-preview-small-title",children:"Miniverso Sonoro  Suea en Tres Capas"}),f.jsx("span",{className:"sonoro-preview-tag",children:"#GatoEncerrado"})]}),f.jsx("h2",{className:"sonoro-preview-title",children:"Miniverso Sonoro"}),f.jsx("p",{className:"sonoro-preview-subtitle",children:"Una cmara de resonancia en miniatura: el video corre solo, t eliges la msica y el poema."})]}),N?hs:hr]});return f.jsxs("div",{className:`sonoro-preview root-mode-${T}`,children:[!B&&Oo,qf,f.jsx("audio",{ref:Q,src:(oe==null?void 0:oe.url_audio)||(oe==null?void 0:oe.url)||void 0,loop:!0}),(E||c)&&f.jsx("p",{className:"sonoro-preview-error",children:E||c})]})}function i7(){const[n,e]=A.useState("segment"),[t,s]=A.useState([]),[r,i]=A.useState(!1),[o,a]=A.useState(null),[c,u]=A.useState(null),[d,h]=A.useState(""),[p,m]=A.useState(!1),[y,g]=A.useState(0),w=async()=>{try{const k=await(await fetch("/data/novela-preview.json")).json();s(k.segments||[])}catch(E){console.error("Error cargando segmentos:",E)}},v=(E,k)=>{y>=4||(a(E),u(k),h(""),i(!0))},b=()=>{i(!1),a(null),u(null),h("")};return{mode:n,setMode:e,segments:t,loadSegments:w,isModalOpen:r,openModal:v,closeModal:b,activeSegment:o,activePlan:c,reflection:d,setReflection:h,loading:p,reflectionCount:y,sendReflection:async()=>{if(d.trim()){m(!0);try{const{data:E,error:k}=await fetch("/functions/v1/send-blog-reflection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({segment_id:o.id,plan:c,reflection:d,author:"Invitado"})});k&&console.error("Supabase error:",k),g(T=>Math.min(T+1,4)),alert("Reflexin enviada."),b()}catch(E){console.error("Error enviando reflexin:",E)}m(!1)}}}}function o7(){const[n,e]=A.useState(!0),t=A.useRef(null);return A.useEffect(()=>{if(typeof window>"u"||!("ontouchstart"in window||(navigator.maxTouchPoints??0)>0||(navigator.msMaxTouchPoints??0)>0))return;const r=()=>{e(!1),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{e(!0)},500)};return window.addEventListener("touchstart",r,{passive:!0}),window.addEventListener("touchmove",r,{passive:!0}),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchmove",r),t.current&&clearTimeout(t.current)}},[]),n}function a7({isOpen:n,onClose:e,segment:t,plan:s,reflection:r,setReflection:i,onSubmit:o,loading:a}){var u;if(A.useEffect(()=>{if(n)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]),!n)return null;const c={academic:"Plano Acadmico",psychological:"Plano Psicolgico",narrative:"Plano Narrativo",theatrical:"Plano Teatral"};return f.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/80 backdrop-blur-3xl px-4",children:f.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-purple-400/40 bg-black/90 p-6 shadow-[0_30px_80px_rgba(15,23,42,0.75)]",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-purple-300/80",children:"Plano"}),f.jsx("h2",{className:"text-2xl font-semibold text-white",children:c[s]??"Plano"})]}),f.jsx("button",{onClick:e,className:"text-sm text-slate-300 hover:text-white",children:"Cerrar "})]}),f.jsx("p",{className:"text-sm text-slate-300/80 mb-6 leading-relaxed",children:(u=t==null?void 0:t.questions)==null?void 0:u[s]}),f.jsx("textarea",{className:"w-full min-h-[160px] rounded-2xl border border-white/10 bg-black/40 p-4 text-sm text-slate-100 outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500/40 transition",placeholder:"Escribe tu reflexin aqu",value:r,onChange:d=>i(d.target.value)}),f.jsxs("div",{className:"mt-6 flex items-center justify-between gap-4",children:[f.jsx("button",{onClick:e,className:"text-sm uppercase tracking-[0.4em] text-slate-400 hover:text-white",children:"Cancelar"}),f.jsx("button",{onClick:o,disabled:a,className:"rounded-full bg-gradient-to-r from-purple-600/90 to-indigo-600/80 px-6 py-3 text-sm font-semibold text-white transition hover:from-purple-500/90 hover:to-indigo-500/90 disabled:opacity-60",children:a?"Enviando":"Enviar reflexin"})]})]})})}const l7=[{plan:"academic",label:"Acadmico",Icon:yk},{plan:"psychological",label:"Psicolgico",Icon:b$},{plan:"narrative",label:"Narrativo",Icon:N1},{plan:"theatrical",label:"Teatral",Icon:I$}];function c7({iconsVisible:n=!0,onSelect:e,disabled:t=!1,isTouchDevice:s=!1,readingMode:r="dark"}){return f.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:l7.map(({plan:i,label:o,Icon:a})=>{const c=s?n?"opacity-100":"opacity-50":"opacity-0 group-hover:opacity-100",u=r==="premium"?"text-[#3b2a1f]":"text-white",d=r==="premium"?"stroke-[#3b2a1f]":"stroke-current";return f.jsxs("button",{type:"button",onClick:()=>!t&&e(i),disabled:t,className:`group flex flex-col items-center justify-center rounded-full border border-white/10 bg-white/5 py-3 text-[0.6rem] uppercase tracking-[0.4em] text-white transition-opacity duration-300 ${c} ${t?"cursor-not-allowed opacity-40":`hover:border-purple-400 hover:text-white ${u}`}`,"aria-label":`Abrir plano ${o}`,children:[f.jsx(a,{size:18,className:d}),f.jsx("span",{className:`mt-1 ${u}`,children:o})]},i)})})}function u7(){const{segments:n,loadSegments:e,openModal:t,activeSegment:s,activePlan:r,reflection:i,setReflection:o,isModalOpen:a,closeModal:c,sendReflection:u,loading:d,reflectionCount:h}=i7(),p=o7(),m=h>=4,[y,g]=A.useState(!1),[w,v]=A.useState("dark"),b={dark:"bg-black/40 border-white/10 text-slate-100",premium:"bg-[#f7f2e8] border-[#c4bdae] text-[#3b2a1f] shadow-[0_20px_35px_rgba(0,0,0,0.15)]"},S={dark:"text-slate-100",premium:"text-[#3b2a1f]"},E={dark:'"Literata", "Times New Roman", serif',premium:'"Cormorant Garamond", "Palatino Linotype", serif'};return A.useEffect(()=>{e()},[]),A.useEffect(()=>{if(typeof window>"u")return;const k="ontouchstart"in window||(navigator.maxTouchPoints??0)>0||(navigator.msMaxTouchPoints??0)>0;g(k)},[]),f.jsxs("div",{className:"w-full min-h-screen px-4 py-8 text-slate-100",children:[f.jsxs("div",{className:"mx-auto flex w-full max-w-3xl flex-col items-center gap-6",children:[f.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:f.jsx("div",{className:"flex gap-3 items-center",children:["dark","premium"].map(k=>f.jsx("button",{onClick:()=>v(k),className:`w-8 h-8 rounded-full border transition ${w===k?"border-white/90 bg-white/80 shadow-lg":"border-white/30 bg-black/20"}`,"aria-label":`Modo ${k}`,children:f.jsx("span",{className:"hidden",children:k})},k))})}),m&&f.jsx("div",{className:"w-full max-w-[650px] rounded-2xl border border-rose-500/40 bg-rose-500/10 px-4 py-3 text-center text-sm text-rose-200 shadow-lg shadow-rose-900/30",children:"Has alcanzado el lmite de reflexiones del preview."}),f.jsx("div",{className:"space-y-6",children:n.map(k=>f.jsxs("div",{className:`group mx-auto max-w-[650px] space-y-6 rounded-3xl border px-8 py-10 backdrop-blur-md shadow-[0_20px_50px_rgba(0,0,0,0.45)] transition-colors duration-500 ${b[w]}`,children:[f.jsx("p",{className:`text-base leading-relaxed ${S[w]}`,style:{fontFamily:E[w],lineHeight:1.8},children:k.text}),f.jsx(c7,{onSelect:T=>t(k,T),iconsVisible:p,isTouchDevice:y,disabled:m,readingMode:w})]},k.id))}),")}"]}),f.jsx(a7,{isOpen:a,onClose:c,segment:s,plan:r,reflection:i,setReflection:o,loading:d,onSubmit:u})]})}async function d7({showcaseId:n,user:e}){if(!n)return{success:!1,error:new Error("Falta el identificador del showcase")};const t={showcase_id:n,user_id:(e==null?void 0:e.id)??null,user_email:(e==null?void 0:e.email)??null,metadata:{recorded_at:new Date().toISOString()}},{error:s}=await nt.from("showcase_likes").insert(t);return{success:!s,error:s}}function h7(){const[n,e]=A.useState(!1),[t,s]=A.useState(()=>new Set);A.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const a=window.matchMedia("(max-width: 768px)"),c=u=>e(u.matches);return c(a),typeof a.addEventListener=="function"?(a.addEventListener("change",c),()=>a.removeEventListener("change",c)):(a.addListener(c),()=>a.removeListener(c))},[]),A.useEffect(()=>{n||s(new Set)},[n]);const r=A.useCallback(a=>{a&&s(c=>{if(c.has(a))return c;const u=new Set(c);return u.add(a),u})},[]),i=A.useCallback(a=>!n||!a?!0:t.has(a),[t,n]),o=A.useCallback(async(a,c)=>{if(!n)return;a.preventDefault(),a.stopPropagation();const u=a.currentTarget;if(!(u instanceof HTMLVideoElement))return;const d=async()=>{(u.paused||u.readyState<2)&&await u.play()};if(typeof document<"u"&&"pictureInPictureEnabled"in document&&document.pictureInPictureEnabled&&typeof u.requestPictureInPicture=="function"&&!u.disablePictureInPicture)try{await d(),await u.requestPictureInPicture();return}catch{}const p=u.requestFullscreen||u.webkitEnterFullscreen||u.webkitRequestFullscreen||u.mozRequestFullScreen||u.msRequestFullscreen;if(p)try{await d(),await p.call(u);return}catch{}r(c),u.controls=!0;try{await d()}catch{}},[r,n]);return{isMobileViewport:n,canUseInlinePlayback:i,requestMobileVideoPresentation:o}}ar.workerSrc=`https://unpkg.com/pdfjs-dist@${mT}/build/pdf.worker.min.mjs`;const gp={miniversos:{label:"Miniverso Trgico",type:"tragedia",intro:"Aqu nace la obra dentro de la obra. El gato encerrado de Es un gato encerrado.",cartaTitle:"#VibracinEscnica",notaAutoral:`De la escena brot el universo:
voz, trance y cuerpo
abriendo portales.`,narrative:["En este miniverso puedes entrar al mundo de Silvestre: escuchar sus ecos, leer a sus fantasmas o conversar directamente con su trasunto, el Payasito Tiste, en un chat que habita la herida."],ctaLabel:"Hablar con Silvestre",ctaDescription:"Activa el vnculo con la voz que an no se apaga. Aqu es donde Silvestre o lo que queda de l te responde."},copycats:{label:"Miniverso Cine",type:"cinema",intro:"El cine dentro de #GatoEncerrado es un laboratorio donde la realidad se revela por roce, no por imitacin. Obra, proceso y mirada se mezclan hasta volver indistinguibles sus fronteras.",promise:"Aqu no solo ves cine: te invitamos a entrar a su laboratorio.",theme:"La doble vida de una imagen: aquello que se ve y aquello que tiembla detrs. CopyCats (farsa lcida) y Quirn (herida ntima) responden a la misma pregunta en dos lenguajes.",tone:["Premiere ntima","Laboratorio abierto","Cine con memoria"],cartaTitle:"#LuzQueHiere",copycats:{title:"CopyCats",description:"Un juego serio sobre cmo nos repetimos sin notarlo. Mira su bitcora creativa y descubre cmo surgi esta pieza.",microcopy:"CopyCats es un ensayo cinematogrfico sobre el desgaste creativo: un making-of que piensa el acto de crear mientras sucede. Se detiene en el burnout, en la autocrtica feroz, y en ese desprecio silencioso que a veces sentimos por la obra justo cuando ms nos necesita.",assets:[{id:"copycats-carta",label:"Carta audiovisual (4:02)",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/ensayos/La%20Cadena%20del%20Gesto.mp4"},{id:"copycats-ensayo",label:"La Cadena del Gesto (4:28)",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/ensayos/La%20Cadena%20del%20Gesto.mp4"}],tags:["Cine-ensayo","Identidad Digital","Archivo autoficcional"]},quiron:{title:"Quirn",description:"Mira el teaser y los stills de rodaje de un cortometraje que busca la vulnerabilidad donde casi no se nota.",microcopy:"Quirn explora un silencio heredado: una familia atravesada por el suicidio de un padre y un abuelo. La pelcula nace para darle lenguaje a ese dolor y acercarnos a lo que normalmente se calla.",teaser:{id:"quiron-teaser",label:"Teaser oficial",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/Quiron.mp4"},stills:[{id:"quiron-still-01",label:"Still 01  Primera llamada",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/stills%20-%20quiron/rodaje%201.jpg"},{id:"quiron-still-02",label:"Still 02  Lectura en el set",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/stills%20-%20quiron/IMG_2290.JPG"},{id:"quiron-still-03",label:"Still 03  Seales del da",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Cine%20-%20teasers/stills%20-%20quiron/IMG_2382.JPG"}]},collaborators:[{id:"viviana-gonzalez",name:"Viviana Gonzlez",role:"Direccin de foto y registro creativo",bio:"Cineasta y documentalista. Su cmara captura el pulso emocional de CopyCats y Quirn.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/placeholder-colaboradores.jpg",anchor:"#team"},{id:"diego-madera",name:"Diego Madera",role:"Compositor  Tema musical",bio:"Msico y compositor cuyo trabajo explora la tensin entre sonido y silencio.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/diego.png",anchor:"#team"},{id:"maria-diana-laura-rodriguez",name:"Mara Diana Laura Rodriguez",role:"Coordinadora",bio:"Productora en lnea que facilita procesos con una disponibilidad impecable.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/placeholder-produccion.jpg",anchor:"#team"}],bridge:{title:"Una lnea que vibra entre ambas historias",description:"CopyCats y Quirn dialogan desde extremos distintos del mismo territorio. Una filma el desgaste creativo y la fractura del proceso;la otra abre una confesin ntima que decide hablar del suicidio sin rodeos.",note:"Dos pelculas, dos vulnerabilidades distintas, un mismo impulso: usar el arte para tocar aquello que no queremos decir en voz alta y encontrar otra manera de contarlo."},screening:{title:"Screening privado  Marzo  Cineteca CECUT",description:"nete al universo transmedial y asegura tu acceso al primer screening doble de CopyCats + Quirn, con conservatorio del equipo.",cta:"Quiero ser parte del screening",footnote:"El cine es otro modo de entrar al encierro. Acompanos en marzo para ver ambas pelculas antes que nadie."},notaAutoral:`Cuando la escena no alcanza,
la cmara recuerda
Quirn, CopyCats,
mismo espacio en otra luz.`},lataza:{label:"EstoNoEsUnaTaza",type:"object-webar",slug:"taza-que-habla",subtitle:"Esta no es una taza. Es un boleto.",intro:"Un objeto cotidiano convertido en smbolo de comunin. Cada taza est vinculada a un sentimiento. Cada sentimiento, a una historia personal.",note:"Apunta tu cmara a la taza. La pista aparecer.",ctaLabel:"Probar activacin WebAR",ctaLink:"/webar/taza/index.html",ctaMessage:"Cuando liberes la activacin WebAR, descubrirs la pista que le corresponde a tu taza.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Merch/taza_h.png",sentiments:["Es tu manera de apoyar la causa social de Gato Encerrado."],phrases:["La taza te habla."],instructions:["Permite el acceso a tu cmara para iniciar.","Coloca la taza completa en cuadro, con buena iluminacin.","Mantn el marcador visible hasta que aparezca la orbe."],comments:[{id:"la-taza-comment-1",quote:"La taza me mostr una frase que me persigui toda la semana.",author:"Usuario annimo"},{id:"la-taza-comment-2",quote:"No entend nada hasta que le agarr el modo.",author:"Sofa B."}],cartaTitle:"#EstoNoEsUnaTaza",notaAutoral:`Una taza que escucha.
Un marcador que mira.
Lo cotidiano tambin es ritual.`},miniversoNovela:{label:"Miniverso Novela",type:"blog-series",slug:null,intro:"Aqu se cruzan la autoficcin, la novela grfica y las vidas que an no caben en escena. Fragmentos, procesos y pistas que solo existen cuando alguien las lee.",cartaTitle:"#PginaViva",notaAutoral:`La palabra devolvi lo que el gato se trag:
Mi Gato Encerrado
se cuenta a s misma.`,entries:[{id:"compra-libro",title:"Edicin fsica",description:"La novela completa en su versin impresa. Incluye QR secreto.",image:"/assets/edicion-fisica.png",type:"purchase-link",url:"/comprar-novela"},{id:"novel-apps",title:"Activa tu novela",description:"Cada formato tiene su propia app interactiva. La novela de autoficcin ya se puede activar; el cmic transmedia abre pronto su lector con pistas y capas expandidas.",type:"novel-apps",apps:[{id:"autoficcion-app",name:"Lector interactivo",description:"Lee los primeros fragmentos de la novela y desbloquea preguntas guiadas en cuatro planos de lectura: acadmico, psicolgico, narrativo y teatral.",snippet:{tagline:"Contraportada transmedial",text:"Al escanear el QR de tu ejemplar se desbloquean lecturas personalizadas. Aqu puedes probar una versin de inicio.",sideLayout:!0},ctaLabel:"Leer fragmentos",ctaAction:"openAutoficcionPreview"}]},{id:"comentarios-lectores",title:"Conversaciones con lectores",type:"quotes",quotes:[{quote:"No saba que un libro poda hablarme a mitad de la pgina.",author:"Lectora annima"}]}],ctaLabel:"Leer los primeros fragmentos"},miniversoSonoro:{label:"Miniverso Sonoro  Suea en Tres Capas",type:"audio-dream",intro:"Este miniverso mezcla imgenes errantes, pistas sonoras y palabras mviles para que crees tu propia atmsfera. Solo entra, prende un video, ponle la msica que quieras, elige un poema y deja que la combinacin te sorprenda.",highlights:["Video que fluye solo.","Msica que t eliges.","Poemas que respiran en pantalla."],exploration:["El video corre por su cuenta  cambia con cada visita.","T eliges la msica  ajusta el nimo del sueo.","Escoge un poema  y observa cmo se desliza mientras todo ocurre."],closing:["Cada combinacin abre un sueo distinto.","Entra y crea el tuyo."],videoUrl:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Sonoridades/videos-v/Vacio.mov",musicOptions:[{id:"silencio",label:"Silencio",url:""},{id:"ensayo-abierto",label:"Ensayo Abierto (pista)",url:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/Sonoridades/audio/cat_theme.m4a"}],poems:[{id:"pulmon",label:"Poema 1  Pulmn",text:"La noche se abre como un pulmn cansado."},{id:"cuerpo",label:"Poema 2  Cuerpo",text:"Lo que cae del sueo tambin cae del cuerpo."}],cartaTitle:"#SueoEnCapas",notaAutoral:`suea una imagen.
Elige un pulso.
Deja que el poema respire por ti.`},miniversoGrafico:{label:"Miniverso Grfico",type:"graphic-lab",intro:"Coleccin viva de exploraciones visuales: cmics en curso, vietas interactivas, posters simblicos, caricaturas conceptuales, murales colaborativos y avances con IA/tcnicas mixtas.",cartaTitle:"#FronteraAbierta",notaAutoral:"Lo grfico como portal emocional. Cada pieza es un disparo breve a la herida o a la curiosidad, nunca un catlogo plano.",collection:["Cmics en curso y por venir","Vietas interactivas","Posters simblicos","Caricaturas conceptuales","Murales colaborativos","Avances con IA y tcnicas mixtas"],swipe:{title:"Swipe narrativo (modo vieta)",description:"Haz scroll hacia arriba para navegar por tarjetas verticales.",steps:["Cada tarjeta revela una escena, una decisin o una herida.","Desliza y elige: quieres ver lo que pasa o lo que duele?"]},upcoming:{title:"Prximamente  Lector Visual Interactivo",points:["Escanea la edicin impresa o digital.","Desbloquea vietas ocultas.","Escucha dilogos no escuchados.","Activa capas simblicas."]},quote:{text:"El cmic me habl justo cuando dudaba de seguir leyendo.",author:"Lectora annima"},ctas:{primary:"Explora el miniverso grfico",secondary:"Smate a la residencia grfica"}}},Sl=({showcaseId:n,title:e,description:t,buttonLabel:s})=>{const{user:r}=Ny(),[i,o]=A.useState("idle"),a=A.useCallback(async()=>{if(i==="loading")return;o("loading");const{success:c,error:u}=await d7({showcaseId:n,user:r});if(!c){console.error("[ShowcaseReaction] Error guardando like:",u),Ae({description:"No pudimos registrar el like. Intenta de nuevo ms tarde."}),o("idle");return}o("success"),Ae({description:"Gracias por tu apoyo en este showcase."})},[n,i,r]);return f.jsxs("div",{className:"mt-4 flex flex-col gap-3 rounded-2xl border border-white/10 bg-black/20 p-4",children:[f.jsxs("div",{className:"flex items-center justify-between gap-3",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-[0.6rem] uppercase tracking-[0.35em] text-slate-500",children:e}),f.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:t})]}),f.jsx("button",{type:"button",onClick:a,className:`rounded-full p-3 transition ${i==="success"?"bg-gradient-to-r from-pink-500 via-rose-500 to-yellow-500 shadow-[0_0_25px_rgba(244,114,182,0.6)] text-white border border-transparent":"bg-gradient-to-r from-purple-600/80 to-indigo-600/80 text-white hover:from-purple-500 hover:to-indigo-500"}`,disabled:i==="loading",children:f.jsx(WL,{size:20})})]}),s?f.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-300",children:i==="loading"?"Enviando":s}):null]})},f7=[{id:"miniversos",title:"Miniverso Trgico",description:"La obra como un miniverso dentro del mismo universo que ha generado.",icon:HL,iconClass:"text-purple-300",notaAutoral:"Aqu nunca abaca bien. Por lo menos no hasta el final."},{id:"lataza",title:"Miniverso Taza",description:"Objeto ritual con WebAR. Una excusa para seguir la historia desde lo cotidiano.",icon:UL,iconClass:"text-amber-300",notaAutoral:"Un objeto cotidiano que abri un portal. La Taza no acompaa: revela. Lo que sostiene no es barro, sino vnculo."},{id:"miniversoNovela",title:"Miniverso Novela",description:"El teatro termin, pero algo sigui hablando y de ese eco nace esta autoficcin.",icon:yk,iconClass:"text-emerald-300",notaAutoral:"La novela es donde la escena se desborda. Fragmentos que respiran distinto cuando alguien los lee. Aqu la historia sigue probndose."},{id:"miniversoGrafico",title:"Miniverso Grfico",description:"Coleccin de vietas interactivas, garabatos y smbolos en mutacin.",icon:XL,iconClass:"text-fuchsia-300",notaAutoral:"Lo grfico como portal emocional. Cada pieza se siente antes de entenderse."},{id:"copycats",title:"Miniverso Cine",description:"Filmes que piensan el cuerpo del Gato en clave cinematogrfica.",icon:bk,iconClass:"text-rose-300",notaAutoral:"La cmara mir lo que el teatro no poda sostener. CopyCats cuestiona; Quirn hiere con luz. Este espacio guarda esas miradas."},{id:"miniversoSonoro",title:"Miniverso Sonoro",description:"Capas de imagen, sonido y poema para soar.",icon:KL,iconClass:"text-cyan-300",notaAutoral:"Imagen, msica y palabra en suspensin. Cada mezcla inventa otro nimo. Aqu el sueo se edita solo."},{id:"detodxs",title:"Miniverso Apps",description:"Experiencias digitales que te convierten en cmplice del universo.",icon:wk,iconClass:"text-lime-300",notaAutoral:"Tecnologa como acompaamiento, no como solucin. Experiencias que cuidan, preguntan y extienden la historia cuando nadie est mirando."},{id:"clubdegato",title:"Miniverso Bitcora",description:"Crnicas, expansiones narrativas y debate vivo sobre el universo.",icon:_k,iconClass:"text-indigo-300",notaAutoral:"El rastro vivo del proyecto. Crnicas, ecos, desvos. Donde lo que pasa en escena encuentra su segunda vida."}],GR=[{id:"tratamientos",title:"Tratamientos emocionales",description:"Tu suscripcin asigna hasta 6 sesiones a un joven sin costo para su familia. Isabel Ayuda para la Vida, A.C. activa las sesiones cuando se detecta riesgo emocional.",icon:qL,metric:"6 sesiones promedio por suscriptor"},{id:"residencias",title:"Residencias creativas",description:"Laboratorios de 2 meses donde arte y acompaamiento reparan memoria y cuerpo. Cada 17 suscripciones financian una residencia completa.",icon:XL,metric:"3 residencias activas por temporada"},{id:"app-escolar",title:"App Causa Social en escuelas",description:"Implementacin y seguimiento semestral de la app de deteccin temprana. 75 suscripciones financian 1 escuela por semestre.",icon:wk,metric:"15 escuelas atendidas cada semestre"}],p7=()=>{const[n,e]=A.useState(!1),[t,s]=A.useState(null),[r,i]=A.useState({}),o=A.useRef(null),[a,c]=A.useState(GR[0].id),[u,d]=A.useState(null),[h,p]=A.useState(null),[m,y]=A.useState(null),[g,w]=A.useState(null),v=A.useRef(null),b=A.useRef(null),[S,E]=A.useState(0),k=Math.max(S-48,320),[T,P]=A.useState(!1),[N,M]=A.useState(!1),[L,O]=A.useState(!1),[D,V]=A.useState(!1),[I,R]=A.useState(!1),[j,F]=A.useState(""),[$,z]=A.useState(""),[B,H]=A.useState(!1),U=A.useRef(null),Y=A.useRef(""),[Q,ge]=A.useState(!1),[Ce,oe]=A.useState(null),[je,Ue]=A.useState({}),{isMobileViewport:ye,canUseInlinePlayback:Be,requestMobileVideoPresentation:Ft}=h7(),X=()=>ye?f.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:f.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-black/70 px-3 py-1 text-[0.65rem] font-semibold uppercase tracking-[0.2em] text-white/80",children:[f.jsx(_k,{size:14}),"Ver video"]})}):null,J=A.useCallback(()=>{e(!0)},[]),le=A.useCallback(()=>{e(!1)},[]),he=A.useCallback(async G=>{const ce=gp[G];if(!(!ce||ce.type==="blog-series"||!ce.slug)){i(Pe=>({...Pe,[G]:{...Pe[G]??{},status:"loading",error:null}}));try{const Pe=await dq(ce.slug);if(!Pe)throw new Error("No encontramos el texto asociado a este miniverso.");i(pr=>({...pr,[G]:{status:"success",post:Pe,error:null}}))}catch(Pe){i(pr=>({...pr,[G]:{status:"error",post:null,error:(Pe==null?void 0:Pe.message)??"Ocurri un error al cargar este showcase."}}))}}},[]),Bt=A.useCallback(G=>{if(gp[G]){s(Pe=>Pe===G?null:G);const ce=gp[G];if(ce.slug&&ce.type!=="blog-series"){const Pe=r[G];(!Pe||Pe.status==="error")&&he(G)}return}J()},[J,he,r]),hs=A.useCallback(G=>{var ce;G&&(window.dispatchEvent(new CustomEvent("gatoencerrado:open-blog",{detail:{slug:G}})),(ce=document.getElementById("dialogo-critico"))==null||ce.scrollIntoView({behavior:"smooth",block:"start"}))},[]),hr=A.useCallback(async G=>{if(G)try{await fetch("http://localhost:3000/api/silvestre",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mensaje:G})})}catch(ce){console.error("[Silvestre Voice] Error sending transcript:",ce),z("No pudimos enviar tu mensaje de voz. Intenta nuevamente ms tarde.")}},[]),qf=A.useCallback(()=>{if(typeof window>"u")return;I?D||V(!0):(V(!0),R(!0));const G=window.SpeechRecognition||window.webkitSpeechRecognition;if(!G){z("Tu navegador no permite activar el micrfono. Puedes escribirle a Silvestre si prefieres."),window.dispatchEvent(new CustomEvent("gatoencerrado:open-silvestre"));return}if(!U.current){const ce=new G;ce.continuous=!0,ce.interimResults=!0,ce.lang="es-MX",ce.maxAlternatives=1,ce.onresult=Pe=>{const Wf=Array.from(Pe.results).map(By=>{var Kf;return((Kf=By[0])==null?void 0:Kf.transcript)??""}).join(" ");Y.current=Wf,F(Wf)},ce.onerror=Pe=>{console.error("[Silvestre Voice] recognition error:",Pe),z("No pudimos acceder al micrfono. Intenta nuevamente."),H(!1)},ce.onend=()=>{H(!1);const Pe=Y.current.trim();Pe&&(hr(Pe),Y.current="")},U.current=ce}if(!B){try{U.current.start(),H(!0),z("")}catch(ce){console.error("[Silvestre Voice] start error:",ce),z("No pudimos abrir el micrfono. Intenta nuevamente.")}window.dispatchEvent(new CustomEvent("gatoencerrado:open-silvestre"))}},[I,B,D,hr]),Oo=A.useCallback((G="#team")=>{const ce=document.querySelector(G);ce&&ce.scrollIntoView({behavior:"smooth",block:"start"})},[]),re=A.useCallback(G=>{G!=null&&G.src&&d({src:G.src,title:G.title??"",description:G.description??""})},[]),De=A.useCallback(()=>{d(null)},[]),Vs=A.useCallback(()=>{var G;(G=b.current)==null||G.scrollIntoView({behavior:"smooth",block:"start"})},[]);A.useCallback(G=>{G!=null&&G.src&&(p({src:G.src,title:G.title??"",description:G.description??""}),y(null),w(null))},[]);const Iu=A.useCallback(()=>{p(null),y(null),w(null)},[]),rS=A.useCallback(()=>{P(!0),typeof window<"u"&&window.matchMedia("(max-width: 768px)").matches?(M(!0),document.body.classList.add("overflow-hidden")):M(!1)},[]),fr=A.useCallback(()=>{P(!1),M(!1),document.body.classList.remove("overflow-hidden")},[]),Fo=A.useCallback(()=>{t&&Ue(G=>({...G,[t]:!G[t]}))},[t]),Ur=A.useCallback(({numPages:G})=>{y(G)},[]),W=t?gp[t]:null,jT=t?je[t]:!1,pt=t?r[t]:null,MT=A.useMemo(()=>{var G;return(G=pt==null?void 0:pt.post)!=null&&G.content?pt.post.content.split(/\n{2,}/).map(ce=>ce.trim()).filter(Boolean):[]},[pt]);A.useEffect(()=>{t&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"start"})},[t]),A.useEffect(()=>{t&&Ue(G=>({...G,[t]:!1}))},[t]),A.useEffect(()=>{t!=="copycats"&&(ge(!1),oe(null))},[t]),A.useEffect(()=>{t!=="lataza"&&(P(!1),M(!1),document.body.classList.remove("overflow-hidden"))},[t]),A.useEffect(()=>{if(!u&&!h)return;const G=ce=>{ce.key==="Escape"&&(u&&De(),h&&Iu())};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[u,h,De,Iu]),A.useEffect(()=>{if(!h)return;const G=()=>{v.current&&E(v.current.offsetWidth)};return G(),window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[h]),A.useEffect(()=>()=>{document.body.classList.remove("overflow-hidden")},[]),A.useEffect(()=>()=>{var G,ce;(ce=(G=U.current)==null?void 0:G.abort)==null||ce.call(G),U.current=null},[]);const q3=G=>{Ae({description:G||"Muy pronto liberaremos la activacin WebAR de este objeto."})},LT=A.useCallback(async()=>{var G;if(typeof navigator>"u"||!((G=navigator.mediaDevices)!=null&&G.getUserMedia)){Ae({description:"Tu dispositivo no permite abrir la cmara desde el navegador."});return}try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}}})).getTracks().forEach(Pe=>Pe.stop()),Ae({description:"Listo. En la versin final validaremos el QR con geolocalizacin para redimir tu ejemplar."})}catch(ce){console.error("Error al acceder a la cmara:",ce),Ae({description:"No pudimos acceder a la cmara. Revisa los permisos e intntalo de nuevo."})}},[]),W3=A.useCallback(G=>{if(G){if(G.ctaUrl){window.open(G.ctaUrl,"_blank","noopener,noreferrer");return}if(G.ctaAction==="openCamera"){LT();return}if(G.ctaAction==="openAutoficcionPreview"){O(!0);return}Ae({description:G.ctaMessage||"Muy pronto liberaremos esta app interactiva."})}},[LT]),IT=()=>{if(!(W!=null&&W.notaAutoral))return null;const G=W.type==="tragedia",ce=G?"rounded-2xl border border-purple-400/60 bg-purple-900/20 p-4 text-sm text-slate-100 shadow-[0_0_25px_rgba(168,85,247,0.45),0_0_55px_rgba(109,40,217,0.32)]":"rounded-2xl border border-purple-300/45 p-6 bg-black/30 text-slate-300/80 text-sm leading-relaxed shadow-[0_0_22px_rgba(168,85,247,0.32),0_0_42px_rgba(59,130,246,0.18),0_20px_65px_rgba(0,0,0,0.45)]",Pe=G?"text-xs uppercase tracking-[0.35em] text-slate-400 underline-offset-4 hover:text-white":"text-xs uppercase tracking-[0.35em] text-slate-400/80 underline-offset-4 hover:text-white";return f.jsxs("div",{className:`${G?"space-y-3 pt-4":"space-y-3 mt-4"}`,children:[f.jsx("button",{type:"button",className:Pe,onClick:Fo,children:jT?"Ocultar Verso del Autor":"Mostrar Verso del Autor"}),jT?f.jsxs(se.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.35,ease:"easeOut"},className:ce,children:[f.jsx("div",{className:"mb-2 space-y-1",children:f.jsx("p",{className:`text-xs uppercase tracking-[0.35em] ${G?"text-purple-200":"text-purple-300"}`,children:W.cartaTitle||"Nota autoral"})}),f.jsx("p",{className:"leading-relaxed whitespace-pre-line",children:W.notaAutoral})]},t):null]})},DT=(G="Pronto liberaremos la carta completa de este miniverso.")=>W!=null&&W.slug?(pt==null?void 0:pt.status)==="loading"?f.jsx("p",{className:"text-slate-400 text-sm",children:"Cargando la carta que acompaa a este miniverso"}):(pt==null?void 0:pt.status)==="error"?f.jsx("p",{className:"text-red-300 text-sm",children:pt.error}):(pt==null?void 0:pt.status)==="success"&&pt.post?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-slate-400 mb-4",children:[pt.post.author?f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(N1,{size:16}),pt.post.author,pt.post.author_role?f.jsxs("span",{className:"text-slate-500",children:["/ ",pt.post.author_role]}):null]}):null,pt.post.published_at?f.jsx("span",{children:new Date(pt.post.published_at).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}):null]}),f.jsx("h4",{className:"font-display text-2xl text-slate-100 mb-6",children:pt.post.title}),f.jsx("div",{className:"space-y-5 text-slate-200 leading-relaxed font-light",children:MT.length===0?f.jsx("p",{children:"Muy pronto abriremos el expediente completo de este miniverso. Gracias por tu curiosidad."}):MT.map((ce,Pe)=>f.jsx("p",{children:ce},Pe))})]}):f.jsx("p",{className:"text-slate-400 text-sm",children:G}):null,K3=()=>{var ce,Pe,pr,Wf,By,Kf,OT,FT,BT,$T,zT,VT,UT,HT,GT,qT,WT,KT,XT,YT,QT,JT,ZT,eP,tP,nP,sP,rP,iP,oP,aP,lP,cP;if(!W)return f.jsx("p",{className:"text-slate-400 text-sm",children:"Selecciona un miniverso para explorar su carta y materiales."});if(W.type==="object-webar"){const we=`${t??"object-webar"}-video`;return f.jsxs("div",{className:"grid gap-10 lg:grid-cols-[2fr_1fr]",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"rounded-3xl border border-white/10 overflow-hidden bg-black/30",children:t==="lataza"&&T&&!N?f.jsx("div",{className:"p-0 sm:p-4",children:f.jsx(VR,{targetSrc:"/webar/taza/taza.mind",phrases:W.phrases,onExit:fr})}):f.jsxs(f.Fragment,{children:[/\.mp4($|\?)/i.test(W.image)?f.jsxs("div",{className:"relative",children:[ye?f.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/25 via-transparent to-black/55"}):null,X(),f.jsx("video",{src:W.image,className:"w-full h-64 object-cover bg-black/50",autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:Be(we),onClick:Oe=>Ft(Oe,we),poster:W.imagePoster})]}):f.jsx("img",{src:W.image,alt:"Ilustracin de La Taza",className:"w-full h-64 object-cover bg-black/50"}),f.jsxs("div",{className:"p-6 space-y-3",children:[f.jsx("p",{className:"text-sm text-slate-400 uppercase tracking-[0.3em]",children:W.note}),W.instructions?f.jsx("ul",{className:"text-sm text-slate-300/90 space-y-2",children:W.instructions.map((Oe,ue)=>f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"text-purple-300 mt-1",children:""}),f.jsx("span",{children:Oe})]},ue))}):null,t==="lataza"?f.jsx(xe,{className:"border-purple-400/40 text-purple-200 hover:bg-purple-500/10",variant:"outline",onClick:rS,children:W.ctaLabel}):W.ctaLink?f.jsx("a",{href:W.ctaLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-full border border-purple-400/40 text-purple-200 hover:bg-purple-500/10 px-6 py-2 font-semibold",children:W.ctaLabel}):f.jsx(xe,{variant:"outline",className:"border-purple-400/40 text-purple-200 hover:bg-purple-500/10",onClick:()=>q3(W.ctaMessage),children:W.ctaLabel})]})]})}),W.sentiments?f.jsxs("div",{className:"rounded-2xl border border-white/10 p-6 bg-black/30",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70 mb-4",children:"Sentimientos vinculados"}),f.jsx("ul",{className:"space-y-3 text-slate-300/80 text-sm leading-relaxed",children:W.sentiments.map((Oe,ue)=>f.jsxs("li",{children:[" ",Oe]},ue))})]}):null]}),f.jsx("div",{className:"space-y-6",children:W.comments?f.jsxs("div",{className:"rounded-2xl border border-white/10 p-6 bg-black/30 space-y-6",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70 mb-0",children:"Comentarios de la comunidad"}),f.jsx("div",{className:"space-y-4",children:W.comments.map(Oe=>f.jsxs("div",{className:"rounded-xl border border-white/5 p-4 bg-black/20",children:[f.jsx("p",{className:"text-slate-100 font-light mb-2",children:Oe.quote}),f.jsx("p",{className:"text-xs text-slate-500",children:Oe.author})]},Oe.id))}),t==="lataza"?f.jsx(Sl,{showcaseId:"lataza",description:"Haz clic para guardar un like que conecta a la comunidad alrededor de la taza.",buttonLabel:"Resonar con la taza"}):null]}):null})]})}if(W.type==="audio-dream")return f.jsxs("div",{className:"grid gap-6 lg:gap-10 lg:grid-cols-[2fr_1fr]",children:[f.jsxs("div",{className:"space-y-6 order-1 lg:order-2",children:[f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-4",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Cmo explorar"}),f.jsx("ol",{className:"list-decimal list-inside space-y-3 text-slate-200 text-sm leading-relaxed md:text-base",children:(ce=W.exploration)==null?void 0:ce.map((we,Oe)=>f.jsx("li",{children:we},Oe))})]}),f.jsxs("div",{className:"hidden lg:block space-y-4",children:[f.jsx("div",{className:"rounded-3xl border border-white/10 bg-black/20 p-6 space-y-3 text-sm text-slate-300",children:(Pe=W.closing)==null?void 0:Pe.map((we,Oe)=>f.jsx("p",{children:we},Oe))}),t==="miniversoSonoro"?f.jsx(Sl,{showcaseId:"miniversoSonoro",title:"La voz de quienes escuchan",description:"Comparte tu vibracin y deja un like que resuene en este miniverso.",buttonLabel:"Hacer latir la resonancia"}):null]}),f.jsxs("div",{className:"lg:hidden",children:[f.jsx(HR,{videoUrl:W.videoUrl,videoTitle:W.label,videoArtist:"Residencia #GatoEncerrado",audioOptions:W.musicOptions,poemOptions:W.poems,showHeader:!0,showCTA:!0}),f.jsxs("div",{className:"mt-4 space-y-4",children:[f.jsx("div",{className:"rounded-3xl border border-white/10 bg-black/20 p-6 space-y-3 text-sm text-slate-300",children:(pr=W.closing)==null?void 0:pr.map((we,Oe)=>f.jsx("p",{children:we},Oe))}),t==="miniversoSonoro"?f.jsx(Sl,{showcaseId:"miniversoSonoro",title:"La voz de quienes escuchan",description:"Comparte tu vibracin y deja un like que resuene en este miniverso.",buttonLabel:"Hacer latir la resonancia"}):null]})]})]}),f.jsx("div",{className:"hidden lg:flex justify-center px-4 order-2 lg:order-1 lg:px-0",children:f.jsx("div",{className:"w-full max-w-[1100px]",children:f.jsx("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6",children:f.jsx(HR,{videoUrl:W.videoUrl,videoTitle:W.label,videoArtist:"Residencia #GatoEncerrado",audioOptions:W.musicOptions,poemOptions:W.poems,showHeader:!0,showCTA:!0})})})})]});if(W.type==="tragedia")return f.jsx("div",{className:"space-y-10",children:f.jsxs("div",{className:"relative overflow-hidden rounded-[2.5rem] border border-white/10 bg-gradient-to-br from-slate-900/90 via-black/60 to-rose-900/40 shadow-[0_25px_65px_rgba(15,23,42,0.65)]",children:[f.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.15),_transparent_45%)]"}),f.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_bottom,_rgba(15,23,42,0.8),_transparent_65%)]"}),f.jsxs("div",{className:"relative mx-auto grid w-full max-w-[min(100vw-2rem,1100px)] gap-6 p-6 sm:p-8 lg:grid-cols-[3fr_2fr]",children:[f.jsx("div",{className:"space-y-6",children:f.jsxs("div",{className:"space-y-5 rounded-3xl border border-white/10 bg-black/30 p-6 shadow-[0_20px_40px_rgba(0,0,0,0.45)]",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-purple-300",children:"Escaparate"}),f.jsx("h3",{className:"font-display text-3xl leading-tight text-white md:text-4xl",children:W.label}),f.jsx("p",{className:"text-lg text-slate-200/80 leading-relaxed font-light",children:W.intro}),f.jsx("div",{className:"space-y-3",children:(Wf=W.narrative)==null?void 0:Wf.map((we,Oe)=>f.jsx("p",{className:"text-sm text-slate-300/90 leading-relaxed",children:we},`tragico-paragraph-${Oe}`))}),IT()]})}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/40 p-6 space-y-5 shadow-[0_25px_45px_rgba(0,0,0,0.45)]",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400",children:"Conciencia abierta"}),f.jsx("p",{className:"text-sm text-slate-300/90 leading-relaxed",children:W.ctaDescription}),f.jsx(xe,{type:"button",variant:"outline",className:"w-full border border-purple-400/40 text-purple-100 hover:bg-purple-500/10 silvestre-cta",onClick:qf,children:W.ctaLabel}),f.jsx("p",{className:"text-[11px] text-slate-500",children:"La conversacin se abre dentro del universo transmedial (pronto con GPT de Silvestre)."}),D&&!$?f.jsxs("div",{className:"mt-3 rounded-2xl border border-white/10 bg-black/40 p-4 text-sm text-slate-200",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-purple-300",children:"Silvestre quiere escucharte"}),f.jsx("p",{children:"Silvestre quiere escucharte. Dale acceso a tu micrfono para comenzar."})]}):null,$?f.jsxs("div",{className:"mt-3 rounded-2xl border border-red-500/30 bg-red-500/10 p-4 text-sm text-red-100",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-red-300",children:"Sin micrfono"}),f.jsx("p",{children:"Tu navegador no permite activar el micrfono. Puedes escribirle a Silvestre si prefieres."})]}):null,j?f.jsxs("div",{className:"mt-3 rounded-2xl border border-purple-500/40 bg-white/5 p-4 text-sm text-slate-100",children:[f.jsxs("p",{className:"text-xs uppercase tracking-[0.35em] text-purple-300",children:["Transcripcin en vivo",B?" (escuchando...)":""]}),f.jsx("p",{className:"break-words",children:j})]}):null]})]})]})});if(W.type==="graphic-lab")return f.jsxs("div",{className:"grid gap-6 lg:gap-10 lg:grid-cols-[2fr_1fr]",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:(By=W.swipe)==null?void 0:By.title}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:(Kf=W.swipe)==null?void 0:Kf.description}),f.jsx("ul",{className:"space-y-2 text-sm text-slate-200/90 leading-relaxed",children:(FT=(OT=W.swipe)==null?void 0:OT.steps)==null?void 0:FT.map((we,Oe)=>f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"text-purple-300 mt-1",children:""}),f.jsx("span",{children:we})]},`swipe-step-${Oe}`))})]}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/20 p-6 space-y-4",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Coleccin viva"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:(BT=W.collection)==null?void 0:BT.map((we,Oe)=>f.jsx("span",{className:"px-3 py-1 rounded-full border border-white/10 bg-white/5 text-xs text-slate-100",children:we},`collection-pill-${Oe}`))})]}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-r from-slate-900/70 via-black/60 to-fuchsia-900/40 p-6 space-y-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-fuchsia-200/80",children:($T=W.upcoming)==null?void 0:$T.title}),f.jsx("ul",{className:"space-y-2 text-sm text-slate-100 leading-relaxed",children:(VT=(zT=W.upcoming)==null?void 0:zT.points)==null?void 0:VT.map((we,Oe)=>f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"text-fuchsia-200 mt-1",children:""}),f.jsx("span",{children:we})]},`upcoming-point-${Oe}`))})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-4",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Acciones"}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:"Activa el lector visual o smate a la residencia grfica."}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[f.jsx(xe,{onClick:()=>Ae({description:"Muy pronto liberars el lector visual interactivo desde aqu."}),className:"w-full sm:w-auto justify-center bg-gradient-to-r from-purple-600/80 to-fuchsia-500/80 hover:from-purple-500 hover:to-fuchsia-400 text-white",children:(UT=W.ctas)==null?void 0:UT.primary}),f.jsx(xe,{variant:"outline",onClick:()=>Ae({description:"Escrbenos o postula; abriremos la residencia grfica en breve."}),className:"w-full sm:w-auto justify-center border-purple-400/40 text-purple-200 hover:bg-purple-500/10",children:(HT=W.ctas)==null?void 0:HT.secondary})]})]}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Testimonio"}),f.jsx("p",{className:"text-lg text-slate-100 leading-relaxed italic",children:(GT=W.quote)==null?void 0:GT.text}),f.jsx("p",{className:"text-xs text-slate-500",children:(qT=W.quote)==null?void 0:qT.author})]}),t==="miniversoGrafico"?f.jsx(Sl,{showcaseId:"miniversoGrafico",title:"Validacin grfica",description:"Haz clic para dejar un like y seguir curando esta coleccin.",buttonLabel:"Resonar con el trazo"}):null]})]});if(W.type==="cinema"){const we=(()=>{var on;const ae=new Set;return(((on=W.copycats)==null?void 0:on.assets)??[]).filter(He=>{const Mn=(He==null?void 0:He.id)||(He==null?void 0:He.url);return Mn?ae.has(Mn)?!1:(ae.add(Mn),!0):!0})})(),Oe=(()=>{var on;const ae=new Set;return(((on=W.quiron)==null?void 0:on.stills)??[]).filter((He,Mn)=>{const yl=typeof He=="string"?He:(He==null?void 0:He.id)||(He==null?void 0:He.url)||`idx-${Mn}`;return ae.has(yl)?!1:(ae.add(yl),!0)})})();W.tone;const ue=ae=>{if(!(ae!=null&&ae.url))return null;const on=/\.mp4($|\?)/i.test(ae.url),He=(ae==null?void 0:ae.id)||(ae==null?void 0:ae.url);return f.jsxs("div",{className:"rounded-2xl border border-white/10 overflow-hidden bg-black/40",children:[f.jsx("div",{className:"aspect-video w-full bg-black/60",children:on?f.jsxs("div",{className:"relative h-full w-full",children:[ye?f.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/25 via-transparent to-black/55"}):null,X(),f.jsx("video",{src:ae.url,title:ae.label,className:"w-full h-full object-cover",controls:Be(He),onClick:Mn=>Ft(Mn,He),playsInline:!0,preload:"metadata"})]}):f.jsx("iframe",{src:ae.url,title:ae.label,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share",allowFullScreen:!0,loading:"lazy",referrerPolicy:"strict-origin-when-cross-origin"})}),ae.label?f.jsx("div",{className:"px-4 py-3 text-sm text-slate-300 flex items-center justify-between gap-3",children:f.jsx("span",{children:ae.label})}):null]})};return f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-4",children:[f.jsx("div",{className:"flex items-start justify-between gap-3",children:f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Meta-documental"}),f.jsx("h4",{className:"font-display text-xl text-slate-100",children:(WT=W.copycats)==null?void 0:WT.title})]})}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:(KT=W.copycats)==null?void 0:KT.description}),f.jsx("p",{className:"text-sm text-slate-200/90 leading-relaxed",children:(XT=W.copycats)==null?void 0:XT.microcopy}),(QT=(YT=W.copycats)==null?void 0:YT.tags)!=null&&QT.length?f.jsx("div",{className:"flex flex-wrap gap-2",children:W.copycats.tags.map((ae,on)=>f.jsx("span",{className:"px-3 py-1 rounded-full border border-purple-400/30 bg-purple-900/20 text-xs text-purple-100",children:ae},`copycats-tag-${on}`))}):null,we.length?f.jsx("div",{className:"space-y-4",children:we.map(ae=>f.jsx("div",{children:ue(ae)},ae.id))}):null]}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-4",children:[f.jsxs("div",{className:"flex items-start justify-between gap-3",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Cortometraje"}),f.jsx("h4",{className:"font-display text-xl text-slate-100",children:(JT=W.quiron)==null?void 0:JT.title})]}),f.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-rose-300",children:"Teaser + stills"})]}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:(ZT=W.quiron)==null?void 0:ZT.description}),f.jsx("p",{className:"text-sm text-slate-200/90 leading-relaxed",children:(eP=W.quiron)==null?void 0:eP.microcopy}),(tP=W.quiron)!=null&&tP.teaser?f.jsx("div",{children:ue(W.quiron.teaser)}):null,Oe.length?f.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:Oe.map((ae,on)=>{const He=typeof ae=="string"?ae:ae.label||`Still ${on+1}`,Mn=typeof ae=="string"?null:ae.url;return Mn?f.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/10 bg-black/20",children:[f.jsx("div",{className:"aspect-[4/3] bg-black/40",children:f.jsx("img",{src:Mn,alt:He,className:"h-full w-full object-cover",loading:"lazy"})}),f.jsx("p",{className:"px-4 py-3 text-xs uppercase tracking-[0.25em] text-slate-200",children:He})]},ae.id||`quiron-still-${on}`):f.jsx("span",{className:"px-3 py-1 rounded-full border border-white/10 bg-white/5 text-xs text-slate-100",children:He},`quiron-still-pill-${on}`)})}):null]})]}),(nP=W.collaborators)!=null&&nP.length?f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between gap-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-purple-300",children:"Colaboradores"}),f.jsx("button",{type:"button",onClick:()=>ge(ae=>!ae),className:"text-xs uppercase tracking-[0.3em] text-slate-300 hover:text-white transition",children:Q?"Ocultar":"Ver"})]}),Q?f.jsx("div",{className:"space-y-3",children:W.collaborators.map((ae,on)=>{const He=Ce===ae.id,Mn=ae.image||"/images/placeholder-colaboradores.jpg";return f.jsxs("div",{className:"border border-white/10 rounded-2xl bg-black/20",children:[f.jsxs("button",{type:"button",onClick:()=>oe(yl=>yl===ae.id?null:ae.id),className:"w-full flex items-center justify-between gap-3 px-4 py-3 text-left hover:bg-white/5 transition",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("img",{src:Mn,alt:`Retrato de ${ae.name}`,className:"h-12 w-12 rounded-full object-cover border border-white/10",loading:"lazy"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-100 font-semibold",children:ae.name}),ae.role?f.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-purple-300",children:ae.role}):null]})]}),f.jsx("span",{className:"text-slate-400 text-lg",children:He?"":"+"})]}),He?f.jsxs("div",{className:"px-4 pb-4 text-sm text-slate-200/90 leading-relaxed space-y-3",children:[ae.bio?f.jsx("p",{children:ae.bio}):null,f.jsx("button",{type:"button",onClick:()=>Oo(ae.anchor),className:"text-xs uppercase tracking-[0.3em] text-purple-300 hover:text-purple-100 underline underline-offset-4",children:"Ver semblanza"})]}):null]},ae.id||`cinema-collab-${on}`)})}):null]}):null,f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-black/20 p-6 space-y-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Lo que las conecta"}),f.jsx("h4",{className:"font-display text-xl text-slate-100",children:(sP=W.bridge)==null?void 0:sP.title}),f.jsx("p",{className:"text-sm text-slate-200/90 leading-relaxed",children:(rP=W.bridge)==null?void 0:rP.description}),f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:(iP=W.bridge)==null?void 0:iP.note})]}),f.jsxs("div",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-r from-slate-900/80 via-black/60 to-purple-900/40 p-6 space-y-4",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Pantalla 5  CTA final"}),f.jsx("h4",{className:"font-display text-2xl text-slate-100",children:(oP=W.screening)==null?void 0:oP.title}),f.jsx("p",{className:"text-sm text-slate-200/90 leading-relaxed",children:(aP=W.screening)==null?void 0:aP.description}),f.jsx(xe,{onClick:()=>Ae({description:"Guardaremos tu inters; pronto abriremos la lista de suscriptores para el screening doble en CECUT."}),className:"w-full sm:w-auto justify-center bg-gradient-to-r from-purple-600/80 to-indigo-500/80 hover:from-purple-500 hover:to-indigo-400 text-white",children:(lP=W.screening)==null?void 0:lP.cta}),(cP=W.screening)!=null&&cP.footnote?f.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:W.screening.footnote}):null]}),f.jsx("div",{className:"space-y-4",children:f.jsx(Sl,{showcaseId:"copycats",title:"Validacin cinematogrfica",description:"Haz clic para dejar un like y amplificar el screening de CopyCats + Quirn.",buttonLabel:"Sumar mi aplauso"})})]})]})}if(W.type==="blog-series"){const we=W.entries??[],Oe=ue=>{switch(ue.type){case"internal-reading":return ue.previewMode==="pdf"&&ue.previewPdfUrl?f.jsx(xe,{onClick:()=>O(!0),className:"w-full sm:w-auto justify-center",children:"Leer fragmento"}):ue.previewMode==="image"&&ue.previewImage?f.jsx(xe,{onClick:()=>re({src:ue.previewImage,title:ue.title,description:ue.description}),className:"w-full sm:w-auto justify-center",children:"Ver fragmento"}):ue.contentSlug?f.jsx(xe,{onClick:()=>hs(ue.contentSlug),className:"w-full sm:w-auto justify-center",children:"Leer fragmento"}):null;case"purchase-link":return ue.url?f.jsx("a",{href:ue.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex w-full sm:w-auto items-center justify-center rounded-full border border-purple-400/40 text-purple-200 hover:bg-purple-500/10 px-6 py-2 font-semibold transition",children:"Comprar edicin"}):null;case"qr-scan":return f.jsx(xe,{variant:"outline",className:"border-purple-400/40 text-purple-200 hover:bg-purple-500/10 w-full sm:w-auto justify-center",onClick:()=>Ae({title:"Escanea el QR",description:"Abre la cmara de tu dispositivo y apunta al cdigo para activar la experiencia."}),children:"Escanear QR"});default:return null}};return f.jsxs("div",{className:"space-y-10",children:[f.jsx("div",{children:DT()}),we.length>0?f.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:we.map(ue=>{var He,Mn,yl;if(ue.type==="horizontal-gallery")return f.jsxs("div",{className:"md:col-span-2 rounded-2xl border border-white/10 p-6 bg-black/30 space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h5",{className:"font-display text-xl text-slate-100",children:ue.title}),ue.description?f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:ue.description}):null]}),f.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:(He=ue.images)==null?void 0:He.map((_t,$y)=>f.jsx("div",{className:"w-48 h-32 flex-shrink-0 rounded-xl overflow-hidden border border-white/5 bg-black/40",children:f.jsx("img",{src:_t,alt:`${ue.title} ${$y+1}`,className:"w-full h-full object-cover"})},`${ue.id}-${$y}`))})]},ue.id);if(ue.type==="quotes")return f.jsxs("div",{className:"md:col-span-2 rounded-2xl border border-white/10 p-6 bg-black/30 space-y-4",children:[f.jsx("h5",{className:"font-display text-xl text-slate-100",children:ue.title}),f.jsx("div",{className:"space-y-4",children:(Mn=ue.quotes)==null?void 0:Mn.map((_t,$y)=>f.jsxs("blockquote",{className:"text-slate-100 font-light leading-relaxed",children:[f.jsx("p",{children:_t.quote}),_t.author?f.jsx("p",{className:"text-xs text-slate-500 mt-2",children:_t.author}):null]},`${ue.id}-quote-${$y}`))}),f.jsx(Sl,{showcaseId:"miniversoNovela",description:"Haz clic para guardar un like y amplificar las conversaciones que la novela susurra.",buttonLabel:"Apoyar la novela"})]},ue.id);if(ue.type==="novel-apps")return f.jsxs("div",{className:"rounded-2xl border border-white/10 p-6 bg-black/30 space-y-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h5",{className:"font-display text-xl text-slate-100",children:ue.title}),ue.description?f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:ue.description}):null]}),f.jsx("div",{className:"grid gap-4 grid-cols-1",children:(yl=ue.apps)==null?void 0:yl.map(_t=>f.jsxs("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4 flex flex-col gap-4",children:[f.jsxs("div",{className:"flex items-center justify-between gap-4",children:[f.jsx("p",{className:"font-semibold text-slate-100",children:_t.name}),f.jsx("span",{className:`text-xs uppercase tracking-[0.3em] ${_t.status==="Disponible"?"text-emerald-300":"text-slate-500"}`,children:_t.status})]}),f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:_t.description}),_t.snippet?f.jsxs("div",{className:"rounded-xl border border-white/10 bg-slate-900/60 p-4 space-y-2",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-300",children:_t.snippet.tagline}),_t.snippet.image?f.jsx("img",{src:_t.snippet.image,alt:_t.name,className:"w-full h-32 object-cover rounded-lg border border-white/5"}):null,_t.snippet.text?f.jsx("p",{className:"text-sm text-slate-200/90 leading-relaxed",children:_t.snippet.text}):null]}):null,f.jsx(xe,{onClick:()=>W3(_t),variant:_t.status==="Disponible"?"default":"outline",className:`w-full justify-center ${_t.status==="Disponible"?"bg-purple-600/80 hover:bg-purple-600 text-white":"border-purple-400/40 text-purple-200 hover:bg-purple-500/10"}`,children:_t.ctaLabel})]},_t.id))})]},ue.id);const ae=ue.previewImage||ue.image,on=Oe(ue);return f.jsxs("div",{className:"rounded-2xl border border-white/10 p-6 bg-black/30 space-y-4",children:[ae?f.jsx("div",{className:"rounded-xl overflow-hidden border border-white/5 bg-black/40 h-52 sm:h-64",children:f.jsx("img",{src:ae,alt:ue.title,className:"w-full h-full object-cover",loading:"lazy"})}):null,f.jsxs("div",{className:"space-y-2",children:[f.jsx("h5",{className:"font-display text-xl text-slate-100",children:ue.title}),ue.description?f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:ue.description}):null]}),on]},ue.id)})}):f.jsx("p",{className:"text-sm text-slate-400",children:"Muy pronto liberaremos el resto de la serie."})]})}const G=W.videos??[];return f.jsxs("div",{className:"space-y-10",children:[f.jsx("div",{children:DT("Pronto liberaremos la carta completa de este miniverso. Mientras tanto puedes explorar la galera audiovisual.")}),G.length>0?f.jsxs("div",{children:[f.jsx("h5",{className:"font-display text-xl text-slate-100 mb-4",children:"Galera audiovisual"}),f.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:G.map((we,Oe)=>{const ue=we.id||we.url||`video-${Oe}`;return f.jsxs("div",{className:"rounded-2xl border border-white/10 overflow-hidden bg-black/40 flex flex-col",children:[f.jsx("div",{className:"relative aspect-video w-full",children:/\.mp4($|\?)/i.test(we.url)?f.jsxs(f.Fragment,{children:[ye?f.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/25 via-transparent to-black/55"}):null,X(),f.jsx("video",{src:we.url,title:we.title,className:"w-full h-full object-cover bg-black",controls:Be(ue),onClick:ae=>Ft(ae,ue),playsInline:!0,preload:"metadata",poster:we.poster})]}):f.jsx("iframe",{src:we.url,title:we.title,className:"w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})}),f.jsxs("div",{className:"p-4 space-y-1 text-sm text-slate-300",children:[f.jsx("p",{className:"font-semibold text-slate-100",children:we.title}),we.author?f.jsx("p",{children:we.author}):null,we.duration?f.jsxs("p",{className:"text-slate-500",children:["Duracin: ",we.duration]}):null]})]},we.id||we.url||`video-${Oe}`)})})]}):null,t==="copycats"?f.jsx(Sl,{showcaseId:"copycats",description:"Guarda un like que celebra las miradas que quedarn en escena.",title:"Opiniones despus del corte"}):null]})};return f.jsxs(f.Fragment,{children:[f.jsxs("section",{id:"transmedia",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-16 space-y-6",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70",children:"Universo Transmedia"}),f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium text-gradient italic",children:"Miniversos que sostienen la causa"}),f.jsxs("p",{className:"text-lg text-slate-300/80 max-w-3xl mx-auto leading-relaxed font-light",children:["#GatoEncerrado es un universo transmedial compuesto por miniversos narrativos. Cada experiencia digital, objeto o narrativa expandida financia el acompaamiento psicoemocional de"," ",f.jsx("button",{type:"button",onClick:Vs,className:"text-purple-200 underline underline-offset-4 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-400 rounded-sm",children:"Isabel Ayuda para la Vida, A.C."})]})]}),f.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:f7.map((G,ce)=>{const Pe=G.icon,pr=G.iconClass??"text-purple-200";return f.jsxs(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:ce*.1,ease:"easeOut"},viewport:{once:!0},className:"group glass-effect rounded-xl p-8 hover-glow cursor-pointer flex flex-col transition-all duration-300 hover:border-purple-400/50",onClick:()=>Bt(G.id),children:[f.jsx("div",{className:"flex items-center justify-start mb-6 transition-all duration-300 group-hover:scale-110",children:f.jsx(Pe,{size:32,className:`${pr} drop-shadow-[0_0_12px_rgba(168,85,247,0.4)]`})}),f.jsx("h3",{className:"font-display text-2xl font-medium text-slate-100 mb-3",children:G.title}),f.jsx("p",{className:"text-slate-300/70 text-base leading-relaxed mb-4 flex-grow font-light",children:G.description}),f.jsxs("div",{className:"text-purple-300 flex items-center gap-2 font-semibold transition-all duration-300 group-hover:gap-3",children:["Explorar",f.jsx(v$,{size:18})]})]},G.id)})}),W?f.jsxs(se.div,{ref:o,initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"mt-12 glass-effect rounded-2xl p-8 md:p-12 border border-white/10",children:[f.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[f.jsx("div",{children:W.type!=="tragedia"?f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70 mb-2",children:"Showcase"}),f.jsx("h3",{className:"font-display text-3xl text-slate-100 mb-3",children:W.label}),f.jsx("p",{className:"text-slate-300/80 leading-relaxed font-light max-w-3xl",children:W.intro}),IT()]}):null}),f.jsx("button",{onClick:()=>s(null),className:"text-sm text-slate-400 hover:text-white transition self-start md:self-auto",children:"Cerrar showcase "})]}),f.jsx("div",{className:"mt-8",children:K3()})]}):null,f.jsxs("div",{className:"mt-16 grid lg:grid-cols-[3fr_2fr] gap-10",children:[f.jsxs(se.div,{ref:b,initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.2,ease:"easeOut"},viewport:{once:!0},className:"glass-effect rounded-2xl p-8 md:p-10 flex flex-col justify-between",children:[f.jsxs("div",{className:"space-y-5",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/80",children:"Apoya el proyecto"}),f.jsx("h3",{className:"font-display text-3xl text-slate-100",children:"Nuestro impacto crece contigo"}),f.jsxs("p",{className:"text-slate-300/80 leading-relaxed font-light",children:["La taquilla mantiene la obra en escena; el universo transmedia financia acompaamiento emocional real. Cada cuota se distribuye en tres frentes que opera Isabel Ayuda para la Vida, A.C."," ",f.jsx("a",{href:"https://www.ayudaparalavida.com/index.html",target:"_blank",rel:"noreferrer",className:"text-purple-200 underline underline-offset-4 hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-400 rounded-sm",children:"Visita su sitio"})]}),f.jsx("div",{className:"mt-4 space-y-3",children:GR.map(G=>{const ce=G.icon,Pe=a===G.id;return f.jsxs("div",{className:"border border-white/10 rounded-2xl bg-black/20 overflow-hidden transition",children:[f.jsxs("button",{type:"button",onClick:()=>c(pr=>pr===G.id?null:G.id),className:"w-full flex items-center justify-between gap-4 px-4 py-3 text-left hover:bg-white/5 transition",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 rounded-full bg-purple-500/15 text-purple-200",children:f.jsx(ce,{size:18})}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-slate-100",children:G.title}),f.jsx("p",{className:"text-xs text-slate-400",children:G.metric})]})]}),f.jsx("span",{className:"text-xs uppercase tracking-[0.35em] text-slate-500",children:Pe?"Ocultar":"Ver impacto"})]}),Pe?f.jsx("div",{className:"px-4 pb-4 text-sm text-slate-300/90",children:G.description}):null]},G.id)})})]}),f.jsxs("div",{className:"mt-8 flex flex-col gap-4 md:flex-row md:items-center",children:[f.jsx(xe,{onClick:J,variant:"ghost",className:"text-purple-200 hover:text-white hover:bg-white/10 justify-start md:justify-center",children:" Ver miniversos activos"}),f.jsxs("div",{className:"flex items-center gap-3 text-slate-400 text-sm",children:[f.jsx(qL,{size:20,className:"text-purple-300"}),f.jsx("span",{children:"Tu suscripcin = Apoyo directo"})]})]})]}),f.jsx(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.3,ease:"easeOut"},viewport:{once:!0},className:"glass-effect rounded-2xl p-6 border border-white/10 bg-slate-950/50 shadow-2xl",children:f.jsx(cq,{})})]})]})]}),f.jsx(aq,{open:n,onClose:le}),h?f.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-10",children:[f.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:Iu}),f.jsxs("div",{className:"relative z-10 w-full max-w-5xl space-y-4",children:[f.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70",children:"Lectura en progreso"}),f.jsx("h4",{className:"font-display text-2xl text-slate-100",children:h.title||"Fragmento en PDF"}),h.description?f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed max-w-2xl",children:h.description}):null]}),f.jsx("button",{type:"button",onClick:Iu,className:"self-start rounded-full border border-white/10 px-4 py-2 text-sm text-slate-300 hover:text-white hover:border-white/30 transition",children:"Cerrar "})]}),f.jsx("div",{ref:v,className:"rounded-3xl border border-white/10 bg-slate-950/95 shadow-2xl p-4 max-h-[75vh] overflow-auto",children:g?f.jsx("p",{className:"text-sm text-red-300 text-center py-8",children:g}):f.jsx(D9,{file:h.src,onLoadSuccess:Ur,onLoadError:G=>{console.error("Error al cargar PDF del miniverso:",G),w("No pudimos cargar el fragmento en PDF. Intenta de nuevo ms tarde.")},loading:f.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Preparando pginas"}),children:m?Array.from(new Array(m),(G,ce)=>f.jsx("div",{className:"mb-6 last:mb-0",children:f.jsx(W9,{pageNumber:ce+1,width:k,renderTextLayer:!1,renderAnnotationLayer:!1})},`pdf-page-${ce+1}`)):null})})]})]}):null,u?f.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-10",children:[f.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:De}),f.jsxs("div",{className:"relative z-10 w-full max-w-3xl",children:[f.jsx("div",{className:"flex justify-end mb-4",children:f.jsx("button",{type:"button",onClick:De,className:"rounded-full border border-white/10 px-4 py-2 text-sm text-slate-300 hover:text-white hover:border-white/30 transition",children:"Cerrar "})}),f.jsxs("div",{className:"rounded-3xl border border-white/10 bg-slate-950/95 shadow-2xl overflow-hidden",children:[f.jsx("div",{className:"bg-black/60",children:f.jsx("img",{src:u.src,alt:u.title||"Vista previa",className:"w-full h-auto"})}),u.title||u.description?f.jsxs("div",{className:"p-6 space-y-2",children:[u.title?f.jsx("h4",{className:"font-display text-2xl text-slate-100",children:u.title}):null,u.description?f.jsx("p",{className:"text-sm text-slate-300/80 leading-relaxed",children:u.description}):null,f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-500",children:"Ilustracin de la novela"})]}):null]})]})]}):null,T&&N?f.jsx("div",{className:"fixed inset-0 z-40 bg-black",children:f.jsx(VR,{targetSrc:"/webar/taza/taza.mind",phrases:gp.lataza.phrases,onExit:fr})}):null,L&&f.jsx("div",{className:"fixed inset-0 z-[200] overflow-auto bg-black/80 backdrop-blur-xl p-6",children:f.jsxs("div",{className:"max-w-3xl mx-auto",children:[f.jsx("button",{onClick:()=>O(!1),className:"text-slate-300 hover:text-white mb-6",children:"Cerrar "}),f.jsx(u7,{})]})})]})},_l=[{id:"obra_escenica",icon:f.jsx(HL,{size:20,className:"text-purple-300"}),title:"La Obra - Es un Gato Encerrado",description:`De la escena brot el universo:
voz, trance y cuerpo
abriendo portales.`},{id:"miniverso_novela",icon:f.jsx(yk,{size:20,className:"text-emerald-300"}),title:"Miniverso Novela",description:`La palabra devolvi lo que el gato se trag:
Mi Gato Encerrado
 se cuenta a s misma.`},{id:"taza",icon:f.jsx(UL,{size:20,className:"text-amber-300"}),title:"Miniverso Taza",description:`Una taza que escucha.
Un marcador que mira.
Lo cotidiano tambin es ritual.`},{id:"cine",icon:f.jsx(bk,{size:20,className:"text-rose-300"}),title:"Miniverso Cine",description:`Cuando la escena no alcanza,
la cmara recuerda
Quirn, CopyCats,
mismo espacio en otra luz.`},{id:"apps",icon:f.jsx(wk,{size:20,className:"text-lime-300"}),title:"Miniverso Apps",description:`Pantallas que acompaan.
Tecnologas que cuidan.
Aqu sigues el universo,
sin salir del tuyo.`},{id:"sonoro",icon:f.jsx(KL,{size:20,className:"text-cyan-300"}),title:"Miniverso Sonoro",description:`Suea una imagen.
Elige un pulso.
Deja que el poema respire por ti.`},{id:"bitacora",icon:f.jsx(_k,{size:20,className:"text-indigo-300"}),title:"Miniverso Bitcora",description:`Crnicas que laten.
Pistas que se desdoblan.
La vida y la muerte conversan aqu.`},{id:"otro",icon:f.jsx(L$,{size:20,className:"text-fuchsia-300"}),title:"Otra contribucin",description:"Performance, glitch sonoro o investigacin hbrida. Tambin cabe aqu."}],m7={hidden:{opacity:0},visible:{opacity:.85}},g7={hidden:{opacity:0,y:40,scale:.96},visible:{opacity:1,y:0,scale:1,transition:{duration:.35,ease:"easeOut"}},exit:{opacity:0,y:20,scale:.97,transition:{duration:.2,ease:"easeIn"}}},Tv={name:"",email:"",role:"",proposal:"",attachmentUrl:""},g_="gatoencerrado-contrib-form",qR=new Set(["apps","bitacora","sonoro"]),y7={obra_escenica:"Si la Obra te toc, este espacio es tuyo.",miniverso_novela:"Si encontraste algo tuyo entre estas pginas, djalo dicho.",taza:"Qu historia se activ cuando tomaste la taza? Escrbela aqu.",cine:"Qu imagen te persigui despus? Cuntanos qu viste ms all de la pantalla.",apps:"Cmo cambi tu forma de jugar o explorar este universo?",bitacora:"Comparte qu mezcla soaste: qu viste, qu escuchaste, qu palabras eligieron.",otro:"Si no cabe en un miniverso es porque an no lo hemos nombrado.",sonoro:"Comparte qu mezcla soaste: qu viste, qu escuchaste, qu palabras eligieron."},v7=({open:n,onClose:e})=>{const{user:t}=Ny(),s=!!(t!=null&&t.email),r=A.useMemo(()=>{var X,J;return((X=t==null?void 0:t.user_metadata)==null?void 0:X.alias)||((J=t==null?void 0:t.user_metadata)==null?void 0:J.full_name)||""},[t]),i=(t==null?void 0:t.email)??"",o=r||(i?i.split("@")[0]:""),[a,c]=A.useState(Tv),[u,d]=A.useState("idle"),[h,p]=A.useState(""),[m,y]=A.useState(_l[0]),[g,w]=A.useState(!1),[v,b]=A.useState(!1),[S,E]=A.useState([]),[k,T]=A.useState(!1),[P,N]=A.useState(!1),[M,L]=A.useState(()=>typeof window>"u"?!1:window.matchMedia("(min-width: 768px)").matches),[O,D]=A.useState(()=>typeof window>"u"?!1:window.matchMedia("(max-width: 767px)").matches),V=A.useRef(null),I=A.useRef(null),[R,j]=A.useState(!1),F=s||g;A.useEffect(()=>{if(typeof window>"u")return;const X=tT(g_);if(X)try{const J=JSON.parse(X);V.current=J,c(he=>({...he,...J.formState})),w(!!J.notifyOnPublish);const le=_l.find(he=>he.id===J.selectedCategory);le&&y(le)}catch{V.current=null}j(!0)},[]),A.useEffect(()=>{if(!(!n||!R)){if(!V.current)c({...Tv,name:s?o:"",email:s?i:""}),w(s),y(_l[0]),b(!1);else{const X=V.current.formState??Tv;c({...X});const J=V.current.notifyOnPublish;w(typeof J=="boolean"?J:s);const le=_l.find(he=>he.id===V.current.selectedCategory);le&&y(le),b(!0)}d("idle"),p("")}},[n,s,R]),A.useEffect(()=>{!n||!s||c(X=>{var J;return{...X,name:(J=X.name)!=null&&J.trim()?X.name:o,email:i||X.email}})},[n,s,o,i]),A.useEffect(()=>{if(!n)return;const X=J=>{J.key==="Escape"&&(e==null||e())};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[n,e]),A.useEffect(()=>{if(typeof window>"u")return;const X=window.matchMedia("(min-width: 768px)"),J=window.matchMedia("(max-width: 767px)"),le=Bt=>{L(Bt.matches)},he=Bt=>{D(Bt.matches)};return L(X.matches),D(J.matches),X.addEventListener?(X.addEventListener("change",le),J.addEventListener("change",he)):(X.addListener(le),J.addListener(he)),()=>{X.removeEventListener?(X.removeEventListener("change",le),J.removeEventListener("change",he)):(X.removeListener(le),J.removeListener(he))}},[]),A.useEffect(()=>{s&&T(!1)},[s]);const $=A.useCallback(X=>{const{name:J,value:le}=X.target;s&&J==="email"||c(he=>({...he,[J]:le}))},[s]),z=A.useCallback(()=>{T(!1)},[]),B=A.useCallback(()=>{N(!0),setTimeout(()=>N(!1),420)},[]),H=A.useCallback(()=>{if(typeof window>"u")return;const X=window.AudioContext||window.webkitAudioContext;if(!X)return;const J=new X,le=J.createOscillator(),he=J.createGain();le.type="sine",le.frequency.value=720,he.gain.value=.03,le.connect(he),he.connect(J.destination),le.start(),le.stop(J.currentTime+.1),le.onended=()=>{J.close()}},[]),U=A.useCallback(()=>{I.current||(I.current=setTimeout(()=>{T(!0),I.current=null},520))},[]),Y=A.useCallback(X=>{if(B(),H(),setTimeout(H,140),!s){U();return}w(X.target.checked)},[B,H,s,U]);A.useEffect(()=>{if(typeof window>"u")return;const X={formState:a,notifyOnPublish:g,selectedCategory:m.id};Rm(g_,JSON.stringify(X)),V.current=X},[a,g,m]),A.useEffect(()=>()=>{I.current&&clearTimeout(I.current)},[]);const Q=A.useCallback(()=>{const X=Date.now();E(J=>[...J,X]),setTimeout(()=>{E(J=>J.filter(le=>le!==X))},1100)},[]),ge=A.useCallback(()=>{u!=="loading"&&(e==null||e(),!(typeof document>"u")&&setTimeout(()=>{var X;(X=document.querySelector("#transmedia"))==null||X.scrollIntoView({behavior:"smooth",block:"start"})},80))},[e,u]),Ce=A.useCallback(async X=>{var J;if(X.preventDefault(),u!=="loading"){if(!a.name.trim()||!a.email.trim()||!a.proposal.trim()){Ae({description:"Completa tu nombre, correo y una breve propuesta."});return}if(g&&!s){Ae({description:"Inicia sesin para recibir la notificacin personalizada."});return}if(!s){Ae({description:"Inicia sesin para enviar tu propuesta."}),U();return}d("loading"),p("");try{const le=(m==null?void 0:m.id)??"obra_escenica",he={name:a.name.trim(),email:a.email.trim().toLowerCase(),role:a.role.trim()||null,topic:le,proposal:a.proposal.trim(),attachment_url:a.attachmentUrl.trim()||null,notify_on_publish:g},{error:Bt}=await nt.from("blog_contributions").insert(he);if(Bt){console.error("[ContributionModal] Error al registrar propuesta:",Bt),d("error"),p((J=Bt.message)!=null&&J.includes("blog_contributions")?"Asegrate de crear la tabla blog_contributions en Supabase.":"No pudimos registrar tu propuesta. Intenta nuevamente.");return}try{const hs={author_email:he.email,author_name:he.name,category:le,content:he.proposal,meta:{origin:"public_site"}},{error:hr}=await nt.from("backstage_contributions").insert(hs);hr&&console.error("[ContributionModal] No se pudo duplicar en backstage_contributions:",hr)}catch(hs){console.error("[ContributionModal] Excepcin duplicando en backstage_contributions:",hs)}a.email.trim()&&await b7({email:a.email.trim().toLowerCase(),name:a.name.trim(),proposal:a.proposal.trim(),category:(m==null?void 0:m.title)??_l[0].title}),d("success"),Q(),Ae({description:"Gracias! Revisaremos tu propuesta y te contactaremos pronto."}),c({...Tv,name:r||"",email:(t==null?void 0:t.email)??""}),w(!1),y(_l[0]),b(!1),WD(g_),V.current=null}catch(le){console.error("[ContributionModal] Excepcin al guardar:",le),d("error"),p("Ocurri un error inesperado. Intenta ms tarde.")}}},[a,u,m,g,s,Q,r,t==null?void 0:t.email]),oe=A.useCallback(()=>{u!=="loading"&&(e==null||e())},[e,u]),je=A.useCallback(X=>{y(X),b(!0)},[]),Ue=A.useMemo(()=>y7[m==null?void 0:m.id]??"Contribuye al dilogo crtico",[m]),ye=A.useCallback(()=>{u!=="loading"&&b(!1)},[u]),Be=()=>f.jsxs("div",{className:"rounded-2xl border border-white/10 bg-black/20 px-4 py-3 text-[0.8rem] text-slate-300 leading-relaxed",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-500",children:"Qu necesitas saber?"}),f.jsx("p",{children:" Algunos miniversos an estn bajo construccin."}),f.jsx("p",{children:" Puedes ser parte de las pruebas tempranas o versiones beta."}),f.jsx("p",{children:" Si te unes a esta lista, recibirs avances exclusivos antes de que se abran al pblico."}),f.jsx("div",{className:"border-t border-white/10 pt-3 text-xs uppercase tracking-[0.35em] text-slate-500",children:" Qu recibirs?"}),f.jsx("p",{className:"text-sm",children:"Invitaciones a exploraciones internas, accesos temporales, adelantos curatoriales y ventanas de activacin anticipada en los miniversos en desarrollo."})]}),Ft=()=>f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Formulario"}),f.jsx("h3",{id:"contribution-modal-title",className:"font-display text-2xl text-slate-50",children:Ue}),f.jsxs("p",{className:"text-sm text-slate-400/80",children:["Ests escribiendo sobre"," ",f.jsx("span",{className:"text-purple-200 font-semibold",children:m.title})]})]}),O?f.jsx("button",{type:"button",onClick:ye,className:"mb-4 flex items-center gap-2 text-sm font-semibold text-purple-300 hover:text-purple-200",children:" Ver Ms"}):null,O&&qR.has(m.id)?f.jsx("div",{className:"mb-4",children:Be()}):null,f.jsxs("form",{className:"space-y-4",onSubmit:Ce,children:[f.jsxs("div",{children:[f.jsx("input",{name:"name",type:"text",required:!0,value:a.name,onChange:$,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Cmo quieres que te nombremos?"}),f.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"As quieres que te llamemos? Dinos cmo te gusta que te nombren."})]}),f.jsxs("div",{children:[f.jsx("input",{name:"email",type:"email",required:!0,value:a.email,onChange:$,readOnly:s,className:`w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 ${s?"cursor-not-allowed opacity-80":""}`,placeholder:"nombre@correo.com"}),s?f.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"El correo se toma de tu sesin actual."}):null]}),f.jsx("input",{name:"role",type:"text",value:a.role,onChange:$,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Crtica teatral, artista, investigador, espectador..."}),f.jsx("textarea",{name:"proposal",rows:5,required:!0,value:a.proposal,onChange:$,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400 resize-none",placeholder:"Resume tu texto, crnica o propuesta curatorial..."}),f.jsx("input",{name:"attachmentUrl",type:"url",value:a.attachmentUrl,onChange:$,className:"w-full rounded-lg border border-white/10 bg-black/30 px-4 py-3 text-slate-100 placeholder-slate-500 focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Enlace a material adicional (Drive, portfolio, video...)"}),f.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border border-white/5 bg-black/20 px-4 py-3",children:[f.jsxs(se.button,{type:"button",onClick:Y,"aria-label":"Activar notificacin de publicacin",className:"relative flex items-center gap-3 text-left group focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-purple-400/60",children:[f.jsx(se.div,{animate:F?{scale:[1,1.05,1],boxShadow:g?"0 0 18px rgba(74,222,128,0.65)":"0 0 12px rgba(74,222,128,0.45)",filter:"drop-shadow(0 0 10px rgba(74,222,128,0.45))"}:{scale:1,boxShadow:"0 0 0 rgba(0,0,0,0)"},transition:{duration:.45,ease:"easeOut"},className:`h-5 w-5 rounded-full border border-white/20 ${F?"bg-emerald-400 shadow-[0_0_12px_4px_rgba(52,211,153,0.65)] ring-2 ring-emerald-300/70":"bg-slate-600/40"}`}),f.jsx("span",{className:"text-sm text-slate-300/80 leading-relaxed",children:"Quiero recibir notificacin cuando se publique mi propuesta"})]}),s?null:f.jsx("span",{className:"pl-8 text-xs text-slate-500",children:"Inicia sesin para activar el seguimiento"})]}),u==="error"?f.jsx("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:h}):null,u==="success"?f.jsx("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:"Recibimos tu propuesta. Te contactaremos si necesitamos ms detalles."}):null,f.jsx(xe,{type:"submit",disabled:u==="loading",className:"w-full bg-gradient-to-r from-purple-600/80 to-indigo-600/80 hover:from-purple-600 hover:to-indigo-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover-glow",children:u==="loading"?"Enviando":"Enviar propuesta"})]}),M&&qR.has(m.id)?f.jsx("div",{className:"mt-6 space-y-3",children:Be()}):null]});return f.jsxs(f.Fragment,{children:[f.jsx(Co,{children:n?f.jsxs(se.div,{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6 sm:py-12",initial:"hidden",animate:"visible",exit:"hidden",children:[f.jsx(se.div,{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",variants:m7,onClick:oe,"aria-hidden":"true"}),f.jsxs(se.div,{role:"dialog","aria-modal":"true","aria-labelledby":"contribution-modal-title",variants:g7,className:"relative z-10 w-full max-w-5xl h-full max-h-[90vh] rounded-3xl border border-white/10 bg-slate-950 p-4 sm:p-8 shadow-2xl overflow-y-auto md:overflow-hidden flex flex-col gap-6",children:[f.jsxs("div",{className:"relative overflow-visible",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/70",children:"Blog / Dilogo vivo"}),f.jsx("h2",{className:"font-display text-2xl sm:text-3xl text-slate-50",children:"Contribuye al dilogo crtico"})]}),f.jsx("button",{onClick:oe,className:"text-slate-400 hover:text-white transition text-xl leading-none","aria-label":"Cerrar formulario de propuestas",children:""})]}),S.map(X=>f.jsx(x7,{seed:X},X))]}),f.jsxs("div",{className:"mt-6 flex flex-col gap-6 md:flex-row md:items-start md:gap-6",children:[f.jsxs("div",{className:"flex-1 space-y-3 pr-3 md:pr-0 md:overflow-y-auto md:max-h-[72vh]",children:[_l.map(X=>f.jsxs("button",{type:"button",onClick:()=>je(X),className:`w-full rounded-2xl border px-4 py-4 text-left transition ${m.id===X.id?"bg-purple-500/15 border-purple-300/40":"bg-black/20 border-white/10 hover:border-purple-300/30"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[X.icon,f.jsx("h4",{className:"text-slate-100 font-medium",children:X.title})]}),f.jsx("p",{className:"text-sm text-slate-400/80 leading-relaxed whitespace-pre-line",children:X.description})]},X.id)),f.jsx("div",{className:"pt-2 text-center text-xs text-purple-200/80",children:f.jsx("button",{type:"button",onClick:ge,className:"underline-offset-4 hover:underline",children:"No conoces los Miniversos? Clica aqu"})})]}),M?f.jsx("div",{className:"md:w-[520px] md:shrink-0",children:v?f.jsx(se.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:16},transition:{duration:.35,ease:"easeOut"},className:"flex h-full max-h-[78vh] flex-col rounded-3xl border border-white/10 bg-slate-950/90 p-6 shadow-2xl overflow-y-auto",children:Ft()}):f.jsx("div",{className:"flex h-full min-h-[320px] items-center justify-center rounded-3xl border border-dashed border-white/10 bg-black/30 px-4 text-center text-sm text-slate-400",children:"Selecciona una categora para abrir el formulario."})}):null]}),f.jsx(Co,{children:!M&&v?f.jsx(f.Fragment,{children:f.jsx(se.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:24,stiffness:240},className:"fixed inset-0 z-[60] w-full bg-slate-950 border-white/15 shadow-2xl p-6 overflow-y-auto md:hidden",children:Ft()})}):null})]})]}):null}),f.jsx(Co,{children:k?f.jsx(nT,{onClose:z}):null})]})};async function b7({email:n,name:e,proposal:t,category:s}){if(n)try{const{error:r}=await nt.functions.invoke("send-proposal-confirmation",{body:{email:n,name:e,proposal:t,category:s}});r&&console.error("[ContributionModal] Error en sendConfirmationEmail:",r)}catch(r){console.error("[ContributionModal] Excepcin en sendConfirmationEmail:",r)}}const WR=["#f472b6","#a855f7","#facc15","#34d399"],x7=({seed:n})=>{const e=A.useMemo(()=>Array.from({length:12},(t,s)=>({left:Math.random()*100,top:Math.random()*20,delay:Math.random()*.2,color:WR[s%WR.length]})),[n]);return f.jsx("div",{className:"confetti-layer",children:e.map((t,s)=>f.jsx("span",{className:"confetti-piece",style:{left:`${t.left}%`,top:`${t.top}%`,backgroundColor:t.color,animationDelay:`${t.delay}s`}},`${n}-${s}`))})},y_=n=>(n||"").toString().trim().toLowerCase(),$m=["curaduria","expansiones","backstage"],Eb={curaduria:{id:"curaduria",label:"Curadura Reflexiva",summary:"Textos crticos y anlisis profundos sobre la obra y su universo, escritos por investigadores, curadoras y voces especializadas.",keywords:["curaduria","curatorial","critica","ensayo","analisis","reflexiva"]},expansiones:{id:"expansiones",label:"Expansiones Narrativas",summary:"Microficciones, comunidad y relatos que acompaan los miniversos transmedia: cartas, diarios, audios y relatos colectivos.",keywords:["miniverso","transmedia","ficcion","comunidad","microficcion","expansion"]},backstage:{id:"backstage",label:"Detrs de Cmaras",summary:"Noticias, avances y bitcoras del proceso creativo: apps, novela, ensayo tcnico, produccin y archivos del montaje.",keywords:["backstage","proceso","produccion","apps","novela","noticias","detras"]}},w7=["carta-a-copycats","taza-que-habla"],KR=$m[0],S7=n=>{if(!n)return KR;const e=y_(n.category);if(e&&$m.includes(e))return e;const t=y_(n.slug);if(t&&w7.includes(t))return"expansiones";const s=Array.isArray(n.tags)?n.tags.map(r=>y_(r)).filter(Boolean):[];for(const r of $m){const i=Eb[r].keywords;if(s.some(o=>i.includes(o)))return r}return KR};async function _7({post:n,action:e,liked:t,notify:s,miniverse:r,mostViewedMiniverse:i,mostViewedMiniverseCount:o,interactionContext:a="blog_article_footer"}){if(!(n!=null&&n.id)||!(n!=null&&n.slug))return{success:!1,error:new Error("Falta el identificador del artculo")};const c={post_id:n.id,post_slug:n.slug,post_title:n.title,action:e,liked:!!t,notify:!!s,miniverse:r,most_viewed_miniverse:i,most_viewed_miniverse_count:o??null,interaction_context:a,metadata:{author:n.author,tags:n.tags??[],published_at:n.published_at}},{error:u}=await nt.from("blog_article_interactions").insert(c);return{success:!u,error:u}}const XR={hidden:{opacity:0,y:40},visible:{opacity:1,y:0,transition:{duration:.8,ease:"easeOut"}}},YR={cine:{label:"Miniverso Cine",views:4320,subcategories:["Quirn","Copycats","Campo expandido"]},expansiones:{label:"Expansiones Narrativas",views:3860,subcategories:["Cartas","Bitcoras","Microrrelatos"]},curaduria:{label:"Curadura Reflexiva",views:2780,subcategories:["Ensayo crtico","Cartografas emocionales"]},apps:{label:"Miniverso Apps",views:2190,subcategories:["Guardianes digitales","Glitches","Rituales mviles"]},sonoro:{label:"Miniverso Sonoro",views:2010,subcategories:["Pistas","Field recordings","Ondas"]},bitacora:{label:"Miniverso Bitcora",views:1760,subcategories:["Crnicas","Archivo vivo","Cartas"]},taza:{label:"Miniverso Taza",views:1630,subcategories:["Objetos rituales","Memorias lquidas"]},otro:{label:"Otra contribucin",views:1480,subcategories:["Performance","Investigacin hbrida"]}},A7={cine:["cine","quirn","copycats","film","pelcula"],expansiones:["expansiones","miniverso","novela","diario","microficcin"],curaduria:["curadura","critica","analisis","ensayo"],apps:["app","apps","digital","interactivo"],sonoro:["sonoro","audio","msica","sonidos"],bitacora:["bitcora","bitacora","cronica","crnica"],taza:["taza","objeto","cermica","ritual"],otro:["performance","hbrido","glitch","experimental"]},E7=n=>{const e=[n.category,n.slug,n.title,n.excerpt,...Array.isArray(n.tags)?n.tags:[]].filter(Boolean).join(" ").toLowerCase();for(const[t,s]of Object.entries(A7))if(s.some(r=>e.includes(r)))return t;return"curaduria"},C7=({post:n,onSelect:e})=>{const t=n.published_at?new Date(n.published_at):null;return f.jsxs(se.article,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.2},transition:{duration:.5,ease:"easeOut"},className:"glass-effect rounded-2xl p-8 md:p-10 flex flex-col hover-glow transition-shadow",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 text-sm text-slate-400",children:[t&&f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(vk,{size:16}),t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})]}),n.read_time_minutes?f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(VL,{size:16}),n.read_time_minutes," min lectura"]}):null,f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(N1,{size:16}),n.author,n.author_role?f.jsxs("span",{className:"text-slate-500",children:["/ ",n.author_role]}):null]})]}),f.jsx("h3",{className:"font-display text-2xl md:text-3xl font-medium text-slate-100 mb-4",children:n.title}),f.jsx("p",{className:"text-slate-300/80 leading-relaxed font-light mb-6",children:n.excerpt}),Array.isArray(n.tags)&&n.tags.length>0?f.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:n.tags.map(s=>f.jsx("span",{className:"text-xs uppercase tracking-wider text-purple-200/80 bg-purple-500/10 border border-purple-400/20 px-3 py-1 rounded-full",children:s},s))}):null,f.jsx(xe,{onClick:()=>e(n),variant:"outline",className:"self-start border-purple-400/40 text-purple-200 hover:bg-purple-500/20",children:"Leer artculo completo"})]})},k7=({post:n,onClose:e})=>{const t=A.useMemo(()=>n!=null&&n.content?n.content.split(/\n{2,}/).map(r=>r.trim()).filter(Boolean):[],[n]),s=n.published_at?new Date(n.published_at):null;return f.jsxs(se.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.4,ease:"easeOut"},className:"glass-effect rounded-3xl p-8 md:p-12 border border-white/10 shadow-2xl backdrop-blur-xl",children:[f.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-8",children:[f.jsxs("div",{className:"flex flex-col gap-2 text-sm text-slate-400",children:[s?f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(vk,{size:16}),s.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})]}):null,f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(N1,{size:16}),n.author,n.author_role?f.jsxs("span",{className:"text-slate-500",children:["/ ",n.author_role]}):null]}),n.read_time_minutes?f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx(VL,{size:16}),n.read_time_minutes," min lectura"]}):null]}),f.jsx(xe,{onClick:e,variant:"ghost",className:"text-slate-400 hover:text-white hover:bg-white/10",children:"Cerrar artculo"})]}),f.jsx("h3",{className:"font-display text-3xl md:text-4xl font-semibold text-slate-50 mb-8",children:n.title}),f.jsx("div",{className:"space-y-6 text-slate-200 leading-relaxed font-light",children:t.length===0?f.jsx("p",{children:"Este artculo estar disponible muy pronto. Gracias por tu inters en la comunidad crtica de #GatoEncerrado."}):t.map((r,i)=>f.jsx("p",{children:r},i))}),f.jsx(T7,{post:n})]})},T7=({post:n})=>{const{user:e}=Ny(),[t,s]=A.useState(!1),r=A.useCallback(()=>s(!0),[]),i=A.useCallback(()=>s(!1),[]),o=A.useMemo(()=>E7(n),[n]),a=YR[o]??YR.curaduria,[c,u]=A.useState(!1),[d,h]=A.useState(!1),[p,m]=A.useState({like:"idle",notify:"idle"}),y=async g=>{const w=g==="like"?!c:c,v=g==="notify"?!d:d;if(g==="notify"&&!e){Ae({description:"Inicia sesin para recibir notificaciones y continuar en el Backstage."}),r();return}m(E=>({...E,[g]:"loading"}));const{success:b,error:S}=await _7({post:n,action:g,liked:w,notify:v,miniverse:o,mostViewedMiniverse:a.label,mostViewedMiniverseCount:a.views??null});b?g==="like"?(u(w),Ae({description:w?"Gracias por tu apoyo.":"Quitaste el Me gusta."})):(h(v),Ae({description:v?"Te avisaremos cuando haya novedades sobre este texto.":"Ya no recibes notificaciones de este artculo."})):(console.error("[ArticleInteraction] Error guardando interaccin:",S),Ae({description:"No pudimos guardar tu interaccin. Intenta nuevamente."})),m(E=>({...E,[g]:"idle"}))};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"mt-10 rounded-3xl border border-white/10 bg-black/40 p-6 shadow-[0_30px_80px_rgba(0,0,0,0.35)]",children:[f.jsx("p",{className:"text-base text-slate-200",children:"La lectura te movi?"}),f.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Clic en los botones y registramos la interaccin para alimentar al gato del Backstage."}),f.jsxs("div",{className:"mt-6 flex flex-col gap-3 md:flex-row",children:[f.jsx(xe,{variant:c?"secondary":"default",size:"lg",onClick:()=>y("like"),disabled:p.like==="loading",className:"flex-1",children:c?"Gracias por el Me gusta":"Me gust este artculo"}),f.jsx(xe,{variant:"outline",size:"lg",onClick:()=>y("notify"),disabled:p.notify==="loading",className:"flex-1",children:d?"Te avisaremos de novedades":"Quiero recibir notificaciones"})]})]}),t?f.jsx(nT,{onClose:i}):null]})},v_="gatoencerrado-blog-onboarding",P7=({posts:n=[],isLoading:e=!1,error:t=null})=>{const[s,r]=A.useState(null),[i,o]=A.useState(null),[a,c]=A.useState(!1),[u,d]=A.useState("all"),[h,p]=A.useState(""),[m,y]=A.useState(!1),g=A.useRef(null),w=A.useRef(!1),{user:v}=Ny(),b=!!(v!=null&&v.email),S=zr("text-white px-8 py-3 rounded-full font-semibold flex items-center gap-2 hover-glow transition mx-auto",b?"bg-gradient-to-r from-emerald-500/90 to-emerald-600/90 hover:from-emerald-400/90 hover:to-emerald-500/90 shadow-[0_0_35px_rgba(16,185,129,0.5)] ring-2 ring-emerald-400/30":"bg-gradient-to-r from-purple-600/80 to-indigo-600/80 hover:from-purple-600 hover:to-indigo-600"),E=A.useMemo(()=>n.map(L=>({...L,category:S7(L)})),[n]),k=A.useMemo(()=>[...E].sort((L,O)=>{const D=L.published_at?new Date(L.published_at).getTime():0;return(O.published_at?new Date(O.published_at).getTime():0)-D}),[E]),T=A.useMemo(()=>{const L=h.trim().toLowerCase();return k.filter(O=>(u==="all"?!0:O.category===u)?L?[O.title,O.author,O.excerpt,...Array.isArray(O.tags)?O.tags:[]].filter(Boolean).join(" ").toLowerCase().includes(L):!0:!1)},[k,u,h]),P=A.useCallback(L=>{r(L),requestAnimationFrame(()=>{const O=document.getElementById("blog-article");O==null||O.scrollIntoView({behavior:"smooth",block:"start"})})},[]),N=A.useCallback(L=>{d(L),requestAnimationFrame(()=>{var O;(O=g.current)==null||O.scrollIntoView({behavior:"smooth",block:"start"})})},[]);A.useEffect(()=>{if(i&&E.length>0){const L=E.find(O=>O.slug===i);L&&(P(L),o(null))}},[P,i,E]),A.useEffect(()=>{t&&Ae({description:"No se pudieron cargar los artculos del blog."})},[t]),A.useEffect(()=>{const L=O=>{var I;const{slug:D}=O.detail||{};if(!D)return;const V=E.find(R=>R.slug===D);V?P(V):o(D),(I=document.getElementById("dialogo-critico"))==null||I.scrollIntoView({behavior:"smooth"})};return window.addEventListener("gatoencerrado:open-blog",L),()=>window.removeEventListener("gatoencerrado:open-blog",L)},[P,E]);const M=A.useCallback(()=>{c(!0),y(!1),w.current=!0,Rm(v_,"seen")},[]);return A.useEffect(()=>{if(typeof window>"u"||w.current)return;if(tT(v_)==="seen"){y(!1),w.current=!0;return}y(!0);const O=setTimeout(()=>{y(!1),Rm(v_,"seen"),w.current=!0},6e3);return()=>clearTimeout(O)},[]),A.useEffect(()=>{const L=()=>{c(!0)};return window.addEventListener("gatoencerrado:resume-contribution",L),()=>{window.removeEventListener("gatoencerrado:resume-contribution",L)}},[]),f.jsxs(f.Fragment,{children:[f.jsxs("section",{id:"dialogo-critico",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-16",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400/70 mb-4",children:"Dilogo Crtico"}),f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-6 text-gradient italic",children:"Pensamiento crtico, comunidad y resonancia"}),f.jsx("p",{className:"text-lg text-slate-300/80 max-w-3xl mx-auto leading-relaxed font-light",children:"Un espacio de pensamiento crtico, creatividad y potica donde convergen curadura, ficcin expandida y noticias detrs de escena. Filtra por inters, busca autoras especficas o explora las lneas editoriales."})]}),f.jsxs("div",{className:"space-y-16",children:[f.jsx(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.1,ease:"easeOut"},viewport:{once:!0},className:"grid md:grid-cols-3 gap-6",children:$m.map(L=>f.jsxs("div",{className:"glass-effect rounded-2xl p-6 border border-white/10 flex flex-col gap-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400/80",children:Eb[L].label}),f.jsx("p",{className:"text-slate-300/80 text-sm leading-relaxed flex-1",children:Eb[L].summary}),f.jsx(xe,{variant:"link",onClick:()=>N(L),className:"text-purple-300 hover:text-white self-start px-0",children:"Leer esta lnea editorial"})]},L))}),f.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx("button",{type:"button",onClick:()=>d("all"),className:`rounded-full border px-4 py-2 text-sm transition ${u==="all"?"border-purple-400/60 bg-purple-500/20 text-purple-100":"border-white/10 text-slate-300 hover:border-purple-300/40 hover:text-purple-100"}`,children:"Todas"}),$m.map(L=>f.jsx("button",{type:"button",onClick:()=>d(L),className:`rounded-full border px-4 py-2 text-sm transition ${u===L?"border-purple-400/60 bg-purple-500/20 text-purple-100":"border-white/10 text-slate-300 hover:border-purple-300/40 hover:text-purple-100"}`,children:Eb[L].label},L))]}),f.jsxs("div",{className:"relative w-full md:w-72",children:[f.jsx(R$,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),f.jsx("input",{type:"search",value:h,onChange:L=>p(L.target.value),placeholder:"Buscar por ttulo o autor",className:"w-full rounded-full border border-white/10 bg-black/30 pl-10 pr-4 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-purple-400 focus:outline-none focus:ring-1 focus:ring-purple-400"})]})]}),f.jsx(se.div,{ref:g,initial:"hidden",whileInView:"visible",viewport:{once:!0},variants:{visible:{transition:{staggerChildren:.12}}},className:"grid md:grid-cols-2 gap-8",children:e?f.jsx(se.div,{variants:XR,className:"md:col-span-2 text-center text-slate-400 py-12",children:"Cargando artculos"}):T.length===0?f.jsx(se.div,{variants:XR,className:"md:col-span-2 text-center text-slate-400 py-12",children:"No encontramos textos con ese criterio. Ajusta el filtro o comparte un nuevo testimonio."}):T.map(L=>f.jsx(C7,{post:L,onSelect:P},L.id))}),f.jsx("div",{id:"blog-article",children:f.jsx(Co,{mode:"wait",children:s?f.jsx(k7,{post:s,onClose:()=>r(null)},s.id):null})})]}),f.jsxs(se.div,{id:"blog-contribuye",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.3,ease:"easeOut"},viewport:{once:!0},className:"mt-20 glass-effect rounded-2xl p-8 md:p-12 text-center",children:[f.jsx("h3",{className:"font-display text-3xl font-medium text-slate-100 mb-6",children:"Algo de la obra se qued contigo?"}),f.jsx("p",{className:"text-slate-300/80 leading-relaxed mb-8 max-w-2xl mx-auto font-light",children:"Invitamos a espectadores, artistas, investigadores y espritus curiosos a compartir cmo esta obra reson en su forma de mirar, sentir, imaginar o habitar el mundo. Tu palabra tambin construye este universo."}),f.jsxs("div",{className:"relative inline-flex flex-col items-center gap-2",children:[m?f.jsx(se.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute -top-10 bg-purple-600/80 text-white text-xs px-3 py-1 rounded-full shadow-lg",children:"Nuevo! Abre la bandeja lateral y comparte tu texto"}):null,f.jsxs(xe,{id:"blog-submit-cta",onClick:M,className:S,children:[f.jsx(T$,{size:18})," Enviar propuesta"]})]})]})]})]}),f.jsx(v7,{open:a,onClose:()=>c(!1)})]})};var N7=uj[" useId ".trim().toString()]||(()=>{}),R7=0;function A3(n){const[e,t]=A.useState(N7());return Au(()=>{n||t(s=>s??String(R7++))},[n]),n||(e?`radix-${e}`:"")}var tS="Collapsible",[j7,E3]=k1(tS),[M7,wT]=j7(tS),C3=A.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:s,defaultOpen:r,disabled:i,onOpenChange:o,...a}=n,[c,u]=T1({prop:s,defaultProp:r??!1,onChange:o,caller:tS});return f.jsx(M7,{scope:t,disabled:i,contentId:A3(),open:c,onOpenToggle:A.useCallback(()=>u(d=>!d),[u]),children:f.jsx(Wn.div,{"data-state":_T(c),"data-disabled":i?"":void 0,...a,ref:e})})});C3.displayName=tS;var k3="CollapsibleTrigger",T3=A.forwardRef((n,e)=>{const{__scopeCollapsible:t,...s}=n,r=wT(k3,t);return f.jsx(Wn.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":_T(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...s,ref:e,onClick:Un(n.onClick,r.onOpenToggle)})});T3.displayName=k3;var ST="CollapsibleContent",P3=A.forwardRef((n,e)=>{const{forceMount:t,...s}=n,r=wT(ST,n.__scopeCollapsible);return f.jsx(hk,{present:t||r.open,children:({present:i})=>f.jsx(L7,{...s,ref:e,present:i})})});P3.displayName=ST;var L7=A.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:s,children:r,...i}=n,o=wT(ST,t),[a,c]=A.useState(s),u=A.useRef(null),d=Ro(e,u),h=A.useRef(0),p=h.current,m=A.useRef(0),y=m.current,g=o.open||a,w=A.useRef(g),v=A.useRef(void 0);return A.useEffect(()=>{const b=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(b)},[]),Au(()=>{const b=u.current;if(b){v.current=v.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const S=b.getBoundingClientRect();h.current=S.height,m.current=S.width,w.current||(b.style.transitionDuration=v.current.transitionDuration,b.style.animationName=v.current.animationName),c(s)}},[o.open,s]),f.jsx(Wn.div,{"data-state":_T(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...i,ref:d,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...n.style},children:g&&r})});function _T(n){return n?"open":"closed"}var I7=C3,D7=T3,O7=P3,F7=A.createContext(void 0);function B7(n){const e=A.useContext(F7);return n||e||"ltr"}var Vr="Accordion",$7=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[AT,z7,V7]=pL(Vr),[nS,EK]=k1(Vr,[V7,E3]),ET=E3(),N3=Re.forwardRef((n,e)=>{const{type:t,...s}=n,r=s,i=s;return f.jsx(AT.Provider,{scope:n.__scopeAccordion,children:t==="multiple"?f.jsx(q7,{...i,ref:e}):f.jsx(G7,{...r,ref:e})})});N3.displayName=Vr;var[R3,U7]=nS(Vr),[j3,H7]=nS(Vr,{collapsible:!1}),G7=Re.forwardRef((n,e)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},collapsible:i=!1,...o}=n,[a,c]=T1({prop:t,defaultProp:s??"",onChange:r,caller:Vr});return f.jsx(R3,{scope:n.__scopeAccordion,value:Re.useMemo(()=>a?[a]:[],[a]),onItemOpen:c,onItemClose:Re.useCallback(()=>i&&c(""),[i,c]),children:f.jsx(j3,{scope:n.__scopeAccordion,collapsible:i,children:f.jsx(M3,{...o,ref:e})})})}),q7=Re.forwardRef((n,e)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},...i}=n,[o,a]=T1({prop:t,defaultProp:s??[],onChange:r,caller:Vr}),c=Re.useCallback(d=>a((h=[])=>[...h,d]),[a]),u=Re.useCallback(d=>a((h=[])=>h.filter(p=>p!==d)),[a]);return f.jsx(R3,{scope:n.__scopeAccordion,value:o,onItemOpen:c,onItemClose:u,children:f.jsx(j3,{scope:n.__scopeAccordion,collapsible:!0,children:f.jsx(M3,{...i,ref:e})})})}),[W7,sS]=nS(Vr),M3=Re.forwardRef((n,e)=>{const{__scopeAccordion:t,disabled:s,dir:r,orientation:i="vertical",...o}=n,a=Re.useRef(null),c=Ro(a,e),u=z7(t),h=B7(r)==="ltr",p=Un(n.onKeyDown,m=>{var N;if(!$7.includes(m.key))return;const y=m.target,g=u().filter(M=>{var L;return!((L=M.ref.current)!=null&&L.disabled)}),w=g.findIndex(M=>M.ref.current===y),v=g.length;if(w===-1)return;m.preventDefault();let b=w;const S=0,E=v-1,k=()=>{b=w+1,b>E&&(b=S)},T=()=>{b=w-1,b<S&&(b=E)};switch(m.key){case"Home":b=S;break;case"End":b=E;break;case"ArrowRight":i==="horizontal"&&(h?k():T());break;case"ArrowDown":i==="vertical"&&k();break;case"ArrowLeft":i==="horizontal"&&(h?T():k());break;case"ArrowUp":i==="vertical"&&T();break}const P=b%v;(N=g[P].ref.current)==null||N.focus()});return f.jsx(W7,{scope:t,disabled:s,direction:r,orientation:i,children:f.jsx(AT.Slot,{scope:t,children:f.jsx(Wn.div,{...o,"data-orientation":i,ref:c,onKeyDown:s?void 0:p})})})}),bx="AccordionItem",[K7,CT]=nS(bx),L3=Re.forwardRef((n,e)=>{const{__scopeAccordion:t,value:s,...r}=n,i=sS(bx,t),o=U7(bx,t),a=ET(t),c=A3(),u=s&&o.value.includes(s)||!1,d=i.disabled||n.disabled;return f.jsx(K7,{scope:t,open:u,disabled:d,triggerId:c,children:f.jsx(I7,{"data-orientation":i.orientation,"data-state":$3(u),...a,...r,ref:e,disabled:d,open:u,onOpenChange:h=>{h?o.onItemOpen(s):o.onItemClose(s)}})})});L3.displayName=bx;var I3="AccordionHeader",D3=Re.forwardRef((n,e)=>{const{__scopeAccordion:t,...s}=n,r=sS(Vr,t),i=CT(I3,t);return f.jsx(Wn.h3,{"data-orientation":r.orientation,"data-state":$3(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:e})});D3.displayName=I3;var yC="AccordionTrigger",O3=Re.forwardRef((n,e)=>{const{__scopeAccordion:t,...s}=n,r=sS(Vr,t),i=CT(yC,t),o=H7(yC,t),a=ET(t);return f.jsx(AT.ItemSlot,{scope:t,children:f.jsx(D7,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":r.orientation,id:i.triggerId,...a,...s,ref:e})})});O3.displayName=yC;var F3="AccordionContent",B3=Re.forwardRef((n,e)=>{const{__scopeAccordion:t,...s}=n,r=sS(Vr,t),i=CT(F3,t),o=ET(t);return f.jsx(O7,{role:"region","aria-labelledby":i.triggerId,"data-orientation":r.orientation,...o,...s,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});B3.displayName=F3;function $3(n){return n?"open":"closed"}var X7=N3,Y7=L3,Q7=D3,z3=O3,V3=B3;const J7=X7,U3=Re.forwardRef(({className:n,...e},t)=>f.jsx(Y7,{ref:t,className:zr("border-b",n),...e}));U3.displayName="AccordionItem";const H3=Re.forwardRef(({className:n,children:e,...t},s)=>f.jsx(Q7,{className:"flex",children:f.jsxs(z3,{ref:s,className:zr("tran-accordion-trigger flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",n),...t,children:[e,f.jsx("span",{className:"trigger-line","aria-hidden":"true"}),f.jsx(x$,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));H3.displayName=z3.displayName;const G3=Re.forwardRef(({className:n,children:e,...t},s)=>f.jsx(V3,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:f.jsx("div",{className:zr("pb-4 pt-0",n),children:e})}));G3.displayName=V3.displayName;const Z7={Direccin:{name:"Gilberto Corrales",bio:"Director, dramaturgo y actor. Licenciado en Teatro por la Facultad de Artes de la UABC, ha dirigido ms de cuarenta obras, la mayora de su autora. Su trabajo explora la transdisciplina y la investigacin del lenguaje escnico. Fundador de Incendio Producciones, sus obras han estado presentes en la Muestra Nacional de Teatro y en festivales de Colombia, Argentina y EE.UU. Ganador del Premio Juventud 2016 y del FITU UNAM. Dirige el Contagio Tijuana y colabora con artistas como Jorge Ballina y Daniel Primo.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/gil-corrales.gif"},Elenco:{description:"Actores y actrices que encarnan el pulso emocional de la obra desde la fisicalidad, la voz y la presencia simblica.",members:[{id:"elenco-cyndi",name:"Cynthia Teresa Rodrguez Aguirre",role:"Intrprete",bio:"Artista interdisciplinaria egresada de la UABC. Su prctica integra fotografa, escritura y teatro. Ha participado en el San Diego Fringe Festival y en montajes de Incendio Producciones. Actualmente se enfoca en la direccin escnica y la exploracin visual.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/cyndi.jpg"},{id:"elenco-mariana",name:"Mariana de los Santos",role:"Intrprete",bio:"Actriz tijuanense formada en CEART y con experiencia en cine y teatro contemporneo. Su trabajo corporal revela una sensibilidad potica que dialoga entre lo ntimo y lo colectivo.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/mariana.jpg"},{id:"elenco-ricardo",name:"Ricardo Mrquez Salgado",role:"Intrprete",bio:"Comuniclogo, modelo y actor. Ha participado en teatro, cine y publicidad. Destacan sus coprotagnicos en 'Ideas para no morir en el anonimato' y 'Entre Dos'. Su presencia combina energa escnica y precisin esttica.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/ricardo.jpg"},{id:"elenco-carlos-valdez",name:"Carlos Valdez Rosas",role:"Intrprete",bio:"Actor y productor de Incendio Producciones. Su trabajo combina performance, posdrama e interdisciplina. Ha participado en la Muestra Nacional de Teatro y festivales internacionales en Argentina y Estados Unidos.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/carlitos.jpg"}]},Dramaturgia:{name:"Carlos A. Prez H.",bio:"Artista transmedial, autor y dramaturgo. Su obra habita entre teatro, escritura y tecnologa, proponiendo una potica crtica y humana. Formado en el ITESO, la Universidad de Salamanca y LABASAD Barcelona, integra astrologa psicolgica, cuerpo y arte digital en una mirada simblica. Creador del universo transmedia #GatoEncerrado, concibe el acto creativo como una forma de acompaamiento y transformacin.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/carlos_perez.gif"},"Diseo y Tcnica Escnica":{description:"Un equipo de diseadores y tcnicos escnicos que entrelazan arquitectura, multimedia, sonido y luz para expandir la atmsfera de la obra.",members:[{name:"Jorge Ballina",role:"Escenografa",bio:"Arquitecto y escengrafo con ms de 120 obras en teatro, danza y pera. Miembro del Sistema Nacional de Creadores de Arte, ha sido galardonado con premios internacionales como el World Stage Design Toronto y Calgary. Su trabajo combina estructura y poesa visual.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/jorge.jpg"},{name:"Daniel Primo",role:"Video Escenogrfico e Iluminacin",bio:"Artista visual y diseador escnico. Explora la relacin entre multimedia y espacio escnico. Integrante del Sistema Nacional de Creadores, su trabajo ha sido presentado en Europa, Asia y Amrica. Cofundador de Engranaje Invertebrado.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/primo.jpg"},{name:"La Prez",role:"Diseo Sonoro",bio:"Artista sonora con ms de doce aos de experiencia. Fundadora de Concrete Sounds, ha colaborado en filmes como 'Ya no estoy aqu' y 'Monos'. Su especialidad es la creacin de paisajes inmersivos que amplan la dimensin sensorial del teatro.",image:"/images/placeholder-diseno.jpg"},{name:"Harold Garca",role:"Direccin Tcnica",bio:"Arquitecto y diseador lumnico. Ha colaborado en producciones como 'Matilda', 'Mamma Mia!' y 'Madame Butterfly'. Su trabajo abarca teatro, pera y danza contempornea, con presentaciones en Mxico, Los ngeles y festivales nacionales.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/harold.jpg"},{name:"Rebeca Hernndez",role:"Realizacin Escenogrfica",bio:"Diseadora industrial egresada del CIDI-UNAM y fundadora de Atelier RHC en Tijuana. Su taller produce escenografas, mobiliario y piezas funcionales para teatro y espacios pblicos, uniendo tcnica artesanal con visin contempornea.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/rebeca.jpg"},{name:"Ximena Inurreta",role:"Asistente de Diseo de Escenografa",bio:"Diseadora escnica emergente que apoya el desarrollo de atmsferas visuales y transiciones espaciales en el montaje de #GatoEncerrado.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/Ximena.jpg"},{name:"Diego Madera",role:"Tema Musical",bio:"Msico y compositor cuyo trabajo explora la tensin entre sonido y silencio. Su pieza original acompaa los pasajes emocionales de la obra.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/diego.png"},{name:"Karla Flores",role:"Realizacin de Vestuario",bio:"Diseadora de vestuario que traduce emociones en textura, movimiento y color. Su trabajo aporta profundidad simblica a la corporalidad de los intrpretes.",image:"/images/placeholder-diseno.jpg"},{name:"Jonathan Lazcano",role:"Pelucas",bio:"Artista de caracterizacin. Su trabajo artesanal da vida y coherencia visual a los personajes a travs del detalle y la textura.",image:"/images/placeholder-diseno.jpg"}]},"Produccin y Asistencia":{description:"Un equipo que coordina, articula y acompaa cada engranaje de la produccin escnica con mirada sensible, tcnica y humana.",members:[{name:"Rosala Hernndez Milln",role:"Produccin General y Vinculacin Social",bio:"Presidenta de Isabel A.C. Ayuda para la Vida, Maestra en Psicobiologa y Neurociencia Cognitiva (UAB). Su labor impulsa la integracin entre arte y bienestar emocional, fortaleciendo el puente entre el proyecto escnico y la comunidad.",image:"/images/placeholder-colaboradores.jpg"},{name:"Miroslava Wilson",role:"Produccin Ejecutiva",bio:"Productora ejecutiva, directora y asesora de movimiento. Originaria de Hermosillo y radicada en Tijuana, es fundadora de Pndulo Cero A.C. y educadora de movimiento somtico certificada por Body Mind Movement. Su trabajo interdisciplinario vincula arte, medio ambiente y humanismo. Ha presentado su obra en Asia, Amrica y Europa, y actualmente impulsa proyectos como Casa Viva y SomasSomos.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/Miroslava%20.jpg"},{name:"Marcela Durn Mulia",role:"Produccin Administrativa",bio:"Actriz, gestora y representante legal de Incendio Producciones. Licenciada en Comunicacin (UABC) y Maestra en Alta Direccin Corporativa (Humanitas). Ha participado en la Muestra Nacional de Teatro, ENARTES y otros festivales internacionales. Su mirada estratgica une la gestin cultural con la sensibilidad artstica.",image:"/images/placeholder-colaboradores.jpg"},{name:"Gabriel Monroy",role:"Asistencia de Direccin y Gestin",bio:"Actor, fotgrafo escnico y gestor. Licenciado en Artes Escnicas por la Universidad de Sonora. Creador de la serie fotogrfica 'Reflejos de la escena', exhibida internacionalmente. Su mirada visual y su acompaamiento escnico fortalecen el proceso de direccin.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/gabriel.jpg"},{name:"Roco Morgan",role:"Asistencia Ejecutiva",bio:"Gestora cultural y apoyo logstico de produccin. Su labor sostiene los procesos administrativos y humanos que hacen posible la operacin cotidiana de la obra.",image:"https://ytubybkoucltwnselbhc.supabase.co/storage/v1/object/public/equipo/rocio.jpg"},{name:"Mara Diana Laura Rodriguez",role:"Enlace de Produccin",bio:"Maquillista y traspunte en el Teatro Camafeo. Fue un apoyo operativo clave en la etapa temprana de #GatoEncerrado y facilit el enlace con el director Gilberto Corrales, gesto que defini la continuidad del proyecto. Su iniciativa y acompaamiento hicieron posible que el montaje avanzara en el momento ms decisivo.",image:"/images/placeholder-produccion.jpg"}]},"Colaboradores y Agradecimientos":{description:"Detrs de cada funcin existe una constelacin de manos, miradas y corazones que hacen posible la obra de Es un Gato Encerrado. Este bloque celebra su labor silenciosa y luminosa.",members:[],details:{tecnicos:"Asistencia tcnica y tramoya: Renee Camacho  asistencia tcnica y tramoya. Luis Fernando Lpez Snchez, Alex Nava, Christian Camacho  equipo de realizacin de escenografa. Marco Antonio Corral Gastelm, Manuel Axxel Aquino, Santiago Augusto Rodrguez, Alejandro Saldaa  realizadores y tramoya.",registro:"Registro, foto y medios: Viviana Gonzlez  registro creativo videogrfico. Sergio Brown  registro audiovisual. Enigma Creative  publicidad y diseo grfico. Eclipse Comunicacin Estratgica  difusin y medios.",institucionales:"Apoyos institucionales: Agradecimiento a Teatro CAMAFEO y sus productoras Margarita Martnez de Camarena y Elsa Prez de Vargas; CEART Tijuana, IMAC, Casa Viva y Adagio Studio por su apoyo en ensayos y espacios."}},"Alianza Estratgica de Impacto Social":{name:"Isabel Ayuda para la Vida A.C.",bio:"Asociacin civil sin fines de lucro fundada en 2018 y dirigida por Rosala Hernndez Milln. Su misin es prevenir la violencia autoinfligida mediante el programa DySVAE, promoviendo el pedir ayuda como estrategia de vida. Colabora con #GatoEncerrado para visibilizar la salud emocional y la empata en contextos artsticos y educativos.",image:"/images/placeholder-institucional.jpg"}},eK=()=>{const[n,e]=A.useState(null),[t,s]=A.useState(!1),r=A.useRef(null);A.useEffect(()=>{const o=()=>s(typeof window<"u"?window.innerWidth<768:!1);return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),A.useEffect(()=>{t&&n&&e(null)},[t,n]);const i=(o,a)=>{const c=a==="Elenco",u=a==="Diseo y Tcnica Escnica"||a==="Produccin y Asistencia";if(Array.isArray(o==null?void 0:o.members)){const d=c&&!t,h=o.members.map((m,y)=>({member:m,id:m.id||`${m.name}-${y}`,idx:y})),p=d&&n?[...h.filter(m=>m.id===n),...h.filter(m=>m.id!==n)]:h;return f.jsxs("div",{className:"space-y-6",children:[o.description&&f.jsx("p",{className:"text-slate-300/80 leading-relaxed font-light mb-2 md:text-base sm:text-sm",children:o.description}),f.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:p.map(({member:m,id:y})=>{const g=d&&n===y,w=()=>d?e(v=>v===y?null:y):void 0;return g?f.jsx("div",{className:"glass-effect rounded-xl p-0 overflow-hidden border border-white/5 transition-all duration-300 md:col-span-2",children:f.jsx("button",{type:"button",onClick:w,className:"block w-full focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-400",children:f.jsx("img",{className:"w-full h-full max-h-[520px] object-cover",src:m.image,alt:`Retrato de ${m.name}`,loading:"lazy"})})},y):u?f.jsxs("div",{className:"glass-effect rounded-xl p-5 flex gap-4 items-start border border-white/5",children:[f.jsx("img",{className:"h-20 w-20 flex-shrink-0 rounded-full object-cover shadow-lg shadow-black/30",src:m.image,alt:`Retrato de ${m.name}`,loading:"lazy"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"font-display text-lg text-purple-200",children:m.name}),m.role&&f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-purple-300/70",children:m.role}),m.bio&&f.jsx("p",{className:"text-sm md:text-base sm:text-sm text-slate-300/80 leading-relaxed",children:m.bio}),m.url&&f.jsx("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-semibold text-purple-200 transition hover:text-purple-100 underline-offset-4",children:m.urlLabel??"Ver perfil"})]})]},y):f.jsxs("div",{className:`glass-effect rounded-xl p-5 flex flex-col md:flex-row gap-4 border border-white/5 transition-all duration-300 ${d?"cursor-pointer hover:border-purple-400/40":""}`,onClick:w,role:d?"button":void 0,tabIndex:d?0:void 0,onKeyDown:d?v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),w())}:void 0,children:[f.jsx("div",{className:"w-full md:w-44 overflow-hidden rounded-lg border border-white/5 bg-black/30",children:f.jsx("img",{className:"w-full h-44 object-cover shadow-lg shadow-black/30",src:m.image,alt:`Retrato de ${m.name}`,loading:"lazy"})}),f.jsxs("div",{className:"space-y-2 flex-1",children:[f.jsx("h4",{className:"font-display text-lg text-purple-200",children:m.name}),m.role&&f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-purple-300/70",children:m.role}),m.bio&&f.jsx("p",{className:"text-sm md:text-base sm:text-sm text-slate-300/80 leading-relaxed",children:m.bio}),m.url&&f.jsx("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-semibold text-purple-200 transition hover:text-purple-100 underline-offset-4",children:m.urlLabel??"Ver perfil"})]})]},y)})}),o.details&&f.jsxs("div",{className:"text-slate-400 text-sm leading-relaxed space-y-4",children:[f.jsx("div",{className:"border-t border-white/10 pt-4",children:o.details.tecnicos}),f.jsx("div",{className:"border-t border-white/10 pt-4",children:o.details.registro}),f.jsx("div",{className:"border-t border-white/10 pt-4",children:o.details.institucionales})]})]})}return f.jsxs("div",{className:"grid md:grid-cols-3 gap-6 items-center",children:[f.jsx("div",{className:"md:col-span-1",children:f.jsx("img",{className:"w-full h-48 object-cover rounded-lg shadow-lg shadow-black/30",alt:`Retrato de ${o.name}`,src:o.image})}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("h3",{className:"font-display text-xl font-bold text-purple-300 mb-2",children:o.name}),f.jsx("p",{className:"text-slate-300/80 leading-relaxed font-light md:text-base sm:text-sm",children:o.bio})]})]})};return f.jsxs("section",{id:"team",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-16",children:[f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-6 text-gradient italic",children:"Equipo Creativo"}),f.jsx("p",{className:"text-lg text-slate-300/80 max-w-3xl mx-auto leading-relaxed font-light md:text-base sm:text-sm",children:"Un colectivo de artistas multidisciplinarios unidos por la pasin de crear experiencias teatrales que desafan los lmites del arte escnico y la empata."})]}),f.jsx(se.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8,delay:.2,ease:"easeOut"},viewport:{once:!0},className:"max-w-4xl mx-auto",children:f.jsx(J7,{type:"single",collapsible:!0,className:"w-full space-y-4",ref:r,onValueChange:()=>{r.current&&r.current.scrollIntoView({behavior:"smooth",block:"start"})},children:Object.entries(Z7).map(([o,a],c)=>f.jsxs(U3,{value:`item-${c}`,className:"glass-effect rounded-lg border-none overflow-hidden",children:[f.jsx(H3,{className:"font-display text-xl md:text-2xl text-slate-100 p-6 hover:no-underline hover:bg-white/5 transition-colors duration-300",children:o}),f.jsx(G3,{className:"p-6 pt-0 bg-black/20",children:i(a,o)})]},o))})})]})]})};async function tK(){const n="galeria de gatoencerrado";try{const{data:e,error:t}=await nt.storage.from(n).list("",{limit:100,offset:0,sortBy:{column:"name",order:"desc"}});return t?(console.error("Error al listar imgenes:",t.message),[]):e.filter(r=>r.name.match(/\.(jpg|jpeg|png|webp)$/i)).map(r=>{const i=nt.storage.from(n).getPublicUrl(r.name).data.publicUrl;return{id:r.id||r.name,imgSrc:i,alt:r.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," "),postUrl:i}})}catch(e){return console.error("Excepcin al obtener imgenes del bucket:",e),[]}}const Pv=[{grid:"col-span-2 row-span-3 sm:col-span-3 sm:row-span-4 md:col-span-3 md:row-span-3 lg:col-span-3 lg:row-span-4",offset:"lg:-translate-y-3 lg:rotate-[0.8deg]",frame:"shadow-[17px_17px_0_rgba(164,196,248,0.14)]",tint:"from-sky-300/18 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-3 sm:row-span-2 md:col-span-2 md:row-span-2 lg:col-span-2 lg:row-span-2",offset:"lg:translate-y-2 lg:rotate-[0.3deg]",frame:"shadow-[14px_14px_0_rgba(167,139,250,0.14)]",tint:"from-purple-400/14 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-2 sm:row-span-2 md:col-span-2 md:row-span-2 lg:col-span-3 lg:row-span-3",offset:"lg:translate-y-3 lg:rotate-[0.9deg]",frame:"shadow-[12px_12px_0_rgba(129,140,248,0.14)]",tint:"from-indigo-400/15 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-3 sm:row-span-2 md:col-span-3 md:row-span-2 lg:col-span-3 lg:row-span-3",offset:"lg:-translate-y-2",frame:"shadow-[11px_11px_0_rgba(248,113,113,0.15)]",tint:"from-rose-400/14 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-3 sm:col-span-2 sm:row-span-3 md:col-span-2 md:row-span-3 lg:col-span-2 lg:row-span-4",offset:"lg:translate-y-2 lg:-rotate-[1.6deg]",frame:"shadow-[16px_16px_0_rgba(251,191,36,0.14)]",tint:"from-amber-300/16 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-3 sm:row-span-2 md:col-span-3 md:row-span-2 lg:col-span-3 lg:row-span-2",offset:"lg:-translate-y-4 lg:rotate-[-0.7deg]",frame:"shadow-[13px_13px_0_rgba(45,212,191,0.15)]",tint:"from-teal-300/12 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-2 sm:row-span-2 md:col-span-2 md:row-span-2 lg:col-span-2 lg:row-span-2",offset:"lg:translate-y-3 lg:rotate-[0.6deg]",frame:"shadow-[12px_12px_0_rgba(148,163,184,0.16)]",tint:"from-slate-300/12 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-3 sm:col-span-3 sm:row-span-3 md:col-span-3 md:row-span-3 lg:col-span-4 lg:row-span-4",offset:"lg:-translate-y-2 lg:rotate-[0.4deg]",frame:"shadow-[16px_16px_0_rgba(110,231,183,0.12)]",tint:"from-emerald-300/14 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-2 sm:row-span-2 md:col-span-2 md:row-span-3 lg:col-span-2 lg:row-span-3",offset:"lg:translate-y-2 lg:-rotate-[0.9deg]",frame:"shadow-[13px_13px_0_rgba(244,162,97,0.13)]",tint:"from-orange-300/16 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-3 sm:col-span-3 sm:row-span-4 md:col-span-3 md:row-span-3 lg:col-span-3 lg:row-span-4",offset:"lg:-translate-y-3 lg:rotate-[0.7deg]",frame:"shadow-[17px_17px_0_rgba(164,196,248,0.14)]",tint:"from-sky-300/18 via-transparent to-slate-950/0"},{grid:"col-span-3 row-span-2 sm:col-span-4 sm:row-span-2 md:col-span-4 md:row-span-2 lg:col-span-5 lg:row-span-3",offset:"lg:translate-y-1 lg:-rotate-[0.3deg]",frame:"shadow-[11px_11px_0_rgba(250,204,21,0.15)]",tint:"from-yellow-300/15 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-2 sm:col-span-2 sm:row-span-3 md:col-span-3 md:row-span-3 lg:col-span-3 lg:row-span-3",offset:"lg:-translate-y-1 lg:rotate-[1deg]",frame:"shadow-[15px_15px_0_rgba(153,246,228,0.12)]",tint:"from-teal-200/14 via-transparent to-slate-950/0"},{grid:"col-span-2 row-span-3 sm:col-span-3 sm:row-span-3 md:col-span-2 md:row-span-4 lg:col-span-2 lg:row-span-4",offset:"lg:-translate-y-4 lg:-rotate-[1.1deg]",frame:"shadow-[20px_20px_0_rgba(203,213,225,0.13)]",tint:"from-slate-200/18 via-transparent to-slate-950/0"},{grid:"col-span-3 row-span-2 sm:col-span-4 sm:row-span-2 md:col-span-4 md:row-span-2 lg:col-span-5 lg:row-span-2",offset:"lg:translate-y-1 lg:-rotate-[0.3deg]",frame:"shadow-[31px_11px_0_rgba(250,204,21,0.15)]",tint:"from-sky-300/18 via-transparent to-slate-950/0"},{grid:"col-span-3 row-span-2 sm:col-span-4 sm:row-span-2 md:col-span-4 md:row-span-2 lg:col-span-5 lg:row-span-2",offset:"lg:translate-y-1 lg:-rotate-[0.33deg]",frame:"shadow-[11px_11px_0_rgba(250,204,21,0.15)]",tint:"from-sky-300/18 via-transparent to-slate-950/0"}],nK=[{match:"Copia de Foto 1 (1)",patternIndex:0,story:"Corte al vaco"},{match:"PoloyEstela",patternIndex:1,story:"Microclimas invisibles"},{match:"Copia de Foto 4",patternIndex:2,story:"Un nmero interminable"},{match:"Copia de Foto 3 (1)",patternIndex:3,story:"Memoria desdoblada"},{match:"Pausa entre actos",patternIndex:4,story:"Coreografa de luces"},{match:"Copia de Foto 4 (1)",patternIndex:5,story:"Confesin en penumbra"},{match:"_V7M6314",patternIndex:6,story:"Ritual previo al acto"},{match:"_V7M6296",patternIndex:7,story:"Risa entre grietas"},{match:"_V7M6348",patternIndex:8,story:"La jaula bajo la mesa"},{match:"Xanadu",patternIndex:9,story:"Voz que no se nombra"},{match:"_V7M6281",patternIndex:10,story:"El pliegue del vestido"},{match:"_V7M6324",patternIndex:11,story:"La cuerda floja"},{match:"_V7M6329",patternIndex:12,story:"Luz que acusa"},{match:"Copia de Foto 5 (1)",patternIndex:13,story:"Un eco sin dueo"},{match:"DSC02497",patternIndex:14,story:"Vestigio de sombras"}],$u=["Vestigio de sombras"],sK=()=>{const[n,e]=A.useState([]),[t,s]=A.useState(null),r="https://www.instagram.com/esungatoencerrado/?hl=en",i=15,[o,a]=A.useState(null),c=A.useRef(null),u=A.useRef(null),[d,h]=A.useState([]),p=A.useRef(0),m=A.useRef([]),y=A.useCallback((D,V)=>{if(!V)return!1;const I=`${D.alt||""} ${D.imgSrc||""}`.toLowerCase();return Array.isArray(V)?V.some(R=>I.includes(String(R).toLowerCase())):I.includes(String(V).toLowerCase())},[]),g=A.useCallback(D=>["susurro de vestuario","foto 2"].some(I=>y(D,I)),[y]);A.useEffect(()=>{(async()=>{try{const V=await tK();e(V)}catch(V){console.error("Error al traer imgenes del bucket:",V),s("No se pudieron cargar las imgenes del bucket.")}})()},[]),A.useEffect(()=>{if(n.length===0){h([]),p.current=0,m.current=[];return}const D=n.map((z,B)=>({post:z,originalIndex:B})).filter(({post:z})=>!g(z));if(D.length===0){h([]),p.current=0,m.current=[];return}const V=new Set,I=[];nK.forEach(z=>{const B=D.findIndex((H,U)=>!V.has(U)&&y(H.post,z.match));if(B!==-1){const H=D[B];V.add(B),I.push({postIndex:H.originalIndex,patternIndex:z.patternIndex??I.length%Pv.length,story:z.story??$u[I.length%$u.length]})}});const R=D.map((z,B)=>({...z,idx:B})).filter(({idx:z})=>!V.has(z)).map((z,B)=>({postIndex:z.originalIndex,patternIndex:(I.length+B)%Pv.length,story:$u[(I.length+B)%$u.length]})),j=[...I,...R];if(m.current=j,j.length===0){h([]),p.current=0;return}const F=Math.min(i,j.length),$=j.slice(0,F).map((z,B)=>({slotId:`${Date.now()}-${B}-${z.postIndex}-${Math.random()}`,postIndex:z.postIndex,patternIndex:z.patternIndex,story:z.story}));h($),p.current=j.length>0?F%j.length:0},[n,i,y,g]);const w=D=>{window.open(D,"_blank","noopener,noreferrer")},v=A.useCallback(D=>{c.current=document.activeElement,a(D)},[]),b=A.useCallback(()=>{a(null),c.current&&typeof c.current.focus=="function"&&c.current.focus()},[]),S=A.useCallback(()=>{a(D=>D===null?D:(D-1+n.length)%n.length)},[n.length]),E=A.useCallback(()=>{a(D=>D===null?D:(D+1)%n.length)},[n.length]);A.useEffect(()=>{if(o===null)return;const D=V=>{V.key==="Escape"&&b(),V.key==="ArrowLeft"&&S(),V.key==="ArrowRight"&&E()};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[o,b,S,E]);const k=o!==null,T=k&&n[o]?n[o]:null,P=n.length,N=o!==null?o:0,M=P>0?(N+1)/P*100:0;A.useEffect(()=>{k&&u.current&&u.current.focus()},[k]);const L={hidden:{opacity:0,y:40,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.55,ease:"easeOut"}},exit:{opacity:0,y:-30,scale:.94,transition:{duration:.4,ease:"easeInOut"}}},O=A.useCallback((D,V)=>{if(!V||n.length<=i)return;const I=typeof window<"u"?window.innerHeight:0,R=V.boundingClientRect.bottom<=0,j=I?V.boundingClientRect.top>=I:!1;!R&&!j||h(F=>{if(!Array.isArray(F)||F.length===0)return F;const $=[...F],z=new Set($.filter((Q,ge)=>ge!==D).map(Q=>Q.postIndex)),B=m.current;if(!B||B.length===0)return F;let H=p.current??0,U=0;for(;U<B.length&&z.has(B[H].postIndex);)H=(H+1)%B.length,U+=1;if(U>=B.length)return F;const Y=B[H];return p.current=(H+1)%B.length,$[D]={slotId:`${Date.now()}-${D}-${Y.postIndex}-${Math.random()}`,postIndex:Y.postIndex,patternIndex:Y.patternIndex,story:Y.story},$})},[n.length,i]);return f.jsxs("section",{id:"instagram",className:"py-20 relative",children:[f.jsx("div",{className:"section-divider mb-20"}),f.jsxs("div",{className:"container mx-auto px-5 sm:px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.75,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-14",children:[f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-5 text-gradient italic",children:"Memoria Escnica"}),f.jsx("p",{className:"text-base md:text-lg text-slate-300/75 max-w-3xl mx-auto leading-relaxed mb-7 font-light",children:"Fragmentos de lo que solo sucede en escena Un homenaje visual al trabajo colectivo detrs de #GatoEncerrado: las funciones, los cuerpos, los silencios, las luces lo que solo existe cuando alguien lo mira."}),f.jsxs(xe,{onClick:()=>w(r),className:"bg-gradient-to-r from-pink-600/80 via-purple-600/80 to-indigo-600/80 hover:from-pink-600 hover:to-purple-600 text-white px-7 py-3 rounded-full font-semibold flex items-center gap-2 mx-auto hover-glow",children:[f.jsx(xk,{size:20}),"Seguir @esungatonecerrado",f.jsx(A$,{size:16})]})]}),t&&f.jsxs("div",{className:"flex items-center justify-center gap-3 p-4 mb-6 text-center text-red-400 bg-red-900/20 rounded-lg",children:[f.jsx(g$,{size:22}),f.jsx("p",{children:t})]}),d.length>0?f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 lg:grid-cols-8 auto-rows-[95px] sm:auto-rows-[110px] md:auto-rows-[130px] lg:auto-rows-[150px] gap-2 md:gap-3 lg:gap-3.5",children:f.jsx(Co,{mode:"popLayout",children:d.map((D,V)=>{const I=n[D.postIndex];if(!I)return null;const R=Pv[D.patternIndex%Pv.length],j=D.story??$u[(V+D.postIndex)%$u.length];return f.jsx(se.button,{type:"button",layout:!0,variants:L,initial:"hidden",animate:"visible",exit:"exit",viewport:{amount:.5,once:!1},onViewportLeave:F=>O(V,F),onClick:()=>v(D.postIndex),onKeyDown:F=>{F.key==="Enter"&&v(D.postIndex)},className:`group relative isolate flex h-full w-full cursor-pointer items-stretch focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-pink-400/60 ${R.grid}`,children:f.jsx("div",{className:`relative h-full w-full transition-transform duration-300 ease-out ${R.offset}`,children:f.jsxs(se.div,{layout:!0,variants:L,initial:"hidden",whileInView:"visible",viewport:{amount:.6,once:!1},whileHover:{translateY:-6},transition:{duration:.35,ease:"easeOut"},className:`relative flex h-full w-full overflow-hidden rounded-[20px] bg-slate-950/70 backdrop-blur-sm ${R.frame}`,children:[f.jsx("span",{className:`pointer-events-none absolute inset-0 bg-gradient-to-br ${R.tint}`,"aria-hidden":"true"}),f.jsx(se.img,{src:I.imgSrc,alt:I.alt||"Recuerdo #GatoEncerrado",className:"absolute inset-0 h-full w-full object-cover",loading:"lazy",initial:{scale:1.02,y:0,opacity:1},whileHover:{scale:1.06},transition:{duration:.35,ease:"easeOut"}}),f.jsxs("div",{className:"relative flex h-full flex-col justify-between p-3 md:p-4",children:[f.jsx("div",{className:"text-[0.58rem] uppercase tracking-[0.3em] text-slate-200/75 mix-blend-screen",children:"#GatoEncerrado"}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("div",{className:"w-8 md:w-10 border-t border-slate-200/30"}),f.jsx("p",{className:"text-[0.8rem] md:text-sm font-light text-slate-50/90 max-w-[10rem] md:max-w-[10.5rem] leading-relaxed drop-shadow-[0_10px_22px_rgba(15,23,42,0.6)]",children:j})]})]})]})})},D.slotId)})})}):!t&&f.jsx("div",{className:"text-center text-slate-400 animate-pulse italic",children:f.jsx("p",{children:"Cargando recuerdos..."})}),f.jsx(Co,{children:k&&T&&f.jsxs(se.div,{className:"fixed inset-0 z-50 flex items-center justify-center px-6",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[f.jsx(se.div,{className:"absolute inset-0 bg-slate-950/80",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),f.jsxs(se.div,{className:"relative z-10 w-full max-w-5xl overflow-hidden rounded-[28px] bg-slate-900/90 backdrop-blur-xl shadow-2xl",role:"dialog","aria-modal":"true","aria-label":"Recuerdo ampliado",initial:{scale:.92,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.92,opacity:0},transition:{type:"spring",stiffness:220,damping:26},children:[f.jsxs("div",{className:"flex flex-col gap-4 p-6 md:flex-row md:items-center md:gap-6",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between text-slate-300/90",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-300/70",children:"#GatoEncerrado"}),f.jsxs("span",{className:"text-xs font-medium tracking-wide",children:[P>0?`${N+1}`:"0",f.jsxs("span",{className:"text-slate-400/80",children:["/",P]})]})]}),f.jsx("div",{className:"mt-3 h-2 rounded-full bg-white/10 overflow-hidden",children:f.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-pink-400 via-purple-400 to-indigo-400 transition-all duration-500",style:{width:`${M}%`},"aria-hidden":"true"})})]}),f.jsxs("div",{className:"flex items-center gap-3 self-start md:self-center",children:[f.jsx("button",{"aria-label":"Anterior",onClick:S,className:"flex h-11 w-11 items-center justify-center rounded-full border border-white/20 text-white transition hover:bg-white/10",children:f.jsx(w$,{size:20})}),f.jsx("button",{"aria-label":"Siguiente",onClick:E,className:"flex h-11 w-11 items-center justify-center rounded-full border border-white/20 text-white transition hover:bg-white/10",children:f.jsx(S$,{size:20})}),f.jsx("button",{ref:u,"aria-label":"Cerrar",onClick:b,className:"flex h-11 w-11 items-center justify-center rounded-full border border-white/20 text-white transition hover:bg-white/10",children:f.jsx(R1,{size:18})})]})]}),f.jsx("div",{className:"relative aspect-[3/2] w-full bg-black",children:f.jsx("img",{src:T.imgSrc,alt:T.alt||"Recuerdo #GatoEncerrado",className:"h-full w-full object-contain"})})]})]},"gallery-modal")})]})]})},rK=()=>{const[n,e]=A.useState(!1),[t,s]=A.useState("preventa"),r=A.useCallback(o=>{s(o),e(!0)},[]),i=A.useCallback(()=>{e(!1)},[]);return f.jsxs(f.Fragment,{children:[f.jsxs("section",{id:"next-show",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsx("div",{className:"container mx-auto px-6",children:f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"glass-effect rounded-2xl p-8 md:p-12 text-center overflow-hidden",children:[f.jsxs("div",{className:"relative z-10",children:[f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-4 text-gradient italic",children:"Prxima Funcin"}),f.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[f.jsx(vk,{size:24,className:"text-purple-300"}),f.jsx("span",{className:"font-display text-2xl md:text-3xl text-slate-100 font-semibold",children:"28 de Diciembre"})]}),f.jsx("p",{className:"text-lg text-slate-300/80 max-w-2xl mx-auto leading-relaxed mb-8 italic font-light",children:'"En el Da de los Santos Inocentes, te invitamos a dudar de todo, incluso de lo que crees ver en escena. Quizs la mayor inocentada es pensar que algo es real."'}),f.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:f.jsxs(xe,{onClick:()=>r("preventa"),className:"bg-gradient-to-r from-orange-500/90 via-rose-500/90 to-pink-500/90 hover:from-orange-400 hover:to-pink-400 text-white px-6 py-3 rounded-full font-semibold flex items-center gap-2 shadow-lg shadow-orange-500/40 transition",children:[f.jsx(Sk,{size:20}),"Compra tu boleto"]})})]}),f.jsx("div",{className:"absolute -top-20 -left-20 w-64 h-64 bg-purple-900/20 rounded-full blur-3xl animate-pulse"}),f.jsx("div",{className:"absolute -bottom-20 -right-20 w-64 h-64 bg-blue-900/20 rounded-full blur-3xl animate-pulse animation-delay-2000"})]})})]}),f.jsx(sT,{open:n,onClose:i,initialInterest:t})]})},iK=()=>{const[n,e]=A.useState({name:"",email:"",message:""}),[t,s]=A.useState("idle"),[r,i]=A.useState(""),o="https://www.instagram.com/esungatoencerrado/?hl=en",a="https://x.com/SilvestreFilis",c="https://www.facebook.com/share/16pHNpZjpM/?mibextid=wwXIfr",u=A.useCallback(async p=>{if(p.preventDefault(),t==="loading")return;const m=n.name.trim(),y=n.email.trim(),g=n.message.trim();if(!m||!y||!g){Ae({description:"Completa nombre, email y mensaje antes de enviar."});return}s("loading"),i("");try{const{error:w}=await nt.functions.invoke("send-contact-message",{body:{name:m,email:y.toLowerCase(),message:g}});if(w)throw w;try{const{error:v}=await nt.from("backstage_inbox").insert({name:m,email:y.toLowerCase(),subject:"Contacto pblico",message:g,meta:{route:"contact"}});v&&console.error("[Contact] No se pudo duplicar en backstage_inbox:",v)}catch(v){console.error("[Contact] Excepcin duplicando en backstage_inbox:",v)}s("success"),e({name:"",email:"",message:""}),Ae({description:"Recibimos tu mensaje y te escribiremos pronto."})}catch(w){console.error("[Contact] Error enviando mensaje:",w),s("error"),i("No pudimos enviar tu mensaje. Intenta de nuevo ms tarde."),Ae({description:"No pudimos enviar tu mensaje. Intenta de nuevo."})}},[n,t]),d=()=>{Ae({description:" Esta funcin no est implementada anpero no te preocupes! Puedes solicitarla en tu prximo prompt! "})},h=p=>{p?window.open(p,"_blank","noopener,noreferrer"):Ae({description:" Esta funcin no est implementada anpero no te preocupes! Puedes solicitarla en tu prximo prompt! "})};return f.jsxs("section",{id:"contact",className:"py-24 relative",children:[f.jsx("div",{className:"section-divider mb-24"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs(se.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"text-center mb-16",children:[f.jsx("h2",{className:"font-display text-4xl md:text-5xl font-medium mb-6 text-gradient italic",children:"Contacto, Prensa & Crditos"}),f.jsx("p",{className:"text-lg text-slate-300/80 max-w-3xl mx-auto leading-relaxed font-light",children:"Para colaboraciones, entrevistas o simplemente para compartir tus teoras. Aqu cae el teln, pero la conversacin contina."})]}),f.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[f.jsxs(se.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"glass-effect rounded-2xl p-8",children:[f.jsx("h3",{className:"font-display text-2xl font-medium text-slate-100 mb-8",children:"Envanos un Mensaje"}),f.jsxs("form",{onSubmit:u,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-slate-300/80 text-sm font-medium mb-2",children:"Nombre"}),f.jsx("input",{name:"name",type:"text",value:n.name,onChange:p=>e(m=>({...m,name:p.target.value})),className:"w-full px-4 py-3 bg-black/30 border border-slate-100/20 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"Tu nombre"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-slate-300/80 text-sm font-medium mb-2",children:"Email"}),f.jsx("input",{name:"email",type:"email",value:n.email,onChange:p=>e(m=>({...m,email:p.target.value})),className:"w-full px-4 py-3 bg-black/30 border border-slate-100/20 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400",placeholder:"tu@email.com"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-slate-300/80 text-sm font-medium mb-2",children:"Mensaje"}),f.jsx("textarea",{name:"message",rows:5,value:n.message,onChange:p=>e(m=>({...m,message:p.target.value})),className:"w-full px-4 py-3 bg-black/30 border border-slate-100/20 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400 resize-none",placeholder:"Cuntanos ms..."})]}),t==="error"&&f.jsx("div",{className:"rounded-lg border border-red-500/60 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:r}),t==="success"&&f.jsx("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-500/10 px-4 py-3 text-sm text-emerald-200",children:"Tu mensaje lleg. Te escribiremos a la brevedad."}),f.jsxs(xe,{type:"submit",disabled:t==="loading",className:"w-full bg-gradient-to-r from-purple-600/80 to-indigo-600/80 hover:from-purple-600 hover:to-indigo-600 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover-glow",children:[f.jsx(j$,{size:20}),t==="loading"?"Enviando":"Enviar"]})]})]}),f.jsxs(se.div,{initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},transition:{duration:.8,ease:"easeOut"},viewport:{once:!0},className:"space-y-8",children:[f.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[f.jsx("h3",{className:"font-display text-xl font-medium text-slate-100 mb-4",children:"Redes Sociales"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(xe,{onClick:()=>h(o),variant:"ghost",size:"icon",className:"text-slate-400 hover:text-white",children:f.jsx(xk,{size:24})}),f.jsx(xe,{onClick:()=>h(a),variant:"ghost",size:"icon",className:"text-slate-400 hover:text-white",children:f.jsx(YL,{size:24})}),f.jsx(xe,{onClick:()=>h(c),variant:"ghost",size:"icon",className:"text-slate-400 hover:text-white",children:f.jsx(GL,{size:24})})]})]}),f.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[f.jsx("h3",{className:"font-display text-xl font-medium text-slate-100 mb-4",children:"Kit de Prensa"}),f.jsx("p",{className:"text-slate-300/70 mb-4 font-light",children:"Descarga nuestro kit de prensa con imgenes en alta resolucin, dossier y ms."}),f.jsxs(xe,{onClick:d,variant:"outline",className:"border-purple-400/50 text-purple-300 hover:bg-purple-500/20 hover:border-purple-400",children:[f.jsx(_$,{size:18,className:"mr-2"}),"Descargar Kit"]})]}),f.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[f.jsx("h3",{className:"font-display text-xl font-medium text-slate-100 mb-4",children:"Crditos Finales"}),f.jsxs("p",{className:"text-slate-300/70 text-sm leading-relaxed font-light",children:["Una produccin de ",f.jsx("span",{className:"text-slate-200",children:"#GatoEncerrado"}),".",f.jsx("br",{}),"Con el apoyo de ",f.jsx("span",{className:"text-slate-200",children:"Isabel Ayuda para la Vida, A.C."}),".",f.jsx("br",{}),"Agradecimientos especiales a todos los que creyeron en esta locura."]})]})]})]})]})]})},oK=()=>{const n="https://www.instagram.com/esungatoencerrado/?hl=en",e="https://x.com/SilvestreFilis",t="https://www.facebook.com/share/16pHNpZjpM/?mibextid=wwXIfr",s=i=>{i?window.open(i,"_blank","noopener,noreferrer"):Ae({description:" Esta funcin no est implementada anpero no te preocupes! Puedes solicitarla en tu prximo prompt! "})},r=i=>{const o=document.querySelector(i);o&&o.scrollIntoView({behavior:"smooth"})};return f.jsxs("footer",{className:"relative py-16 mt-24",children:[f.jsx("div",{className:"section-divider mb-16"}),f.jsxs("div",{className:"container mx-auto px-6",children:[f.jsxs("div",{className:"grid md:grid-cols-4 gap-8 mb-12",children:[f.jsx("div",{className:"md:col-span-2",children:f.jsxs(se.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},viewport:{once:!0},children:[f.jsx("span",{className:"font-display text-3xl font-medium italic text-gradient mb-4 block",children:"#GatoEncerrado"}),f.jsx("p",{className:"text-slate-400 leading-relaxed mb-6 max-w-md font-light",children:"Una experiencia teatral transmedial que explora los lmites entre la realidad y la ficcin, creando nuevas formas de narrativa artstica."}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>s(n),className:"text-slate-400 hover:text-white hover:bg-white/10",children:f.jsx(xk,{size:20})}),f.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>s(e),className:"text-slate-400 hover:text-white hover:bg-white/10",children:f.jsx(YL,{size:20})}),f.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>s(t),className:"text-slate-400 hover:text-white hover:bg-white/10",children:f.jsx(GL,{size:20})}),f.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>r("#contact"),className:"text-slate-400 hover:text-white hover:bg-white/10",children:f.jsx(C$,{size:20})})]})]})}),f.jsx("div",{children:f.jsxs(se.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1,ease:"easeOut"},viewport:{once:!0},children:[f.jsx("span",{className:"font-semibold text-slate-200 mb-4 block",children:"Navegacin"}),f.jsx("ul",{className:"space-y-3",children:[{name:"La Obra",href:"#about"},{name:"Equipo",href:"#team"},{name:"Miniversos",href:"#transmedia"},{name:"Textos",href:"#dialogo-critico"},{name:"Galera",href:"#instagram"},{name:"Funcin",href:"#next-show"}].map(i=>f.jsx("li",{children:f.jsx("button",{onClick:()=>r(i.href),className:"text-slate-400 hover:text-white transition-colors text-sm font-light",children:i.name})},i.name))})]})}),f.jsx("div",{children:f.jsxs(se.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2,ease:"easeOut"},viewport:{once:!0},children:[f.jsx("span",{className:"font-semibold text-slate-200 mb-4 block",children:"Contacto"}),f.jsxs("ul",{className:"space-y-3 text-sm font-light",children:[f.jsx("li",{className:"text-slate-400",children:"contacto@gatoencerrado.ai"}),f.jsx("li",{className:"text-slate-400",children:"+52 123 456 789"}),f.jsxs("li",{className:"text-slate-400",children:["#UniversoTransmedial",f.jsx("br",{}),"Tijuana, Mxico"]})]})]})})]}),f.jsxs(se.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.3,ease:"easeOut"},viewport:{once:!0},className:"border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[f.jsxs("p",{className:"text-slate-500 text-sm",children:[" ",new Date().getFullYear()," #GatoEncerrado. Todos los derechos reservados."]}),f.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[f.jsx("span",{children:"Hecho con"}),f.jsx(WL,{size:16,className:"text-red-500/70"}),f.jsx("span",{children:"para el arte teatral"})]})]})]})]})},aK=()=>{const[n,e]=A.useState([]),[t,s]=A.useState(!0),[r,i]=A.useState(null),o=A.useCallback(async()=>{s(!0),i(null);try{const a=await uq();e(Array.isArray(a)?a:[])}catch(a){console.error("[useBlogPosts] Error al cargar posts:",a),i(a),e([])}finally{s(!1)}},[]);return A.useEffect(()=>{o()},[o]),{posts:n,isLoading:t,error:r,refreshPosts:o}},lK="#GatoEncerrado - Obra de Teatro Transmedial",cK="La historia de alguien que desaparece y deja una huella emocional. Una experiencia teatral nica que explora mltiples formatos transmediales.";function uK(){const n=aK();return A.useEffect(()=>{document.title=lK;let e=document.querySelector('meta[name="description"]');e||(e=document.createElement("meta"),e.setAttribute("name","description"),document.head.appendChild(e)),e.setAttribute("content",cK)},[]),f.jsxs("div",{className:"min-h-screen overflow-x-hidden",children:[f.jsx(BG,{}),f.jsxs("main",{className:"pt-20 lg:pt-24",children:[f.jsx(JG,{}),f.jsx(sq,{}),f.jsx(eK,{}),f.jsx(P7,{posts:n.posts,isLoading:n.isLoading,error:n.error}),f.jsx(p7,{}),f.jsx(sK,{}),f.jsx(rK,{}),f.jsx(iK,{})]}),f.jsx(oK,{}),f.jsx(yz,{})]})}b_.createRoot(document.getElementById("root")).render(f.jsx(Re.StrictMode,{children:f.jsx(OG,{children:f.jsx(uK,{})})}));
